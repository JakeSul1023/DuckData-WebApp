/*! For license information please see main.5f285f21.js.LICENSE.txt */
(()=>{"use strict";var e={732:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler");Symbol.for("react.provider");var a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),g=Symbol.for("react.client.reference");function m(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case o:case s:case u:case h:return e;default:switch(e=e&&e.$$typeof){case l:case c:case f:case d:case a:return e;default:return t}}case r:return t}}}t.Hy=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===o||e===s||e===u||e===h||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===d||e.$$typeof===l||e.$$typeof===a||e.$$typeof===c||e.$$typeof===g||void 0!==e.getModuleId)}},232:e=>{function t(e,t,r){r=r||2;var s,o,a,l,h,d,p,g=t&&t.length,m=g?t[0]*r:e.length,_=n(e,0,m,r,!0),y=[];if(!_||_.next===_.prev)return y;if(g&&(_=function(e,t,r,i){var s,o,a,l=[];for(s=0,o=t.length;s<o;s++)(a=n(e,t[s]*i,s<o-1?t[s+1]*i:e.length,i,!1))===a.next&&(a.steiner=!0),l.push(f(a));for(l.sort(c),s=0;s<l.length;s++)r=u(l[s],r);return r}(e,t,_,r)),e.length>80*r){s=a=e[0],o=l=e[1];for(var v=r;v<m;v+=r)(h=e[v])<s&&(s=h),(d=e[v+1])<o&&(o=d),h>a&&(a=h),d>l&&(l=d);p=0!==(p=Math.max(a-s,l-o))?32767/p:0}return i(_,y,r,s,o,p,0),y}function n(e,t,n,r,i){var s,o;if(i===A(e,t,n,r)>0)for(s=t;s<n;s+=r)o=S(s,e[s],e[s+1],o);else for(s=n-r;s>=t;s-=r)o=S(s,e[s],e[s+1],o);return o&&_(o,o.next)&&(x(o),o=o.next),o}function r(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!_(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(x(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function i(e,t,n,c,u,h,f){if(e){!f&&h&&function(e,t,n,r){var i=e;do{0===i.z&&(i.z=d(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,s,o,a,l,c=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,r=n,a=0,t=0;t<c&&(a++,r=r.nextZ);t++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1)}(i)}(e,c,u,h);for(var p,g,m=e;e.prev!==e.next;)if(p=e.prev,g=e.next,h?o(e,c,u,h):s(e))t.push(p.i/n|0),t.push(e.i/n|0),t.push(g.i/n|0),x(e),e=g.next,m=g.next;else if((e=g)===m){f?1===f?i(e=a(r(e),t,n),t,n,c,u,h,2):2===f&&l(e,t,n,c,u,h):i(r(e),t,n,c,u,h,1);break}}}function s(e){var t=e.prev,n=e,r=e.next;if(m(t,n,r)>=0)return!1;for(var i=t.x,s=n.x,o=r.x,a=t.y,l=n.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=i>s?i>o?i:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,g=r.next;g!==t;){if(g.x>=u&&g.x<=d&&g.y>=h&&g.y<=f&&p(i,a,s,l,o,c,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function o(e,t,n,r){var i=e.prev,s=e,o=e.next;if(m(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,u=i.y,h=s.y,f=o.y,g=a<l?a<c?a:c:l<c?l:c,_=u<h?u<f?u:f:h<f?h:f,y=a>l?a>c?a:c:l>c?l:c,v=u>h?u>f?u:f:h>f?h:f,b=d(g,_,t,n,r),w=d(y,v,t,n,r),E=e.prevZ,S=e.nextZ;E&&E.z>=b&&S&&S.z<=w;){if(E.x>=g&&E.x<=y&&E.y>=_&&E.y<=v&&E!==i&&E!==o&&p(a,u,l,h,c,f,E.x,E.y)&&m(E.prev,E,E.next)>=0)return!1;if(E=E.prevZ,S.x>=g&&S.x<=y&&S.y>=_&&S.y<=v&&S!==i&&S!==o&&p(a,u,l,h,c,f,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;E&&E.z>=b;){if(E.x>=g&&E.x<=y&&E.y>=_&&E.y<=v&&E!==i&&E!==o&&p(a,u,l,h,c,f,E.x,E.y)&&m(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;S&&S.z<=w;){if(S.x>=g&&S.x<=y&&S.y>=_&&S.y<=v&&S!==i&&S!==o&&p(a,u,l,h,c,f,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function a(e,t,n){var i=e;do{var s=i.prev,o=i.next.next;!_(s,o)&&y(s,i,i.next,o)&&w(s,o)&&w(o,s)&&(t.push(s.i/n|0),t.push(i.i/n|0),t.push(o.i/n|0),x(i),x(i.next),i=e=o),i=i.next}while(i!==e);return r(i)}function l(e,t,n,s,o,a){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&g(l,c)){var u=E(l,c);return l=r(l,l.next),u=r(u,u.next),i(l,t,n,s,o,a,0),void i(u,t,n,s,o,a,0)}c=c.next}l=l.next}while(l!==e)}function c(e,t){return e.x-t.x}function u(e,t){var n=function(e,t){var n,r=t,i=e.x,s=e.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>o&&(o=a,n=r.x<r.next.x?r:r.next,a===i))return n}r=r.next}while(r!==t);if(!n)return null;var l,c=n,u=n.x,d=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=u&&i!==r.x&&p(s<d?i:o,s,u,d,s<d?o:i,s,r.x,r.y)&&(l=Math.abs(s-r.y)/(i-r.x),w(r,e)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,f=l)),r=r.next}while(r!==c);return n}(e,t);if(!n)return t;var i=E(n,e);return r(i,i.next),r(n,n.next)}function h(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0}function d(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function p(e,t,n,r,i,s,o,a){return(i-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(r-a)>=(n-o)*(t-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function g(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&y(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||_(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0)}function m(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function _(e,t){return e.x===t.x&&e.y===t.y}function y(e,t,n,r){var i=b(m(e,t,n)),s=b(m(e,t,r)),o=b(m(n,r,e)),a=b(m(n,r,t));return i!==s&&o!==a||(!(0!==i||!v(e,n,t))||(!(0!==s||!v(e,r,t))||(!(0!==o||!v(n,e,r))||!(0!==a||!v(n,t,r)))))}function v(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function b(e){return e>0?1:e<0?-1:0}function w(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function E(e,t){var n=new T(e.i,e.x,e.y),r=new T(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function S(e,t,n,r){var i=new T(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function x(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(e,t,n,r){for(var i=0,s=t,o=n-r;s<n;s+=r)i+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return i}e.exports=t,e.exports.default=t,t.deviation=function(e,t,n,r){var i=t&&t.length,s=i?t[0]*n:e.length,o=Math.abs(A(e,0,s,n));if(i)for(var a=0,l=t.length;a<l;a++){var c=t[a]*n,u=a<l-1?t[a+1]*n:e.length;o-=Math.abs(A(e,c,u,n))}var h=0;for(a=0;a<r.length;a+=3){var d=r[a]*n,f=r[a+1]*n,p=r[a+2]*n;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},t.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)for(var o=0;o<t;o++)n.vertices.push(e[i][s][o]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},85:(e,t,n)=>{var r=n(340),i=n(950),s=n(119);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}var l=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),g=Symbol.for("react.consumer"),m=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),w=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var E=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var S=Symbol.for("react.memo_cache_sentinel"),x=Symbol.iterator;function T(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=x&&e[x]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function C(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case h:return"Fragment";case u:return"Portal";case f:return"Profiler";case d:return"StrictMode";case y:return"Suspense";case v:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case m:return(e.displayName||"Context")+".Provider";case g:return(e._context.displayName||"Context")+".Consumer";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case b:return null!==(t=e.displayName||null)?t:C(e.type)||"Memo";case w:t=e._payload,e=e._init;try{return C(e(t))}catch(n){}}return null}var R,P,k=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M=Object.assign;function L(e){if(void 0===R)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||"",P=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+R+e+P}var I=!1;function O(e,t){if(!e||I)return"";I=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(s){r=s}e.call(n.prototype)}}else{try{throw Error()}catch(o){r=o}(n=e())&&"function"===typeof n.catch&&n.catch((function(){}))}}catch(a){if(a&&r&&"string"===typeof a.stack)return[a.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=r.DetermineComponentFrameRoot(),o=s[0],a=s[1];if(o&&a){var l=o.split("\n"),c=a.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{I=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?L(n):""}function N(e){switch(e.tag){case 26:case 27:case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 15:return e=O(e.type,!1);case 11:return e=O(e.type.render,!1);case 1:return e=O(e.type,!0);default:return""}}function F(e){try{var t="";do{t+=N(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function D(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function B(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function U(e){if(D(e)!==e)throw Error(o(188))}function z(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=z(e)))return t;e=e.sibling}return null}var G=Array.isArray,V=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},W=[],$=-1;function H(e){return{current:e}}function X(e){0>$||(e.current=W[$],W[$]=null,$--)}function q(e,t){$++,W[$]=e.current,e.current=t}var K=H(null),Y=H(null),Z=H(null),Q=H(null);function J(e,t){switch(q(Z,t),q(Y,e),q(K,null),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?Yu(t):0;break;default:if(t=(e=8===e?t.parentNode:t).tagName,e=e.namespaceURI)t=Zu(e=Yu(e),t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}X(K),q(K,t)}function ee(){X(K),X(Y),X(Z)}function te(e){null!==e.memoizedState&&q(Q,e);var t=K.current,n=Zu(t,e.type);t!==n&&(q(Y,e),q(K,n))}function ne(e){Y.current===e&&(X(K),X(Y)),Q.current===e&&(X(Q),Fh._currentValue=j)}var re=Object.prototype.hasOwnProperty,ie=r.unstable_scheduleCallback,se=r.unstable_cancelCallback,oe=r.unstable_shouldYield,ae=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,he=r.unstable_UserBlockingPriority,de=r.unstable_NormalPriority,fe=r.unstable_LowPriority,pe=r.unstable_IdlePriority,ge=r.log,me=r.unstable_setDisableYieldValue,_e=null,ye=null;function ve(e){if("function"===typeof ge&&me(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(_e,e)}catch(t){}}var be=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(we(e)/Ee|0)|0},we=Math.log,Ee=Math.LN2;var Se=128,xe=4194304;function Te(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=e.warmLanes;e=0!==e.finishedLanes;var a=134217727&n;return 0!==a?0!==(n=a&~i)?r=Te(n):0!==(s&=a)?r=Te(s):e||0!==(o=a&~o)&&(r=Te(o)):0!==(a=n&~i)?r=Te(a):0!==s?r=Te(s):e||0!==(o=n&~o)&&(r=Te(o)),0===r?0:0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||32===i&&0!==(4194176&o))?t:r}function Ce(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Re(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Pe(){var e=Se;return 0===(4194176&(Se<<=1))&&(Se=128),e}function ke(){var e=xe;return 0===(62914560&(xe<<=1))&&(xe=4194304),e}function Me(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Le(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ie(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-be(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194218&n}function Oe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-be(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Ne(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Fe(){var e=V.p;return 0!==e?e:void 0===(e=window.event)?32:Zh(e.type)}var De=Math.random().toString(36).slice(2),Be="__reactFiber$"+De,Ue="__reactProps$"+De,ze="__reactContainer$"+De,Ge="__reactEvents$"+De,Ve="__reactListeners$"+De,je="__reactHandles$"+De,We="__reactResources$"+De,$e="__reactMarker$"+De;function He(e){delete e[Be],delete e[Ue],delete e[Ge],delete e[Ve],delete e[je]}function Xe(e){var t=e[Be];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ze]||n[Be]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=lh(e);null!==e;){if(n=e[Be])return n;e=lh(e)}return t}n=(e=n).parentNode}return null}function qe(e){if(e=e[Be]||e[ze]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ke(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function Ye(e){var t=e[We];return t||(t=e[We]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ze(e){e[$e]=!0}var Qe=new Set,Je={};function et(e,t){tt(e,t),tt(e+"Capture",t)}function tt(e,t){for(Je[e]=t,e=0;e<t.length;e++)Qe.add(t[e])}var nt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),rt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},st={};function ot(e,t,n){if(i=t,re.call(st,i)||!re.call(it,i)&&(rt.test(i)?st[i]=!0:(it[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function at(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function lt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function dt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function gt(e){return e.replace(pt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function mt(e,t,n,r,i,s,o,a){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?yt(e,o,ct(t)):null!=n?yt(e,o,ct(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=s&&(e.defaultChecked=!!s),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ct(a):e.removeAttribute("name")}function _t(e,t,n,r,i,s,o,a){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o)}function yt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function vt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function bt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(o(92));if(G(r)){if(1<r.length)throw Error(o(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function Et(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Tt(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&xt(e,i,r)}else for(var s in t)t.hasOwnProperty(s)&&xt(e,s,t[s])}function At(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ct=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Rt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Rt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var kt=null;function Mt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Lt=null,It=null;function Ot(e){var t=qe(e);if(t&&(e=t.stateNode)){var n=e[Ue]||null;e:switch(e=t.stateNode,t.type){case"input":if(mt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+gt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[Ue]||null;if(!i)throw Error(o(90));mt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&dt(r)}break e;case"textarea":bt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&vt(e,!!n.multiple,t,!1)}}}var Nt=!1;function Ft(e,t,n){if(Nt)return e(t,n);Nt=!0;try{return e(t)}finally{if(Nt=!1,(null!==Lt||null!==It)&&(Bc(),Lt&&(t=Lt,e=It,It=Lt=null,Ot(t),e)))for(t=0;t<e.length;t++)Ot(e[t])}}function Dt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Ue]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Bt=!1;if(nt)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch(wd){Bt=!1}var zt=null,Gt=null,Vt=null;function jt(){if(Vt)return Vt;var e,t,n=Gt,r=n.length,i="value"in zt?zt.value:zt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Vt=i.slice(e,1<t?1-t:void 0)}function Wt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function $t(){return!0}function Ht(){return!1}function Xt(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?$t:Ht,this.isPropagationStopped=Ht,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=$t)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=$t)},persist:function(){},isPersistent:$t}),t}var qt,Kt,Yt,Zt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qt=Xt(Zt),Jt=M({},Zt,{view:0,detail:0}),en=Xt(Jt),tn=M({},Jt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yt&&(Yt&&"mousemove"===e.type?(qt=e.screenX-Yt.screenX,Kt=e.screenY-Yt.screenY):Kt=qt=0,Yt=e),qt)},movementY:function(e){return"movementY"in e?e.movementY:Kt}}),nn=Xt(tn),rn=Xt(M({},tn,{dataTransfer:0})),sn=Xt(M({},Jt,{relatedTarget:0})),on=Xt(M({},Zt,{animationName:0,elapsedTime:0,pseudoElement:0})),an=Xt(M({},Zt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),ln=Xt(M({},Zt,{data:0})),cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},un={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function fn(){return dn}var pn=Xt(M({},Jt,{key:function(e){if(e.key){var t=cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Wt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?un[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fn,charCode:function(e){return"keypress"===e.type?Wt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Wt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=Xt(M({},tn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),mn=Xt(M({},Jt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fn})),_n=Xt(M({},Zt,{propertyName:0,elapsedTime:0,pseudoElement:0})),yn=Xt(M({},tn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),vn=Xt(M({},Zt,{newState:0,oldState:0})),bn=[9,13,27,32],wn=nt&&"CompositionEvent"in window,En=null;nt&&"documentMode"in document&&(En=document.documentMode);var Sn=nt&&"TextEvent"in window&&!En,xn=nt&&(!wn||En&&8<En&&11>=En),Tn=String.fromCharCode(32),An=!1;function Cn(e,t){switch(e){case"keyup":return-1!==bn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pn=!1;var kn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!kn[e.type]:"textarea"===t}function Ln(e,t,n,r){Lt?It?It.push(r):It=[r]:Lt=r,0<(t=Fu(t,"onChange")).length&&(n=new Qt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var In=null,On=null;function Nn(e){Ru(e,0)}function Fn(e){if(dt(Ke(e)))return e}function Dn(e,t){if("change"===e)return t}var Bn=!1;if(nt){var Un;if(nt){var zn="oninput"in document;if(!zn){var Gn=document.createElement("div");Gn.setAttribute("oninput","return;"),zn="function"===typeof Gn.oninput}Un=zn}else Un=!1;Bn=Un&&(!document.documentMode||9<document.documentMode)}function Vn(){In&&(In.detachEvent("onpropertychange",jn),On=In=null)}function jn(e){if("value"===e.propertyName&&Fn(On)){var t=[];Ln(t,On,e,Mt(e)),Ft(Nn,t)}}function Wn(e,t,n){"focusin"===e?(Vn(),On=n,(In=t).attachEvent("onpropertychange",jn)):"focusout"===e&&Vn()}function $n(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(On)}function Hn(e,t){if("click"===e)return Fn(t)}function Xn(e,t){if("input"===e||"change"===e)return Fn(t)}var qn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Kn(e,t){if(qn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!re.call(t,i)||!qn(e[i],t[i]))return!1}return!0}function Yn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zn(e,t){var n,r=Yn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Yn(r)}}function Qn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Qn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Jn(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function er(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function tr(e,t){var n=Jn(t);t=e.focusedElem;var r=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&Qn(t.ownerDocument.documentElement,t)){if(null!==r&&er(t))if(e=r.start,void 0===(n=r.end)&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if((n=(e=t.ownerDocument||document)&&e.defaultView||window).getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=Zn(t,s);var o=Zn(t,r);i&&o&&(1!==n.rangeCount||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&((e=e.createRange()).setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}for(e=[],n=t;n=n.parentNode;)1===n.nodeType&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for("function"===typeof t.focus&&t.focus(),t=0;t<e.length;t++)(n=e[t]).element.scrollLeft=n.left,n.element.scrollTop=n.top}}var nr=nt&&"documentMode"in document&&11>=document.documentMode,rr=null,ir=null,sr=null,or=!1;function ar(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;or||null==rr||rr!==ft(r)||("selectionStart"in(r=rr)&&er(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},sr&&Kn(sr,r)||(sr=r,0<(r=Fu(ir,"onSelect")).length&&(t=new Qt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},hr={};function dr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in hr)return ur[e]=n[t];return e}nt&&(hr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var fr=dr("animationend"),pr=dr("animationiteration"),gr=dr("animationstart"),mr=dr("transitionrun"),_r=dr("transitionstart"),yr=dr("transitioncancel"),vr=dr("transitionend"),br=new Map,wr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Er(e,t){br.set(e,t),et(t,[e])}var Sr=[],xr=0,Tr=0;function Ar(){for(var e=xr,t=Tr=xr=0;t<e;){var n=Sr[t];Sr[t++]=null;var r=Sr[t];Sr[t++]=null;var i=Sr[t];Sr[t++]=null;var s=Sr[t];if(Sr[t++]=null,null!==r&&null!==i){var o=r.pending;null===o?i.next=i:(i.next=o.next,o.next=i),r.pending=i}0!==s&&kr(n,i,s)}}function Cr(e,t,n,r){Sr[xr++]=e,Sr[xr++]=t,Sr[xr++]=n,Sr[xr++]=r,Tr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Rr(e,t,n,r){return Cr(e,t,n,r),Mr(e)}function Pr(e,t){return Cr(e,null,null,t),Mr(e)}function kr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(r=s.alternate)&&(r.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(i=!0)),e=s,s=s.return;i&&null!==t&&3===e.tag&&(s=e.stateNode,i=31-be(n),null===(e=(s=s.hiddenUpdates)[i])?s[i]=[t]:e.push(t),t.lane=536870912|n)}function Mr(e){if(50<Rc)throw Rc=0,Pc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Lr={},Ir=new WeakMap;function Or(e,t){if("object"===typeof e&&null!==e){var n=Ir.get(e);return void 0!==n?n:(t={value:e,source:t,stack:F(t)},Ir.set(e,t),t)}return{value:e,source:t,stack:F(t)}}var Nr=[],Fr=0,Dr=null,Br=0,Ur=[],zr=0,Gr=null,Vr=1,jr="";function Wr(e,t){Nr[Fr++]=Br,Nr[Fr++]=Dr,Dr=e,Br=t}function $r(e,t,n){Ur[zr++]=Vr,Ur[zr++]=jr,Ur[zr++]=Gr,Gr=e;var r=Vr;e=jr;var i=32-be(r)-1;r&=~(1<<i),n+=1;var s=32-be(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Vr=1<<32-be(t)+i|n<<i|r,jr=s+e}else Vr=1<<s|n<<i|r,jr=e}function Hr(e){null!==e.return&&(Wr(e,1),$r(e,1,0))}function Xr(e){for(;e===Dr;)Dr=Nr[--Fr],Nr[Fr]=null,Br=Nr[--Fr],Nr[Fr]=null;for(;e===Gr;)Gr=Ur[--zr],Ur[zr]=null,jr=Ur[--zr],Ur[zr]=null,Vr=Ur[--zr],Ur[zr]=null}var qr=null,Kr=null,Yr=!1,Zr=null,Qr=!1,Jr=Error(o(519));function ei(e){throw si(Or(Error(o(418,"")),e)),Jr}function ti(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Be]=e,t[Ue]=r,n){case"dialog":Pu("cancel",t),Pu("close",t);break;case"iframe":case"object":case"embed":Pu("load",t);break;case"video":case"audio":for(n=0;n<Au.length;n++)Pu(Au[n],t);break;case"source":Pu("error",t);break;case"img":case"image":case"link":Pu("error",t),Pu("load",t);break;case"details":Pu("toggle",t);break;case"input":Pu("invalid",t),_t(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),ht(t);break;case"select":Pu("invalid",t);break;case"textarea":Pu("invalid",t),wt(t,r.value,r.defaultValue,r.children),ht(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Vu(t.textContent,n)?(null!=r.popover&&(Pu("beforetoggle",t),Pu("toggle",t)),null!=r.onScroll&&Pu("scroll",t),null!=r.onScrollEnd&&Pu("scrollend",t),null!=r.onClick&&(t.onclick=ju),t=!0):t=!1,t||ei(e)}function ni(e){for(qr=e.return;qr;)switch(qr.tag){case 3:case 27:return void(Qr=!0);case 5:case 13:return void(Qr=!1);default:qr=qr.return}}function ri(e){if(e!==qr)return!1;if(!Yr)return ni(e),Yr=!0,!1;var t,n=!1;if((t=3!==e.tag&&27!==e.tag)&&((t=5===e.tag)&&(t=!("form"!==(t=e.type)&&"button"!==t)||Qu(e.type,e.memoizedProps)),t=!t),t&&(n=!0),n&&Kr&&ei(e),ni(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){Kr=ah(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}Kr=null}}else Kr=qr?ah(e.stateNode.nextSibling):null;return!0}function ii(){Kr=qr=null,Yr=!1}function si(e){null===Zr?Zr=[e]:Zr.push(e)}var oi=Error(o(460)),ai=Error(o(474)),li={then:function(){}};function ci(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ui(){}function hi(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(ui,ui),t=n),t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===oi)throw Error(o(483));throw e;default:if("string"===typeof t.status)t.then(ui,ui);else{if(null!==(e=tc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}}),(function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===oi)throw Error(o(483));throw e}throw di=t,oi}}var di=null;function fi(){if(null===di)throw Error(o(459));var e=di;return di=null,e}var pi=null,gi=0;function mi(e){var t=gi;return gi+=1,null===pi&&(pi=[]),hi(pi,e,t)}function _i(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function yi(e,t){if(t.$$typeof===l)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Dl(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=33554434,n):r:(t.flags|=33554434,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=33554434),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Vl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n,r){var s=n.type;return s===h?p(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===w&&vi(s)===t.type)?(_i(t=i(t,n.props),n),t.return=e,t):(_i(t=Ul(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function f(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=jl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function p(e,t,n,r,s){return null===t||7!==t.tag?((t=zl(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function g(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case c:return _i(n=Ul(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case u:return(t=jl(t,e.mode,n)).return=e,t;case w:return g(e,t=(0,t._init)(t._payload),n)}if(G(t)||T(t))return(t=zl(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return g(e,mi(t),n);if(t.$$typeof===m)return g(e,Aa(e,t),n);yi(e,t)}return null}function _(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case c:return n.key===i?d(e,t,n,r):null;case u:return n.key===i?f(e,t,n,r):null;case w:return _(e,t,n=(i=n._init)(n._payload),r)}if(G(n)||T(n))return null!==i?null:p(e,t,n,r,null);if("function"===typeof n.then)return _(e,t,mi(n),r);if(n.$$typeof===m)return _(e,t,Aa(e,n),r);yi(e,n)}return null}function y(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case c:return d(t,e=e.get(null===r.key?n:r.key)||null,r,i);case u:return f(t,e=e.get(null===r.key?n:r.key)||null,r,i);case w:return y(e,t,n,r=(0,r._init)(r._payload),i)}if(G(r)||T(r))return p(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return y(e,t,n,mi(r),i);if(r.$$typeof===m)return y(e,t,n,Aa(t,r),i);yi(t,r)}return null}function v(l,d,f,p){if("object"===typeof f&&null!==f&&f.type===h&&null===f.key&&(f=f.props.children),"object"===typeof f&&null!==f){switch(f.$$typeof){case c:e:{for(var b=f.key;null!==d;){if(d.key===b){if((b=f.type)===h){if(7===d.tag){n(l,d.sibling),(p=i(d,f.props.children)).return=l,l=p;break e}}else if(d.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===w&&vi(b)===d.type){n(l,d.sibling),_i(p=i(d,f.props),f),p.return=l,l=p;break e}n(l,d);break}t(l,d),d=d.sibling}f.type===h?((p=zl(f.props.children,l.mode,p,f.key)).return=l,l=p):(_i(p=Ul(f.type,f.key,f.props,null,l.mode,p),f),p.return=l,l=p)}return a(l);case u:e:{for(b=f.key;null!==d;){if(d.key===b){if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){n(l,d.sibling),(p=i(d,f.children||[])).return=l,l=p;break e}n(l,d);break}t(l,d),d=d.sibling}(p=jl(f,l.mode,p)).return=l,l=p}return a(l);case w:return v(l,d,f=(b=f._init)(f._payload),p)}if(G(f))return function(i,o,a,l){for(var c=null,u=null,h=o,d=o=0,f=null;null!==h&&d<a.length;d++){h.index>d?(f=h,h=null):f=h.sibling;var p=_(i,h,a[d],l);if(null===p){null===h&&(h=f);break}e&&h&&null===p.alternate&&t(i,h),o=s(p,o,d),null===u?c=p:u.sibling=p,u=p,h=f}if(d===a.length)return n(i,h),Yr&&Wr(i,d),c;if(null===h){for(;d<a.length;d++)null!==(h=g(i,a[d],l))&&(o=s(h,o,d),null===u?c=h:u.sibling=h,u=h);return Yr&&Wr(i,d),c}for(h=r(h);d<a.length;d++)null!==(f=y(h,i,d,a[d],l))&&(e&&null!==f.alternate&&h.delete(null===f.key?d:f.key),o=s(f,o,d),null===u?c=f:u.sibling=f,u=f);return e&&h.forEach((function(e){return t(i,e)})),Yr&&Wr(i,d),c}(l,d,f,p);if(T(f)){if("function"!==typeof(b=T(f)))throw Error(o(150));return function(i,a,l,c){if(null==l)throw Error(o(151));for(var u=null,h=null,d=a,f=a=0,p=null,m=l.next();null!==d&&!m.done;f++,m=l.next()){d.index>f?(p=d,d=null):p=d.sibling;var v=_(i,d,m.value,c);if(null===v){null===d&&(d=p);break}e&&d&&null===v.alternate&&t(i,d),a=s(v,a,f),null===h?u=v:h.sibling=v,h=v,d=p}if(m.done)return n(i,d),Yr&&Wr(i,f),u;if(null===d){for(;!m.done;f++,m=l.next())null!==(m=g(i,m.value,c))&&(a=s(m,a,f),null===h?u=m:h.sibling=m,h=m);return Yr&&Wr(i,f),u}for(d=r(d);!m.done;f++,m=l.next())null!==(m=y(d,i,f,m.value,c))&&(e&&null!==m.alternate&&d.delete(null===m.key?f:m.key),a=s(m,a,f),null===h?u=m:h.sibling=m,h=m);return e&&d.forEach((function(e){return t(i,e)})),Yr&&Wr(i,f),u}(l,d,f=b.call(f),p)}if("function"===typeof f.then)return v(l,d,mi(f),p);if(f.$$typeof===m)return v(l,d,Aa(l,f),p);yi(l,f)}return"string"===typeof f&&""!==f||"number"===typeof f||"bigint"===typeof f?(f=""+f,null!==d&&6===d.tag?(n(l,d.sibling),(p=i(d,f)).return=l,l=p):(n(l,d),(p=Vl(f,l.mode,p)).return=l,l=p),a(l)):n(l,d)}return function(e,t,n,r){try{gi=0;var i=v(e,t,n,r);return pi=null,i}catch(o){if(o===oi)throw o;var s=Nl(29,o,null,e.mode);return s.lanes=r,s.return=e,s}}}var wi=bi(!0),Ei=bi(!1),Si=H(null),xi=H(0);function Ti(e,t){q(xi,e=cc),q(Si,t),cc=e|t.baseLanes}function Ai(){q(xi,cc),q(Si,Si.current)}function Ci(){cc=xi.current,X(Si),X(xi)}var Ri=H(null),Pi=null;function ki(e){var t=e.alternate;q(Oi,1&Oi.current),q(Ri,e),null===Pi&&(null===t||null!==Si.current||null!==t.memoizedState)&&(Pi=e)}function Mi(e){if(22===e.tag){if(q(Oi,Oi.current),q(Ri,e),null===Pi){var t=e.alternate;null!==t&&null!==t.memoizedState&&(Pi=e)}}else Li()}function Li(){q(Oi,Oi.current),q(Ri,Ri.current)}function Ii(e){X(Ri),Pi===e&&(Pi=null),X(Oi)}var Oi=H(0);function Ni(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fi="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Di=r.unstable_scheduleCallback,Bi=r.unstable_NormalPriority,Ui={$$typeof:m,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zi(){return{controller:new Fi,data:new Map,refCount:0}}function Gi(e){e.refCount--,0===e.refCount&&Di(Bi,(function(){e.controller.abort()}))}var Vi=null,ji=0,Wi=0,$i=null;function Hi(){if(0===--ji&&null!==Vi){null!==$i&&($i.status="fulfilled");var e=Vi;Vi=null,Wi=0,$i=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Xi=k.S;k.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Vi){var n=Vi=[];ji=0,Wi=wu(),$i={status:"pending",value:void 0,then:function(e){n.push(e)}}}ji++,t.then(Hi,Hi)}(0,t),null!==Xi&&Xi(e,t)};var qi=H(null);function Ki(){var e=qi.current;return null!==e?e:tc.pooledCache}function Yi(e,t){q(qi,null===t?qi.current:t.pool)}function Zi(){var e=Ki();return null===e?null:{parent:Ui._currentValue,pool:e}}var Qi=0,Ji=null,es=null,ts=null,ns=!1,rs=!1,is=!1,ss=0,os=0,as=null,ls=0;function cs(){throw Error(o(321))}function us(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!qn(e[n],t[n]))return!1;return!0}function hs(e,t,n,r,i,s){return Qi=s,Ji=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,k.H=null===e||null===e.memoizedState?Ao:Co,is=!1,s=n(r,i),is=!1,rs&&(s=fs(t,n,r,i)),ds(e),s}function ds(e){k.H=To;var t=null!==es&&null!==es.next;if(Qi=0,ts=es=Ji=null,ns=!1,os=0,as=null,t)throw Error(o(300));null===e||Wo||null!==(e=e.dependencies)&&Sa(e)&&(Wo=!0)}function fs(e,t,n,r){Ji=e;var i=0;do{if(rs&&(as=null),os=0,rs=!1,25<=i)throw Error(o(301));if(i+=1,ts=es=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}k.H=Ro,s=t(n,r)}while(rs);return s}function ps(){var e=k.H,t=e.useState()[0];return t="function"===typeof t.then?bs(t):t,e=e.useState()[0],(null!==es?es.memoizedState:null)!==e&&(Ji.flags|=1024),t}function gs(){var e=0!==ss;return ss=0,e}function ms(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function _s(e){if(ns){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}ns=!1}Qi=0,ts=es=Ji=null,rs=!1,os=ss=0,as=null}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ts?Ji.memoizedState=ts=e:ts=ts.next=e,ts}function vs(){if(null===es){var e=Ji.alternate;e=null!==e?e.memoizedState:null}else e=es.next;var t=null===ts?Ji.memoizedState:ts.next;if(null!==t)ts=t,es=e;else{if(null===e){if(null===Ji.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(es=e).memoizedState,baseState:es.baseState,baseQueue:es.baseQueue,queue:es.queue,next:null},null===ts?Ji.memoizedState=ts=e:ts=ts.next=e}return ts}function bs(e){var t=os;return os+=1,null===as&&(as=[]),e=hi(as,e,t),t=Ji,null===(null===ts?t.memoizedState:ts.next)&&(t=t.alternate,k.H=null===t||null===t.memoizedState?Ao:Co),e}function ws(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return bs(e);if(e.$$typeof===m)return Ta(e)}throw Error(o(438,String(e)))}function Es(e){var t=null,n=Ji.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Ji.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Ji.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=S;return t.index++,n}function Ss(e,t){return"function"===typeof t?t(e):t}function xs(e){return Ts(vs(),es,e)}function Ts(e,t,n){var r=e.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=n;var i=e.baseQueue,s=r.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}t.baseQueue=i=s,r.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=a=null,c=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(rc&d)===d:(Qi&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Wi&&(h=!0);else{if((Qi&f)===f){u=u.next,f===Wi&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,a=s):c=c.next=d,Ji.lanes|=f,hc|=f}d=u.action,is&&n(s,d),s=u.hasEagerState?u.eagerState:n(s,d)}else f={lane:d,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,a=s):c=c.next=f,Ji.lanes|=d,hc|=d;u=u.next}while(null!==u&&u!==t);if(null===c?a=s:c.next=l,!qn(s,e.memoizedState)&&(Wo=!0,h&&null!==(n=$i)))throw n;e.memoizedState=s,e.baseState=a,e.baseQueue=c,r.lastRenderedState=s}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function As(e){var t=vs(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);qn(s,t.memoizedState)||(Wo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Cs(e,t,n){var r=Ji,i=vs(),s=Yr;if(s){if(void 0===n)throw Error(o(407));n=n()}else n=t();var a=!qn((es||i).memoizedState,n);if(a&&(i.memoizedState=n,Wo=!0),i=i.queue,Qs(ks.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==ts&&1&ts.memoizedState.tag){if(r.flags|=2048,Xs(9,Ps.bind(null,r,i,n,t),{destroy:void 0},null),null===tc)throw Error(o(349));s||0!==(60&Qi)||Rs(r,t,n)}return n}function Rs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ji.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ji.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ps(e,t,n,r){t.value=n,t.getSnapshot=r,Ms(t)&&Ls(e)}function ks(e,t,n){return n((function(){Ms(t)&&Ls(e)}))}function Ms(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!qn(e,n)}catch(r){return!0}}function Ls(e){var t=Pr(e,2);null!==t&&Lc(t,e,2)}function Is(e){var t=ys();if("function"===typeof e){var n=e;if(e=n(),is){ve(!0);try{n()}finally{ve(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:e},t}function Os(e,t,n,r){return e.baseState=n,Ts(e,es,"function"===typeof r?r:Ss)}function Ns(e,t,n,r,i){if(Eo(e))throw Error(o(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==k.T?n(!0):s.isTransition=!1,r(s),null===(n=t.pending)?(s.next=t.pending=s,Fs(t,s)):(s.next=n.next,t.pending=n.next=s)}}function Fs(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var s=k.T,o={};k.T=o;try{var a=n(i,r),l=k.S;null!==l&&l(o,a),Ds(e,t,a)}catch(c){Us(e,t,c)}finally{k.T=s}}else try{Ds(e,t,s=n(i,r))}catch(u){Us(e,t,u)}}function Ds(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then((function(n){Bs(e,t,n)}),(function(n){return Us(e,t,n)})):Bs(e,t,n)}function Bs(e,t,n){t.status="fulfilled",t.value=n,zs(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Fs(e,n)))}function Us(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,zs(t),t=t.next}while(t!==r)}e.action=null}function zs(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Gs(e,t){return t}function Vs(e,t){if(Yr){var n=tc.formState;if(null!==n){e:{var r=Ji;if(Yr){if(Kr){t:{for(var i=Kr,s=Qr;8!==i.nodeType;){if(!s){i=null;break t}if(null===(i=ah(i.nextSibling))){i=null;break t}}i="F!"===(s=i.data)||"F"===s?i:null}if(i){Kr=ah(i.nextSibling),r="F!"===i.data;break e}}ei(r)}r=!1}r&&(t=n[0])}}return(n=ys()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:t},n.queue=r,n=vo.bind(null,Ji,r),r.dispatch=n,r=Is(!1),s=wo.bind(null,Ji,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=ys()).queue=i,n=Ns.bind(null,Ji,i,s,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function js(e){return Ws(vs(),es,e)}function Ws(e,t,n){t=Ts(e,t,Gs)[0],e=xs(Ss)[0],t="object"===typeof t&&null!==t&&"function"===typeof t.then?bs(t):t;var r=vs(),i=r.queue,s=i.dispatch;return n!==r.memoizedState&&(Ji.flags|=2048,Xs(9,$s.bind(null,i,n),{destroy:void 0},null)),[t,s,e]}function $s(e,t){e.action=t}function Hs(e){var t=vs(),n=es;if(null!==n)return Ws(t,n,e);vs(),t=t.memoizedState;var r=(n=vs()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Xs(e,t,n,r){return e={tag:e,create:t,inst:n,deps:r,next:null},null===(t=Ji.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ji.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function qs(){return vs().memoizedState}function Ks(e,t,n,r){var i=ys();Ji.flags|=e,i.memoizedState=Xs(1|t,n,{destroy:void 0},void 0===r?null:r)}function Ys(e,t,n,r){var i=vs();r=void 0===r?null:r;var s=i.memoizedState.inst;null!==es&&null!==r&&us(r,es.memoizedState.deps)?i.memoizedState=Xs(t,n,s,r):(Ji.flags|=e,i.memoizedState=Xs(1|t,n,s,r))}function Zs(e,t){Ks(8390656,8,e,t)}function Qs(e,t){Ys(2048,8,e,t)}function Js(e,t){return Ys(4,2,e,t)}function eo(e,t){return Ys(4,4,e,t)}function to(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function no(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Ys(4,4,to.bind(null,t,e),n)}function ro(){}function io(e,t){var n=vs();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&us(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function so(e,t){var n=vs();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&us(t,r[1]))return r[0];if(r=e(),is){ve(!0);try{e()}finally{ve(!1)}}return n.memoizedState=[r,t],r}function oo(e,t,n){return void 0===n||0!==(1073741824&Qi)?e.memoizedState=t:(e.memoizedState=n,e=Mc(),Ji.lanes|=e,hc|=e,n)}function ao(e,t,n,r){return qn(n,t)?n:null!==Si.current?(e=oo(e,n,r),qn(e,t)||(Wo=!0),e):0===(42&Qi)?(Wo=!0,e.memoizedState=n):(e=Mc(),Ji.lanes|=e,hc|=e,t)}function lo(e,t,n,r,i){var s=V.p;V.p=0!==s&&8>s?s:8;var o=k.T,a={};k.T=a,wo(e,!1,t,n);try{var l=i(),c=k.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then((function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)}),(function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)})),r}(l,r);bo(e,t,u,kc())}else bo(e,t,r,kc())}catch(h){bo(e,t,{then:function(){},status:"rejected",reason:h},kc())}finally{V.p=s,k.T=o}}function co(){}function uo(e,t,n,r){if(5!==e.tag)throw Error(o(476));var i=ho(e).queue;lo(e,i,t,j,null===n?co:function(){return fo(e),n(r)})}function ho(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:j},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function fo(e){bo(e,ho(e).next.queue,{},kc())}function po(){return Ta(Fh)}function go(){return vs().memoizedState}function mo(){return vs().memoizedState}function _o(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=kc(),r=La(t,e=Ma(n),n);return null!==r&&(Lc(r,t,n),Ia(r,t,n)),t={cache:zi()},void(e.payload=t)}t=t.return}}function yo(e,t,n){var r=kc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Eo(e)?So(t,n):null!==(n=Rr(e,t,n,r))&&(Lc(n,e,r),xo(n,t,r))}function vo(e,t,n){bo(e,t,n,kc())}function bo(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Eo(e))So(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,qn(a,o))return Cr(e,t,i,0),null===tc&&Ar(),!1}catch(l){}if(null!==(n=Rr(e,t,i,r)))return Lc(n,e,r),xo(n,t,r),!0}return!1}function wo(e,t,n,r){if(r={lane:2,revertLane:wu(),action:r,hasEagerState:!1,eagerState:null,next:null},Eo(e)){if(t)throw Error(o(479))}else null!==(t=Rr(e,n,r,2))&&Lc(t,e,2)}function Eo(e){var t=e.alternate;return e===Ji||null!==t&&t===Ji}function So(e,t){rs=ns=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function xo(e,t,n){if(0!==(4194176&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}var To={readContext:Ta,use:ws,useCallback:cs,useContext:cs,useEffect:cs,useImperativeHandle:cs,useLayoutEffect:cs,useInsertionEffect:cs,useMemo:cs,useReducer:cs,useRef:cs,useState:cs,useDebugValue:cs,useDeferredValue:cs,useTransition:cs,useSyncExternalStore:cs,useId:cs};To.useCacheRefresh=cs,To.useMemoCache=cs,To.useHostTransitionStatus=cs,To.useFormState=cs,To.useActionState=cs,To.useOptimistic=cs;var Ao={readContext:Ta,use:ws,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Ta,useEffect:Zs,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Ks(4194308,4,to.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ks(4194308,4,e,t)},useInsertionEffect:function(e,t){Ks(4,2,e,t)},useMemo:function(e,t){var n=ys();t=void 0===t?null:t;var r=e();if(is){ve(!0);try{e()}finally{ve(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=ys();if(void 0!==n){var i=n(t);if(is){ve(!0);try{n(t)}finally{ve(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=yo.bind(null,Ji,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:function(e){var t=(e=Is(e)).queue,n=vo.bind(null,Ji,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ro,useDeferredValue:function(e,t){return oo(ys(),e,t)},useTransition:function(){var e=Is(!1);return e=lo.bind(null,Ji,e.queue,!0,!1),ys().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Ji,i=ys();if(Yr){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===tc)throw Error(o(349));0!==(60&rc)||Rs(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Zs(ks.bind(null,r,s,e),[e]),r.flags|=2048,Xs(9,Ps.bind(null,r,s,n,t),{destroy:void 0},null),n},useId:function(){var e=ys(),t=tc.identifierPrefix;if(Yr){var n=jr;t=":"+t+"R"+(n=(Vr&~(1<<32-be(Vr)-1)).toString(32)+n),0<(n=ss++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ls++).toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return ys().memoizedState=_o.bind(null,Ji)}};Ao.useMemoCache=Es,Ao.useHostTransitionStatus=po,Ao.useFormState=Vs,Ao.useActionState=Vs,Ao.useOptimistic=function(e){var t=ys();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=wo.bind(null,Ji,!0,n),n.dispatch=t,[e,t]};var Co={readContext:Ta,use:ws,useCallback:io,useContext:Ta,useEffect:Qs,useImperativeHandle:no,useInsertionEffect:Js,useLayoutEffect:eo,useMemo:so,useReducer:xs,useRef:qs,useState:function(){return xs(Ss)},useDebugValue:ro,useDeferredValue:function(e,t){return ao(vs(),es.memoizedState,e,t)},useTransition:function(){var e=xs(Ss)[0],t=vs().memoizedState;return["boolean"===typeof e?e:bs(e),t]},useSyncExternalStore:Cs,useId:go};Co.useCacheRefresh=mo,Co.useMemoCache=Es,Co.useHostTransitionStatus=po,Co.useFormState=js,Co.useActionState=js,Co.useOptimistic=function(e,t){return Os(vs(),0,e,t)};var Ro={readContext:Ta,use:ws,useCallback:io,useContext:Ta,useEffect:Qs,useImperativeHandle:no,useInsertionEffect:Js,useLayoutEffect:eo,useMemo:so,useReducer:As,useRef:qs,useState:function(){return As(Ss)},useDebugValue:ro,useDeferredValue:function(e,t){var n=vs();return null===es?oo(n,e,t):ao(n,es.memoizedState,e,t)},useTransition:function(){var e=As(Ss)[0],t=vs().memoizedState;return["boolean"===typeof e?e:bs(e),t]},useSyncExternalStore:Cs,useId:go};function Po(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}Ro.useCacheRefresh=mo,Ro.useMemoCache=Es,Ro.useHostTransitionStatus=po,Ro.useFormState=Hs,Ro.useActionState=Hs,Ro.useOptimistic=function(e,t){var n=vs();return null!==es?Os(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])};var ko={isMounted:function(e){return!!(e=e._reactInternals)&&D(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=kc(),i=Ma(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=La(e,i,r))&&(Lc(t,e,r),Ia(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=kc(),i=Ma(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=La(e,i,r))&&(Lc(t,e,r),Ia(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=kc(),r=Ma(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=La(e,r,n))&&(Lc(t,e,n),Ia(t,e,n))}};function Mo(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!Kn(n,r)||!Kn(i,s))}function Lo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ko.enqueueReplaceState(t,t.state,null)}function Io(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=M({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}var Oo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function No(e){Oo(e)}function Fo(e){console.error(e)}function Do(e){Oo(e)}function Bo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout((function(){throw n}))}}function Uo(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout((function(){throw r}))}}function zo(e,t,n){return(n=Ma(n)).tag=3,n.payload={element:null},n.callback=function(){Bo(e,t)},n}function Go(e){return(e=Ma(e)).tag=3,e}function Vo(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var s=r.value;e.payload=function(){return i(s)},e.callback=function(){Uo(t,n,r)}}var o=n.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Uo(t,n,r),"function"!==typeof i&&(null===Ec?Ec=new Set([this]):Ec.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var jo=Error(o(461)),Wo=!1;function $o(e,t,n,r){t.child=null===e?Ei(t,null,n,r):wi(t,e.child,n,r)}function Ho(e,t,n,r,i){n=n.render;var s=t.ref;if("ref"in r){var o={};for(var a in r)"ref"!==a&&(o[a]=r[a])}else o=r;return xa(t),r=hs(e,t,n,o,s,i),a=gs(),null===e||Wo?(Yr&&a&&Hr(t),t.flags|=1,$o(e,t,r,i),t.child):(ms(e,t,i),da(e,t,i))}function Xo(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Fl(s)||void 0!==s.defaultProps||null!==n.compare?((e=Ul(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,qo(e,t,s,r,i))}if(s=e.child,!fa(e,i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:Kn)(o,r)&&e.ref===t.ref)return da(e,t,i)}return t.flags|=1,(e=Dl(s,r)).ref=t.ref,e.return=t,t.child=e}function qo(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(Kn(s,r)&&e.ref===t.ref){if(Wo=!1,t.pendingProps=r=s,!fa(e,i))return t.lanes=e.lanes,da(e,t,i);0!==(131072&e.flags)&&(Wo=!0)}}return Qo(e,t,n,r,i)}function Ko(e,t,n){var r=t.pendingProps,i=r.children,s=0!==(2&t.stateNode._pendingVisibility),o=null!==e?e.memoizedState:null;if(Zo(e,t),"hidden"===r.mode||s){if(0!==(128&t.flags)){if(r=null!==o?o.baseLanes|n:n,null!==e){for(i=t.child=e.child,s=0;null!==i;)s=s|i.lanes|i.childLanes,i=i.sibling;t.childLanes=s&~r}else t.childLanes=0,t.child=null;return Yo(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Yo(e,t,null!==o?o.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Yi(0,null!==o?o.cachePool:null),null!==o?Ti(t,o):Ai(),Mi(t)}else null!==o?(Yi(0,o.cachePool),Ti(t,o),Li(),t.memoizedState=null):(null!==e&&Yi(0,null),Ai(),Li());return $o(e,t,i,n),t.child}function Yo(e,t,n,r){var i=Ki();return i=null===i?null:{parent:Ui._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Yi(0,null),Ai(),Mi(t),null!==e&&Ea(e,t,r,!0),null}function Zo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(o(284));null!==e&&e.ref===n||(t.flags|=2097664)}}function Qo(e,t,n,r,i){return xa(t),n=hs(e,t,n,r,void 0,i),r=gs(),null===e||Wo?(Yr&&r&&Hr(t),t.flags|=1,$o(e,t,n,i),t.child):(ms(e,t,i),da(e,t,i))}function Jo(e,t,n,r,i,s){return xa(t),t.updateQueue=null,n=fs(t,r,n,i),ds(e),r=gs(),null===e||Wo?(Yr&&r&&Hr(t),t.flags|=1,$o(e,t,n,s),t.child):(ms(e,t,s),da(e,t,s))}function ea(e,t,n,r,i){if(xa(t),null===t.stateNode){var s=Lr,o=n.contextType;"object"===typeof o&&null!==o&&(s=Ta(o)),s=new n(r,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=ko,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=r,s.state=t.memoizedState,s.refs={},Pa(t),o=n.contextType,s.context="object"===typeof o&&null!==o?Ta(o):Lr,s.state=t.memoizedState,"function"===typeof(o=n.getDerivedStateFromProps)&&(Po(t,n,o,r),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(o=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),o!==s.state&&ko.enqueueReplaceState(s,s.state,null),Da(t,r,s,i),Fa(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){s=t.stateNode;var a=t.memoizedProps,l=Io(n,a);s.props=l;var c=s.context,u=n.contextType;o=Lr,"object"===typeof u&&null!==u&&(o=Ta(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a||c!==o)&&Lo(t,s,r,o),Ra=!1;var d=t.memoizedState;s.state=d,Da(t,r,s,i),Fa(),c=t.memoizedState,a||d!==c||Ra?("function"===typeof h&&(Po(t,n,h,r),c=t.memoizedState),(l=Ra||Mo(t,n,l,r,d,c,o))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=o,r=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,ka(e,t),u=Io(n,o=t.memoizedProps),s.props=u,h=t.pendingProps,d=s.context,c=n.contextType,l=Lr,"object"===typeof c&&null!==c&&(l=Ta(c)),(c="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||d!==l)&&Lo(t,s,r,l),Ra=!1,d=t.memoizedState,s.state=d,Da(t,r,s,i),Fa();var f=t.memoizedState;o!==h||d!==f||Ra||null!==e&&null!==e.dependencies&&Sa(e.dependencies)?("function"===typeof a&&(Po(t,n,a,r),f=t.memoizedState),(u=Ra||Mo(t,n,u,r,d,f,l)||null!==e&&null!==e.dependencies&&Sa(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return s=r,Zo(e,t),r=0!==(128&t.flags),s||r?(s=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&r?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,n,i)):$o(e,t,n,i),t.memoizedState=s.state,e=t.child):e=da(e,t,i),e}function ta(e,t,n,r){return ii(),t.flags|=256,$o(e,t,n,r),t.child}var na={dehydrated:null,treeContext:null,retryLane:0};function ra(e){return{baseLanes:e,cachePool:Zi()}}function ia(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=pc),e}function sa(e,t,n){var r,i=t.pendingProps,s=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Oi.current)),r&&(s=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(Yr){if(s?ki(t):Li(),Yr){var l,c=Kr;if(l=c){e:{for(l=c,c=Qr;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=ah(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Gr?{id:Vr,overflow:jr}:null,retryLane:536870912},(l=Nl(18,null,null,0)).stateNode=c,l.return=t,t.child=l,qr=t,Kr=null,l=!0):l=!1}l||ei(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return"$!"===c.data?t.lanes=16:t.lanes=536870912,null;Ii(t)}return c=i.children,i=i.fallback,s?(Li(),c=aa({mode:"hidden",children:c},s=t.mode),i=zl(i,s,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(s=t.child).memoizedState=ra(n),s.childLanes=ia(e,r,n),t.memoizedState=na,i):(ki(t),oa(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(ki(t),t.flags&=-257,t=la(e,t,n)):null!==t.memoizedState?(Li(),t.child=e.child,t.flags|=128,t=null):(Li(),s=i.fallback,c=t.mode,i=aa({mode:"visible",children:i.children},c),(s=zl(s,c,n,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,wi(t,e.child,null,n),(i=t.child).memoizedState=ra(n),i.childLanes=ia(e,r,n),t.memoizedState=na,t=s);else if(ki(t),"$!"===c.data){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(o(419))).stack="",i.digest=r,si({value:i,source:null,stack:null}),t=la(e,t,n)}else if(Wo||Ea(e,t,n,!1),r=0!==(n&e.childLanes),Wo||r){if(null!==(r=tc)){if(0!==(42&(i=n&-n)))i=1;else switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=64;break;case 268435456:i=134217728;break;default:i=0}if(0!==(i=0!==(i&(r.suspendedLanes|n))?0:i)&&i!==l.retryLane)throw l.retryLane=i,Pr(e,i),Lc(r,e,i),jo}"$?"===c.data||Wc(),t=la(e,t,n)}else"$?"===c.data?(t.flags|=128,t.child=e.child,t=au.bind(null,e),c._reactRetry=t,t=null):(e=l.treeContext,Kr=ah(c.nextSibling),qr=t,Yr=!0,Zr=null,Qr=!1,null!==e&&(Ur[zr++]=Vr,Ur[zr++]=jr,Ur[zr++]=Gr,Vr=e.id,jr=e.overflow,Gr=t),(t=oa(t,i.children)).flags|=4096);return t}return s?(Li(),s=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=Dl(l,{mode:"hidden",children:i.children})).subtreeFlags=31457280&l.subtreeFlags,null!==u?s=Dl(u,s):(s=zl(s,c,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,null===(c=e.child.memoizedState)?c=ra(n):(null!==(l=c.cachePool)?(u=Ui._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Zi(),c={baseLanes:c.baseLanes|n,cachePool:l}),s.memoizedState=c,s.childLanes=ia(e,r,n),t.memoizedState=na,i):(ki(t),e=(n=e.child).sibling,(n=Dl(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function oa(e,t){return(t=aa({mode:"visible",children:t},e.mode)).return=e,e.child=t}function aa(e,t){return Gl(e,t,0,null)}function la(e,t,n){return wi(t,e.child,null,n),(e=oa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ca(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ba(e.return,t,n)}function ua(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ha(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if($o(e,t,r.children,n),0!==(2&(r=Oi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ca(e,n,t);else if(19===e.tag)ca(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(q(Oi,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Ni(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),ua(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Ni(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}ua(t,!0,n,null,s);break;case"together":ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function da(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),hc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ea(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Dl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function fa(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Sa(e))}function pa(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Wo=!0;else{if(!fa(e,n)&&0===(128&t.flags))return Wo=!1,function(e,t,n){switch(t.tag){case 3:J(t,t.stateNode.containerInfo),ya(t,Ui,e.memoizedState.cache),ii();break;case 27:case 5:te(t);break;case 4:J(t,t.stateNode.containerInfo);break;case 10:ya(t,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(ki(t),t.flags|=128,null):0!==(n&t.child.childLanes)?sa(e,t,n):(ki(t),null!==(e=da(e,t,n))?e.sibling:null);ki(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ea(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return ha(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),q(Oi,Oi.current),r)break;return null;case 22:case 23:return t.lanes=0,Ko(e,t,n);case 24:ya(t,Ui,e.memoizedState.cache)}return da(e,t,n)}(e,t,n);Wo=0!==(131072&e.flags)}else Wo=!1,Yr&&0!==(1048576&t.flags)&&$r(t,Br,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,i=r._init;if(r=i(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((i=r.$$typeof)===_){t.tag=11,t=Ho(null,t,r,e,n);break e}if(i===b){t.tag=14,t=Xo(null,t,r,e,n);break e}}throw t=C(r)||r,Error(o(306,t,""))}Fl(r)?(e=Io(r,e),t.tag=1,t=ea(null,t,r,e,n)):(t.tag=0,t=Qo(null,t,r,e,n))}return t;case 0:return Qo(e,t,t.type,t.pendingProps,n);case 1:return ea(e,t,r=t.type,i=Io(r,t.pendingProps),n);case 3:e:{if(J(t,t.stateNode.containerInfo),null===e)throw Error(o(387));var s=t.pendingProps;r=(i=t.memoizedState).element,ka(e,t),Da(t,s,null,n);var a=t.memoizedState;if(s=a.cache,ya(t,Ui,s),s!==i.cache&&wa(t,[Ui],n,!0),Fa(),s=a.element,i.isDehydrated){if(i={element:s,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=ta(e,t,s,n);break e}if(s!==r){si(r=Or(Error(o(424)),t)),t=ta(e,t,s,n);break e}for(Kr=ah(t.stateNode.containerInfo.firstChild),qr=t,Yr=!0,Zr=null,Qr=!0,n=Ei(t,null,s,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ii(),s===r){t=da(e,t,n);break e}$o(e,t,s,n)}t=t.child}return t;case 26:return Zo(e,t),null===e?(n=mh(t.type,null,t.pendingProps,null))?t.memoizedState=n:Yr||(n=t.type,e=t.pendingProps,(r=Ku(Z.current).createElement(n))[Be]=t,r[Ue]=e,Hu(r,n,e),Ze(r),t.stateNode=r):t.memoizedState=mh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return te(t),null===e&&Yr&&(r=t.stateNode=ch(t.type,t.pendingProps,Z.current),qr=t,Qr=!0,Kr=ah(r.firstChild)),r=t.pendingProps.children,null!==e||Yr?$o(e,t,r,n):t.child=wi(t,null,r,n),Zo(e,t),t.child;case 5:return null===e&&Yr&&((i=r=Kr)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[$e])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==i.rel||e.getAttribute("href")!==(null==i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===s)return e}if(null===(e=ah(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,Qr))?(t.stateNode=r,qr=t,Kr=ah(r.firstChild),Qr=!1,i=!0):i=!1),i||ei(t)),te(t),i=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,r=s.children,Qu(i,s)?r=null:null!==a&&Qu(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=hs(e,t,ps,null,null,n),Fh._currentValue=i),Zo(e,t),$o(e,t,r,n),t.child;case 6:return null===e&&Yr&&((e=n=Kr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=ah(e.nextSibling)))return null}return e}(n,t.pendingProps,Qr))?(t.stateNode=n,qr=t,Kr=null,e=!0):e=!1),e||ei(t)),null;case 13:return sa(e,t,n);case 4:return J(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wi(t,null,r,n):$o(e,t,r,n),t.child;case 11:return Ho(e,t,t.type,t.pendingProps,n);case 7:return $o(e,t,t.pendingProps,n),t.child;case 8:case 12:return $o(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,ya(t,t.type,r.value),$o(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,xa(t),r=r(i=Ta(i)),t.flags|=1,$o(e,t,r,n),t.child;case 14:return Xo(e,t,t.type,t.pendingProps,n);case 15:return qo(e,t,t.type,t.pendingProps,n);case 19:return ha(e,t,n);case 22:return Ko(e,t,n);case 24:return xa(t),r=Ta(Ui),null===e?(null===(i=Ki())&&(i=tc,s=zi(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=n),i=s),t.memoizedState={parent:r,cache:i},Pa(t),ya(t,Ui,i)):(0!==(e.lanes&n)&&(ka(e,t),Da(t,null,null,n),Fa()),i=e.memoizedState,s=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),ya(t,Ui,r)):(r=s.cache,ya(t,Ui,r),r!==i.cache&&wa(t,[Ui],n,!0))),$o(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}var ga=H(null),ma=null,_a=null;function ya(e,t,n){q(ga,t._currentValue),t._currentValue=n}function va(e){e._currentValue=ga.current,X(ga)}function ba(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function wa(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var a=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ba(s.return,n,e),r||(a=null);break e}s=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(o(341));a.lanes|=n,null!==(s=a.alternate)&&(s.lanes|=n),ba(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function Ea(e,t,n,r){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(0!==(524288&i.flags))s=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(o(387));if(null!==(a=a.memoizedProps)){var l=i.type;qn(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===Q.current){if(null===(a=i.alternate))throw Error(o(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Fh):e=[Fh])}i=i.return}null!==e&&wa(t,e,n,r),t.flags|=262144}function Sa(e){for(e=e.firstContext;null!==e;){if(!qn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function xa(e){ma=e,_a=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ta(e){return Ca(ma,e)}function Aa(e,t){return null===ma&&xa(e),Ca(e,t)}function Ca(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===_a){if(null===e)throw Error(o(308));_a=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else _a=_a.next=t;return n}var Ra=!1;function Pa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ka(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ma(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function La(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&ec)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Mr(e),kr(e,null,n),t}return Cr(e,r,t,n),Mr(e)}function Ia(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194176&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}function Oa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Na=!1;function Fa(){if(Na){if(null!==$i)throw $i}}function Da(e,t,n,r){Na=!1;var i=e.updateQueue;Ra=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,u=c=l=null,a=s;;){var d=-536870913&a.lane,f=d!==a.lane;if(f?(rc&d)===d:(r&d)===d){0!==d&&d===Wi&&(Na=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var p=e,g=a;d=t;var m=n;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(m,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(m,h,d):p)||void 0===d)break e;h=M({},h,d);break e;case 2:Ra=!0}}null!==(d=a.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=i.callbacks)?i.callbacks=[d]:f.push(d))}else f={lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(f=a).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===s&&(i.shared.lanes=0),hc|=o,e.lanes=o,e.memoizedState=h}}function Ba(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function Ua(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ba(n[e],t)}function za(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var s=n.create,o=n.inst;r=s(),o.destroy=r}n=n.next}while(n!==i)}}catch(a){ru(t,t.return,a)}}function Ga(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var s=i.next;r=s;do{if((r.tag&e)===e){var o=r.inst,a=o.destroy;if(void 0!==a){o.destroy=void 0,i=t;var l=n;try{a()}catch(c){ru(i,l,c)}}}r=r.next}while(r!==s)}}catch(c){ru(t,t.return,c)}}function Va(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ua(t,n)}catch(r){ru(e,e.return,r)}}}function ja(e,t,n){n.props=Io(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){ru(e,t,r)}}function Wa(e,t){try{var n=e.ref;if(null!==n){var r=e.stateNode;switch(e.tag){case 26:case 27:case 5:var i=r;break;default:i=r}"function"===typeof n?e.refCleanup=n(i):n.current=i}}catch(s){ru(e,t,s)}}function $a(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){ru(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){ru(e,t,s)}else n.current=null}function Ha(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){ru(e,e.return,i)}}function Xa(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,a=null,l=null,c=null,u=null,h=null;for(p in n){var d=n[p];if(n.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":c=d;default:r.hasOwnProperty(p)||Wu(e,t,p,null,r,d)}}for(var f in r){var p=r[f];if(d=n[f],r.hasOwnProperty(f)&&(null!=p||null!=d))switch(f){case"type":s=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:p!==d&&Wu(e,t,f,p,r,d)}}return void mt(e,a,l,c,u,h,s,i);case"select":for(s in p=a=l=f=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(s)||Wu(e,t,s,null,r,c)}for(i in r)if(s=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":f=s;break;case"defaultValue":l=s;break;case"multiple":a=s;default:s!==c&&Wu(e,t,i,s,r,c)}return t=l,n=a,r=p,void(null!=f?vt(e,!!n,f,!1):!!r!==!!n&&(null!=t?vt(e,!!n,t,!0):vt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Wu(e,t,l,null,r,i)}for(a in r)if(i=r[a],s=n[a],r.hasOwnProperty(a)&&(null!=i||null!=s))switch(a){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(o(91));break;default:i!==s&&Wu(e,t,a,i,r,s)}return void bt(e,f,p);case"option":for(var g in n)if(f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g))if("selected"===g)e.selected=!1;else Wu(e,t,g,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Wu(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in n)f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m)&&Wu(e,t,m,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:Wu(e,t,u,f,r,p)}return;default:if(At(t)){for(var _ in n)f=n[_],n.hasOwnProperty(_)&&void 0!==f&&!r.hasOwnProperty(_)&&$u(e,t,_,void 0,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||void 0===f&&void 0===p||$u(e,t,h,f,r,p);return}}for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!r.hasOwnProperty(y)&&Wu(e,t,y,null,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||null==f&&null==p||Wu(e,t,d,f,r,p)}(r,e.type,n,t),r[Ue]=t}catch(i){ru(e,e.return,i)}}function qa(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag||4===e.tag}function Ka(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||qa(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&27!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Ya(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=ju));else if(4!==r&&27!==r&&null!==(e=e.child))for(Ya(e,t,n),e=e.sibling;null!==e;)Ya(e,t,n),e=e.sibling}function Za(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&27!==r&&null!==(e=e.child))for(Za(e,t,n),e=e.sibling;null!==e;)Za(e,t,n),e=e.sibling}var Qa=!1,Ja=!1,el=!1,tl="function"===typeof WeakSet?WeakSet:Set,nl=null,rl=!1;function il(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:_l(e,n),4&r&&za(5,n);break;case 1:if(_l(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){ru(n,n.return,a)}else{var i=Io(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){ru(n,n.return,l)}}64&r&&Va(n),512&r&&Wa(n,n.return);break;case 3:if(_l(e,n),64&r&&null!==(r=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:e=n.child.stateNode}try{Ua(r,e)}catch(a){ru(n,n.return,a)}}break;case 26:_l(e,n),512&r&&Wa(n,n.return);break;case 27:case 5:_l(e,n),null===t&&4&r&&Ha(n),512&r&&Wa(n,n.return);break;case 12:default:_l(e,n);break;case 13:_l(e,n),4&r&&ul(e,n);break;case 22:if(!(i=null!==n.memoizedState||Qa)){t=null!==t&&null!==t.memoizedState||Ja;var s=Qa,o=Ja;Qa=i,(Ja=t)&&!o?vl(e,n,0!==(8772&n.subtreeFlags)):_l(e,n),Qa=s,Ja=o}512&r&&("manual"===n.memoizedProps.mode?Wa(n,n.return):$a(n,n.return))}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&He(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ol=null,al=!1;function ll(e,t,n){for(n=n.child;null!==n;)cl(e,t,n),n=n.sibling}function cl(e,t,n){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(_e,n)}catch(o){}switch(n.tag){case 26:Ja||$a(n,t),ll(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Ja||$a(n,t);var r=ol,i=al;for(ol=n.stateNode,ll(e,t,n),t=(n=n.stateNode).attributes;t.length;)n.removeAttributeNode(t[0]);He(n),ol=r,al=i;break;case 5:Ja||$a(n,t);case 6:i=ol;var s=al;if(ol=null,ll(e,t,n),al=s,null!==(ol=i))if(al)try{e=ol,r=n.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)}catch(a){ru(n,t,a)}else try{ol.removeChild(n.stateNode)}catch(a){ru(n,t,a)}break;case 18:null!==ol&&(al?(t=ol,n=n.stateNode,8===t.nodeType?sh(t.parentNode,n):1===t.nodeType&&sh(t,n),gd(t)):sh(ol,n.stateNode));break;case 4:r=ol,i=al,ol=n.stateNode.containerInfo,al=!0,ll(e,t,n),ol=r,al=i;break;case 0:case 11:case 14:case 15:Ja||Ga(2,n,t),Ja||Ga(4,n,t),ll(e,t,n);break;case 1:Ja||($a(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&ja(n,t,r)),ll(e,t,n);break;case 21:ll(e,t,n);break;case 22:Ja||$a(n,t),Ja=(r=Ja)||null!==n.memoizedState,ll(e,t,n),Ja=r;break;default:ll(e,t,n)}}function ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{gd(e)}catch(n){ru(t,t.return,n)}}function hl(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new tl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new tl),t;default:throw Error(o(435,e.tag))}}(e);t.forEach((function(t){var r=lu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}function dl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:case 5:ol=l.stateNode,al=!1;break e;case 3:case 4:ol=l.stateNode.containerInfo,al=!0;break e}l=l.return}if(null===ol)throw Error(o(160));cl(s,a,i),ol=null,al=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}var fl=null;function pl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:dl(t,e),gl(e),4&r&&(Ga(3,e,e.return),za(3,e),Ga(5,e,e.return));break;case 1:dl(t,e),gl(e),512&r&&(Ja||null===n||$a(n,n.return)),64&r&&Qa&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=fl;if(dl(t,e),gl(e),512&r&&(Ja||null===n||$a(n,n.return)),4&r){var s=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(s=i.getElementsByTagName("title")[0])||s[$e]||s[Be]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(r),i.head.insertBefore(s,i.querySelector("head > title"))),Hu(s,r,n),s[Be]=e,Ze(s),r=s;break e;case"link":var a=Ch("link","href",i).get(r+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((s=a[l]).getAttribute("href")===(null==n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}Hu(s=i.createElement(r),r,n),i.head.appendChild(s);break;case"meta":if(a=Ch("meta","content",i).get(r+(n.content||"")))for(l=0;l<a.length;l++)if((s=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}Hu(s=i.createElement(r),r,n),i.head.appendChild(s);break;default:throw Error(o(468,r))}s[Be]=e,Ze(s),r=s}e.stateNode=r}else Rh(i,e.type,e.stateNode);else e.stateNode=Eh(i,r,e.memoizedProps);else s!==r?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===r?Rh(i,e.type,e.stateNode):Eh(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Xa(e,e.memoizedProps,n.memoizedProps)}break;case 27:if(4&r&&null===e.alternate){i=e.stateNode,s=e.memoizedProps;try{for(var c=i.firstChild;c;){var u=c.nextSibling,h=c.nodeName;c[$e]||"HEAD"===h||"BODY"===h||"SCRIPT"===h||"STYLE"===h||"LINK"===h&&"stylesheet"===c.rel.toLowerCase()||i.removeChild(c),c=u}for(var d=e.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);Hu(i,d,s),i[Be]=e,i[Ue]=s}catch(g){ru(e,e.return,g)}}case 5:if(dl(t,e),gl(e),512&r&&(Ja||null===n||$a(n,n.return)),32&e.flags){i=e.stateNode;try{Et(i,"")}catch(g){ru(e,e.return,g)}}4&r&&null!=e.stateNode&&Xa(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(el=!0);break;case 6:if(dl(t,e),gl(e),4&r){if(null===e.stateNode)throw Error(o(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(g){ru(e,e.return,g)}}break;case 3:if(Ah=null,i=fl,fl=dh(t.containerInfo),dl(t,e),fl=i,gl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{gd(t.containerInfo)}catch(g){ru(e,e.return,g)}el&&(el=!1,ml(e));break;case 4:r=fl,fl=dh(e.stateNode.containerInfo),dl(t,e),gl(e),fl=r;break;case 12:dl(t,e),gl(e);break;case 13:dl(t,e),gl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(vc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,hl(e,r)));break;case 22:if(512&r&&(Ja||null===n||$a(n,n.return)),c=null!==e.memoizedState,u=null!==n&&null!==n.memoizedState,Qa=(h=Qa)||c,Ja=(d=Ja)||u,dl(t,e),Ja=d,Qa=h,gl(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&r&&(t._visibility=c?-2&t._visibility:1|t._visibility,c&&(t=Qa||Ja,null===n||u||t||yl(e)),null===e.memoizedProps||"manual"!==e.memoizedProps.mode))e:for(n=null,t=e;;){if(5===t.tag||26===t.tag||27===t.tag){if(null===n){u=n=t;try{if(i=u.stateNode,c)"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{a=u.stateNode;var p=void 0!==(l=u.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null;a.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(g){ru(u,u.return,g)}}}else if(6===t.tag){if(null===n){u=t;try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(g){ru(u,u.return,g)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,hl(e,n))));break;case 19:dl(t,e),gl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,hl(e,r)));break;case 21:break;default:dl(t,e),gl(e)}}function gl(e){var t=e.flags;if(2&t){try{if(27!==e.tag){e:{for(var n=e.return;null!==n;){if(qa(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 27:var i=r.stateNode;Za(e,Ka(e),i);break;case 5:var s=r.stateNode;32&r.flags&&(Et(s,""),r.flags&=-33),Za(e,Ka(e),s);break;case 3:case 4:var a=r.stateNode.containerInfo;Ya(e,Ka(e),a);break;default:throw Error(o(161))}}}catch(l){ru(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ml(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;ml(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function _l(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)il(e,t.alternate,t),t=t.sibling}function yl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ga(4,t,t.return),yl(t);break;case 1:$a(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&ja(t,t.return,n),yl(t);break;case 26:case 27:case 5:$a(t,t.return),yl(t);break;case 22:$a(t,t.return),null===t.memoizedState&&yl(t);break;default:yl(t)}e=e.sibling}}function vl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,s=t,o=s.flags;switch(s.tag){case 0:case 11:case 15:vl(i,s,n),za(4,s);break;case 1:if(vl(i,s,n),"function"===typeof(i=(r=s).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){ru(r,r.return,c)}if(null!==(i=(r=s).updateQueue)){var a=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)Ba(l[i],a)}catch(c){ru(r,r.return,c)}}n&&64&o&&Va(s),Wa(s,s.return);break;case 26:case 27:case 5:vl(i,s,n),n&&null===r&&4&o&&Ha(s),Wa(s,s.return);break;case 12:default:vl(i,s,n);break;case 13:vl(i,s,n),n&&4&o&&ul(i,s);break;case 22:null===s.memoizedState&&vl(i,s,n),Wa(s,s.return)}t=t.sibling}}function bl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Gi(n))}function wl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Gi(e))}function El(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Sl(e,t,n,r),t=t.sibling}function Sl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:El(e,t,n,r),2048&i&&za(9,t);break;case 3:El(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Gi(e)));break;case 12:if(2048&i){El(e,t,n,r),e=t.stateNode;try{var s=t.memoizedProps,o=s.id,a=s.onPostCommit;"function"===typeof a&&a(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){ru(t,t.return,l)}}else El(e,t,n,r);break;case 23:break;case 22:s=t.stateNode,null!==t.memoizedState?4&s._visibility?El(e,t,n,r):Tl(e,t):4&s._visibility?El(e,t,n,r):(s._visibility|=4,xl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&bl(t.alternate,t);break;case 24:El(e,t,n,r),2048&i&&wl(t.alternate,t);break;default:El(e,t,n,r)}}function xl(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,o=t,a=n,l=r,c=o.flags;switch(o.tag){case 0:case 11:case 15:xl(s,o,a,l,i),za(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?4&u._visibility?xl(s,o,a,l,i):Tl(s,o):(u._visibility|=4,xl(s,o,a,l,i)),i&&2048&c&&bl(o.alternate,o);break;case 24:xl(s,o,a,l,i),i&&2048&c&&wl(o.alternate,o);break;default:xl(s,o,a,l,i)}t=t.sibling}}function Tl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Tl(n,r),2048&i&&bl(r.alternate,r);break;case 24:Tl(n,r),2048&i&&wl(r.alternate,r);break;default:Tl(n,r)}t=t.sibling}}var Al=8192;function Cl(e){if(e.subtreeFlags&Al)for(e=e.child;null!==e;)Rl(e),e=e.sibling}function Rl(e){switch(e.tag){case 26:Cl(e),e.flags&Al&&null!==e.memoizedState&&function(e,t,n){if(null===kh)throw Error(o(475));var r=kh;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=_h(n.href),s=e.querySelector(yh(i));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Lh.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=s,void Ze(s);s=e.ownerDocument||e,n=vh(n),(i=uh.get(i))&&xh(n,i),Ze(s=s.createElement("link"));var a=s;a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),Hu(s,"link",n),t.instance=s}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Lh.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(fl,e.memoizedState,e.memoizedProps);break;case 5:default:Cl(e);break;case 3:case 4:var t=fl;fl=dh(e.stateNode.containerInfo),Cl(e),fl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Al,Al=16777216,Cl(e),Al=t):Cl(e))}}function Pl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function kl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];nl=r,Il(r,e)}Pl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Ml(e),e=e.sibling}function Ml(e){switch(e.tag){case 0:case 11:case 15:kl(e),2048&e.flags&&Ga(9,e,e.return);break;case 3:case 12:default:kl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,Ll(e)):kl(e)}}function Ll(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];nl=r,Il(r,e)}Pl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:Ga(8,t,t.return),Ll(t);break;case 22:4&(n=t.stateNode)._visibility&&(n._visibility&=-5,Ll(t));break;default:Ll(t)}e=e.sibling}}function Il(e,t){for(;null!==nl;){var n=nl;switch(n.tag){case 0:case 11:case 15:Ga(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Gi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,nl=r;else e:for(n=e;null!==nl;){var i=(r=nl).sibling,s=r.return;if(sl(r),r===n){nl=null;break e}if(null!==i){i.return=s,nl=i;break e}nl=s}}}function Ol(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nl(e,t,n,r){return new Ol(e,t,n,r)}function Fl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dl(e,t){var n=e.alternate;return null===n?((n=Nl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=31457280&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Bl(e,t){e.flags&=31457282;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ul(e,t,n,r,i,s){var a=0;if(r=e,"function"===typeof e)Fl(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,K.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case h:return zl(n.children,i,s,t);case d:a=8,i|=24;break;case f:return(e=Nl(12,n,t,2|i)).elementType=f,e.lanes=s,e;case y:return(e=Nl(13,n,t,i)).elementType=y,e.lanes=s,e;case v:return(e=Nl(19,n,t,i)).elementType=v,e.lanes=s,e;case E:return Gl(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case p:case m:a=10;break e;case g:a=9;break e;case _:a=11;break e;case b:a=14;break e;case w:a=16,r=null;break e}a=29,n=Error(o(130,null===e?"null":typeof e,"")),r=null}return(t=Nl(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function zl(e,t,n,r){return(e=Nl(7,e,r,t)).lanes=n,e}function Gl(e,t,n,r){(e=Nl(22,e,r,t)).elementType=E,e.lanes=n;var i={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=i._current;if(null===e)throw Error(o(456));if(0===(2&i._pendingVisibility)){var t=Pr(e,2);null!==t&&(i._pendingVisibility|=2,Lc(t,e,2))}},attach:function(){var e=i._current;if(null===e)throw Error(o(456));if(0!==(2&i._pendingVisibility)){var t=Pr(e,2);null!==t&&(i._pendingVisibility&=-3,Lc(t,e,2))}}};return e.stateNode=i,e}function Vl(e,t,n){return(e=Nl(6,e,null,t)).lanes=n,e}function jl(e,t,n){return(t=Nl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wl(e){e.flags|=4}function $l(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Ph(t)){if(null!==(t=Ri.current)&&((4194176&rc)===rc?null!==Pi:(62914560&rc)!==rc&&0===(536870912&rc)||t!==Pi))throw di=li,ai;e.flags|=8192}}function Hl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ke():536870912,e.lanes|=t,gc|=t)}function Xl(e,t){if(!Yr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ql(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=31457280&i.subtreeFlags,r|=31457280&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Kl(e,t,n){var r=t.pendingProps;switch(Xr(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ql(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),va(Ui),ee(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ri(t)?Wl(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Zr&&(Oc(Zr),Zr=null))),ql(t),null;case 26:return n=t.memoizedState,null===e?(Wl(t),null!==n?(ql(t),$l(t,n)):(ql(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Wl(t),ql(t),$l(t,n)):(ql(t),t.flags&=-16777217):(e.memoizedProps!==r&&Wl(t),ql(t),t.flags&=-16777217),null;case 27:ne(t),n=Z.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Wl(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return ql(t),null}e=K.current,ri(t)?ti(t):(e=ch(i,r,n),t.stateNode=e,Wl(t))}return ql(t),null;case 5:if(ne(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Wl(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return ql(t),null}if(e=K.current,ri(t))ti(t);else{switch(i=Ku(Z.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?i.createElement(n,{is:r.is}):i.createElement(n)}}e[Be]=t,e[Ue]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(Hu(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Wl(t)}}return ql(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Wl(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(e=Z.current,ri(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=qr))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Be]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Vu(e.nodeValue,n)))||ei(t)}else(e=Ku(e).createTextNode(r))[Be]=t,t.stateNode=e}return ql(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=ri(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[Be]=t}else ii(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ql(t),i=!1}else null!==Zr&&(Oc(Zr),Zr=null),i=!0;if(!i)return 256&t.flags?(Ii(t),t):(Ii(t),null)}if(Ii(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool);var s=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==i&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Hl(t,t.updateQueue),ql(t),null;case 4:return ee(),null===e&&Lu(t.stateNode.containerInfo),ql(t),null;case 10:return va(t.type),ql(t),null;case 19:if(X(Oi),null===(i=t.memoizedState))return ql(t),null;if(r=0!==(128&t.flags),null===(s=i.rendering))if(r)Xl(i,!1);else{if(0!==uc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Ni(e))){for(t.flags|=128,Xl(i,!1),e=s.updateQueue,t.updateQueue=e,Hl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Bl(n,e),n=n.sibling;return q(Oi,1&Oi.current|2),t.child}e=e.sibling}null!==i.tail&&le()>bc&&(t.flags|=128,r=!0,Xl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=Ni(s))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,Hl(t,e),Xl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!Yr)return ql(t),null}else 2*le()-i.renderingStartTime>bc&&536870912!==n&&(t.flags|=128,r=!0,Xl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=le(),t.sibling=null,e=Oi.current,q(Oi,r?1&e|2:1&e),t):(ql(t),null);case 22:case 23:return Ii(t),Ci(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(ql(t),6&t.subtreeFlags&&(t.flags|=8192)):ql(t),null!==(n=t.updateQueue)&&Hl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&X(qi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),va(Ui),ql(t),null;case 25:return null}throw Error(o(156,t.tag))}function Yl(e,t){switch(Xr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return va(Ui),ee(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return ne(t),null;case 13:if(Ii(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));ii()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return X(Oi),null;case 4:return ee(),null;case 10:return va(t.type),null;case 22:case 23:return Ii(t),Ci(),null!==e&&X(qi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return va(Ui),null;default:return null}}function Zl(e,t){switch(Xr(t),t.tag){case 3:va(Ui),ee();break;case 26:case 27:case 5:ne(t);break;case 4:ee();break;case 13:Ii(t);break;case 19:X(Oi);break;case 10:va(t.type);break;case 22:case 23:Ii(t),Ci(),null!==e&&X(qi);break;case 24:va(Ui)}}var Ql={getCacheForType:function(e){var t=Ta(Ui),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},Jl="function"===typeof WeakMap?WeakMap:Map,ec=0,tc=null,nc=null,rc=0,ic=0,sc=null,oc=!1,ac=!1,lc=!1,cc=0,uc=0,hc=0,dc=0,fc=0,pc=0,gc=0,mc=null,_c=null,yc=!1,vc=0,bc=1/0,wc=null,Ec=null,Sc=!1,xc=null,Tc=0,Ac=0,Cc=null,Rc=0,Pc=null;function kc(){if(0!==(2&ec)&&0!==rc)return rc&-rc;if(null!==k.T){return 0!==Wi?Wi:wu()}return Fe()}function Mc(){0===pc&&(pc=0===(536870912&rc)||Yr?Pe():536870912);var e=Ri.current;return null!==e&&(e.flags|=32),pc}function Lc(e,t,n){(e===tc&&2===ic||null!==e.cancelPendingCommit)&&(zc(e,0),Dc(e,rc,pc,!1)),Le(e,n),0!==(2&ec)&&e===tc||(e===tc&&(0===(2&ec)&&(dc|=n),4===uc&&Dc(e,rc,pc,!1)),gu(e))}function Ic(e,t,n){if(0!==(6&ec))throw Error(o(327));for(var r=!n&&0===(60&t)&&0===(t&e.expiredLanes)||Ce(e,t),i=r?function(e,t){var n=ec;ec|=2;var r=Vc(),i=jc();tc!==e||rc!==t?(wc=null,bc=le()+500,zc(e,t)):ac=Ce(e,t);e:for(;;)try{if(0!==ic&&null!==nc){t=nc;var s=sc;t:switch(ic){case 1:ic=0,sc=null,Yc(e,t,s,1);break;case 2:if(ci(s)){ic=0,sc=null,Kc(t);break}t=function(){2===ic&&tc===e&&(ic=7),gu(e)},s.then(t,t);break e;case 3:ic=7;break e;case 4:ic=5;break e;case 7:ci(s)?(ic=0,sc=null,Kc(t)):(ic=0,sc=null,Yc(e,t,s,7));break;case 5:var a=null;switch(nc.tag){case 26:a=nc.memoizedState;case 5:case 27:var l=nc;if(!a||Ph(a)){ic=0,sc=null;var c=l.sibling;if(null!==c)nc=c;else{var u=l.return;null!==u?(nc=u,Zc(u)):nc=null}break t}}ic=0,sc=null,Yc(e,t,s,5);break;case 6:ic=0,sc=null,Yc(e,t,s,6);break;case 8:Uc(),uc=6;break e;default:throw Error(o(462))}}Xc();break}catch(h){Gc(e,h)}return _a=ma=null,k.H=r,k.A=i,ec=n,null!==nc?0:(tc=null,rc=0,Ar(),uc)}(e,t):$c(e,t,!0),s=r;;){if(0===i){ac&&!r&&Dc(e,t,0,!1);break}if(6===i)Dc(e,t,0,!oc);else{if(n=e.current.alternate,s&&!Fc(n)){i=$c(e,t,!1),s=!1;continue}if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=mc;var c=l.current.memoizedState.isDehydrated;if(c&&(zc(l,a).flags|=256),2!==(a=$c(l,a,!1))){if(lc&&!c){l.errorRecoveryDisabledLanes|=s,dc|=s,i=4;break e}s=_c,_c=i,null!==s&&Oc(s)}i=a}if(s=!1,2!==i)continue}}if(1===i){zc(e,0),Dc(e,t,0,!0);break}e:{switch(r=e,i){case 0:case 1:throw Error(o(345));case 4:if((4194176&t)===t){Dc(r,t,pc,!oc);break e}break;case 2:_c=null;break;case 3:case 5:break;default:throw Error(o(329))}if(r.finishedWork=n,r.finishedLanes=t,(62914560&t)===t&&10<(s=vc+300-le())){if(Dc(r,t,pc,!oc),0!==Ae(r,0))break e;r.timeoutHandle=eh(Nc.bind(null,r,n,_c,wc,yc,t,pc,dc,gc,oc,2,-0,0),s)}else Nc(r,n,_c,wc,yc,t,pc,dc,gc,oc,0,-0,0)}}break}gu(e)}function Oc(e){null===_c?_c=e:_c.push.apply(_c,e)}function Nc(e,t,n,r,i,s,a,l,c,u,h,d,f){var p=t.subtreeFlags;if((8192&p||16785408===(16785408&p))&&(kh={stylesheets:null,count:0,unsuspend:Mh},Rl(t),null!==(t=function(){if(null===kh)throw Error(o(475));var e=kh;return e.stylesheets&&0===e.count&&Oh(e,e.stylesheets),0<e.count?function(t){var n=setTimeout((function(){if(e.stylesheets&&Oh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=t(Jc.bind(null,e,n,r,i,a,l,c,1,d,f)),void Dc(e,s,a,!u);Jc(e,n,r,i,a,l,c,h,d,f)}function Fc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!qn(s(),i))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Dc(e,t,n,r){t&=~fc,t&=~dc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var s=31-be(i),o=1<<s;r[s]=-1,i&=~o}0!==n&&Ie(e,n,t)}function Bc(){return 0!==(6&ec)||(mu(0,!1),!1)}function Uc(){if(null!==nc){if(0===ic)var e=nc.return;else _a=ma=null,_s(e=nc),pi=null,gi=0,e=nc;for(;null!==e;)Zl(e.alternate,e),e=e.return;nc=null}}function zc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,th(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Uc(),tc=e,nc=n=Dl(e.current,null),rc=t,ic=0,sc=null,oc=!1,ac=Ce(e,t),lc=!1,gc=pc=fc=dc=hc=uc=0,_c=mc=null,yc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-be(r),s=1<<i;t|=e[i],r&=~s}return cc=t,Ar(),n}function Gc(e,t){Ji=null,k.H=To,t===oi?(t=fi(),ic=3):t===ai?(t=fi(),ic=4):ic=t===jo?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,sc=t,null===nc&&(uc=1,Bo(e,Or(t,e.current)))}function Vc(){var e=k.H;return k.H=To,null===e?To:e}function jc(){var e=k.A;return k.A=Ql,e}function Wc(){uc=4,oc||(4194176&rc)!==rc&&null!==Ri.current||(ac=!0),0===(134217727&hc)&&0===(134217727&dc)||null===tc||Dc(tc,rc,pc,!1)}function $c(e,t,n){var r=ec;ec|=2;var i=Vc(),s=jc();tc===e&&rc===t||(wc=null,zc(e,t)),t=!1;var o=uc;e:for(;;)try{if(0!==ic&&null!==nc){var a=nc,l=sc;switch(ic){case 8:Uc(),o=6;break e;case 3:case 2:case 6:null===Ri.current&&(t=!0);var c=ic;if(ic=0,sc=null,Yc(e,a,l,c),n&&ac){o=0;break e}break;default:c=ic,ic=0,sc=null,Yc(e,a,l,c)}}Hc(),o=uc;break}catch(u){Gc(e,u)}return t&&e.shellSuspendCounter++,_a=ma=null,ec=r,k.H=i,k.A=s,null===nc&&(tc=null,rc=0,Ar()),o}function Hc(){for(;null!==nc;)qc(nc)}function Xc(){for(;null!==nc&&!oe();)qc(nc)}function qc(e){var t=pa(e.alternate,e,cc);e.memoizedProps=e.pendingProps,null===t?Zc(e):nc=t}function Kc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Jo(n,t,t.pendingProps,t.type,void 0,rc);break;case 11:t=Jo(n,t,t.pendingProps,t.type.render,t.ref,rc);break;case 5:_s(t);default:Zl(n,t),t=pa(n,t=nc=Bl(t,cc),cc)}e.memoizedProps=e.pendingProps,null===t?Zc(e):nc=t}function Yc(e,t,n,r){_a=ma=null,_s(t),pi=null,gi=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ea(t,n,i,!0),null!==(n=Ri.current)){switch(n.tag){case 13:return null===Pi?Wc():null===n.alternate&&0===uc&&(uc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===li?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),iu(e,r,i)),!1;case 22:return n.flags|=65536,r===li?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),iu(e,r,i)),!1}throw Error(o(435,n.tag))}return iu(e,r,i),Wc(),!1}if(Yr)return null!==(t=Ri.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==Jr&&si(Or(e=Error(o(422),{cause:r}),n))):(r!==Jr&&si(Or(t=Error(o(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Or(r,n),Oa(e,i=zo(e.stateNode,r,i)),4!==uc&&(uc=2)),!1;var s=Error(o(520),{cause:r});if(s=Or(s,n),null===mc?mc=[s]:mc.push(s),4!==uc&&(uc=2),null===t)return!0;r=Or(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,Oa(n,e=zo(n.stateNode,r,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Ec||!Ec.has(s))))return n.flags|=65536,i&=-i,n.lanes|=i,Vo(i=Go(i),e,n,r),Oa(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,rc))return uc=1,Bo(e,Or(n,e.current)),void(nc=null)}catch(s){if(null!==i)throw nc=i,s;return uc=1,Bo(e,Or(n,e.current)),void(nc=null)}32768&t.flags?(Yr||1===r?e=!0:ac||0!==(536870912&rc)?e=!1:(oc=e=!0,(2===r||3===r||6===r)&&(null!==(r=Ri.current)&&13===r.tag&&(r.flags|=16384))),Qc(t,e)):Zc(t)}function Zc(e){var t=e;do{if(0!==(32768&t.flags))return void Qc(t,oc);e=t.return;var n=Kl(t.alternate,t,cc);if(null!==n)return void(nc=n);if(null!==(t=t.sibling))return void(nc=t);nc=t=e}while(null!==t);0===uc&&(uc=5)}function Qc(e,t){do{var n=Yl(e.alternate,e);if(null!==n)return n.flags&=32767,void(nc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(nc=e);nc=e=n}while(null!==e);uc=6,nc=null}function Jc(e,t,n,r,i,s,a,l,c,u){var h=k.T,d=V.p;try{V.p=2,k.T=null,function(e,t,n,r,i,s,a,l){do{tu()}while(null!==xc);if(0!==(6&ec))throw Error(o(327));var c=e.finishedWork;if(r=e.finishedLanes,null===c)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var u=c.lanes|c.childLanes;if(function(e,t,n,r,i,s){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-be(n),h=1<<u;a[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}n&=~h}0!==r&&Ie(e,r,0),0!==s&&0===i&&0!==e.tag&&(e.suspendedLanes|=s&~(o&~t))}(e,r,u|=Tr,s,a,l),e===tc&&(nc=tc=null,rc=0),0===(10256&c.subtreeFlags)&&0===(10256&c.flags)||Sc||(Sc=!0,Ac=u,Cc=n,function(e,t){ie(e,t)}(de,(function(){return tu(),null}))),n=0!==(15990&c.flags),0!==(15990&c.subtreeFlags)||n?(n=k.T,k.T=null,s=V.p,V.p=2,a=ec,ec|=4,function(e,t){if(e=e.containerInfo,Xu=Wh,er(e=Jn(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(m){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==s||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===s&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(qu={focusedElem:e,selectionRange:n},Wh=!1,nl=t;null!==nl;)if(e=(t=nl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,nl=e;else for(;null!==nl;){switch(s=(t=nl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,i=s.memoizedProps,s=s.memoizedState,r=n.stateNode;try{var g=Io(n.type,i,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(g,s),r.__reactInternalSnapshotBeforeUpdate=e}catch(_){ru(n,n.return,_)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))oh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":oh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,nl=e;break}nl=t.return}g=rl,rl=!1}(e,c),pl(c,e),tr(qu,e.containerInfo),Wh=!!Xu,qu=Xu=null,e.current=c,il(e,c.alternate,c),ae(),ec=a,V.p=s,k.T=n):e.current=c,Sc?(Sc=!1,xc=e,Tc=r):eu(e,u),u=e.pendingLanes,0===u&&(Ec=null),function(e){if(ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(_e,e,void 0,128===(128&e.current.flags))}catch(t){}}(c.stateNode),gu(e),null!==t)for(i=e.onRecoverableError,c=0;c<t.length;c++)u=t[c],i(u.value,{componentStack:u.stack});0!==(3&Tc)&&tu(),u=e.pendingLanes,0!==(4194218&r)&&0!==(42&u)?e===Pc?Rc++:(Rc=0,Pc=e):Rc=0,mu(0,!1)}(e,t,n,r,d,i,s,a)}finally{k.T=h,V.p=d}}function eu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Gi(t)))}function tu(){if(null!==xc){var e=xc,t=Ac;Ac=0;var n=Ne(Tc),r=k.T,i=V.p;try{if(V.p=32>n?32:n,k.T=null,null===xc)var s=!1;else{n=Cc,Cc=null;var a=xc,l=Tc;if(xc=null,Tc=0,0!==(6&ec))throw Error(o(331));var c=ec;if(ec|=4,Ml(a.current),Sl(a,a.current,l,n),ec=c,mu(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(_e,a)}catch(u){}s=!0}return s}finally{V.p=i,k.T=r,eu(e,t)}}return!1}function nu(e,t,n){t=Or(n,t),null!==(e=La(e,t=zo(e.stateNode,t,2),2))&&(Le(e,2),gu(e))}function ru(e,t,n){if(3===e.tag)nu(e,e,n);else for(;null!==t;){if(3===t.tag){nu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ec||!Ec.has(r))){e=Or(n,e),null!==(r=La(t,n=Go(2),2))&&(Vo(n,r,t,e),Le(r,2),gu(r));break}}t=t.return}}function iu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Jl;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(lc=!0,i.add(n),e=su.bind(null,e,t,n),t.then(e,e))}function su(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,tc===e&&(rc&n)===n&&(4===uc||3===uc&&(62914560&rc)===rc&&300>le()-vc?0===(2&ec)&&zc(e,0):fc|=n,gc===rc&&(gc=0)),gu(e)}function ou(e,t){0===t&&(t=ke()),null!==(e=Pr(e,t))&&(Le(e,t),gu(e))}function au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),ou(e,n)}function lu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==r&&r.delete(t),ou(e,n)}var cu=null,uu=null,hu=!1,du=!1,fu=!1,pu=0;function gu(e){var t;e!==uu&&null===e.next&&(null===uu?cu=uu=e:uu=uu.next=e),du=!0,hu||(hu=!0,t=_u,rh((function(){0!==(6&ec)?ie(ue,t):t()})))}function mu(e,t){if(!fu&&du){fu=!0;do{for(var n=!1,r=cu;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var s=0;else{var o=r.suspendedLanes,a=r.pingedLanes;s=(1<<31-be(42|e)+1)-1,s=201326677&(s&=i&~(o&~a))?201326677&s|1:s?2|s:0}0!==s&&(n=!0,bu(r,s))}else s=rc,0===(3&(s=Ae(r,r===tc?s:0)))||Ce(r,s)||(n=!0,bu(r,s));r=r.next}}while(n);fu=!1}}function _u(){du=hu=!1;var e=0;0!==pu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Ju&&(Ju=e,!0);return Ju=null,!1}()&&(e=pu),pu=0);for(var t=le(),n=null,r=cu;null!==r;){var i=r.next,s=yu(r,t);0===s?(r.next=null,null===n?cu=i:n.next=i,null===i&&(uu=n)):(n=r,(0!==e||0!==(3&s))&&(du=!0)),r=i}mu(e,!1)}function yu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var o=31-be(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=Re(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}if(n=rc,n=Ae(e,e===(t=tc)?n:0),r=e.callbackNode,0===n||e===t&&2===ic||null!==e.cancelPendingCommit)return null!==r&&null!==r&&se(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ce(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&se(r),Ne(n)){case 2:case 8:n=he;break;case 32:default:n=de;break;case 268435456:n=pe}return r=vu.bind(null,e),n=ie(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&se(r),e.callbackPriority=2,e.callbackNode=null,2}function vu(e,t){var n=e.callbackNode;if(tu()&&e.callbackNode!==n)return null;var r=rc;return 0===(r=Ae(e,e===tc?r:0))?null:(Ic(e,r,t),yu(e,le()),null!=e.callbackNode&&e.callbackNode===n?vu.bind(null,e):null)}function bu(e,t){if(tu())return null;Ic(e,t,!0)}function wu(){return 0===pu&&(pu=Pe()),pu}function Eu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function Su(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var xu=0;xu<wr.length;xu++){var Tu=wr[xu];Er(Tu.toLowerCase(),"on"+(Tu[0].toUpperCase()+Tu.slice(1)))}Er(fr,"onAnimationEnd"),Er(pr,"onAnimationIteration"),Er(gr,"onAnimationStart"),Er("dblclick","onDoubleClick"),Er("focusin","onFocus"),Er("focusout","onBlur"),Er(mr,"onTransitionRun"),Er(_r,"onTransitionStart"),Er(yr,"onTransitionCancel"),Er(vr,"onTransitionEnd"),tt("onMouseEnter",["mouseout","mouseover"]),tt("onMouseLeave",["mouseout","mouseover"]),tt("onPointerEnter",["pointerout","pointerover"]),tt("onPointerLeave",["pointerout","pointerover"]),et("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),et("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),et("onBeforeInput",["compositionend","keypress","textInput","paste"]),et("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Au));function Ru(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(u){Oo(u)}i.currentTarget=null,s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(u){Oo(u)}i.currentTarget=null,s=l}}}}function Pu(e,t){var n=t[Ge];void 0===n&&(n=t[Ge]=new Set);var r=e+"__bubble";n.has(r)||(Iu(t,e,2,!1),n.add(r))}function ku(e,t,n){var r=0;t&&(r|=4),Iu(n,e,r,t)}var Mu="_reactListening"+Math.random().toString(36).slice(2);function Lu(e){if(!e[Mu]){e[Mu]=!0,Qe.forEach((function(t){"selectionchange"!==t&&(Cu.has(t)||ku(t,!1,e),ku(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Mu]||(t[Mu]=!0,ku("selectionchange",!1,t))}}function Iu(e,t,n,r){switch(Zh(t)){case 2:var i=$h;break;case 8:i=Hh;break;default:i=Xh}n=i.bind(null,t,n,e),i=void 0,!Bt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Ou(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=Xe(a)))return;if(5===(l=o.tag)||6===l||26===l||27===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Ft((function(){var r=s,i=Mt(n),o=[];e:{var a=br.get(e);if(void 0!==a){var l=Qt,c=e;switch(e){case"keypress":if(0===Wt(n))break e;case"keydown":case"keyup":l=pn;break;case"focusin":c="focus",l=sn;break;case"focusout":c="blur",l=sn;break;case"beforeblur":case"afterblur":l=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=nn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=rn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=mn;break;case fr:case pr:case gr:l=on;break;case vr:l=_n;break;case"scroll":case"scrollend":l=en;break;case"wheel":l=yn;break;case"copy":case"cut":case"paste":l=an;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=gn;break;case"toggle":case"beforetoggle":l=vn}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=p;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===d||null!=(g=Dt(p,d))&&u.push(Nu(p,g,f)),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===kt||!(c=n.relatedTarget||n.fromElement)||!Xe(c)&&!c[ze])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?Xe(c):null)&&(h=D(c),u=c.tag,c!==h||5!==u&&27!==u&&6!==u)&&(c=null)):(l=null,c=r),l!==c)){if(u=nn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=gn,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:Ke(l),f=null==c?a:Ke(c),(a=new u(g,p+"leave",l,n,i)).target=h,a.relatedTarget=f,g=null,Xe(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Du(f))p++;for(f=0,g=d;g;g=Du(g))f++;for(;0<p-f;)u=Du(u),p--;for(;0<f-p;)d=Du(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Du(u),d=Du(d)}u=null}else u=null;null!==l&&Bu(o,a,l,u,!1),null!==c&&null!==h&&Bu(o,h,c,u,!0)}if("select"===(l=(a=r?Ke(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Dn;else if(Mn(a))if(Bn)m=Xn;else{m=$n;var _=Wn}else!(l=a.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&At(r.elementType)&&(m=Dn):m=Hn;switch(m&&(m=m(e,r))?Ln(o,m,n,i):(_&&_(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&yt(a,"number",a.value)),_=r?Ke(r):window,e){case"focusin":(Mn(_)||"true"===_.contentEditable)&&(rr=_,ir=r,sr=null);break;case"focusout":sr=ir=rr=null;break;case"mousedown":or=!0;break;case"contextmenu":case"mouseup":case"dragend":or=!1,ar(o,n,i);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":ar(o,n,i)}var y;if(wn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Pn?Cn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(xn&&"ko"!==n.locale&&(Pn||"onCompositionStart"!==v?"onCompositionEnd"===v&&Pn&&(y=jt()):(Gt="value"in(zt=i)?zt.value:zt.textContent,Pn=!0)),0<(_=Fu(r,v)).length&&(v=new ln(v,e,null,n,i),o.push({event:v,listeners:_}),y?v.data=y:null!==(y=Rn(n))&&(v.data=y))),(y=Sn?function(e,t){switch(e){case"compositionend":return Rn(t);case"keypress":return 32!==t.which?null:(An=!0,Tn);case"textInput":return(e=t.data)===Tn&&An?null:e;default:return null}}(e,n):function(e,t){if(Pn)return"compositionend"===e||!wn&&Cn(e,t)?(e=jt(),Vt=Gt=zt=null,Pn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(v=Fu(r,"onBeforeInput")).length&&(_=new ln("onBeforeInput","beforeinput",null,n,i),o.push({event:_,listeners:v}),_.data=y)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var s=Eu((i[Ue]||null).action),o=r.submitter;o&&null!==(t=(t=o[Ue]||null)?Eu(t.formAction):o.getAttribute("formAction"))&&(s=t,o=null);var a=new Qt("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==pu){var e=o?Su(i,o):new FormData(i);uo(n,{pending:!0,data:e,method:i.method,action:s},null,e)}}else"function"===typeof s&&(a.preventDefault(),e=o?Su(i,o):new FormData(i),uo(n,{pending:!0,data:e,method:i.method,action:s},s,e))},currentTarget:i}]})}}(o,e,r,n,i)}Ru(o,t)}))}function Nu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fu(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5!==(i=i.tag)&&26!==i&&27!==i||null===s||(null!=(i=Dt(e,n))&&r.unshift(Nu(e,i,s)),null!=(i=Dt(e,t))&&r.push(Nu(e,i,s))),e=e.return}return r}function Du(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Bu(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,i?null!=(c=Dt(n,s))&&o.unshift(Nu(n,c,l)):i||null!=(c=Dt(n,s))&&o.push(Nu(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Uu=/\r\n?/g,zu=/\u0000|\uFFFD/g;function Gu(e){return("string"===typeof e?e:""+e).replace(Uu,"\n").replace(zu,"")}function Vu(e,t){return t=Gu(t),Gu(e)===t}function ju(){}function Wu(e,t,n,r,i,s){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Et(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Et(e,""+r);break;case"className":at(e,"class",r);break;case"tabIndex":at(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":at(e,n,r);break;case"style":Tt(e,r,s);break;case"data":if("object"!==t){at(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&Wu(e,t,"name",i.name,i,null),Wu(e,t,"formEncType",i.formEncType,i,null),Wu(e,t,"formMethod",i.formMethod,i,null),Wu(e,t,"formTarget",i.formTarget,i,null)):(Wu(e,t,"encType",i.encType,i,null),Wu(e,t,"method",i.method,i,null),Wu(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=ju);break;case"onScroll":null!=r&&Pu("scroll",e);break;case"onScrollEnd":null!=r&&Pu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Pt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Pu("beforetoggle",e),Pu("toggle",e),ot(e,"popover",r);break;case"xlinkActuate":lt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":lt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":lt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":lt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":lt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":lt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":lt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":lt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":lt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":ot(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ot(e,n=Ct.get(n)||n,r)}}function $u(e,t,n,r,i,s){switch(n){case"style":Tt(e,r,s);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Et(e,r):("number"===typeof r||"bigint"===typeof r)&&Et(e,""+r);break;case"onScroll":null!=r&&Pu("scroll",e);break;case"onScrollEnd":null!=r&&Pu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=ju);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Je.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(s=null!=(s=e[Ue]||null)?s[n]:null)&&e.removeEventListener(t,s,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):ot(e,n,r):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function Hu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Pu("error",e),Pu("load",e);var r,i=!1,s=!1;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(null!=a)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Wu(e,t,r,a,n,null)}}return s&&Wu(e,t,"srcSet",n.srcSet,n,null),void(i&&Wu(e,t,"src",n.src,n,null));case"input":Pu("invalid",e);var l=r=a=s=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var h=n[i];if(null!=h)switch(i){case"name":s=h;break;case"type":a=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(o(137,t));break;default:Wu(e,t,i,h,n,null)}}return _t(e,r,l,c,u,a,s,!1),void ht(e);case"select":for(s in Pu("invalid",e),i=a=r=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:Wu(e,t,s,l,n,null)}return t=r,n=a,e.multiple=!!i,void(null!=t?vt(e,!!i,t,!1):null!=n&&vt(e,!!i,n,!0));case"textarea":for(a in Pu("invalid",e),r=s=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":s=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:Wu(e,t,a,l,n,null)}return wt(e,i,s,r),void ht(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Wu(e,t,c,i,n,null);return;case"dialog":Pu("cancel",e),Pu("close",e);break;case"iframe":case"object":Pu("load",e);break;case"video":case"audio":for(i=0;i<Au.length;i++)Pu(Au[i],e);break;case"image":Pu("error",e),Pu("load",e);break;case"details":Pu("toggle",e);break;case"embed":case"source":case"link":Pu("error",e),Pu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Wu(e,t,u,i,n,null)}return;default:if(At(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(i=n[h])&&$u(e,t,h,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&Wu(e,t,l,i,n,null))}var Xu=null,qu=null;function Ku(e){return 9===e.nodeType?e:e.ownerDocument}function Yu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function Qu(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Ju=null;var eh="function"===typeof setTimeout?setTimeout:void 0,th="function"===typeof clearTimeout?clearTimeout:void 0,nh="function"===typeof Promise?Promise:void 0,rh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof nh?function(e){return nh.resolve(null).then(e).catch(ih)}:eh;function ih(e){setTimeout((function(){throw e}))}function sh(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void gd(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);gd(t)}function oh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":oh(n),He(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function ah(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}function lh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function ch(e,t,n){switch(t=Ku(n),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}var uh=new Map,hh=new Set;function dh(e){return"function"===typeof e.getRootNode?e.getRootNode():e.ownerDocument}var fh=V.d;V.d={f:function(){var e=fh.f(),t=Bc();return e||t},r:function(e){var t=qe(e);null!==t&&5===t.tag&&"form"===t.type?fo(t):fh.r(e)},D:function(e){fh.D(e),gh("dns-prefetch",e,null)},C:function(e,t){fh.C(e,t),gh("preconnect",e,t)},L:function(e,t,n){fh.L(e,t,n);var r=ph;if(r&&e&&t){var i='link[rel="preload"][as="'+gt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+gt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+gt(n.imageSizes)+'"]')):i+='[href="'+gt(e)+'"]';var s=i;switch(t){case"style":s=_h(e);break;case"script":s=bh(e)}uh.has(s)||(e=M({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),uh.set(s,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(yh(s))||"script"===t&&r.querySelector(wh(s))||(Hu(t=r.createElement("link"),"link",e),Ze(t),r.head.appendChild(t)))}},m:function(e,t){fh.m(e,t);var n=ph;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+gt(r)+'"][href="'+gt(e)+'"]',s=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=bh(e)}if(!uh.has(s)&&(e=M({rel:"modulepreload",href:e},t),uh.set(s,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(wh(s)))return}Hu(r=n.createElement("link"),"link",e),Ze(r),n.head.appendChild(r)}}},X:function(e,t){fh.X(e,t);var n=ph;if(n&&e){var r=Ye(n).hoistableScripts,i=bh(e),s=r.get(i);s||((s=n.querySelector(wh(i)))||(e=M({src:e,async:!0},t),(t=uh.get(i))&&Th(e,t),Ze(s=n.createElement("script")),Hu(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(i,s))}},S:function(e,t,n){fh.S(e,t,n);var r=ph;if(r&&e){var i=Ye(r).hoistableStyles,s=_h(e);t=t||"default";var o=i.get(s);if(!o){var a={loading:0,preload:null};if(o=r.querySelector(yh(s)))a.loading=5;else{e=M({rel:"stylesheet",href:e,"data-precedence":t},n),(n=uh.get(s))&&xh(e,n);var l=o=r.createElement("link");Ze(l),Hu(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){a.loading|=1})),l.addEventListener("error",(function(){a.loading|=2})),a.loading|=4,Sh(o,t,r)}o={type:"stylesheet",instance:o,count:1,state:a},i.set(s,o)}}},M:function(e,t){fh.M(e,t);var n=ph;if(n&&e){var r=Ye(n).hoistableScripts,i=bh(e),s=r.get(i);s||((s=n.querySelector(wh(i)))||(e=M({src:e,async:!0,type:"module"},t),(t=uh.get(i))&&Th(e,t),Ze(s=n.createElement("script")),Hu(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(i,s))}}};var ph="undefined"===typeof document?null:document;function gh(e,t,n){var r=ph;if(r&&"string"===typeof t&&t){var i=gt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),hh.has(i)||(hh.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(Hu(t=r.createElement("link"),"link",e),Ze(t),r.head.appendChild(t)))}}function mh(e,t,n,r){var i=(i=Z.current)?dh(i):null;if(!i)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=_h(n.href),(r=(n=Ye(i).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=_h(n.href);var s=Ye(i).hoistableStyles,a=s.get(e);if(a||(i=i.ownerDocument||i,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(e,a),(s=i.querySelector(yh(e)))&&!s._p&&(a.instance=s,a.state.loading=5),uh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},uh.set(e,n),s||function(e,t,n,r){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=e.createElement("link"),r.preload=t,t.addEventListener("load",(function(){return r.loading|=1})),t.addEventListener("error",(function(){return r.loading|=2})),Hu(t,"link",n),Ze(t),e.head.appendChild(t))}(i,e,n,a.state))),t&&null===r)throw Error(o(528,""));return a}if(t&&null!==r)throw Error(o(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=bh(n),(r=(n=Ye(i).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function _h(e){return'href="'+gt(e)+'"'}function yh(e){return'link[rel="stylesheet"]['+e+"]"}function vh(e){return M({},e,{"data-precedence":e.precedence,precedence:null})}function bh(e){return'[src="'+gt(e)+'"]'}function wh(e){return"script[async]"+e}function Eh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+gt(n.href)+'"]');if(r)return t.instance=r,Ze(r),r;var i=M({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ze(r=(e.ownerDocument||e).createElement("style")),Hu(r,"style",i),Sh(r,n.precedence,e),t.instance=r;case"stylesheet":i=_h(n.href);var s=e.querySelector(yh(i));if(s)return t.state.loading|=4,t.instance=s,Ze(s),s;r=vh(n),(i=uh.get(i))&&xh(r,i),Ze(s=(e.ownerDocument||e).createElement("link"));var a=s;return a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),Hu(s,"link",r),t.state.loading|=4,Sh(s,n.precedence,e),t.instance=s;case"script":return s=bh(n.src),(i=e.querySelector(wh(s)))?(t.instance=i,Ze(i),i):(r=n,(i=uh.get(s))&&Th(r=M({},n),i),Ze(i=(e=e.ownerDocument||e).createElement("script")),Hu(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Sh(r,n.precedence,e));return t.instance}function Sh(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,s=i,o=0;o<r.length;o++){var a=r[o];if(a.dataset.precedence===t)s=a;else if(s!==i)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function xh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Th(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Ah=null;function Ch(e,t,n){if(null===Ah){var r=new Map,i=Ah=new Map;i.set(n,r)}else(r=(i=Ah).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var s=n[i];if(!(s[$e]||s[Be]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var o=s.getAttribute(t)||"";o=e+o;var a=r.get(o);a?a.push(s):r.set(o,[s])}}return r}function Rh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Ph(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var kh=null;function Mh(){}function Lh(){if(this.count--,0===this.count)if(this.stylesheets)Oh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Ih=null;function Oh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Ih=new Map,t.forEach(Nh,e),Ih=null,Lh.call(e))}function Nh(e,t){if(!(4&t.state.loading)){var n=Ih.get(e);if(n)var r=n.get(null);else{n=new Map,Ih.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<i.length;s++){var o=i[s];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}o=(i=t.instance).getAttribute("data-precedence"),(s=n.get(o)||r)===r&&n.set(null,i),n.set(o,i),this.count++,r=Lh.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),s?s.parentNode.insertBefore(i,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Fh={$$typeof:m,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function Dh(e,t,n,r,i,s,o,a){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Me(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Me(0),this.hiddenUpdates=Me(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=s,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function Bh(e,t,n,r,i,s,o,a,l,c,u,h){return e=new Dh(e,t,n,o,a,l,c,h),t=1,!0===s&&(t|=24),s=Nl(3,null,null,t),e.current=s,s.stateNode=e,(t=zi()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:r,isDehydrated:n,cache:t},Pa(s),e}function Uh(e){return e?e=Lr:Lr}function zh(e,t,n,r,i,s){i=Uh(i),null===r.context?r.context=i:r.pendingContext=i,(r=Ma(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(r.callback=s),null!==(n=La(e,r,t))&&(Lc(n,0,t),Ia(n,e,t))}function Gh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vh(e,t){Gh(e,t),(e=e.alternate)&&Gh(e,t)}function jh(e){if(13===e.tag){var t=Pr(e,67108864);null!==t&&Lc(t,0,67108864),Vh(e,67108864)}}var Wh=!0;function $h(e,t,n,r){var i=k.T;k.T=null;var s=V.p;try{V.p=2,Xh(e,t,n,r)}finally{V.p=s,k.T=i}}function Hh(e,t,n,r){var i=k.T;k.T=null;var s=V.p;try{V.p=8,Xh(e,t,n,r)}finally{V.p=s,k.T=i}}function Xh(e,t,n,r){if(Wh){var i=qh(r);if(null===i)Ou(e,t,r,Kh,n),od(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Jh=ad(Jh,e,t,n,r,i),!0;case"dragenter":return ed=ad(ed,e,t,n,r,i),!0;case"mouseover":return td=ad(td,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return nd.set(s,ad(nd.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,rd.set(s,ad(rd.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(od(e,r),4&t&&-1<sd.indexOf(e)){for(;null!==i;){var s=qe(i);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var o=Te(s.pendingLanes);if(0!==o){var a=s;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-be(o);a.entanglements[1]|=l,o&=~l}gu(s),0===(6&ec)&&(bc=le()+500,mu(0,!1))}}break;case 13:null!==(a=Pr(s,2))&&Lc(a,0,2),Bc(),Vh(s,2)}if(null===(s=qh(r))&&Ou(e,t,r,Kh,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Ou(e,t,r,null,n)}}function qh(e){return Yh(e=Mt(e))}var Kh=null;function Yh(e){if(Kh=null,null!==(e=Xe(e))){var t=D(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=B(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Kh=e,null}function Zh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case he:return 8;case de:case fe:return 32;case pe:return 268435456;default:return 32}default:return 32}}var Qh=!1,Jh=null,ed=null,td=null,nd=new Map,rd=new Map,id=[],sd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function od(e,t){switch(e){case"focusin":case"focusout":Jh=null;break;case"dragenter":case"dragleave":ed=null;break;case"mouseover":case"mouseout":td=null;break;case"pointerover":case"pointerout":nd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rd.delete(t.pointerId)}}function ad(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=qe(t))&&jh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function ld(e){var t=Xe(e.target);if(null!==t){var n=D(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=B(n)))return e.blockedOn=t,void function(e,t){var n=V.p;try{return V.p=e,t()}finally{V.p=n}}(e.priority,(function(){if(13===n.tag){var e=kc(),t=Pr(n,e);null!==t&&Lc(t,0,e),Vh(n,e)}}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function cd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=qh(e.nativeEvent);if(null!==n)return null!==(t=qe(n))&&jh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);kt=r,n.target.dispatchEvent(r),kt=null,t.shift()}return!0}function ud(e,t,n){cd(e)&&n.delete(t)}function hd(){Qh=!1,null!==Jh&&cd(Jh)&&(Jh=null),null!==ed&&cd(ed)&&(ed=null),null!==td&&cd(td)&&(td=null),nd.forEach(ud),rd.forEach(ud)}function dd(e,t){e.blockedOn===t&&(e.blockedOn=null,Qh||(Qh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,hd)))}var fd=null;function pd(e){fd!==e&&(fd=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,(function(){fd===e&&(fd=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===Yh(r||n))continue;break}var s=qe(n);null!==s&&(e.splice(t,3),t-=3,uo(s,{pending:!0,data:i,method:n.method,action:r},r,i))}})))}function gd(e){function t(t){return dd(t,e)}null!==Jh&&dd(Jh,e),null!==ed&&dd(ed,e),null!==td&&dd(td,e),nd.forEach(t),rd.forEach(t);for(var n=0;n<id.length;n++){var r=id[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<id.length&&null===(n=id[0]).blockedOn;)ld(n),null===n.blockedOn&&id.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],s=n[r+1],o=i[Ue]||null;if("function"===typeof s)o||pd(n);else if(o){var a=null;if(s&&s.hasAttribute("formAction")){if(i=s,o=s[Ue]||null)a=o.formAction;else if(null!==Yh(i))continue}else a=o.action;"function"===typeof a?n[r+1]=a:(n.splice(r,3),r-=3),pd(n)}}}function md(e){this._internalRoot=e}function _d(e){this._internalRoot=e}_d.prototype.render=md.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));zh(t.current,kc(),e,t,null,null)},_d.prototype.unmount=md.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;0===e.tag&&tu(),zh(e.current,2,null,e,null,null),Bc(),t[ze]=null}},_d.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<id.length&&0!==t&&t<id[n].priority;n++);id.splice(n,0,e),0===n&&ld(e)}};var yd=i.version;if("19.0.0"!==yd)throw Error(o(527,yd,"19.0.0"));V.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=D(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return U(i),e;if(s===r)return U(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?z(e):null)?null:e.stateNode};var vd={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:k,findFiberByHostInstance:Xe,reconcilerVersion:"19.0.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bd.isDisabled&&bd.supportsFiber)try{_e=bd.inject(vd),ye=bd}catch(Ed){}}t.createRoot=function(e,t){if(!a(e))throw Error(o(299));var n=!1,r="",i=No,s=Fo,l=Do;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Bh(e,1,!1,null,0,n,r,i,s,l,0,null),e[ze]=t.current,Lu(8===e.nodeType?e.parentNode:e),new md(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(o(299));var r=!1,i="",s=No,l=Fo,c=Do,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Bh(e,1,!0,t,0,r,i,s,l,c,0,u)).context=Uh(null),n=t.current,(i=Ma(r=kc())).callback=null,La(n,i,r),t.current.lanes=r,Le(t,r),gu(t),e[ze]=t.current,Lu(e),new _d(t)},t.version="19.0.0"},863:(e,t,n)=>{var r=n(950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var o={d:{f:s,r:function(){throw Error(i(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=n,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:s}):"script"===n&&o.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);o.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.0.0"},352:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(85)},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(863)},916:(e,t)=>{var n=Symbol.for("react.transitional.element");function r(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var s in r={},t)"key"!==s&&(r[s]=t[s]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}Symbol.for("react.fragment"),t.jsx=r,t.jsxs=r},983:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function _(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=_.prototype;var b=v.prototype=new y;b.constructor=v,g(b,_.prototype),b.isPureReactComponent=!0;var w=Array.isArray,E={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function x(e,t,r,i,s,o){return r=o.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:o}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(){}function P(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case d:return P((u=e._init)(e._payload),t,i,s,o)}}if(u)return o=o(e),u=""===s?"."+C(e,0):s,w(o)?(i="",null!=u&&(i=u.replace(A,"$&/")+"/"),P(o,t,i,"",(function(e){return e}))):null!=o&&(T(o)&&(l=o,c=i+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(A,"$&/")+"/")+u,o=x(l.type,c,void 0,0,0,l.props)),t.push(o)),1;u=0;var h,p=""===s?".":s+":";if(w(e))for(var g=0;g<e.length;g++)u+=P(s=e[g],t,i,a=p+C(s,g),o);else if("function"===typeof(g=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=f&&h[f]||h["@@iterator"])?h:null))for(e=g.call(e),g=0;!(s=e.next()).done;)u+=P(s=s.value,t,i,a=p+C(s,g++),o);else if("object"===a){if("function"===typeof e.then)return P(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(R,R):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,s,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function k(e,t,n){if(null==e)return e;var r=[],i=0;return P(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function I(){}t.Children={map:k,forEach:function(e,t,n){k(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return k(e,(function(){t++})),t},toArray:function(e){return k(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=i,t.Profiler=o,t.PureComponent=v,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.act=function(){throw Error("act(...) is not supported in production builds of React.")},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!S.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(r[s]=t[s]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var o=Array(s),a=0;a<s;a++)o[a]=arguments[a+2];r.children=o}return x(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var r,i={},s=null;if(null!=t)for(r in void 0!==t.key&&(s=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var o=arguments.length-2;if(1===o)i.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===i[r]&&(i[r]=o[r]);return x(e,s,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,n={};E.T=n;try{var r=e(),i=E.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(I,L)}catch(s){L(s)}finally{E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,n){return E.H.useActionState(e,t,n)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return E.H.useEffect(e,t)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,n){return E.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return E.H.useReducer(e,t,n)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return E.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return E.H.useTransition()},t.version="19.0.0"},950:(e,t,n)=>{e.exports=n(983)},414:(e,t,n)=>{e.exports=n(916)},487:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,_="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(m=!1,b(e),!g)if(null!==r(c))g=!0,M();else{var t=r(u);null!==t&&L(w,t.startTime-e)}}var E,S=!1,x=-1,T=5,A=-1;function C(){return!(t.unstable_now()-A<T)}function R(){if(S){var e=t.unstable_now();A=e;var n=!0;try{e:{g=!1,m&&(m=!1,y(x),x=-1),p=!0;var s=f;try{t:{for(b(e),d=r(c);null!==d&&!(d.expirationTime>e&&C());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){d.callback=a,b(e),n=!0;break t}d===r(c)&&i(c),b(e)}else i(c);d=r(c)}if(null!==d)n=!0;else{var l=r(u);null!==l&&L(w,l.startTime-e),n=!1}}break e}finally{d=null,f=s,p=!1}n=void 0}}finally{n?E():S=!1}}}if("function"===typeof v)E=function(){v(R)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,k=P.port2;P.port1.onmessage=R,E=function(){k.postMessage(null)}}else E=function(){_(R,0)};function M(){S||(S=!0,E())}function L(e,n){x=_((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,M())},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(m?(y(x),x=-1):m=!0,L(w,s-o))):(e.sortIndex=a,n(c,e),g||p||(g=!0,M())),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},340:(e,t,n)=>{e.exports=n(487)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".c4d4db6c.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="deckgl-map-demo:";n.l=(r,i,s,o)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[i];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/DuckData-WebApp/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,s,o=r[0],a=r[1],l=r[2],c=0;if(o.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkdeckgl_map_demo=self.webpackChunkdeckgl_map_demo||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(950),i=n.t(r,2),s=n(352);let o=1,a=1;class l{time=0;channels=(()=>new Map)();animations=(()=>new Map)();playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:i=1}=e,s=o++,a={time:0,delay:t,duration:n,rate:r,repeat:i};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:e,channel:t}=r;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=a++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}const c={number:{type:"number",validate:(e,t)=>Number.isFinite(e)&&"object"===typeof t&&(void 0===t.max||e<=t.max)&&(void 0===t.min||e>=t.min)},array:{type:"array",validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function u(e){let t=h(e);if("object"!==t)return{value:e,...c[t],type:t};if("object"===typeof e)return e?void 0!==e.type?{...e,...c[e.type],type:e.type}:void 0===e.value?{type:"object",value:e}:(t=h(e.value),{...e,...c[t],type:t}):{type:"object",value:null};throw new Error("props")}function h(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}const d={vertex:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fragment:"#ifdef MODULE_MATERIAL\n  fragColor = material_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  fragColor = lighting_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_FOG\n  fragColor = fog_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  fragColor = picking_filterHighlightColor(fragColor);\n  fragColor = picking_filterPickingColor(fragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},f=/void\s+main\s*\([^)]*\)\s*\{\n?/,p=/}\n?[^{}]*$/,g=[],m="__LUMA_INJECT_DECLARATIONS__";function _(e){const t={vertex:{},fragment:{}};for(const n in e){let r=e[n];"string"===typeof r&&(r={order:0,injection:r}),t[y(n)][n]=r}return t}function y(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function v(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i="vertex"===t;for(const s in n){const t=n[s];t.sort(((e,t)=>e.order-t.order)),g.length=t.length;for(let e=0,n=t.length;e<n;++e)g[e]=t[e].injection;const r=`${g.join("\n")}\n`;switch(s){case"vs:#decl":i&&(e=e.replace(m,r));break;case"vs:#main-start":i&&(e=e.replace(f,(e=>e+r)));break;case"vs:#main-end":i&&(e=e.replace(p,(e=>r+e)));break;case"fs:#decl":i||(e=e.replace(m,r));break;case"fs:#main-start":i||(e=e.replace(f,(e=>e+r)));break;case"fs:#main-end":i||(e=e.replace(p,(e=>r+e)));break;default:e=e.replace(s,(e=>e+r))}}return e=e.replace(m,""),r&&(e=e.replace(/\}\s*$/,(e=>e+d[t]))),e}function b(e){e.map((e=>w(e)))}function w(e){if(e.instance)return;b(e.dependencies||[]);const{propTypes:t={},deprecations:n=[],inject:r={}}=e,i={normalizedInjections:_(r),parsedDeprecations:S(n)};t&&(i.propValidators=function(e){const t={};for(const[n,r]of Object.entries(e))t[n]=u(r);return t}(t)),e.instance=i;let s={};t&&(s=Object.entries(t).reduce(((e,t)=>{let[n,r]=t;const i=r?.value;return i&&(e[n]=i),e}),{})),e.defaultUniforms={...e.defaultUniforms,...s}}function E(e,t,n){e.deprecations?.forEach((e=>{e.regex?.test(t)&&(e.deprecated?n.deprecated(e.old,e.new)():n.removed(e.old,e.new)())}))}function S(e){return e.forEach((e=>{if("function"===e.type)e.regex=new RegExp(`\\b${e.old}\\(`);else e.regex=new RegExp(`${e.type} ${e.old};`)})),e}function x(e){b(e);const t={},n={};T({modules:e,level:0,moduleMap:t,moduleDepth:n});const r=Object.keys(n).sort(((e,t)=>n[t]-n[e])).map((e=>t[e]));return b(r),r}function T(e){const{modules:t,level:n,moduleMap:r,moduleDepth:i}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of t)r[s.name]=s,(void 0===i[s.name]||i[s.name]<n)&&(i[s.name]=n);for(const s of t)s.dependencies&&T({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}const A=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],C=[...A,[k("attribute"),"in $1"],[k("varying"),"out $1"]],R=[...A,[k("varying"),"in $1"]];function P(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}function k(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function M(e,t){let n="";for(const r in e){const i=e[r];if(n+=`void ${i.signature} {\n`,i.header&&(n+=`  ${i.header}`),t[r]){const e=t[r];e.sort(((e,t)=>e.order-t.order));for(const t of e)n+=`  ${t.injection}\n`}i.footer&&(n+=`  ${i.footer}`),n+="}\n"}return n}function L(e){const t={vertex:{},fragment:{}};for(const n of e){let e,r;"string"!==typeof n?(e=n,r=e.hook):(e={},r=n),r=r.trim();const[i,s]=r.split(":"),o=r.replace(/\(.+/,""),a=Object.assign(e,{signature:s});switch(i){case"vs":t.vertex[o]=a;break;case"fs":t.fragment[o]=a;break;default:throw new Error(i)}}return t}function I(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return n?n[1]:t}function N(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}if(100!==t&&300!==t)throw new Error(`Invalid GLSL version ${t}`);return t}const F=`\n\n${m}\n`;function D(e,t){const{source:n,stage:r,modules:i,hookFunctions:s=[],inject:o={},log:a}=t;I("string"===typeof n,"shader source must be a string");const l=n;let c="";const u=L(s),h={},d={},f={};for(const g in o){const e="string"===typeof o[g]?{injection:o[g],order:0}:o[g],t=/^(v|f)s:(#)?([\w-]+)$/.exec(g);if(t){const n=t[2],r=t[3];n?"decl"===r?d[g]=[e]:f[g]=[e]:h[g]=[e]}else f[g]=[e]}const p=i;for(const g of p){a&&E(g,l,a);c+=z(g,"wgsl");const e=g.injections?.[r]||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?d:f;r[t]=r[t]||[],r[t].push(e[t])}else h[t]=h[t]||[],h[t].push(e[t])}}return c+=F,c=v(c,r,d),c+=M(u[r],h),c+=l,c=v(c,r,f),c}function B(e,t){const{id:n,source:r,stage:i,language:s="glsl",modules:o,defines:a={},hookFunctions:l=[],inject:c={},prologue:u=!0,log:h}=t;I("string"===typeof r,"shader source must be a string");const d="glsl"===s?function(e,t){return{name:O(e,t),language:"glsl",version:N(e)}}(r).version:-1,f=e.shaderLanguageVersion,p=100===d?"#version 100":"#version 300 es",g=r.split("\n").slice(1).join("\n"),m={};o.forEach((e=>{Object.assign(m,e.defines)})),Object.assign(m,a);let _="";switch(s){case"wgsl":break;case"glsl":_=u?`${p}\n\n// ----- PROLOGUE -------------------------\n${function(e){const{id:t,source:n,stage:r}=e,i=t&&-1===n.indexOf("SHADER_NAME");return i?`\n#define SHADER_NAME ${t}_${r}`:""}({id:n,source:r,stage:i})}\n#define SHADER_TYPE_${i.toUpperCase()}\n\n${function(e){switch(e?.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n// Apple optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Headless Chrome's software shader 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// If the GPU doesn't have full 32 bits precision, will causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e)}\n${"fragment"===i?"precision highp float;\n":""}\n\n// ----- APPLICATION DEFINES -------------------------\n\n${function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";for(const n in e){const r=e[n];(r||Number.isFinite(r))&&(t+=`#define ${n.toUpperCase()} ${e[n]}\n`)}return t}(m)}\n\n`:`${p}\n`}const y=L(l),b={},w={},S={};for(const v in c){const e="string"===typeof c[v]?{injection:c[v],order:0}:c[v],t=/^(v|f)s:(#)?([\w-]+)$/.exec(v);if(t){const n=t[2],r=t[3];n?"decl"===r?w[v]=[e]:S[v]=[e]:b[v]=[e]}else S[v]=[e]}for(const v of o){h&&E(v,g,h);_+=z(v,i);const e=v.instance?.normalizedInjections[i]||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?w:S;r[t]=r[t]||[],r[t].push(e[t])}else b[t]=b[t]||[],b[t].push(e[t])}}return _+="// ----- MAIN SHADER SOURCE -------------------------",_+=F,_=v(_,i,w),_+=M(y[i],b),_+=g,_=v(_,i,S),"glsl"===s&&d!==f&&(_=function(e,t){if(300!==Number(e.match(/^#version[ \t]+(\d+)/m)?.[1]||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return P(e,C);case"fragment":return P(e,R);default:throw new Error(t)}}(_,i)),_.trim()}function U(e){return function(t){const n={};for(const r of e){const e=r.getUniforms?.(t,n);Object.assign(n,e)}return n}}function z(e,t){let n;switch(t){case"vertex":n=e.vs||"";break;case"fragment":n=e.fs||"";break;case"wgsl":n=e.source||"";break;default:I(!1)}if(!e.name)throw new Error("Shader module must have a name");const r=e.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${e.name} ---------------\n\n`;return"wgsl"!==t&&(i+=`#define MODULE_${r}\n`),i+=`${n}\n`,i}const G=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,V=/^\s*\#\s*endif\s*$/;class j{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return j.defaultShaderAssembler=j.defaultShaderAssembler||new j,j.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find((t=>t.name===("string"===typeof e?e:e.name)))||this._defaultModules.push(e)}removeDefaultModule(e){const t="string"===typeof e?e:e.name;this._defaultModules=this._defaultModules.filter((e=>e.name!==t))}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,{source:r,getUniforms:i}=function(e){const t=x(e.modules||[]);return{source:D(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:U(t)}}({...e,source:e.source,modules:t,hookFunctions:n}),s="wgsl"===e.platformInfo.shaderLanguage?function(e,t){const n=e.split("\n"),r=[];let i=!0,s=null;for(const o of n){const e=o.match(G),n=o.match(V);e?(s=e[1],i=Boolean(t?.defines?.[s])):n?i=!0:i&&r.push(o)}return r.join("\n")}(r):r;return{source:s,getUniforms:i,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,r=function(e){const{vs:t,fs:n}=e,r=x(e.modules||[]);return{vs:B(e.platformInfo,{...e,source:t,stage:"vertex",modules:r}),fs:B(e.platformInfo,{...e,source:n,stage:"fragment",modules:r}),getUniforms:U(r)}}({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:n});return{...r,modules:t}}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),n={};let r=0;for(let i=0,s=this._defaultModules.length;i<s;++i){const e=this._defaultModules[i],s=e.name;t[r++]=e,n[s]=!0}for(let i=0,s=e.length;i<s;++i){const s=e[i],o=s.name;n[o]||(t[r++]=s,n[o]=!0)}return t.length=r,b(t),t}}const W="#define SMOOTH_EDGE_RADIUS 0.5",$={name:"geometry",vs:`\n${W}\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n`,fs:`\n${W}\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n`},H=[$],X=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function q(){const e=j.getDefaultShaderAssembler();for(const t of H)e.addDefaultModule(t);for(const t of X)e.addShaderHook(t);return e}const K="uniform layerUniforms {\n  uniform float opacity;\n} layer;\n",Y={name:"layer",vs:K,fs:K,getUniforms:e=>({opacity:Math.pow(e.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},Z="Awaiting state",Q="Matched. State transferred from previous layer",J="Initialized",ee="Discarded. Awaiting garbage collection",te="No longer matched. Awaiting garbage collection",ne="Finalized! Awaiting garbage collection",re=Symbol.for("component"),ie=Symbol.for("propTypes"),se=Symbol.for("deprecatedProps"),oe=Symbol.for("asyncPropDefaults"),ae=Symbol.for("asyncPropOriginal"),le=Symbol.for("asyncPropResolved");function ce(e){if("undefined"!==typeof window&&"renderer"===window.process?.type)return!0;if("undefined"!==typeof process&&Boolean(process.versions?.electron))return!0;const t="undefined"!==typeof navigator&&navigator.userAgent,n=e||t;return Boolean(n&&n.indexOf("Electron")>=0)}function ue(){return!("object"===typeof process&&"[object process]"===String(process)&&!process?.browser)||ce()}const he="4.1.0";class de{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(t){return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var fe;!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(fe||(fe={}));function pe(e){return"string"!==typeof e?e:(e=e.toUpperCase(),fe[e]||fe.WHITE)}function ge(e,t){if(!e)throw new Error(t||"Assertion failed")}const me=globalThis,_e=(globalThis.document,globalThis.process||{}),ye=(globalThis.console,globalThis.navigator||{});function ve(){let e;if(ue()&&me.performance)e=me?.performance?.now?.();else if("hrtime"in _e){const t=_e?.hrtime?.();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}const be={debug:ue()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},we={enabled:!0,level:0};function Ee(){}const Se={},xe={once:!0};class Te{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};this.VERSION=he,this._startTs=ve(),this._deltaTs=ve(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new de(`__probe-${this.id}__`,we),this.timeStamp(`${this.id} started`),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n),i=e;for(const s of r){const n=i[s];"function"===typeof n&&(t.find((e=>s===e))||(i[s]=n.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ve()-this._startTs).toPrecision(10))}getDelta(){return Number((ve()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,be.warn,arguments,xe)}error(e){return this._getLogFunction(0,e,be.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,be.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,be.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,be.debug||be.info,arguments,xe)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||Ee,n&&[n],{tag:Re(t)}):Ee}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Ee)}group(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=Ce({logLevel:e,message:t,opts:n}),{collapsed:i}=n;return r.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ee)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Ae(e)}_getLogFunction(e,t,n,r,i){if(this._shouldLog(e)){i=Ce({logLevel:e,message:t,args:r,opts:i}),ge(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=ve();const s=i.tag||i.message;if(i.once&&s){if(Se[s])return Ee;Se[s]=ve()}return t=function(e,t,n){if("string"===typeof t){const r=n.time?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(t-e.length,0);return`${" ".repeat(n)}${e}`}(function(e){let t;return t=e<10?`${e.toFixed(2)}ms`:e<100?`${e.toFixed(1)}ms`:e<1e3?`${e.toFixed(0)}ms`:`${(e/1e3).toFixed(2)}s`,t}(n.total)):"";t=function(e,t,n){ue||"string"!==typeof e||(t&&(e=`\x1b[${pe(t)}m${e}\x1b[39m`),n&&(e=`\x1b[${pe(n)+10}m${e}\x1b[49m`));return e}(t=n.time?`${e}: ${r}  ${t}`:`${e}: ${t}`,n.color,n.background)}return t}(this.id,i.message,i),n.bind(console,t,...i.args)}return Ee}}function Ae(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return ge(Number.isFinite(t)&&t>=0),t}function Ce(e){const{logLevel:t,message:n}=e;e.logLevel=Ae(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"===typeof e.message&&(e.message=e.message());const i=typeof e.message;return ge("string"===i||"object"===i),Object.assign(e,{args:r},e.opts)}function Re(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}Te.VERSION=he;const Pe=new Te({id:"deck"});let ke={};function Me(e){ke=e}function Le(e,t,n,r){Pe.level>0&&ke[e]&&ke[e].call(null,t,n,r)}function Ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(e)?Oe(e,t,[]):t(e)?[e]:[]}function Oe(e,t,n){let r=-1;for(;++r<e.length;){const i=e[r];Array.isArray(i)?Oe(i,t,n):t(i)&&n.push(i)}return n}function Ne(e){let{target:t,source:n,start:r=0,count:i=1}=e;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)t[l++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o);return t}function Fe(){let e;if("undefined"!==typeof window&&window.performance)e=window.performance.now();else if("undefined"!==typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class De{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Fe(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Fe()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Be{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach((t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((e=>this._getOrCreate(e)))}_getOrCreate(e){const{name:t,type:n}=e;let r=this.stats[t];return r||(r=e instanceof De?e:new De(t,n),this.stats[t]=r),r}}const Ue=e=>"boolean"===typeof e,ze=e=>"function"===typeof e,Ge=e=>null!==e&&"object"===typeof e,Ve=e=>Ge(e)&&e.constructor==={}.constructor,je=e=>"undefined"!==typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,We=e=>"undefined"!==typeof Blob&&e instanceof Blob,$e=e=>(e=>"undefined"!==typeof ReadableStream&&e instanceof ReadableStream||Ge(e)&&ze(e.tee)&&ze(e.cancel)&&ze(e.getReader))(e)||(e=>Ge(e)&&ze(e.read)&&ze(e.pipe)&&Ue(e.readable))(e);function He(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function Xe(e){if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(e?.extensions)}function qe(e){let t;return He(e,"null loader"),He(Xe(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}let Ke="";const Ye={};class Ze extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}const Qe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Je=/^([-\w.]+\/[-\w.+]+)/;function et(e,t){return e.toLowerCase()===t.toLowerCase()}function tt(e){const t=Qe.exec(e);return t?t[1]:""}const nt=/\?.*/;function rt(e){return e.replace(nt,"")}function it(e){if(je(e)){return e.url}if(We(e)){return e.name||""}return"string"===typeof e?e:""}function st(e){if(je(e)){const t=e,n=t.headers.get("content-type")||"",r=rt(t.url);return function(e){const t=Je.exec(e);return t?t[1]:e}(n)||tt(r)}if(We(e)){return e.type||""}return"string"===typeof e?tt(e):""}async function ot(e){if(je(e))return e;const t={},n=function(e){if(je(e))return e.headers["content-length"]||-1;if(We(e))return e.size;return"string"===typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);n>=0&&(t["content-length"]=String(n));const r=it(e),i=st(e);i&&(t["content-type"]=i);const s=await async function(e){const t=5;if("string"===typeof e)return`data:,${e.slice(0,t)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const n=new FileReader;n.onload=t=>e(t?.target?.result),n.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){return`data:base64,${function(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}(e.slice(0,t))}`}return null}(e);s&&(t["x-first-bytes"]=s),"string"===typeof e&&(e=(new TextEncoder).encode(e));const o=new Response(e,{headers:t});return Object.defineProperty(o,"url",{value:r}),o}async function at(e){if(!e.ok){const t=await async function(e){const n=function(e){if(e.length<50)return e;const t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}(e.url);let r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${n}`;r=r.length>100?`${r.slice(0,100)}...`:r;const i={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");i.reason=!e.bodyUsed&&t?.includes("application/json")?await e.json():await e.text()}catch(t){}return new Ze(r,i)}(e);throw t}}async function lt(e,t){if("string"===typeof e){const n=function(e){for(const t in Ye)if(e.startsWith(t)){const n=Ye[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e=`${Ke}${e}`),e}(e);return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(n)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(n,t):await fetch(n,t)}return await ot(e)}const ct=new Te({id:"loaders.gl"});class ut{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof global&&global,"undefined"!==typeof document&&document;const ht=Boolean("object"!==typeof process||"[object process]"!==String(process)||process.browser),dt="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version),ft=(dt&&parseFloat(dt[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{console;constructor(){this.console=console}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.error.bind(this.console,...t)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ht,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),pt={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function gt(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function mt(){const e=gt();return e.globalOptions=e.globalOptions||{...ft},e.globalOptions}function _t(e,t,n,r){return n=n||[],function(e,t){yt(e,null,ft,pt,t);for(const n of t){const r=e&&e[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};yt(r,n.id,i,s,t)}}(e,n=Array.isArray(n)?n:[n]),bt(t,e,r)}function yt(e,t,n,r,i){const s=t||"Top level",o=t?`${t}.`:"";for(const a in e){const l=!t&&Ge(e[a]);if(!(a in n)&&!("baseUri"===a&&!t)&&!("workerUrl"===a&&t))if(a in r)ct.warn(`${s} loader option '${o}${a}' no longer supported, use '${r[a]}'`)();else if(!l){const e=vt(a,i);ct.warn(`${s} loader option '${o}${a}' not recognized. ${e}`)()}}}function vt(e,t){const n=e.toLowerCase();let r="";for(const i of t)for(const t in i.options){if(e===t)return`Did you mean '${i.id}.${t}'?`;const s=t.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||`Did you mean '${i.id}.${t}'?`)}return r}function bt(e,t,n){const r={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(r,n),null===r.log&&(r.log=new ut),wt(r,mt()),wt(r,t),r}function wt(e,t){for(const n in t)if(n in t){const r=t[n];Ve(r)&&Ve(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}function Et(e,t){const n=mt(),r=e||n;return"function"===typeof r.fetch?r.fetch:Ge(r.fetch)?e=>lt(e,r.fetch):t?.fetch?t?.fetch:lt}function St(e,t){return xt(e||{},t)}function xt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n>3)return t;const r={...e};for(const[i,s]of Object.entries(t))s&&"object"===typeof s&&!Array.isArray(s)?r[i]=xt(r[i]||{},t[i],n+1):r[i]=t[i];return r}"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof global&&global,"undefined"!==typeof document&&document;const Tt="object"!==typeof process||"[object process]"!==String(process)||process.browser,At="undefined"!==typeof window&&"undefined"!==typeof window.orientation,Ct="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Ct&&parseFloat(Ct[1]);class Rt{terminate(){}}function Pt(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const kt=new Map;function Mt(e){Pt(e.source&&!e.url||!e.source&&e.url);let t=kt.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return Lt((t=e,`try {\n  importScripts('${t}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`));var t}(e.url),kt.set(e.url,t)),e.source&&(t=Lt(e.source),kt.set(e.source,t))),Pt(t),t}function Lt(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function It(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(e){if(Ot(e))r.add(e);else if(Ot(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"===typeof e)for(const i in e)It(e[i],t,r)}else;return void 0===n?Array.from(r):[]}function Ot(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&e instanceof MessagePort||("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const Nt=()=>{};class Ft{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return"undefined"!==typeof Worker&&Tt||"undefined"!==typeof Rt&&!Tt}constructor(e){const{name:t,source:n,url:r}=e;Pt(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=Nt,this.onError=e=>console.log(e),this.worker=Tt?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Nt,this.onError=Nt,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||It(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=Mt({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new Rt(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new Rt(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class Dt{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,t){this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Pt(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Pt(this.isRunning),this.isRunning=!1,this._reject(e)}}class Bt{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return Ft.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,n)=>e.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e.error(t);const r=new Promise((r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new Dt(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}catch(n){console.error(`Worker exception: ${n}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Tt||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Ft({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return At?this.maxMobileConcurrency:this.maxConcurrency}}const Ut={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class zt{props;workerPools=(()=>new Map)();static _workerFarm;static isSupported(){return Ft.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return zt._workerFarm=zt._workerFarm||new zt({}),zt._workerFarm.setProps(e),zt._workerFarm}constructor(e){this.props={...Ut},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:r}=e;let i=this.workerPools.get(t);return i||(i=new Bt({name:t,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}const Gt=(globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version);async function Vt(e,t,n,r,i){const s=e.id,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t[e.id]||{},r=Tt?`${e.id}-worker.js`:`${e.id}-worker-node.js`;let i=n.workerUrl;if(i||"compression"!==e.id||(i=t.workerUrl),"test"===t._workerType&&(i=Tt?`modules/${e.module}/dist/${r}`:`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!i){let t=e.version;"latest"===t&&(t="latest");const n=t?`@${t}`:"";i=`https://unpkg.com/@loaders.gl/${e.module}${n}/dist/${r}`}return Pt(i),i}(e,n),a=zt.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const l=await a.startJob("process-on-worker",jt.bind(null,i));l.postMessage("process",{input:t,options:n,context:r});const c=await l.result;return await c.result}async function jt(e,t,n,r){switch(n){case"done":t.done(r);break;case"error":t.error(new Error(r.error));break;case"process":const{id:s,input:o,options:a}=r;try{const n=await e(o,a);t.postMessage("done",{id:s,result:n})}catch(i){const e=i instanceof Error?i.message:"unknown error";t.postMessage("error",{id:s,error:e})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function Wt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){const t=e.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),n=t.reduce(((e,t)=>e+t.byteLength),0),r=new Uint8Array(n);let i=0;for(const s of t)r.set(s,i),i+=s.byteLength;return r.buffer}(t)}const $t=262144;function Ht(e){if((t=e)&&"object"===typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"===typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"===typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function Xt(e,t){return ht?async function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();t?._streamReadAhead&&(r=n.read());const{done:i,value:s}=await e;if(i)return;yield Ht(s)}}catch(i){n.releaseLock()}}(e,t):async function*(e){for await(const t of e)yield Ht(t)}(e)}function qt(e,t){if("string"===typeof e)return function*(e,t){const n=t?.chunkSize||262144;let r=0;const i=new TextEncoder;for(;r<e.length;){const t=Math.min(e.length-r,n),s=e.slice(r,r+t);r+=t,yield i.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:n=$t}=t;let r=0;for(;r<e.byteLength;){const t=Math.min(e.byteLength-r,n),i=new ArrayBuffer(t),s=new Uint8Array(e,r,t);new Uint8Array(i).set(s),r+=t,yield i}}()}(e,t);if(We(e))return async function*(e,t){const n=t?.chunkSize||1048576;let r=0;for(;r<e.size;){const t=r+n,i=await e.slice(r,t).arrayBuffer();r=t,yield i}}(e,t);if($e(e))return Xt(e,t);if(je(e)){return Xt(e.body,t)}throw new Error("makeIterator")}const Kt="Cannot convert supplied data type";async function Yt(e,t,n){const r=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"===typeof e||r)return function(e,t){if(t.text&&"string"===typeof e)return e;var n;if((n=e)&&"object"===typeof n&&n.isBuffer&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(Kt)}(e,t);if(We(e)&&(e=await ot(e)),je(e)){const n=e;return await at(n),t.binary?await n.arrayBuffer():await n.text()}if($e(e)&&(e=qt(e,n)),i=e,Boolean(i)&&"function"===typeof i[Symbol.iterator]||(e=>e&&"function"===typeof e[Symbol.asyncIterator])(e))return async function(e){const t=[];for await(const n of e)t.push(n);return Wt(...t)}(e);var i;throw new Error(Kt)}function Zt(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function Qt(e,t,n){if(n)return n;const r={fetch:Et(t,e),...e};if(r.url){const e=rt(r.url);r.baseUrl=e,r.queryString=function(e){const t=e.match(nt);return t&&t[0]}(r.url),r.filename=Zt(e),r.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(r.loaders)||(r.loaders=null),r}const Jt="4.3.2",en=Jt[0]>="0"&&Jt[0]<="9"?`v${Jt}`:"";const tn=function(){const e=new Te({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=e,globalThis.loaders.version=en,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=e,e}(),nn=()=>{const e=gt();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};const rn=/\.([^.]+)$/;function sn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!on(e))return null;if(t&&!Array.isArray(t))return qe(t);let i=[];t&&(i=i.concat(t)),n?.ignoreRegisteredLoaders||i.push(...nn()),function(e){for(const t of e)qe(t)}(i);const s=function(e,t,n,r){const i=it(e),s=st(e),o=rt(i)||r?.url;let a=null,l="";n?.mimeType&&(a=ln(t,n?.mimeType),l=`match forced by supplied MIME type ${n?.mimeType}`);a=a||function(e,t){const n=t&&rn.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,o),l=l||(a?`matched url ${o}`:""),a=a||ln(t,s),l=l||(a?`matched MIME type ${s}`:""),a=a||function(e,t){if(!t)return null;for(const n of e)if("string"===typeof t){if(cn(t,n))return n}else if(ArrayBuffer.isView(t)){if(un(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer){if(un(t,0,n))return n}return null}(t,e),l=l||(a?`matched initial data ${hn(e)}`:""),n?.fallbackMimeType&&(a=a||ln(t,n?.fallbackMimeType),l=l||(a?`matched fallback MIME type ${s}`:""));l&&tn.log(1,`selectLoader selected ${a?.name}: ${l}.`);return a}(e,i,n,r);if(!s&&!n?.nothrow)throw new Error(an(e));return s}function on(e){return!(e instanceof Response&&204===e.status)}function an(e){const t=it(e),n=st(e);let r="No valid loader found (";r+=t?`${Zt(t)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const i=e?hn(e):"";return r+=i?` first bytes: "${i}"`:"first bytes: not available",r+=")",r}function ln(e,t){for(const n of e){if(n.mimeTypes?.some((e=>et(t,e))))return n;if(et(t,`application/x.${n.id}`))return n}return null}function cn(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function un(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((n=>function(e,t,n,r){if(r instanceof ArrayBuffer)return function(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(r,e,r.byteLength);switch(typeof r){case"function":return r(e);case"string":return r===dn(e,t,r.length);default:return!1}}(e,t,0,n)))}function hn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return dn(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return dn(e,0,t)}return""}function dn(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}async function fn(e,t,n,r){!t||Array.isArray(t)||Xe(t)||(r=void 0,n=t,t=void 0),n=n||{};const i=it(e=await e),s=function(e,t){if(e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:void 0}(t,r),o=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!on(e))return null;let i=sn(e,t,{...n,nothrow:!0},r);if(i)return i;if(We(e)&&(i=sn(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!i&&!n?.nothrow)throw new Error(an(e));return i}(e,s,n);return o?(r=Qt({url:i,_parse:fn,loaders:s},n=_t(n,o,s,i),r||null),await async function(e,t,n,r){if(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gt;Pt(e,"no worker provided");const n=e.version}(e),n=St(e.options,n),je(t)){const e=t,{ok:n,redirected:i,status:s,statusText:o,type:a,url:l}=e,c=Object.fromEntries(e.headers.entries());r.response={headers:c,ok:n,redirected:i,status:s,statusText:o,type:a,url:l}}t=await Yt(t,e,n);const i=e;if(i.parseTextSync&&"string"===typeof t)return i.parseTextSync(t,n,r);if(function(e,t){return!!zt.isSupported()&&!(!Tt&&!t?._nodeWorkers)&&e.worker&&t?.worker}(e,n))return await Vt(e,t,n,r,fn);if(i.parseText&&"string"===typeof t)return await i.parseText(t,n,r);if(i.parse)return await i.parse(t,n,r);throw Pt(!i.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}(o,e,n,r)):null}async function pn(e,t,n,r){let i,s;Array.isArray(t)||Xe(t)?(i=t,s=n):(i=[],s=t);const o=Et(s);let a=e;return"string"===typeof e&&(a=await o(e)),We(e)&&(a=await o(e)),Array.isArray(i),await fn(a,i,s)}class gn{constructor(e,t,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let r=e;"string"===typeof e&&(r=pn(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=e)})).catch((e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=e||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const i of this._subscribers)i.onChange(this.getData())}}class mn{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add(e){let{resourceId:t,data:n,forceUpdate:r=!1,persistent:i=!0}=e,s=this._resources[t];s?s.setData(n,r):(s=new gn(t,n,this._context),this._resources[t]=s),s.persistent=i}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe(e){let{consumerId:t}=e;const n=this._consumers[t];if(n){for(const e in n){const t=n[e],r=this._resources[t.resourceId];r&&r.unsubscribe(t)}delete this._consumers[t],this.prune()}}subscribe(e){let{resourceId:t,onChange:n,consumerId:r,requestId:i="default"}=e;const{_resources:s,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),s[t]||this.add({resourceId:t,data:null,persistent:!1}));const a=s[t];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,r){const i=this._consumers,s=i[e]=i[e]||{};let o=s[t];const a=o&&o.resourceId&&this._resources[o.resourceId];a&&(a.unsubscribe(o),this.prune()),n&&(o?(o.onChange=r,o.resourceId=n.id):o={onChange:r,resourceId:n.id},s[t]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}const _n=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,n){let{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}=n;const c=i||e&&e.constructor||Float32Array,u=t*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h=1/0;l&&(h=l*r+s);const d=this._allocate(c,u,a,h);return e&&o?d.set(e):a||d.fill(0,0,4),this._release(e),d}release(e){this._release(e)}_allocate(e,t,n,r){let i=Math.max(Math.ceil(t*this.opts.overAlloc),1);i>r&&(i=r);const s=this._pool,o=e.BYTES_PER_ELEMENT*i,a=s.findIndex((e=>e.byteLength>=o));if(a>=0){const t=new e(s.splice(a,1)[0],0,i);return n&&t.fill(0),t}return new e(i)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:r}=n,i=t.findIndex((e=>e.byteLength>=r));i<0?t.push(n):(i>0||t.length<this.opts.poolSize)&&t.splice(i,0,n),t.length>this.opts.poolSize&&t.shift()}};Math.PI,Math.PI;globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};const yn=globalThis.mathgl.config;function vn(e){let{precision:t=yn.precision}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=function(e){return Math.round(e/yn.EPSILON)*yn.EPSILON}(e),`${parseFloat(e.toPrecision(t))}`}function bn(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function wn(e,t,n){return xn(e,(e=>Math.max(t,Math.min(n,e))))}function En(e,t,n){return bn(e)?e.map(((e,r)=>En(e,t[r],n))):n*t+(1-n)*e}function Sn(e,t,n){const r=yn.EPSILON;n&&(yn.EPSILON=n);try{if(e===t)return!0;if(bn(e)&&bn(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!Sn(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"===typeof e&&"number"===typeof t&&Math.abs(e-t)<=yn.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{yn.EPSILON=r}}function xn(e,t,n){if(bn(e)){const r=e;n=n||function(e){return e.clone?e.clone():new Array(e.length)}(r);for(let i=0;i<n.length&&i<r.length;++i){const r="number"===typeof e?e:e[i];n[i]=t(r,i,n)}return n}return t(e)}class Tn extends Array{clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:bn(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(yn)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+vn(this[n],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Sn(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(void 0===n)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const i=e[r],s="number"===typeof t?t:t[r];this[r]=i+n*(s-i)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]+=r[e];return this.check()}subtract(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]-=r[e];return this.check()}scale(e){if("number"===typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(yn.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function An(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function Cn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(yn.debug&&!function(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}function Rn(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}class Pn extends Tn{get x(){return this[0]}set x(e){this[0]=An(e)}get y(){return this[1]}set y(e){this[1]=An(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-e[n];t+=r*r}return An(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return An(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=r[e];return this.check()}divide(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=r[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Rn(e>=0&&e<this.ELEMENTS,"index is out of range"),An(this[e])}setComponent(e,t){return Rn(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const kn=1e-6;let Mn="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function Ln(){const e=new Mn(3);return Mn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function In(e,t,n){const r=new Mn(3);return r[0]=e,r[1]=t,r[2]=n,r}function On(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Nn(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[0],a=n[1],l=n[2];return e[0]=i*l-s*a,e[1]=s*o-r*l,e[2]=r*a-i*o,e}function Fn(e,t,n){const r=t[0],i=t[1],s=t[2];let o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,e}function Dn(e,t,n){const r=t[0],i=t[1],s=t[2];return e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8],e}function Bn(e,t,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=t[0],l=t[1],c=t[2];let u=i*c-s*l,h=s*a-r*c,d=r*l-i*a,f=i*d-s*h,p=s*u-r*d,g=r*h-i*u;const m=2*o;return u*=m,h*=m,d*=m,f*=2,p*=2,g*=2,e[0]=a+u+f,e[1]=l+h+p,e[2]=c+d+g,e}const Un=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},zn=function(e){const t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},Gn=function(e){const t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r};!function(){const e=Ln()}();function Vn(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[3]*r+n[7]*i+n[11]*s||1;return e[0]=(n[0]*r+n[4]*i+n[8]*s)/o,e[1]=(n[1]*r+n[5]*i+n[9]*s)/o,e[2]=(n[2]*r+n[6]*i+n[10]*s)/o,e}function jn(e,t,n){const r=t[0],i=t[1],s=t[2];return e[0]=n[0]*r+n[3]*i+n[6]*s,e[1]=n[1]*r+n[4]*i+n[7]*s,e[2]=n[2]*r+n[5]*i+n[8]*s,e[3]=t[3],e}const Wn=[0,0,0];let $n;class Hn extends Pn{static get ZERO(){return $n||($n=new Hn(0,0,0),Object.freeze($n)),$n}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(-0,-0,-0),1===arguments.length&&bn(e)?this.copy(e):(yn.debug&&(An(e),An(t),An(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return yn.debug&&(An(e.x),An(e.y),An(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=An(e)}angle(e){return function(e,t){const n=e[0],r=e[1],i=e[2],s=t[0],o=t[1],a=t[2],l=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),c=l&&On(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}(this,e)}cross(e){return Nn(this,this,e),this.check()}rotateX(e){let{radians:t,origin:n=Wn}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}rotateY(e){let{radians:t,origin:n=Wn}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}rotateZ(e){let{radians:t,origin:n=Wn}=e;return function(e,t,n,r){const i=[],s=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2]}(this,this,n,t),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Fn(this,this,e),this.check()}transformAsVector(e){return Vn(this,this,e),this.check()}transformByMatrix3(e){return Dn(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return Bn(this,this,e),this.check()}}const Xn=new Hn;function qn(e,t,n,r){Xn.set(e,t,n);const i=Xn.len();return{distance:r/i,normal:new Hn(-e/i,-t/i,-n/i)}}let Kn;function Yn(e,t){const{size:n=1,startIndex:r=0}=t,i=void 0!==t.endIndex?t.endIndex:e.length,s=(i-r)/n;Kn=_n.allocate(Kn,s,{type:Float32Array,size:2*n});let o=r,a=0;for(;o<i;){for(let t=0;t<n;t++){const r=e[o++];Kn[a+t]=r,Kn[a+t+n]=(l=r)-Math.fround(l)}a+=2*n}var l;return Kn.subarray(0,s*n*2)}function Zn(e){let t=null,n=!1;for(const r of e)r&&(t?(n||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],n=!0),t[0][0]=Math.min(t[0][0],r[0][0]),t[0][1]=Math.min(t[0][1],r[0][1]),t[1][0]=Math.max(t[1][0],r[1][0]),t[1][1]=Math.max(t[1][1],r[1][1])):t=r);return t}class Qn extends Tn{toString(){let e="[";if(yn.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=An(n),this}getColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0);const n=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[n+r];return t}setColumn(e,t){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=t[r];return this}}function Jn(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],_=t[15],y=n*a-r*o,v=n*l-i*o,b=n*c-s*o,w=r*l-i*a,E=r*c-s*a,S=i*c-s*l,x=u*g-h*p,T=u*m-d*p,A=u*_-f*p,C=h*m-d*g,R=h*_-f*g,P=d*_-f*m;let k=y*P-v*R+b*C+w*A-E*T+S*x;return k?(k=1/k,e[0]=(a*P-l*R+c*C)*k,e[1]=(i*R-r*P-s*C)*k,e[2]=(g*S-m*E+_*w)*k,e[3]=(d*E-h*S-f*w)*k,e[4]=(l*A-o*P-c*T)*k,e[5]=(n*P-i*A+s*T)*k,e[6]=(m*b-p*S-_*v)*k,e[7]=(u*S-d*b+f*v)*k,e[8]=(o*R-a*A+c*x)*k,e[9]=(r*A-n*R-s*x)*k,e[10]=(p*E-g*b+_*y)*k,e[11]=(h*b-u*E-f*y)*k,e[12]=(a*T-o*C-l*x)*k,e[13]=(n*C-r*T+i*x)*k,e[14]=(g*v-p*w-m*y)*k,e[15]=(u*w-h*v+d*y)*k,e):null}function er(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],g=t[12],m=t[13],_=t[14],y=t[15];let v=n[0],b=n[1],w=n[2],E=n[3];return e[0]=v*r+b*a+w*h+E*g,e[1]=v*i+b*l+w*d+E*m,e[2]=v*s+b*c+w*f+E*_,e[3]=v*o+b*u+w*p+E*y,v=n[4],b=n[5],w=n[6],E=n[7],e[4]=v*r+b*a+w*h+E*g,e[5]=v*i+b*l+w*d+E*m,e[6]=v*s+b*c+w*f+E*_,e[7]=v*o+b*u+w*p+E*y,v=n[8],b=n[9],w=n[10],E=n[11],e[8]=v*r+b*a+w*h+E*g,e[9]=v*i+b*l+w*d+E*m,e[10]=v*s+b*c+w*f+E*_,e[11]=v*o+b*u+w*p+E*y,v=n[12],b=n[13],w=n[14],E=n[15],e[12]=v*r+b*a+w*h+E*g,e[13]=v*i+b*l+w*d+E*m,e[14]=v*s+b*c+w*f+E*_,e[15]=v*o+b*u+w*p+E*y,e}function tr(e,t,n){const r=n[0],i=n[1],s=n[2];let o,a,l,c,u,h,d,f,p,g,m,_;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(o=t[0],a=t[1],l=t[2],c=t[3],u=t[4],h=t[5],d=t[6],f=t[7],p=t[8],g=t[9],m=t[10],_=t[11],e[0]=o,e[1]=a,e[2]=l,e[3]=c,e[4]=u,e[5]=h,e[6]=d,e[7]=f,e[8]=p,e[9]=g,e[10]=m,e[11]=_,e[12]=o*r+u*i+p*s+t[12],e[13]=a*r+h*i+g*s+t[13],e[14]=l*r+d*i+m*s+t[14],e[15]=c*r+f*i+_*s+t[15]),e}function nr(e,t,n){const r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function rr(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+c*r,e[5]=o*i+u*r,e[6]=a*i+h*r,e[7]=l*i+d*r,e[8]=c*i-s*r,e[9]=u*i-o*r,e[10]=h*i-a*r,e[11]=d*i-l*r,e}function ir(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+c*r,e[1]=o*i+u*r,e[2]=a*i+h*r,e[3]=l*i+d*r,e[4]=c*i-s*r,e[5]=u*i-o*r,e[6]=h*i-a*r,e[7]=d*i-l*r,e}function sr(e,t){const n=t[0],r=t[1],i=t[2],s=t[4],o=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(s*s+o*o+a*a),e[2]=Math.sqrt(l*l+c*c+u*u),e}const or=function(e,t,n,r,i){const s=1/Math.tan(t/2);if(e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0){const t=1/(r-i);e[10]=(i+r)*t,e[14]=2*i*r*t}else e[10]=-1,e[14]=-2*r;return e};const ar=function(e,t,n,r,i,s,o){const a=1/(t-n),l=1/(r-i),c=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*l,e[14]=(o+s)*c,e[15]=1,e};function lr(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function cr(e,t,n,r){const i=t[0],s=t[1];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e}!function(){const e=function(){const e=new Mn(2);return Mn!=Float32Array&&(e[0]=0,e[1]=0),e}()}();function ur(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function hr(e){const t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}function dr(e){const t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function fr(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,e}!function(){const e=function(){const e=new Mn(4);return Mn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();var pr;!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(pr||(pr={}));const gr=45*Math.PI/180,mr=1,_r=.1,yr=500,vr=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class br extends Qn{static get IDENTITY(){return function(){Er||(Er=new br,Object.freeze(Er));return Er}()}static get ZERO(){return function(){wr||(wr=new br([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(wr));return wr}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return pr}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(e,t,n,r,i,s,o,a,l,c,u,h,d,f,p,g){return this[0]=e,this[1]=i,this[2]=l,this[3]=d,this[4]=t,this[5]=s,this[6]=c,this[7]=f,this[8]=n,this[9]=o,this[10]=u,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(vr)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,d=i*o,f=i*a,p=i*l,g=s*o,m=s*a,_=s*l;e[0]=1-h-p,e[1]=u+_,e[2]=d-m,e[3]=0,e[4]=u-_,e[5]=1-c-p,e[6]=f+g,e[7]=0,e[8]=d+m,e[9]=f-g,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:r,top:i,near:s=_r,far:o=yr}=e;return o===1/0?function(e,t,n,r,i,s){const o=2*s/(n-t),a=2*s/(i-r),l=(n+t)/(n-t),c=(i+r)/(i-r),u=-1,h=-1,d=-2*s;e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=l,e[9]=c,e[10]=u,e[11]=h,e[12]=0,e[13]=0,e[14]=d,e[15]=0}(this,t,n,r,i,s):function(e,t,n,r,i,s,o){const a=1/(n-t),l=1/(i-r),c=1/(s-o);e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(i+r)*l,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*c,e[15]=0}(this,t,n,r,i,s,o),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:r=[0,1,0]}=e;return function(e,t,n,r){let i,s,o,a,l,c,u,h,d,f;const p=t[0],g=t[1],m=t[2],_=r[0],y=r[1],v=r[2],b=n[0],w=n[1],E=n[2];Math.abs(p-b)<kn&&Math.abs(g-w)<kn&&Math.abs(m-E)<kn?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(h=p-b,d=g-w,f=m-E,i=1/Math.sqrt(h*h+d*d+f*f),h*=i,d*=i,f*=i,s=y*f-v*d,o=v*h-_*f,a=_*d-y*h,i=Math.sqrt(s*s+o*o+a*a),i?(i=1/i,s*=i,o*=i,a*=i):(s=0,o=0,a=0),l=d*a-f*o,c=f*s-h*a,u=h*o-d*s,i=Math.sqrt(l*l+c*c+u*u),i?(i=1/i,l*=i,c*=i,u*=i):(l=0,c=0,u=0),e[0]=s,e[1]=l,e[2]=h,e[3]=0,e[4]=o,e[5]=c,e[6]=d,e[7]=0,e[8]=a,e[9]=u,e[10]=f,e[11]=0,e[12]=-(s*p+o*g+a*m),e[13]=-(l*p+c*g+u*m),e[14]=-(h*p+d*g+f*m),e[15]=1)}(this,t,n,r),this.check()}ortho(e){const{left:t,right:n,bottom:r,top:i,near:s=_r,far:o=yr}=e;return ar(this,t,n,r,i,s,o),this.check()}orthographic(e){const{fovy:t=gr,aspect:n=mr,focalDistance:r=1,near:i=_r,far:s=yr}=e;Sr(t);const o=t/2,a=r*Math.tan(o),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:i,far:s})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}=e;return Sr(t),or(this,t,n,r,i),this.check()}determinant(){return function(e){const t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],g=e[14],m=t*o-n*s,_=t*a-r*s,y=n*a-r*o,v=c*p-u*f,b=c*g-h*f,w=u*g-h*p;return l*(t*w-n*b+r*v)-i*(s*w-o*b+a*v)+e[15]*(c*y-u*_+h*m)-d*(f*y-p*_+g*m)}(this)}getScale(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],i=1/n[1],s=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*i,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*i,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],i=1/n[1],s=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*s,e[3]=this[4]*r,e[4]=this[5]*i,e[5]=this[6]*s,e[6]=this[8]*r,e[7]=this[9]*i,e[8]=this[10]*s,e}transpose(){return function(e,t){if(e===t){const n=t[1],r=t[2],i=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return Jn(this,this),this.check()}multiplyLeft(e){return er(this,e,this),this.check()}multiplyRight(e){return er(this,this,e),this.check()}rotateX(e){return rr(this,this,e),this.check()}rotateY(e){return function(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-c*r,e[1]=o*i-u*r,e[2]=a*i-h*r,e[3]=l*i-d*r,e[8]=s*r+c*i,e[9]=o*r+u*i,e[10]=a*r+h*i,e[11]=l*r+d*i}(this,this,e),this.check()}rotateZ(e){return ir(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function(e,t,n,r){let i,s,o,a,l,c,u,h,d,f,p,g,m,_,y,v,b,w,E,S,x,T,A,C,R=r[0],P=r[1],k=r[2],M=Math.sqrt(R*R+P*P+k*k);M<kn||(M=1/M,R*=M,P*=M,k*=M,s=Math.sin(n),i=Math.cos(n),o=1-i,a=t[0],l=t[1],c=t[2],u=t[3],h=t[4],d=t[5],f=t[6],p=t[7],g=t[8],m=t[9],_=t[10],y=t[11],v=R*R*o+i,b=P*R*o+k*s,w=k*R*o-P*s,E=R*P*o-k*s,S=P*P*o+i,x=k*P*o+R*s,T=R*k*o+P*s,A=P*k*o-R*s,C=k*k*o+i,e[0]=a*v+h*b+g*w,e[1]=l*v+d*b+m*w,e[2]=c*v+f*b+_*w,e[3]=u*v+p*b+y*w,e[4]=a*E+h*S+g*x,e[5]=l*E+d*S+m*x,e[6]=c*E+f*S+_*x,e[7]=u*E+p*S+y*x,e[8]=a*T+h*A+g*C,e[9]=l*T+d*A+m*C,e[10]=c*T+f*A+_*C,e[11]=u*T+p*A+y*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return nr(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return tr(this,this,e),this.check()}transform(e,t){return 4===e.length?(Cn(t=fr(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let r;switch(n){case 2:r=function(e,t,n){const r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}(t||[-0,-0],e,this);break;case 3:r=Fn(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Cn(r,e.length),r}transformAsVector(e,t){let n;switch(e.length){case 2:n=function(e,t,n){const r=t[0],i=t[1],s=n[3]*r+n[7]*i||1;return e[0]=(n[0]*r+n[4]*i)/s,e[1]=(n[1]*r+n[5]*i)/s,e}(t||[-0,-0],e,this);break;case 3:n=Vn(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Cn(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let wr,Er;function Sr(e){if(e>2*Math.PI)throw Error("expected radians")}function xr(e,t){const n=fr([],t,e);return ur(n,n,1/n[3]),n}function Tr(e,t){const n=e%t;return n<0?t+n:n}function Ar(e,t,n){return e<t?t:e>n?n:e}const Cr=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function Rr(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Pr=Math.PI,kr=Pr/4,Mr=Pr/180,Lr=180/Pr,Ir=512,Or=4003e4,Nr=85.051129,Fr=1.5;function Dr(e){const[t,n]=e;Rr(Number.isFinite(t)),Rr(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*Mr;return[Ir*(t*Mr+Pr)/(2*Pr),Ir*(Pr+Math.log(Math.tan(kr+.5*r)))/(2*Pr)]}function Br(e){const[t,n]=e,r=t/Ir*(2*Pr)-Pr,i=2*(Math.atan(Math.exp(n/Ir*(2*Pr)-Pr))-kr);return[r*Lr,i*Lr]}function Ur(e){const{latitude:t}=e;Rr(Number.isFinite(t));const n=Math.cos(t*Mr);return function(e){return Cr(e)}(Or*n)-9}function zr(e){return 12790407194604047e-21/Math.cos(e*Mr)}function Gr(e){const{latitude:t,longitude:n,highPrecision:r=!1}=e;Rr(Number.isFinite(t)&&Number.isFinite(n));const i=Ir,s=Math.cos(t*Mr),o=i/360,a=o/s,l=12790407194604047e-21/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[.703125,1/a,1/l]};if(r){const e=Mr*Math.tan(t*Mr)/s,n=o*e/2,r=12790407194604047e-21*e,i=r/a*l;c.unitsPerDegree2=[0,n,r],c.unitsPerMeter2=[i,0,i]}return c}function Vr(e,t){const[n,r,i]=e,[s,o,a]=t,{unitsPerMeter:l,unitsPerMeter2:c}=Gr({longitude:n,latitude:r,highPrecision:!0}),u=Dr(e);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=Br(u),d=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],d]:h}function jr(e){const{width:t,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=e;let{fovy:u=Wr(Fr)}=e;void 0!==r&&(u=Wr(r));const h=u*Mr,d=i*Mr,f=$r(u);let p=f;o&&(p+=o[2]*a/Math.cos(d)/n);const g=h*(.5+(s?s[1]:0)/n),m=Math.sin(g)*p/Math.sin(Ar(Math.PI/2-d-g,.01,Math.PI-.01)),_=Math.sin(d)*m+p,y=10*p;return{fov:h,aspect:t/n,focalDistance:f,near:l,far:Math.min(_*c,y)}}function Wr(e){return 2*Math.atan(.5/e)*Lr}function $r(e){return.5/Math.tan(.5*e*Mr)}function Hr(e,t){const[n,r,i=0]=e;return Rr(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),xr(t,[n,r,i,1])}function Xr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[r,i,s]=e;if(Rr(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s)){return xr(t,[r,i,s,1])}const o=xr(t,[r,i,0,1]),a=xr(t,[r,i,1,1]),l=o[2],c=a[2];return cr([],o,a,l===c?0:((n||0)-l)/(c-l))}function qr(e){const{width:t,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=e,[[a,l],[c,u]]=r,h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"===typeof e)return{top:e,bottom:e,left:e,right:e};return Rr(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),d=Dr([a,Ar(u,-85.051129,Nr)]),f=Dr([c,Ar(l,-85.051129,Nr)]),p=[Math.max(Math.abs(f[0]-d[0]),i),Math.max(Math.abs(f[1]-d[1]),i)],g=[t-h.left-h.right-2*Math.abs(o[0]),n-h.top-h.bottom-2*Math.abs(o[1])];Rr(g[0]>0&&g[1]>0);const m=g[0]/p[0],_=g[1]/p[1],y=(h.right-h.left)/2/m,v=(h.top-h.bottom)/2/_,b=Br([(f[0]+d[0])/2+y,(f[1]+d[1])/2+v]),w=Math.min(s,Cr(Math.abs(Math.min(m,_))));return Rr(Number.isFinite(w)),{longitude:b[0],latitude:b[1],zoom:w}}const Kr=Math.PI/180;function Yr(e,t,n){const{pixelUnprojectionMatrix:r}=e,i=xr(r,[t,0,1,1]),s=xr(r,[t,e.height,1,1]),o=Br(cr([],i,s,(n*e.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2])));return o.push(n),o}var Zr,Qr,Jr;!function(e){e[e.Start=1]="Start",e[e.Move=2]="Move",e[e.End=4]="End",e[e.Cancel=8]="Cancel"}(Zr||(Zr={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Up=4]="Up",e[e.Down=8]="Down",e[e.Horizontal=3]="Horizontal",e[e.Vertical=12]="Vertical",e[e.All=15]="All"}(Qr||(Qr={})),function(e){e[e.Possible=1]="Possible",e[e.Began=2]="Began",e[e.Changed=4]="Changed",e[e.Ended=8]="Ended",e[e.Recognized=8]="Recognized",e[e.Cancelled=16]="Cancelled",e[e.Failed=32]="Failed"}(Jr||(Jr={}));const ei="auto",ti="manipulation",ni="none",ri="pan-x",ii="pan-y";class si{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){"compute"===e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return function(e){if(e.includes(ni))return ni;const t=e.includes(ri),n=e.includes(ii);return t&&n?ni:t||n?t?ri:ii:e.includes(ti)?ti:ei}(e.join(" "))}}function oi(e){return e.trim().split(/\s+/g)}function ai(e,t,n){if(e)for(const r of oi(t))e.addEventListener(r,n,!1)}function li(e,t,n){if(e)for(const r of oi(t))e.removeEventListener(r,n,!1)}function ci(e){return(e.ownerDocument||e).defaultView}function ui(e){const t=e.length;if(1===t)return{x:Math.round(e[0].clientX),y:Math.round(e[0].clientY)};let n=0,r=0,i=0;for(;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:Math.round(n/t),y:Math.round(r/t)}}function hi(e){const t=[];let n=0;for(;n<e.pointers.length;)t[n]={clientX:Math.round(e.pointers[n].clientX),clientY:Math.round(e.pointers[n].clientY)},n++;return{timeStamp:Date.now(),pointers:t,center:ui(t),deltaX:e.deltaX,deltaY:e.deltaY}}function di(e,t){const n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function fi(e,t){const n=t.clientX-e.clientX,r=t.clientY-e.clientY;return Math.sqrt(n*n+r*r)}function pi(e,t){const n=t.clientX-e.clientX,r=t.clientY-e.clientY;return 180*Math.atan2(r,n)/Math.PI}function gi(e,t){return e===t?Qr.None:Math.abs(e)>=Math.abs(t)?e<0?Qr.Left:Qr.Right:t<0?Qr.Up:Qr.Down}function mi(e,t,n){return{x:t/e||0,y:n/e||0}}function _i(e,t){const{session:n}=e,{pointers:r}=t,{length:i}=r;n.firstInput||(n.firstInput=hi(t)),i>1&&!n.firstMultiple?n.firstMultiple=hi(t):1===i&&(n.firstMultiple=!1);const{firstInput:s,firstMultiple:o}=n,a=o?o.center:s.center,l=t.center=ui(r);t.timeStamp=Date.now(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=function(e,t){const n=t.x-e.x,r=t.y-e.y;return 180*Math.atan2(r,n)/Math.PI}(a,l),t.distance=di(a,l);const{deltaX:c,deltaY:u}=function(e,t){const n=t.center;let r=e.offsetDelta,i=e.prevDelta;const s=e.prevInput;return t.eventType!==Zr.Start&&s?.eventType!==Zr.End||(i=e.prevDelta={x:s?.deltaX||0,y:s?.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),{deltaX:i.x+(n.x-r.x),deltaY:i.y+(n.y-r.y)}}(n,t);t.deltaX=c,t.deltaY=u,t.offsetDirection=gi(t.deltaX,t.deltaY);const h=mi(t.deltaTime,t.deltaX,t.deltaY);var d,f;t.overallVelocityX=h.x,t.overallVelocityY=h.y,t.overallVelocity=Math.abs(h.x)>Math.abs(h.y)?h.x:h.y,t.scale=o?(d=o.pointers,fi((f=r)[0],f[1])/fi(d[0],d[1])):1,t.rotation=o?function(e,t){return pi(t[1],t[0])-pi(e[1],e[0])}(o.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length;let p=e.element;return function(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parentNode}return!1}(t.srcEvent.target,p)&&(p=t.srcEvent.target),t.target=p,function(e,t){const n=e.lastInterval||t,r=t.timeStamp-n.timeStamp;let i,s,o,a;if(t.eventType!==Zr.Cancel&&(r>25||void 0===n.velocity)){const l=t.deltaX-n.deltaX,c=t.deltaY-n.deltaY,u=mi(r,l,c);s=u.x,o=u.y,i=Math.abs(u.x)>Math.abs(u.y)?u.x:u.y,a=gi(l,c),e.lastInterval=t}else i=n.velocity,s=n.velocityX,o=n.velocityY,a=n.direction;t.velocity=i,t.velocityX=s,t.velocityY=o,t.direction=a}(n,t),t}class yi{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=e=>{this.manager.options.enable&&this.handler(e)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){!function(e,t,n){const r=n.pointers.length,i=n.changedPointers.length,s=t&Zr.Start&&r-i===0,o=t&(Zr.End|Zr.Cancel)&&r-i===0;n.isFirst=Boolean(s),n.isFinal=Boolean(o),s&&(e.session={}),n.eventType=t;const a=_i(e,n);e.emit("hammer.input",a),e.recognize(a),e.session.prevInput=a}(this.manager,e,t)}init(){ai(this.element,this.evEl,this.domHandler),ai(this.target,this.evTarget,this.domHandler),ai(ci(this.element),this.evWin,this.domHandler)}destroy(){li(this.element,this.evEl,this.domHandler),li(this.target,this.evTarget,this.domHandler),li(ci(this.element),this.evWin,this.domHandler)}}const vi={pointerdown:Zr.Start,pointermove:Zr.Move,pointerup:Zr.End,pointercancel:Zr.Cancel,pointerout:Zr.Cancel};class bi extends yi{constructor(e){super(e),this.evEl="pointerdown",this.evWin="pointermove pointerup pointercancel",this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let n=!1;const r=vi[e.type],i=e.pointerType,s="touch"===i;let o=t.findIndex((t=>t.pointerId===e.pointerId));r&Zr.Start&&(e.buttons||s)?o<0&&(t.push(e),o=t.length-1):r&(Zr.End|Zr.Cancel)&&(n=!0),o<0||(t[o]=e,this.callback(r,{pointers:t,changedPointers:[e],eventType:r,pointerType:i,srcEvent:e}),n&&t.splice(o,1))}}const wi=["","webkit","Moz","MS","ms","o"];function Ei(e,t){const n=t[0].toUpperCase()+t.slice(1);for(const r of wi){const i=r?r+n:t;if(i in e)return i}}const Si={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class xi{constructor(e,t){this.options={...Si,...t,cssProps:{...Si.cssProps,...t.cssProps},inputTarget:t.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new bi(this),this.touchAction=new si(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?2:1}recognize(e){const{session:t}=this;if(t.stopped)return;let n;this.session.prevented&&e.srcEvent.preventDefault();const{recognizers:r}=this;let{curRecognizer:i}=t;(!i||i&&i.state&Jr.Recognized)&&(i=t.curRecognizer=null);let s=0;for(;s<r.length;)n=r[s],2===t.stopped||i&&n!==i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&n.state&(Jr.Began|Jr.Changed|Jr.Ended)&&(i=t.curRecognizer=n),s++}get(e){const{recognizers:t}=this;for(let n=0;n<t.length;n++)if(t[n].options.event===e)return t[n];return null}add(e){if(Array.isArray(e)){for(const t of e)this.add(t);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const t of e)this.remove(t);return this}const t="string"===typeof e?this.get(e):e;if(t){const{recognizers:e}=this,n=e.indexOf(t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:n}=this;for(const r of oi(e))n[r]=n[r]||[],n[r].push(t)}off(e,t){if(!e)return;const{handlers:n}=this;for(const r of oi(e))t?n[r]&&n[r].splice(n[r].indexOf(t),1):delete n[r]}emit(e,t){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const r=t;r.type=e,r.preventDefault=function(){t.srcEvent.preventDefault()};let i=0;for(;i<n.length;)n[i](r),i++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[n,r]of Object.entries(this.options.cssProps)){const i=Ei(t.style,n);e?(this.oldCssProps[i]=t.style[i],t.style[i]=r):t.style[i]=this.oldCssProps[i]||""}e||(this.oldCssProps={})}}}let Ti=1;function Ai(e){return e&Jr.Cancelled?"cancel":e&Jr.Ended?"end":e&Jr.Changed?"move":e&Jr.Began?"start":""}class Ci{constructor(e){this.options=e,this.id=Ti++,this.state=Jr.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const t of e)this.recognizeWith(t);return this}let t;if("string"===typeof e){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{simultaneous:n}=this;return n[t.id]||(n[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const t of e)this.dropRecognizeWith(t);return this}let t;return t="string"===typeof e?this.manager.get(e):e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const t of e)this.requireFailure(t);return this}let t;if("string"===typeof e){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{requireFail:n}=this;return-1===n.indexOf(t)&&(n.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const t of e)this.dropRequireFailure(t);return this}let t;if(t="string"===typeof e?this.manager.get(e):e,t){const e=this.requireFail.indexOf(t);e>-1&&this.requireFail.splice(e,1)}return this}hasRequireFailures(){return Boolean(this.requireFail.find((e=>e.options.enable)))}canRecognizeWith(e){return Boolean(this.simultaneous[e.id])}emit(e){if(!e)return;const{state:t}=this;t<Jr.Ended&&this.manager.emit(this.options.event+Ai(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=Jr.Ended&&this.manager.emit(this.options.event+Ai(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Jr.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Jr.Failed|Jr.Possible)))return!1;e++}return!0}recognize(e){const t={...e};if(!this.options.enable)return this.reset(),void(this.state=Jr.Failed);this.state&(Jr.Recognized|Jr.Cancelled|Jr.Failed)&&(this.state=Jr.Possible),this.state=this.process(t),this.state&(Jr.Began|Jr.Changed|Jr.Ended|Jr.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class Ri extends Ci{attrTest(e){const t=this.options.pointers;return 0===t||e.pointers.length===t}process(e){const{state:t}=this,{eventType:n}=e,r=t&(Jr.Began|Jr.Changed),i=this.attrTest(e);return r&&(n&Zr.Cancel||!i)?t|Jr.Cancelled:r||i?n&Zr.End?t|Jr.Ended:t&Jr.Began?t|Jr.Changed:Jr.Began:Jr.Failed}}class Pi extends Ci{constructor(){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[ti]}process(e){const{options:t}=this,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),e.eventType&Zr.Start&&0===this.count)return this.failTimeout();if(r&&i&&n){if(e.eventType!==Zr.End)return this.failTimeout();const n=!this.pTime||e.timeStamp-this.pTime<t.interval,r=!this.pCenter||di(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,r&&n?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=setTimeout((()=>{this.state=Jr.Recognized,this.tryEmit(this._input)}),t.interval),Jr.Began):Jr.Recognized}return Jr.Failed}failTimeout(){return this._timer=setTimeout((()=>{this.state=Jr.Failed}),this.options.interval),Jr.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Jr.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const ki=["","start","move","end","cancel","up","down","left","right"];class Mi extends Ri{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Qr.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&Qr.Horizontal&&t.push(ii),e&Qr.Vertical&&t.push(ri),t}getEventNames(){return ki.map((e=>this.options.event+e))}directionTest(e){const{options:t}=this;let n=!0,{distance:r}=e,{direction:i}=e;const s=e.deltaX,o=e.deltaY;return i&t.direction||(t.direction&Qr.Horizontal?(i=0===s?Qr.None:s<0?Qr.Left:Qr.Right,n=s!==this.pX,r=Math.abs(e.deltaX)):(i=0===o?Qr.None:o<0?Qr.Up:Qr.Down,n=o!==this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&Boolean(i&t.direction)}attrTest(e){return super.attrTest(e)&&(Boolean(this.state&Jr.Began)||!(this.state&Jr.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=Qr[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const Li=["","start","move","end","cancel","in","out"];class Ii{constructor(e,t,n){this.element=e,this.callback=t,this.options=n}}const Oi="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Ni=("undefined"!==typeof window?window:global,"undefined"!==typeof global?global:window,"undefined"!==typeof document&&document,-1!==Oi.indexOf("firefox")),Fi=4.000244140625;class Di extends Ii{constructor(e,t,n){super(e,t,{enable:!0,...n}),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;globalThis.WheelEvent&&(Ni&&e.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(t/=globalThis.devicePixelRatio),e.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%Fi===0&&(t=Math.floor(t/Fi)),e.shiftKey&&t&&(t*=.25),this.callback({type:"wheel",center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}const Bi=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class Ui extends Ii{constructor(e,t,n){super(e,t,{enable:!0,...n}),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,Bi.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){Bi.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t}}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const zi=["keydown","keyup"];class Gi extends Ii{constructor(e,t,n){super(e,t,{enable:!0,tabIndex:0,...n}),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:"keydown",srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",zi.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){zi.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){"keydown"===e&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}class Vi extends Ii{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){"contextmenu"===e&&(this.options.enable=t)}}const ji={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function Wi(e){const t=ji[e.srcEvent.type];if(!t)return null;const{buttons:n,button:r}=e.srcEvent;let i=!1,s=!1,o=!1;return 2===t?(i=Boolean(1&n),s=Boolean(4&n),o=Boolean(2&n)):(i=0===r,s=1===r,o=2===r),{leftButton:i,middleButton:s,rightButton:o}}function $i(e,t){const n=e.center;if(!n)return null;const r=t.getBoundingClientRect(),i=r.width/t.offsetWidth||1,s=r.height/t.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-r.left-t.clientLeft)/i,y:(n.y-r.top-t.clientTop)/s}}}const Hi={srcElement:"root",priority:0};class Xi{constructor(e,t){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:s,handlersByElement:o}=this,a={...Hi,...n};let l=o.get(a.srcElement);l||(l=[],o.set(a.srcElement,l));const c={type:e,handler:t,srcElement:a.srcElement,priority:a.priority};r&&(c.once=!0),i&&(c.passive=!0),s.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const s=n[i];if(s.type===e&&s.handler===t){n.splice(i,1);const e=r.get(s.srcElement);e.splice(e.indexOf(s),1),0===e.length&&r.delete(s.srcElement)}}this._active=n.some((e=>!e.passive))}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},i=()=>{e.handled=!0,t=!0},s=[];for(let o=0;o<n.length;o++){const{type:a,handler:l,once:c}=n[o];if(l({...e,type:a,stopPropagation:r,stopImmediatePropagation:i}),c&&s.push(n[o]),t)break}for(let e=0;e<s.length;e++){const{type:t,handler:n}=s[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...Wi(e),...$i(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}function qi(e){if("recognizer"in e)return e;let t;const n=Array.isArray(e)?[...e]:[e];if("function"===typeof n[0]){t=new(n.shift())(n.shift()||{})}else t=n.shift();return{recognizer:t,recognizeWith:"string"===typeof n[0]?[n[0]]:n[0],requireFailure:"string"===typeof n[1]?[n[1]]:n[1]}}class Ki{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._onBasicInput=e=>{this.manager.emit(e.srcEvent.type,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...t},this.events=new Map,this.element=e,e){this.manager=new xi(e,this.options);for(const e of this.options.recognizers){const{recognizer:t,recognizeWith:n,requireFailure:r}=qi(e);this.manager.add(t),n&&t.recognizeWith(n),r&&t.requireFailure(r)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new Di(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Ui(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Gi(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new Vi(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const r=n.get(e);r&&(r.set({enable:t}),n.touchAction.update()),this.wheelInput?.enableEventType(e,t),this.moveInput?.enableEventType(e,t),this.keyInput?.enableEventType(e,t),this.contextmenuInput?.enableEventType(e,t)}_addEventHandler(e,t,n,r,i){if("string"!==typeof e){n=t;for(const[t,s]of Object.entries(e))this._addEventHandler(t,s,n,r,i);return}const{manager:s,events:o}=this;if(!s)return;let a=o.get(e);if(!a){const t=this._getRecognizerName(e)||e;a=new Xi(this,t),o.set(e,a),s&&s.on(e,a.handleEvent)}a.add(e,t,n,r,i),a.isEmpty()||this._toggleRecognizer(a.recognizerName,!0)}_removeEventHandler(e,t){if("string"!==typeof e){for(const[t,n]of Object.entries(e))this._removeEventHandler(t,n);return}const{events:n}=this,r=n.get(e);if(r&&(r.remove(e,t),r.isEmpty())){const{recognizerName:e}=r;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_getRecognizerName(e){return this.manager.recognizers.find((t=>t.getEventNames().includes(e)))?.options.event}}const Yi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Yi,"IDENTITY",{get:()=>(Pe.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Zi={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Qi={common:0,meters:1,pixels:2},Ji={click:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},es={multipan:[Mi,{threshold:10,direction:Qr.Vertical,pointers:2}],pinch:[class extends Ri{constructor(){super({enable:!0,event:"pinch",threshold:0,pointers:2,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}})}getTouchAction(){return[ni]}getEventNames(){return Li.map((e=>this.options.event+e))}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||Boolean(this.state&Jr.Began))}emit(e){if(1!==e.scale){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}},{},null,["multipan"]],pan:[Mi,{threshold:1},["pinch"],["multipan"]],dblclick:[Pi,{event:"dblclick",taps:2}],click:[Pi,{event:"click"},null,["dblclick"]]},ts=Math.PI/180,ns=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],rs=[0,0,0],is={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class ss{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||is,this.focalDistance=e.focalDistance||1,this.position=e.position||rs,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Zi.WEB_MERCATOR:Zi.WEB_MERCATOR_AUTO_OFFSET:Zi.IDENTITY}equals(e){return e instanceof ss&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Sn(e.projectionMatrix,this.projectionMatrix)&&Sn(e.viewMatrix,this.viewMatrix))}project(e){let{topLeft:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Hr(this.projectPosition(e),this.pixelProjectionMatrix),[r,i]=n,s=t?i:this.height-i;return 2===e.length?[r,s]:[r,s,n[2]]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[r,i,s]=e,o=t?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],l=Xr([r,o,s],this.pixelUnprojectionMatrix,a),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(s)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=Dr(e);return t[1]=wn(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?Br(e):e}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,0],e),n=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),i=this.unproject([this.width,this.height],e);return[Math.min(t[0],n[0],r[0],i[0]),Math.min(t[1],n[1],r[1],i[1]),Math.max(t[0],n[0],r[0],i[0]),Math.max(t[1],n[1],r[1],i[1])]}getDistanceScales(e){return e&&this.isGeospatial?Gr({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel(e){let{x:t,y:n,width:r=1,height:i=1}=e;return t<this.x+this.width&&this.x<t+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:qn((e=this.viewProjectionMatrix)[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:qn(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:qn(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:qn(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:qn(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:qn(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}),this._frustumPlanes;var e}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Ur({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Gr({latitude:n,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:i,modelMatrix:s}=e;let o=rs;if(i&&(o=s?new br(s).transformAsVector(i,[]):i),this.isGeospatial){const e=this.projectPosition([t,n,0]);this.center=new Hn(o).scale(this.distanceScales.unitsPerMeter).add(e)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:t=ns,projectionMatrix:n=null,orthographic:r=!1,fovyRadians:i,fovy:s=75,near:o=.1,far:a=1e3,padding:l=null,focalDistance:c=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new br).multiplyRight(t).translate(new Hn(this.center).negate()),this.projectionMatrix=n||function(e){let{width:t,height:n,orthographic:r,fovyRadians:i,focalDistance:s,padding:o,near:a,far:l}=e;const c=t/n,u=r?(new br).orthographic({fovy:i,aspect:c,focalDistance:s,near:a,far:l}):(new br).perspective({fovy:i,aspect:c,near:a,far:l});if(o){const{left:e=0,right:r=0,top:i=0,bottom:s=0}=o,a=wn((e+t-r)/2,0,t)-t/2,l=wn((i+n-s)/2,0,n)-n/2;u[8]-=2*a/t,u[9]+=2*l/n}return u}({width:this.width,height:this.height,orthographic:r,fovyRadians:i||s*ts,focalDistance:c,padding:l,near:o,far:a});const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var h;er(u,u,this.projectionMatrix),er(u,u,this.viewMatrix),this.viewProjectionMatrix=u,this.viewMatrixInverse=Jn([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(h=this.viewMatrixInverse)[12],h[13],h[14]];const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];nr(d,d,[this.width/2,-this.height/2,1]),tr(d,d,[1,-1,0]),er(f,d,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=Jn([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Pe.warn("Pixel project matrix not invertible")()}}ss.displayName="Viewport";const os=ss;class as{constructor(e,t){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=e=>{Le("layerManager.activateViewport",this,e),e&&(this.context.viewport=e)};const{deck:n,stats:r,viewport:i,timeline:s}=t||{};this.layers=[],this.resourceManager=new mn({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:q(),defaultShaderModules:[Y],renderPass:void 0,stats:r||new Be({id:"deck.gl"}),viewport:i||new os({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new l,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers(){let{layerIds:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?this.layers.filter((t=>e.find((e=>0===t.id.indexOf(e))))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Le("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const n=Ie(e,Boolean);for(const r of n)r.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find((t=>t.name===e.name))||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,n=t.findIndex((t=>t.name===e.name));n>=0&&(t.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,n){n.raiseError(t,`${e} of ${n}`)}_updateLayers(e,t){const n={};for(const s of e)n[s.id]?Pe.warn(`Multiple old layers with same id ${s.id}`)():n[s.id]=s;if(this._defaultShaderModulesChanged){for(const t of e)t.setNeedsUpdate(),t.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const r=[];this._updateSublayersRecursively(t,n,r),this._finalizeOldLayers(n);let i=!1;for(const s of r)if(s.hasUniformTransition()){i=`Uniform transition in ${s}`;break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(e,t,n){for(const i of e){i.context=this.context;const e=t[i.id];null===e&&Pe.warn(`Multiple new layers with same id ${i.id}`)(),t[i.id]=null;let s=null;try{this._debug&&e!==i&&i.validateProps(),e?(this._transferLayerState(e,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(r){this._handleError("matching",r,i)}s&&this._updateSublayersRecursively(s,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=J}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=Q,t!==e&&(e.lifecycle=ee)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=te;try{e._finalize(),e.lifecycle=ne}catch(t){this._handleError("finalization",t,e)}}}function ls(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!ls(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const s of r){if(!t.hasOwnProperty(s))return!1;if(!ls(e[s],t[s],n-1))return!1}return!0}return!1}class cs{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter((t=>t.containsPixel(e))):this._viewports}getViews(){const e={};return this.views.forEach((t=>{e[t.id]=t})),e}getView(e){return this.views.find((t=>t.id===e))}getViewState(e){const t="string"===typeof e?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),r={x:e[0],y:e[1]};for(let i=n.length-1;i>=0;--i){const s=n[i];if(s.containsPixel(r)){const n=e.slice();return n[0]-=s.x,n[1]-=s.y,s.unproject(n,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Ie(e,Boolean);this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){if(e){!ls(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e}else Pe.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>this.getView(e.id)?.makeViewport({viewState:t,width:this.width,height:this.height})})}_updateController(e,t,n,r){const i=e.controller;if(i&&n){const s={...t,...i,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return r&&r.constructor===i.type||(r=this._createController(e,s)),r&&r.setProps(s),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let r=e.length;r--;){const i=e[r],s=this.getViewState(i),o=i.makeViewport({viewState:s,width:this.width,height:this.height});let a=t[i.id];const l=Boolean(i.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[i.id]=this._updateController(i,s,o,a),o&&this._viewports.unshift(o)}for(const r in t){const e=t[r];e&&!this.controllers[r]&&e.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)}))}_diffViews(e,t){return e.length!==t.length||e.some(((n,r)=>!e[r].equals(t[r])))}}const us=/([0-9]+\.?[0-9]*)(%|px)/;function hs(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=us.exec(e);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error(`Could not parse position string ${e}`)}}function ds(e,t){return e.relative?Math.round(e.position*t):e.position}class fs{constructor(e){const{id:t,x:n=0,y:r=0,width:i="100%",height:s="100%",padding:o=null}=e;this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=hs(n),this._y=hs(r),this._width=hs(i),this._height=hs(s),this._padding=o&&{left:hs(o.left||0),right:hs(o.right||0),top:hs(o.top||0),bottom:hs(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||this.constructor===e.constructor&&ls(this.props,e.props,2)}makeViewport(e){let{width:t,height:n,viewState:r}=e;r=this.filterViewState(r);const i=this.getDimensions({width:t,height:n});if(!i.height||!i.width)return null;return new(this.getViewportType(r))({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return"string"===typeof e?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions(e){let{width:t,height:n}=e;const r={x:ds(this._x,t),y:ds(this._y,n),width:ds(this._width,t),height:ds(this._height,n)};return this._padding&&(r.padding={left:ds(this._padding.left,t),top:ds(this._padding.top,n),right:ds(this._padding.right,t),bottom:ds(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"===typeof e?{type:e}:{type:this.ControllerType,...e}:null}}class ps extends os{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:t=0,longitude:n=0,zoom:r=0,pitch:i=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:a=1.01,nearZ:l,farZ:c,orthographic:u=!1,projectionMatrix:h,repeat:d=!1,worldOffset:f=0,position:p,padding:g,legacyMeterSizes:m=!1}=e;let{width:_,height:y,altitude:v=1.5}=e;const b=Math.pow(2,r);let w;_=_||1,y=y||1;let E=null;if(h)v=h[5]/2,w=Wr(v);else{let n;if(e.fovy?(w=e.fovy,v=$r(w)):w=Wr(v),g){const{top:e=0,bottom:t=0}=g;n=[0,wn((e+y-t)/2,0,y)-y/2]}E=jr({width:_,height:y,scale:b,center:p&&[0,0,p[2]*zr(t)],offset:n,pitch:i,fovy:w,nearZMultiplier:o,farZMultiplier:a}),Number.isFinite(l)&&(E.near=l),Number.isFinite(c)&&(E.far=c)}let S=function(e){const{height:t,pitch:n,bearing:r,altitude:i,scale:s,center:o}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];tr(a,a,[0,0,-i]),rr(a,a,-n*Mr),ir(a,a,r*Mr);const l=s/t;var c,u;return nr(a,a,[l,l,l]),o&&tr(a,a,((c=[])[0]=-(u=o)[0],c[1]=-u[1],c[2]=-u[2],c)),a}({height:y,pitch:i,bearing:s,scale:b,altitude:v});if(f){S=(new br).translate([512*f,0,0]).multiplyLeft(S)}super({...e,width:_,height:y,viewMatrix:S,longitude:n,latitude:t,zoom:r,...E,fovy:w,focalDistance:v}),this.latitude=t,this.longitude=n,this.zoom=r,this.pitch=i,this.bearing=s,this.altitude=v,this.fovy=w,this.orthographic=u,this._subViewports=d?[]:null,this._pseudoMeters=m,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let r=t;r<=n;r++){const e=r?new ps({...this,worldOffset:r}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*zr(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)/zr(n)]}addMetersToLngLat(e,t){return Vr(e,t)}panByPosition(e,t){const n=Xr(t,this.pixelUnprojectionMatrix),r=lr([],this.projectFlat(e),((i=[])[0]=-(s=n)[0],i[1]=-s[1],i));var i,s;const o=lr([],this.center,r),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:r,unproject:i}=e,s={targetZ:t},o=i([0,r],s),a=i([n,r],s);let l,c;return(e.fovy?.5*e.fovy*Kr:Math.atan(.5/e.altitude))>(90-e.pitch)*Kr-.01?(l=Yr(e,0,t),c=Yr(e,n,t)):(l=i([0,0],s),c=i([n,0],s)),[o,a,c,l]}(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:n,height:r}=this,{longitude:i,latitude:s,zoom:o}=qr({width:n,height:r,bounds:e,...t});return new ps({width:n,height:r,longitude:i,latitude:s,zoom:o})}}ps.displayName="WebMercatorViewport";const gs=ps;class ms{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const _s=()=>{},ys=2,vs=3,bs=e=>e,ws=1;class Es{constructor(e){this._onTransitionUpdate=e=>{const{time:t,settings:{interpolator:n,startProps:r,endProps:i,duration:s,easing:o}}=e,a=o(t/s),l=n.interpolateProps(r,i,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new ms(e.timeline),this.onViewStateChange=e.onViewStateChange||_s,this.onStateChange=e.onStateChange||_s}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let r=n;if(this.transition.inProgress){const{interruption:e,endProps:t}=this.transition.settings;r={...n,...e===ys?t:this.propsInTransition||n}}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||"auto"===t)&&Boolean(n)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){if(this.transition.inProgress){return this.transition.settings.interruption===vs||this._isUpdateDueToCurrentTransition(t)}return!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const n=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(n),i=t.transitionInterpolator,s=i.getDuration?i.getDuration(e,t):t.transitionDuration;if(0===s)return;const o=i.initializeProps(e,r);this.propsInTransition={};const a={duration:s,easing:t.transitionEasing||bs,interpolator:i,interruption:t.transitionInterruption||ws,startProps:o.start,endProps:o.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(t)}}}function Ss(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}class xs{constructor(e){const{compare:t,extract:n,required:r}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=r}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!Sn(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},r={};for(const i of this._propsToExtract)(i in e||i in t)&&(n[i]=e[i],r[i]=t[i]);return this._checkRequiredProps(n),this._checkRequiredProps(r),{start:n,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach((t=>{const n=e[t];Ss(Number.isFinite(n)||Array.isArray(n),`${t} is required for transition`)}))}}const Ts=["longitude","latitude","zoom","bearing","pitch"],As=["longitude","latitude","zoom"];class Cs extends xs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:Ts,required:As},super(n.transitionProps),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:r,around:i}=this.opts;if(r&&i){const s=r(e),o=r(t),a=s.unproject(i);n.start.around=i,Object.assign(n.end,{around:o.project(a),aroundPosition:a,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const r={};for(const i of this._propsToExtract)r[i]=En(e[i]||0,t[i]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const i=this.opts.makeViewport({...t,...r});Object.assign(r,i.panByPosition(t.aroundPosition,En(e.around,t.around,n)))}return r}}const Rs={transitionDuration:0},Ps=e=>1-(1-e)*(1-e),ks=["wheel"],Ms=["panstart","panmove","panend"],Ls=["pinchstart","pinchmove","pinchend"],Is=["multipanstart","multipanmove","multipanend"],Os=["dblclick"],Ns=["keydown"],Fs={};class Ds{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new Es({...e,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return!t&&this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-n]}isPointInBounds(e,t){const{width:n,height:r}=this.props;if(t&&t.handled)return!1;const i=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=r;return i&&t&&t.stopPropagation(),i}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout((()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)}),e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:a=!1,keyboard:l=!0}=e,c=Boolean(this.onViewStateChange);this.toggleEvents(ks,c&&n),this.toggleEvents(Ms,c),this.toggleEvents(Ls,c&&(o||a)),this.toggleEvents(Is,c&&a),this.toggleEvents(Os,c&&s),this.toggleEvents(Ns,c&&l),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach((e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))}))}updateViewport(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={...e.getViewportProps(),...t},i=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),i){const e=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:e,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(r,Rs,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,Rs,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Ps},{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Rs,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Ps},{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:i}=e;let s=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==s&&(s=1/s);const o=this.controllerState.zoom({pos:t,scale:s});return this.updateViewport(o,{...this._getTransitionProps({around:t}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,Rs,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Rs,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*t/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Ps},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return Fs._startPinchRotation=e.rotation,Fs._lastPinchEvent=e,this.updateViewport(n,Rs,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:Fs._startPinchRotation-n})}return this.updateViewport(t,Rs,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Fs._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=Fs;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const r=this.getCenter(e);let i=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),a=Math.pow(2,s+o*t/2);i=i.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:t,transitionEasing:Ps},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Fs._startPinchRotation=null,Fs._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:s}=!0===this.keyboard?{}:this.keyboard,{controllerState:o}=this;let a;const l={};switch(e.srcEvent.code){case"Minus":a=t?o.zoomOut(n).zoomOut(n):o.zoomOut(n),l.isZooming=!0;break;case"Equal":a=t?o.zoomIn(n).zoomIn(n):o.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":t?(a=o.rotateLeft(i),l.isRotating=!0):(a=o.moveLeft(r),l.isPanning=!0);break;case"ArrowRight":t?(a=o.rotateRight(i),l.isRotating=!0):(a=o.moveRight(r),l.isPanning=!0);break;case"ArrowUp":t?(a=o.rotateUp(s),l.isRotating=!0):(a=o.moveUp(r),l.isPanning=!0);break;case"ArrowDown":t?(a=o.rotateDown(s),l.isRotating=!0):(a=o.moveDown(r),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?{...t,transitionInterpolator:new Cs({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t:Rs}}class Bs{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class Us extends Bs{constructor(e){const{width:t,height:n,latitude:r,longitude:i,zoom:s,bearing:o=0,pitch:a=0,altitude:l=1.5,position:c=[0,0,0],maxZoom:u=20,minZoom:h=0,maxPitch:d=60,minPitch:f=0,startPanLngLat:p,startZoomLngLat:g,startRotatePos:m,startBearing:_,startPitch:y,startZoom:v,normalize:b=!0}=e;Ss(Number.isFinite(i)),Ss(Number.isFinite(r)),Ss(Number.isFinite(s)),super({width:t,height:n,latitude:r,longitude:i,zoom:s,bearing:o,pitch:a,altitude:l,maxZoom:u,minZoom:h,maxPitch:d,minPitch:f,normalize:b,position:c},{startPanLngLat:p,startZoomLngLat:g,startRotatePos:m,startBearing:_,startPitch:y,startZoom:v}),this.makeViewport=e.makeViewport}panStart(e){let{pos:t}=e;return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan(e){let{pos:t,startPos:n}=e;const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(r,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(e){let{pos:t}=e;return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate(e){let{pos:t,deltaAngleX:n=0,deltaAngleY:r=0}=e;const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||void 0===s||void 0===o)return this;let a;return a=t?this._getNewRotation(t,i,o,s):{bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(e){let{pos:t}=e;return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom(e){let{pos:t,startPos:n,scale:r}=e,{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(t)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=wn(l,a,o);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(s,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(e)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/e)}moveLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([e,0])}moveRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-e,0])}moveUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,e])}moveDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-e])}rotateLeft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this.getViewportProps()},{bearing:r,longitude:i}=n;return Math.abs(r-t.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-t.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:r}=e;e.zoom=wn(r,n,t);const{maxPitch:i,minPitch:s,pitch:o}=e;e.pitch=wn(o,s,i);const{normalize:a=!0}=e;return a&&Object.assign(e,function(e){const{width:t,height:n,pitch:r=0}=e;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=e;(i<-180||i>180)&&(i=Tr(i+180,360)-180),(a<-180||a>180)&&(a=Tr(a+180,360)-180);const l=Cr(n/512);if(o<=l)o=l,s=0;else{const e=n/2/Math.pow(2,o),t=Br([0,e])[1];if(s<t)s=t;else{const t=Br([0,512-e])[1];s>t&&(s=t)}}return{width:t,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,r){const i=e[0]-t[0],s=e[1]-t[1],o=e[1],a=t[1],{width:l,height:c}=this.getViewportProps(),u=i/l;let h=0;s>0?Math.abs(c-a)>5&&(h=s/(a-c)*1.2):s<0&&a>5&&(h=1-o/a),h=wn(h,-1,1);const{minPitch:d,maxPitch:f}=this.getViewportProps();let p=n;return h>0?p=n+h*(f-n):h<0&&(p=n-h*(d-n)),{pitch:p,bearing:r+180*u}}}class zs extends Ds{constructor(){super(...arguments),this.ControllerState=Us,this.transition={transitionDuration:300,transitionInterpolator:new Cs({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e);(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Gs extends fs{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getViewportType(){return gs}get ControllerType(){return zs}}Gs.displayName="MapView";const Vs=Gs,js=[255,255,255],Ws=1;let $s=0;class Hs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="ambient";const{color:t=js}=e,{intensity:n=Ws}=e;this.id=e.id||"ambient-"+$s++,this.color=t,this.intensity=n}}const Xs=[255,255,255],qs=1,Ks=[0,0,-1];let Ys=0;class Zs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="directional";const{color:t=Xs}=e,{intensity:n=qs}=e,{direction:r=Ks}=e,{_shadow:i=!1}=e;this.id=e.id||"directional-"+Ys++,this.color=t,this.intensity=n,this.type="directional",this.direction=new Hn(r).normalize().toArray(),this.shadow=i}getProjectedLight(e){return this}}class Qs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};const{id:n}=t;this.id=n,this.device=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Js extends Qs{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[t,n]=this.device.canvasContext.getDrawingBufferSize(),r=e.clearCanvas??!0,i=e.clearColor??(!!r&&[0,0,0,0]),s=!!r&&1,o=!!r&&0,a=e.colorMask??15,l={viewport:[0,0,t,n]};e.colorMask&&(l.colorMask=a),e.scissorRect&&(l.scissorRect=e.scissorRect);const c=this.device.beginRenderPass({framebuffer:e.target,parameters:l,clearColor:i,clearDepth:s,clearStencil:o});try{return this._drawLayers(c,e)}finally{c.end()}}_drawLayers(e,t){const{target:n,shaderModuleProps:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0}=t;t.pass=t.pass||"unknown",a&&(this._lastRenderIndex=-1);const l=[];for(const c of i){const i=s&&s[c.id];o?.(c);const a=this._getDrawLayerParams(c,t),u=c.subViewports||[c];for(const s of u){const o=this._drawLayersInViewport(e,{target:n,shaderModuleProps:r,viewport:s,view:i,pass:t.pass,layers:t.layers},a);l.push(o)}}return l}_getDrawLayerParams(e,t){let{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,shaderModuleProps:l}=t,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const u=[],h=eo(this._lastRenderIndex+1),d={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},f={};for(let p=0;p<n.length;p++){const t=n[p],i=this._shouldDrawLayer(t,d,s,f),o={shouldDrawLayer:i};i&&!c&&(o.shouldDrawLayer=!0,o.layerRenderIndex=h(t,i),o.shaderModuleProps=this._getShaderModuleProps(t,a,r,l),o.layerParameters={...t.context.deck?.props.parameters,...this.getLayerParameters(t,p,e)}),u[p]=o}return u}_drawLayersInViewport(e,t,n){let{layers:r,shaderModuleProps:i,pass:s,target:o,viewport:a,view:l}=t;const c=function(e,t){let{shaderModuleProps:n,target:r,viewport:i}=t;const s=n?.project?.devicePixelRatio??e.canvasContext.cssToDeviceRatio(),[,o]=e.canvasContext.getDrawingBufferSize(),a=r?r.height:o,l=i;return[l.x*s,a-(l.y+l.height)*s,l.width*s,l.height*s]}(this.device,{shaderModuleProps:i,target:o,viewport:a});if(l&&l.props.clear){const e=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;this.device.beginRenderPass({framebuffer:o,parameters:{viewport:c,scissorRect:c},clearColor:!!e.color&&[0,0,0,0],clearDepth:!!e.depth&&1}).end()}const u={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:c});for(let d=0;d<r.length;d++){const t=r[d],i=n[d],{shouldDrawLayer:o}=i;if(o&&t.props.pickable&&u.pickableCount++,t.isComposite&&u.compositeCount++,t.isDrawable&&i.shouldDrawLayer){const{layerRenderIndex:n,shaderModuleProps:r,layerParameters:o}=i;u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,n),r.project&&(r.project.viewport=a),t.context.renderPass=e;try{t._drawLayer({renderPass:e,shaderModuleProps:r,uniforms:{layerIndex:n},parameters:o})}catch(h){t.raiseError(h,`drawing ${t} to ${s}`)}}}return u}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,n){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let i=e.parent;for(;i;){if(!i.props.visible||!i.filterSubLayer(t))return!1;t.layer=i,i=i.parent}if(n){const e=t.layer.id;if(e in r||(r[e]=n(t)),!r[e])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,n,r){const i=this.device.canvasContext.cssToDeviceRatio(),s=e.internalState?.propsInTransition||e.props,o={layer:s,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:i,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const a of t)to(o,a.getShaderModuleProps?.(e,o));return to(o,this.getShaderModuleProps(e,t,o),r)}}function eo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in t)&&r(i.parent,!1),l in n){const e=n[l]=n[l]||eo(t[l],t);c=e(i,s),n[a]=e}else Number.isFinite(o)?(c=o+(t[l]||0),n[a]=null):c=e;return s&&c>=e&&(e=c+1),t[a]=c,c};return r}function to(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)if(i)for(const t in i)e[t]?Object.assign(e[t],i[t]):e[t]=i[t];return e}class no extends Js{constructor(e,t){super(e,t);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),r=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:r})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),r=e.viewports[0],i=r.width*n,s=r.height*n;i===t.width&&s===t.height||t.resize({width:i,height:s}),super.render({...e,clearColor:[1,1,1,1],target:t,pass:"shadow"})}getLayerParameters(e,t,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getShaderModuleProps(e,t,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const ro={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n"},io=`${Object.keys(Yi).map((e=>`const int COORDINATE_SYSTEM_${e} = ${Yi[e]};`)).join("")}\n${Object.keys(Zi).map((e=>`const int PROJECTION_MODE_${e} = ${Zi[e]};`)).join("")}\n${Object.keys(Qi).map((e=>`const int UNIT_${e.toUpperCase()} = ${Qi[e]};`)).join("")}\nuniform projectUniforms {\nbool wrapLongitude;\nint coordinateSystem;\nvec3 commonUnitsPerMeter;\nint projectionMode;\nfloat scale;\nvec3 commonUnitsPerWorldUnit;\nvec3 commonUnitsPerWorldUnit2;\nvec4 center;\nmat4 modelMatrix;\nmat4 viewProjectionMatrix;\nvec2 viewportSize;\nfloat devicePixelRatio;\nfloat focalDistance;\nvec3 cameraPosition;\nvec3 coordinateOrigin;\nvec3 commonOrigin;\nbool pseudoMeters;\n} project;\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\nfloat y = clamp(lat, -89.9, 89.9);\nreturn 1.0 / cos(radians(y));\n}\nfloat project_size() {\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\nproject.pseudoMeters == false) {\nif (geometry.position.w == 0.0) {\nreturn project_size_at_latitude(geometry.worldPosition.y);\n}\nfloat y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\nfloat y2 = y * y;\nfloat y4 = y2 * y2;\nfloat y6 = y4 * y2;\nreturn 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n}\nreturn 1.0;\n}\nfloat project_size_at_latitude(float meters, float lat) {\nreturn meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\nreturn meters * project.commonUnitsPerMeter.z * project_size();\n}\nvec2 project_size(vec2 meters) {\nreturn meters * project.commonUnitsPerMeter.xy * project_size();\n}\nvec3 project_size(vec3 meters) {\nreturn meters * project.commonUnitsPerMeter * project_size();\n}\nvec4 project_size(vec4 meters) {\nreturn vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\nvec3 uz = normalize(up);\nvec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\nvec3 uy = cross(uz, ux);\nreturn mat3(ux, uy, uz);\n}\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\ntransform = project_get_orientation_matrix(commonPosition);\nreturn true;\n}\nreturn false;\n}\nvec3 project_normal(vec3 vector) {\nvec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);\nvec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\nmat3 rotation;\nif (project_needs_rotation(geometry.position.xyz, rotation)) {\nn = rotation * n;\n}\nreturn n;\n}\nvec4 project_offset_(vec4 offset) {\nfloat dy = offset.y;\nvec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\nreturn vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\nfloat x = lnglat.x;\nif (project.wrapLongitude) {\nx = mod(x + 180., 360.0) - 180.;\n}\nfloat y = clamp(lnglat.y, -89.9, 89.9);\nreturn vec2(\nradians(x) + PI,\nPI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n) * WORLD_SCALE;\n}\nvec3 project_globe_(vec3 lnglatz) {\nfloat lambda = radians(lnglatz.x);\nfloat phi = radians(lnglatz.y);\nfloat cosPhi = cos(phi);\nfloat D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\nreturn vec3(\nsin(lambda) * cosPhi,\n-cos(lambda) * cosPhi,\nsin(phi)\n) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\nvec4 position_world = project.modelMatrix * position;\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_mercator_(position_world.xy),\nproject_size_at_latitude(position_world.z, position_world.y),\nposition_world.w\n);\n}\nif (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\nposition_world.xyz += project.coordinateOrigin;\n}\n}\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_globe_(position_world.xyz),\nposition_world.w\n);\n}\n}\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nif (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\nreturn vec4(\nproject_mercator_(position_world.xy) - project.commonOrigin.xy,\nproject_size(position_world.z),\nposition_world.w\n);\n}\n}\n}\nif (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\nposition_world.xyz -= project.coordinateOrigin;\n}\nreturn project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));\n}\nvec4 project_position(vec4 position) {\nreturn project_position(position, ZERO_64_LOW);\n}\nvec3 project_position(vec3 position, vec3 position64Low) {\nvec4 projected_position = project_position(vec4(position, 1.0), position64Low);\nreturn projected_position.xyz;\n}\nvec3 project_position(vec3 position) {\nvec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\nreturn projected_position.xyz;\n}\nvec2 project_position(vec2 position) {\nvec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\nreturn projected_position.xy;\n}\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\nreturn viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\nreturn project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\nvec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\nreturn offset * project.focalDistance;\n}\nfloat project_size_to_pixel(float meters) {\nreturn project_size(meters) * project.scale;\n}\nfloat project_size_to_pixel(float size, int unit) {\nif (unit == UNIT_METERS) return project_size_to_pixel(size);\nif (unit == UNIT_COMMON) return size * project.scale;\nreturn size;\n}\nfloat project_pixel_size(float pixels) {\nreturn pixels / project.scale;\n}\nvec2 project_pixel_size(vec2 pixels) {\nreturn pixels / project.scale;\n}\n`;function so(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}function oo(e){let t,n={};return r=>{for(const i in r)if(!so(r[i],n[i])){t=e(r),n=r;break}return t}}const ao=[0,0,0,0],lo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],co=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],uo=[0,0,0],ho=[0,0,0],fo=oo((function(e){let{viewport:t,devicePixelRatio:n,coordinateSystem:r,coordinateOrigin:i}=e;const{projectionCenter:s,viewProjectionMatrix:o,originCommon:a,cameraPosCommon:l,shaderCoordinateOrigin:c,geospatialOrigin:u}=function(e,t,n){const{viewMatrixUncentered:r,projectionMatrix:i}=e;let{viewMatrix:s,viewProjectionMatrix:o}=e,a=ao,l=ao,c=e.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:d}=po(e,t,n);d&&(l=e.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=fr([],l,o),s=r||s,o=er([],i,s),o=er([],o,lo));return{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(t,r,i),h=t.getDistanceScales(),d=[t.width*n,t.height*n],f=fr([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,p={coordinateSystem:r,projectionMode:t.projectionMode,coordinateOrigin:c,commonOrigin:a.slice(0,3),center:s,pseudoMeters:Boolean(t._pseudoMeters),viewportSize:d,devicePixelRatio:n,focalDistance:f,commonUnitsPerMeter:h.unitsPerMeter,commonUnitsPerWorldUnit:h.unitsPerMeter,commonUnitsPerWorldUnit2:uo,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:o,modelMatrix:co,cameraPosition:l};if(u){const e=t.getDistanceScales(u);switch(r){case Yi.METER_OFFSETS:p.commonUnitsPerWorldUnit=e.unitsPerMeter,p.commonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case Yi.LNGLAT:case Yi.LNGLAT_OFFSETS:t._pseudoMeters||(p.commonUnitsPerMeter=e.unitsPerMeter),p.commonUnitsPerWorldUnit=e.unitsPerDegree,p.commonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case Yi.CARTESIAN:p.commonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],p.commonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return p}));function po(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ho;n.length<3&&(n=[n[0],n[1],0]);let r,i=n,s=!0;switch(r=t===Yi.LNGLAT_OFFSETS||t===Yi.METER_OFFSETS?n:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case Zi.WEB_MERCATOR:t!==Yi.LNGLAT&&t!==Yi.CARTESIAN||(r=[0,0,0],s=!1);break;case Zi.WEB_MERCATOR_AUTO_OFFSET:t===Yi.LNGLAT?i=r:t===Yi.CARTESIAN&&(i=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],r=e.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case Zi.IDENTITY:i=e.position.map(Math.fround),i[2]=i[2]||0;break;case Zi.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}const go={};const mo={name:"project",dependencies:[ro,$],vs:io,getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:go;return"viewport"in e?function(e){let{viewport:t,devicePixelRatio:n=1,modelMatrix:r=null,coordinateSystem:i=Yi.DEFAULT,coordinateOrigin:s=ho,autoWrapLongitude:o=!1}=e;i===Yi.DEFAULT&&(i=t.isGeospatial?Yi.LNGLAT:Yi.CARTESIAN);const a=fo({viewport:t,devicePixelRatio:n,coordinateSystem:i,coordinateOrigin:s});return a.wrapLongitude=o,a.modelMatrix=r||co,a}(e):{}},uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},_o="\nuniform shadowUniforms {\n  bool drawShadowMap;\n  bool useShadowMap;\n  vec4 color;\n  highp int lightId;\n  float lightCount;\n  mat4 viewProjectionMatrix0;\n  mat4 viewProjectionMatrix1;\n  vec4 projectCenter0;\n  vec4 projectCenter1;\n} shadow;\n",yo=`\n${_o}\n\nconst int max_lights = 2;\n\nout vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  mat4 viewProjectionMatrices[max_lights];\n  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;\n  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;\n  vec4 projectCenters[max_lights];\n  projectCenters[0] = shadow.projectCenter0;\n  projectCenters[1] = shadow.projectCenter1;\n\n  if (shadow.drawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);\n  }\n  if (shadow.useShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow.lightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n\n`,vo=`\n${_o}\n\nconst int max_lights = 2;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\n\nin vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow.drawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow.useShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow.lightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow.color.a / shadow.lightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n\n`,bo=oo((function(e){let{viewport:t,center:n}=e;return new br(t.viewProjectionMatrix).invert().transform(n)})),wo=oo((function(e){let{viewport:t,shadowMatrices:n}=e;const r=[],i=t.pixelUnprojectionMatrix,s=t.isGeospatial?void 0:1,o=[[0,0,s],[t.width,0,s],[0,t.height,s],[t.width,t.height,s],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((e=>function(e,t){const[n,r,i]=e,s=Xr([n,r,i],t);if(Number.isFinite(i))return s;return[s[0],s[1],0]}(e,i)));for(const a of n){const e=a.clone().translate(new Hn(t.center).negate()),n=o.map((t=>e.transform(t))),i=(new br).ortho({left:Math.min(...n.map((e=>e[0]))),right:Math.max(...n.map((e=>e[0]))),bottom:Math.min(...n.map((e=>e[1]))),top:Math.max(...n.map((e=>e[1]))),near:Math.min(...n.map((e=>-e[2]))),far:Math.max(...n.map((e=>-e[2])))});r.push(i.multiplyRight(a))}return r})),Eo=[0,0,0,1],So=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const xo={name:"shadow",dependencies:[mo],vs:yo,fs:vo,inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(e){const{shadowEnabled:t=!0,project:n}=e;if(!t||!n||!e.shadowMatrices||!e.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};const r=mo.getUniforms(n),i=bo({viewport:n.viewport,center:r.center}),s=[],o=wo({shadowMatrices:e.shadowMatrices,viewport:n.viewport}).slice();for(let l=0;l<e.shadowMatrices.length;l++){const e=o[l],t=e.clone().translate(new Hn(n.viewport.center).negate());r.coordinateSystem===Yi.LNGLAT&&r.projectionMode===Zi.WEB_MERCATOR?(o[l]=t,s[l]=i):(o[l]=e.clone().multiplyRight(So),s[l]=t.transform(i))}const a={drawShadowMap:Boolean(e.drawToShadowMap),useShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,color:e.shadowColor||Eo,lightId:e.shadowLightId||0,lightCount:e.shadowMatrices.length,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};for(let l=0;l<o.length;l++)a[`viewProjectionMatrix${l}`]=o[l],a[`projectCenter${l}`]=s[l];for(let l=0;l<2;l++)a[`shadow_uShadowMap${l}`]=e.shadowMaps&&e.shadowMaps[l]||e.dummyShadowMap;return a},uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},To={color:[255,255,255],intensity:1},Ao=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Co=[0,0,0,200/255];class Ro{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id="lighting-effect",this.shadowColor=Co,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),n._addDefaultShaderModule(xo),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((e=>e.shadow)),this.context&&this.setup(this.context),this.props=e}preRender(e){let{layers:t,layerFilter:n,viewports:r,onViewportActive:i,views:s}=e;if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let e=0;e<this.shadowPasses.length;e++){this.shadowPasses[e].render({layers:t,layerFilter:n,viewports:r,onViewportActive:i,views:s,shaderModuleProps:{shadow:{shadowLightId:e,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}}getShaderModuleProps(e,t){const n=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map((e=>e.getShadowMap())),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},r={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((t=>t.getProjectedLight({layer:e}))),pointLights:this.pointLights.map((t=>t.getProjectedLight({layer:e})))},i=e.props.material;return{shadow:n,lighting:r,phongMaterial:i,gouraudMaterial:i}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(xo))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=(new br).lookAt({eye:new Hn(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new no(e);this.shadowPasses[t]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;e||0!==t.length||0!==n.length||(this.ambientLight=new Hs(To),this.directionalLights.push(new Zs(Ao[0]),new Zs(Ao[1])))}}const Po=new Ro;class ko{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find((t=>t.id===e.id))){const n=t.findIndex((t=>{return n=e,(t.order??1/0)-(n.order??1/0)>0;var n}));n<0?t.push(e):t.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(ls(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const r of this.effects)t[r.id]=r;const n=[];for(const r of e){const e=t[r.id];let i=r;e&&e!==r?e.setProps?(e.setProps(r.props),i=e):e.cleanup(this._context):e||r.setup(this._context),n.push(i),delete t[r.id]}for(const r in t)t[r].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some((e=>e instanceof Ro))||this._resolvedEffects.push(Po),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class Mo extends Js{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const Lo={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class Io extends Js{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer(e){let{layers:t,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:h,effects:d,pass:f="picking",pickZ:p,shaderModuleProps:g}=e;this.pickZ=p;const m=this._resetColorEncoder(p),_=[a,l,c,u],y=super.render({target:o,layers:t,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:h,effects:d?.filter((e=>e.useInPicking)),pass:f,isPicking:!0,shaderModuleProps:g,clearColor:[0,0,0,0],colorMask:15,scissorRect:_});this._colorEncoderState=null;return{decodePickingColor:m&&Oo.bind(null,m),stats:y}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,t,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,n){const r={...e.props.parameters},{pickable:i,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?r.blend=!1:i&&s.includes("draw")&&(Object.assign(r,Lo),r.blend=!0,r.blendColor=function(e,t,n){const{byLayer:r,byAlpha:i}=e;let s,o=r.get(t);o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:t,viewports:[n]},r.set(t,o),i[s]=o):(Pe.warn("Too many pickable layers, only picking the first 255")(),s=0));return[0,0,0,s/255]}(this._colorEncoderState,e,n)),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function Oo(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}class No{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Mo(e),this.pickLayersPass=new Io(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const r=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const i=t.render({...n,target:r});n.effects&&this._postRender(n.effects,n),this.renderCount++,Le("deckRenderer.renderLayers",this,i,e)}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize();0===e.length&&[0,1].map((t=>{const n=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${t}`,colorAttachments:[n]}))}));for(const n of e)n.resize(t)}_postRender(e,t){const{renderBuffers:n}=this,r={...t,inputBuffer:n[0],swapBuffer:n[1]};for(const i of e)if(i.postRender){r.target=i.id===this.lastPostProcessEffect?t.target:void 0;const e=i.postRender(r);r.inputBuffer=e,r.swapBuffer=e===n[0]?n[1]:n[0]}}}const Fo={pickedColor:null,pickedObjectIndex:-1};function Do(e){let{pickedColors:t,decodePickingColor:n,deviceX:r,deviceY:i,deviceRadius:s,deviceRect:o}=e;const{x:a,y:l,width:c,height:u}=o;let h=s*s,d=-1,f=0;for(let p=0;p<u;p++){const e=p+l-i,n=e*e;if(n>h)f+=4*c;else for(let i=0;i<c;i++){if(t[f+3]-1>=0){const e=i+a-r,t=e*e+n;t<=h&&(h=t,d=f)}f+=4}}if(d>=0){const e=t.slice(d,d+4),r=n(e);if(r){const t=Math.floor(d/4/c),n=d/4-t*c;return{...r,pickedColor:e,pickedX:a+n,pickedY:l+t}}Pe.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Fo}function Bo(e){let t,{pickInfo:n,viewports:r,pixelRatio:i,x:s,y:o,z:a}=e,l=r[0];if(r.length>1&&(l=function(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.containsPixel(t))return r}return e[0]}(n?.pickedViewports||r,{x:s,y:o})),l){const e=[s-l.x,o-l.y];void 0!==a&&(e[2]=a),t=l.unproject(e)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:t,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:i}}function Uo(e){const{pickInfo:t,lastPickedInfo:n,mode:r,layers:i}=e,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=t,l=o?[o]:[];if("hover"===r){const e=n.index,t=n.layerId,r=o?o.props.id:null;if(r!==t||a!==e){if(r!==t){const e=i.find((e=>e.props.id===t));e&&l.unshift(e)}n.layerId=r,n.index=a,n.info=null}}const c=Bo(e),u=new Map;return u.set(null,c),l.forEach((e=>{let t={...c};e===o&&(t.color=s,t.index=a,t.picked=!0),t=zo({layer:e,info:t,mode:r});const i=t.layer;e===o&&"hover"===r&&(n.info=t),u.set(i.id,t),"hover"===r&&i.updateAutoHighlight(t)})),u}function zo(e){let{layer:t,info:n,mode:r}=e;for(;t&&n;){const e=n.layer||null;n.sourceLayer=e,n.layer=t,n=t.getPickingInfo({info:n,mode:r,sourceLayer:e}),t=t.parent}return n}class Go{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new Io(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject(e){let{x:t,y:n,layers:r,viewports:i}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info;const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find((e=>e.id===o)):null,c=a&&i.find((e=>e.id===a))||i[0],u=c&&c.unproject([t-c.x,n-c.y]),h={x:t,y:n,viewport:c,coordinate:u,layer:l};return{...s,...h}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const e=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=e}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter((e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite));return t.length?t:null}_pickClosestObject(e){let{layers:t,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:h}=e;const d=this.device.canvasContext.cssToDeviceRatio(),f=this._getPickable(t);if(!f||0===r.length)return{result:[],emptyInfo:Bo({viewports:r,x:i,y:s,pixelRatio:d})};this._resizeBuffer();const p=this.device.canvasContext.cssToDevicePixels([i,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*d),{width:_,height:y}=this.pickingFBO,v=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:_,deviceHeight:y}),b={x:i-o,y:s-o,width:2*o+1,height:2*o+1};let w;const E=[],S=new Set;for(let x=0;x<a;x++){let e,t;if(v){e=Do({...this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:u,deviceRect:v,cullRect:b,effects:h,pass:`picking:${l}`}),deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:v})}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&c&&this.depthFBO){const{pickedColors:i}=this._drawAndSample({layers:[e.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:b,effects:h,pass:`picking:${l}:z`},!0);i[3]&&(t=i[0])}e.pickedLayer&&x+1<a&&(S.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),w=Uo({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:l,layers:f,viewports:r,x:i,y:s,z:t,pixelRatio:d});for(const n of w.values())n.layer&&E.push(n);if(!e.pickedColor)break}for(const x of S)x.restorePickingColors();return{result:E,emptyInfo:w.get(null)}}_pickVisibleObjects(e){let{layers:t,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:h}=e;const d=this._getPickable(t);if(!d||0===r.length)return[];this._resizeBuffer();const f=this.device.canvasContext.cssToDeviceRatio(),p=this.device.canvasContext.cssToDevicePixels([i,s],!0),g=p.x,m=p.y+p.height,_=this.device.canvasContext.cssToDevicePixels([i+o,s+a],!0),y=_.x+_.width,v=_.y,b={x:g,y:v,width:y-g,height:m-v},w=function(e){let{pickedColors:t,decodePickingColor:n}=e;const r=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const e=t.slice(i,i+4),s=e.join(",");if(!r.has(s)){const t=n(e);t?r.set(s,{...t,color:e}):Pe.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(r.values())}(this._drawAndSample({layers:d,views:n,viewports:r,onViewportActive:u,deviceRect:b,cullRect:{x:i,y:s,width:o,height:a},effects:h,pass:`picking:${l}`})),E=new Map,S=[],x=Number.isFinite(c);for(let T=0;T<w.length&&!(x&&S.length>=c);T++){const e=w[T];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:f};t=zo({layer:e.pickedLayer,info:t,mode:l});const n=t.layer.id;E.has(n)||E.set(n,new Set);const r=E.get(n),o=t.object??t.index;r.has(o)||(r.add(o),S.push(t))}return S}_drawAndSample(e){let{layers:t,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l}=e,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const u=c?this.depthFBO:this.pickingFBO,h={layers:t,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{},isPicking:!0};for(const y of a)y.useInPicking&&(h.preRenderStats[y.id]=y.preRender(h));const{decodePickingColor:d}=this.pickLayersPass.render(h),{x:f,y:p,width:g,height:m}=s,_=new(c?Float32Array:Uint8Array)(g*m*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:f,sourceY:p,sourceWidth:g,sourceHeight:m,target:_}),{pickedColors:_,decodePickingColor:d}}_getPickingRect(e){let{deviceX:t,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}=e;const o=Math.max(0,t-r),a=Math.max(0,n-r),l=Math.min(i,t+r+1)-o,c=Math.min(s,n+r+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const Vo={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},jo="top-left",Wo="__root";class $o{constructor(e){let{deck:t,parentElement:n}=e;this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!ls(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find((t=>t.id===e.id))||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const t={};for(const n of this.resolvedWidgets)t[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)t[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const e=t[n.id];e?e.viewId!==n.viewId||e.placement!==n.placement?(this._remove(e),this._add(n)):n!==e&&(e.setProps(n.props),n=e):this._add(n),t[n.id]=null,this.resolvedWidgets.push(n)}for(const n in t){const e=t[n];e&&this._remove(e)}this.widgets=e}_add(e){const{viewId:t=null,placement:n=jo}=e,r=e.onAdd({deck:this.deck,viewId:t});r&&this._getContainer(t,n).append(r),e._element=r}_remove(e){e.onRemove?.(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,t){const n=e||Wo;let r=this.containers[n];r||(r=document.createElement("div"),r.style.pointerEvents="none",r.style.position="absolute",r.style.overflow="hidden",this.parentElement?.append(r),this.containers[n]=r);let i=r.querySelector(`.${t}`);return i||(i=document.createElement("div"),i.className=t,i.style.position="absolute",i.style.zIndex="2",Object.assign(i.style,Vo[t]),r.append(i)),i}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const n in this.containers){const r=this.lastViewports[n]||null,i=n===Wo||r,s=this.containers[n];i?(s.style.display="block",s.style.left=`${r?r.x:0}px`,s.style.top=`${r?r.y:0}px`,s.style.width=`${r?r.width:e}px`,s.style.height=`${r?r.height:t}px`):s.style.display="none"}}onRedraw(e){let{viewports:t,layers:n}=e;const r=t.reduce(((e,t)=>(e[t.id]=t,e)),{});for(const i of this.getWidgets()){const{viewId:e}=i;if(e){const t=r[e];t&&(i.onViewportChange&&i.onViewportChange(t),i.onRedraw?.({viewports:[t],layers:n}))}else{if(i.onViewportChange)for(const e of t)i.onViewportChange(e);i.onRedraw?.({viewports:t,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,t){for(const n of this.getWidgets()){const{viewId:r}=n;r&&r!==e.viewport?.id||n.onHover?.(e,t)}}onEvent(e,t){const n=Ji[t.type];if(n)for(const r of this.getWidgets()){const{viewId:i}=r;i&&i!==e.viewport?.id||r[n]?.(e,t)}}}const Ho={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Xo{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd(e){let{deck:t}=e;const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,Ho),this.deck=t,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,n=t&&t.props.getTooltip;if(!n)return;const r=n(e);this.lastViewport=e.viewport,this.setTooltip(r,e.x,e.y)}setTooltip(e,t,n){const r=this.element;if(r){if("string"===typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className)}this.isVisible=!0,r.style.display="block",r.style.transform=`translate(${t}px, ${n}px)`,e&&"object"===typeof e&&"style"in e&&Object.assign(r.style,e.style)}}}const qo=globalThis.loaders?.parseImageNode,Ko="undefined"!==typeof Image,Yo="undefined"!==typeof ImageBitmap,Zo=Boolean(qo),Qo=!!ht||Zo;function Jo(e){const t=ta(e);if(!t)throw new Error("Not an image");return t}function ea(e){switch(Jo(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function ta(e){return"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&e instanceof Image?"image":e&&"object"===typeof e&&e.data&&e.width&&e.height?"data":null}const na=/^data:image\/svg\+xml/,ra=/\.svg((\?|#).*)?$/;function ia(e){return e&&(na.test(e)||ra.test(e))}function sa(e,t){if(ia(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function oa(e,t,n){const r=function(e,t){if(ia(t)){let t=(new TextDecoder).decode(e);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(t)}`}return sa(e,t)}(e,n),i=self.URL||self.webkitURL,s="string"!==typeof r&&i.createObjectURL(r);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((e,t)=>{try{n.onload=()=>e(n),n.onerror=e=>{const n=e instanceof Error?e.message:"error";t(new Error(n))}}catch(r){t(r)}}))}(s||r,t)}finally{s&&i.revokeObjectURL(s)}}const aa={};let la=!0;async function ca(e,t,n){let r;if(ia(n)){r=await oa(e,t,n)}else r=sa(e,n);const i=t&&t.imagebitmap;return await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e){for(const t in e||aa)return!1;return!0}(t)&&la||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(n){console.warn(n),la=!1}return await createImageBitmap(e)}(r,i)}function ua(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=(i=t,[...i].map((e=>e.charCodeAt(0))));var i;for(let s=0;s<r.length;++s)if(r[s]!==e[s+n])return!1;return!0}(e,"ftyp",4)?0===(96&e[8])?null:function(e){switch((t=e,n=8,r=12,String.fromCharCode(...t.slice(n,r))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,n,r}(e):null}const ha=!1,da=!0;function fa(e){const t=pa(e);return function(e){const t=pa(e),n=t.byteLength>=24&&2303741511===t.getUint32(0,ha);if(!n)return null;return{mimeType:"image/png",width:t.getUint32(16,ha),height:t.getUint32(20,ha)}}(t)||function(e){const t=pa(e),n=t.byteLength>=3&&65496===t.getUint16(0,ha)&&255===t.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:i}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let s=2;for(;s+9<t.byteLength;){const e=t.getUint16(s,ha);if(i.has(e))return{mimeType:"image/jpeg",height:t.getUint16(s+5,ha),width:t.getUint16(s+7,ha)};if(!r.has(e))return null;s+=2,s+=t.getUint16(s,ha)}return null}(t)||function(e){const t=pa(e),n=t.byteLength>=10&&1195984440===t.getUint32(0,ha);if(!n)return null;return{mimeType:"image/gif",width:t.getUint16(6,da),height:t.getUint16(8,da)}}(t)||function(e){const t=pa(e),n=t.byteLength>=14&&16973===t.getUint16(0,ha)&&t.getUint32(2,da)===t.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:t.getUint32(18,da),height:t.getUint32(22,da)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=ua(t);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(t)}function pa(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const ga={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:"4.3.2",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,n){const r=((t=t||{}).image||{}).type||"auto",{url:i}=n||{};let s;switch(function(e){switch(e){case"auto":case"data":return function(){if(Yo)return"imagebitmap";if(Ko)return"image";if(Qo)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return Yo||Ko||Qo;case"imagebitmap":return Yo;case"image":return Ko;case"data":return Qo;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}(e),e}}(r)){case"imagebitmap":s=await ca(e,t,i);break;case"image":s=await oa(e,t,i);break;case"data":s=await async function(e){const{mimeType:t}=fa(e)||{},n=globalThis.loaders?.parseImageNode;return He(n),await n(e,t)}(e);break;default:He(!1)}return"data"===r&&(s=ea(s)),s},tests:[e=>Boolean(fa(new DataView(e)))],options:{image:{type:"auto",decode:!0}}};const ma={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse};const _a=function(){const e="9.1.1",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error(`deck.gl - multiple versions detected: ${t} vs ${e}`);return t||(Pe.log(1,`deck.gl ${e}`)(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:Pe,_registerLoggers:Me},function(e){const t=nn();e=Array.isArray(e)?e:[e];for(const n of e){const e=qe(n);t.find((t=>e===t))||t.unshift(e)}}([ma,[ga,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}();const ya=new class{stats=(()=>new Map)();getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new Be({id:e})),this.stats.get(e)}},va=new Te({id:"luma.gl"}),ba={};function wa(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";ba[e]=ba[e]||1;return`${e}-${ba[e]++}`}class Ea{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=(()=>new Set)();constructor(e,t,n){if(!e)throw new Error("no device");this._device=e,this.props=function(e,t){const n={...t};for(const r in e)void 0!==e[r]&&(n[r]=e[r]);return n}(t,n);const r="undefined"!==this.props.id?this.props.id:wa(this[Symbol.toStringTag]);this.props.id=r,this.id=r,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}}class Sa extends Ea{static defaultProps={...Ea.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,t){const n={...t};(t.usage||0)&Sa.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?n.indexType="uint32":t.data instanceof Uint16Array&&(n.indexType="uint16")),delete n.data,super(e,n,Sa.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}readSyncWebGL(e,t){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=(()=>new ArrayBuffer(0))();_setDebugData(e,t,n){const r=ArrayBuffer.isView(e)?e.buffer:e,i=Math.min(e?e.byteLength:n,Sa.DEBUG_DATA_MAX_LENGTH);null===r?this.debugData=new ArrayBuffer(i):0===t&&n===r.byteLength?this.debugData=r.slice(0,i):this.debugData=r.slice(t,t+i)}}function xa(e){const t=function(e){const t=Aa[e];return t}(Ta[e]),n=e.includes("norm"),r=!n&&!e.startsWith("float"),i=e.startsWith("s");return{dataType:Ta[e],byteLength:t,integer:r,signed:i,normalized:n}}const Ta={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},Aa={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},Ca="texture-compression-bc",Ra="texture-compression-astc",Pa="texture-compression-etc2",ka="texture-compression-pvrtc-webgl",Ma="texture-compression-atc-webgl",La="float32-renderable-webgl",Ia="float16-renderable-webgl",Oa="snorm8-renderable-webgl",Na="norm16-renderable-webgl",Fa="snorm16-renderable-webgl",Da="float32-filterable",Ba="float16-filterable-webgl";function Ua(e){const t=za[e];if(!t)throw new Error(`Unsupported texture format ${e}`);return t}const za={r8unorm:{},r8snorm:{render:Oa},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:Oa},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:Ia,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:Na},"r16snorm-webgl":{f:Fa},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:Oa},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:Ia,filter:Ba},"rg16unorm-webgl":{render:Na},"rg16snorm-webgl":{render:Fa},r32uint:{},r32sint:{},r32float:{render:La,filter:Da},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:La},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:Na},"rgb16snorm-webgl":{f:Na},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:Da},rgba16uint:{},rgba16sint:{},rgba16float:{render:Ia,filter:Ba},"rgba16unorm-webgl":{render:Na},"rgba16snorm-webgl":{render:Fa},"rgb32float-webgl":{render:La,filter:Da},rgba32uint:{},rgba32sint:{},rgba32float:{render:La,filter:Da},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:Ca},"bc1-rgb-unorm-srgb-webgl":{f:Ca},"bc1-rgba-unorm":{f:Ca},"bc1-rgba-unorm-srgb":{f:Ca},"bc2-rgba-unorm":{f:Ca},"bc2-rgba-unorm-srgb":{f:Ca},"bc3-rgba-unorm":{f:Ca},"bc3-rgba-unorm-srgb":{f:Ca},"bc4-r-unorm":{f:Ca},"bc4-r-snorm":{f:Ca},"bc5-rg-unorm":{f:Ca},"bc5-rg-snorm":{f:Ca},"bc6h-rgb-ufloat":{f:Ca},"bc6h-rgb-float":{f:Ca},"bc7-rgba-unorm":{f:Ca},"bc7-rgba-unorm-srgb":{f:Ca},"etc2-rgb8unorm":{f:Pa},"etc2-rgb8unorm-srgb":{f:Pa},"etc2-rgb8a1unorm":{f:Pa},"etc2-rgb8a1unorm-srgb":{f:Pa},"etc2-rgba8unorm":{f:Pa},"etc2-rgba8unorm-srgb":{f:Pa},"eac-r11unorm":{f:Pa},"eac-r11snorm":{f:Pa},"eac-rg11unorm":{f:Pa},"eac-rg11snorm":{f:Pa},"astc-4x4-unorm":{f:Ra},"astc-4x4-unorm-srgb":{f:Ra},"astc-5x4-unorm":{f:Ra},"astc-5x4-unorm-srgb":{f:Ra},"astc-5x5-unorm":{f:Ra},"astc-5x5-unorm-srgb":{f:Ra},"astc-6x5-unorm":{f:Ra},"astc-6x5-unorm-srgb":{f:Ra},"astc-6x6-unorm":{f:Ra},"astc-6x6-unorm-srgb":{f:Ra},"astc-8x5-unorm":{f:Ra},"astc-8x5-unorm-srgb":{f:Ra},"astc-8x6-unorm":{f:Ra},"astc-8x6-unorm-srgb":{f:Ra},"astc-8x8-unorm":{f:Ra},"astc-8x8-unorm-srgb":{f:Ra},"astc-10x5-unorm":{f:Ra},"astc-10x5-unorm-srgb":{f:Ra},"astc-10x6-unorm":{f:Ra},"astc-10x6-unorm-srgb":{f:Ra},"astc-10x8-unorm":{f:Ra},"astc-10x8-unorm-srgb":{f:Ra},"astc-10x10-unorm":{f:Ra},"astc-10x10-unorm-srgb":{f:Ra},"astc-12x10-unorm":{f:Ra},"astc-12x10-unorm-srgb":{f:Ra},"astc-12x12-unorm":{f:Ra},"astc-12x12-unorm-srgb":{f:Ra},"pvrtc-rgb4unorm-webgl":{f:ka},"pvrtc-rgba4unorm-webgl":{f:ka},"pvrtc-rbg2unorm-webgl":{f:ka},"pvrtc-rgba2unorm-webgl":{f:ka},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:Ma},"atc-rgba-unorm-webgl":{f:Ma},"atc-rgbai-unorm-webgl":{f:Ma}},Ga=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],Va=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function ja(e){return Ga.some((t=>e.startsWith(t)))}function Wa(e){let t=function(e){const t=Ua(e),n=t.bytesPerPixel||1,r=t.bitsPerChannel||[8,8,8,8];delete t.bitsPerChannel,delete t.bytesPerPixel,delete t.f,delete t.render,delete t.filter,delete t.blend,delete t.store;const i={...t,format:e,attachment:t.attachment||"color",channels:t.channels||"r",components:t.components||t.channels?.length||1,bytesPerPixel:n,bitsPerChannel:r,dataType:t.dataType||"uint8",srgb:t.srgb??!1,packed:t.packed??!1,webgl:t.webgl??!1,integer:t.integer??!1,signed:t.signed??!1,normalized:t.normalized??!1,compressed:t.compressed??!1};return i}(e);if(ja(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;const n=function(e){const t=/.*-(\d+)x(\d+)-.*/.exec(e);if(t){const[,e,n]=t;return{blockWidth:Number(e),blockHeight:Number(n)}}return null}(e);n&&(t.blockWidth=n.blockWidth,t.blockHeight=n.blockHeight)}const n=Va.exec(e);if(n){const[,r,i,s,o,a]=n,l=xa(`${s}${i}`),c=8*l.byteLength,u=r.length,h=[c,u>=2?c:0,u>=3?c:0,u>=4?c:0];t={format:e,attachment:t.attachment,dataType:l.dataType,components:u,channels:r,integer:l.integer,signed:l.signed,normalized:l.normalized,bitsPerChannel:h,bytesPerPixel:l.byteLength*r.length,packed:t.packed,srgb:t.srgb},"-webgl"===a&&(t.webgl=!0),"-srgb"===o&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}class $a{}class Ha{features;disabledFeatures;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class Xa{static defaultProps=(()=>({id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>va.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:va.get("debug")||void 0,debugShaders:va.get("debug-shaders")||void 0,debugFramebuffers:Boolean(va.get("debug-framebuffers")),debugWebGL:Boolean(va.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0}))();get[Symbol.toStringTag](){return"Device"}constructor(e){this.props={...Xa.defaultProps,...e},this.id=this.props.id||wa(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=(()=>ya)();timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities(e){const t=function(e){const t=Ua(e),n={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},r=Wa(e),i=e.startsWith("depth")||e.startsWith("stencil"),s=r?.signed,o=r?.integer,a=r?.webgl;return n.render&&=!s,n.filter&&=!i&&!s&&!o&&!a,n}(e),n=e=>("string"===typeof e?this.features.has(e):e)??!0,r=n(t.create),i={format:e,create:r,render:r&&n(t.render),filter:r&&n(t.filter),blend:r&&n(t.blend),store:r&&n(t.store)};return this._getDeviceSpecificTextureFormatCapabilities(i)}isTextureFormatSupported(e,t){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return ja(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return!0===e.createCanvasContext?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};return(e.usage||0)&Sa.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":va.warn("indices buffer content must be of integer type")()),t}}const qa=ue()&&"undefined"!==typeof document,Ka="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class Ya{static defaultProps=(()=>({...Xa.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0}))();static pageLoaded=(()=>function(){if(qa&&"complete"===document.readyState||"undefined"===typeof window)return Promise.resolve();return new Promise((e=>{window.addEventListener("load",(()=>e()))}))}().then((()=>{va.probe(2,"DOM is loaded")()})))();stats=(()=>ya)();log=(()=>va)();VERSION="9.1.2";spector;preregisteredAdapters=(()=>new Map)();constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw va.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),va.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");va.error("This version of luma.gl has already been initialized")()}va.log(1,`${this.VERSION} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=this}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this.getAdapterMap(e);return Array.from(t).map((e=>{let[,t]=e;return t})).filter((e=>e.isSupported?.())).map((e=>e.type))}getBestAvailableAdapter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this.getAdapterMap(e);return t.get("webgpu")?.isSupported?.()?"webgpu":t.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(e){Object.assign(Ya.defaultProps,e)}async createDevice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e={...Ya.defaultProps,...e},e.waitForPageLoad&&await Ya.pageLoaded;const t=this.getAdapterMap(e.adapters);let n=e.type||"";"best-available"===n&&(n=this.getBestAvailableAdapter(e.adapters)||n);const r=(this.getAdapterMap(e.adapters)||t).get(n),i=await(r?.create?.(e));if(i)return i;throw new Error(Ka)}async attachDevice(e){const t=this.getAdapterMap(e.adapters);let n="";e.handle instanceof WebGL2RenderingContext&&(n="webgl"),e.createCanvasContext&&await Ya.pageLoaded,null===e.handle&&(n="unknown");const r=t.get(n),i=await(r?.attach?.(null));if(i)return i;throw new Error(Ka)}enforceWebGL2(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=this.getAdapterMap(t).get("webgl");n||va.warn("enforceWebGL2: webgl adapter not found")(),n?.enforceWebGL2?.(e)}getAdapterMap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Map(this.preregisteredAdapters);for(const n of e)t.set(n.type,n);return t}registerDevices(e){va.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const t of e){const e=t.adapter;e&&this.preregisteredAdapters.set(e.type,e)}}}const Za=new Ya;class Qa{}const Ja={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},el=(e,t,n)=>t?e.enable(n):e.disable(n),tl=(e,t,n)=>e.hint(n,t),nl=(e,t,n)=>e.pixelStorei(n,t),rl=(e,t,n)=>{const r=36006===n?36009:36008;return e.bindFramebuffer(r,t)},il=(e,t,n)=>{const r={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];e.bindBuffer(r,t)};function sl(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const ol={3042:el,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:el,2885:(e,t)=>e.cullFace(t),2929:el,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:el,35723:tl,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>e.bindTransformFeedback?.(36386,t),34229:(e,t)=>e.bindVertexArray(t),36006:rl,36010:rl,34964:il,36662:il,36663:il,35053:il,35055:il,2886:(e,t)=>e.frontFace(t),33170:tl,2849:(e,t)=>e.lineWidth(t),32823:el,32824:"polygonOffset",10752:"polygonOffset",35977:el,32926:el,32928:el,32938:"sampleCoverage",32939:"sampleCoverage",3089:el,3088:(e,t)=>e.scissor(...t),2960:el,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:el,10754:el,12288:el,12289:el,12290:el,12291:el,12292:el,12293:el,12294:el,12295:el,3333:nl,3317:nl,37440:nl,37441:nl,37443:nl,3330:nl,3332:nl,3331:nl,3314:nl,32878:nl,3316:nl,3315:nl,32877:nl,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const n="number"===typeof t?[t,t]:t;e.blendEquationSeparate(...n)},blendFunc:(e,t)=>{const n=2===t?.length?[...t,...t]:t;e.blendFuncSeparate(...n)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(t[0],t[1]||!1),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=sl(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,r)},stencilFunc:(e,t)=>{t=sl(t)&&3===t.length?[...t,...t]:t;const[n,r,i,s,o,a]=t;e.stencilFuncSeparate(1028,n,r,i),e.stencilFuncSeparate(1029,s,o,a)},stencilOp:(e,t)=>{t=sl(t)&&3===t.length?[...t,...t]:t;const[n,r,i,s,o,a]=t;e.stencilOpSeparate(1028,n,r,i),e.stencilOpSeparate(1029,s,o,a)},viewport:(e,t)=>e.viewport(...t)};function al(e,t,n){return void 0!==t[e]?t[e]:n[e]}const ll={blendEquation:(e,t,n)=>e.blendEquationSeparate(al(32777,t,n),al(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(al(32969,t,n),al(32968,t,n),al(32971,t,n),al(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(al(32824,t,n),al(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(al(32938,t,n),al(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,al(2962,t,n),al(2967,t,n),al(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,al(34816,t,n),al(36003,t,n),al(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,al(2964,t,n),al(2965,t,n),al(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,al(34817,t,n),al(34818,t,n),al(34819,t,n))},cl={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,n)=>e({36007:n}),bindTransformFeedback:(e,t,n)=>e({36389:n}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},bindBuffer:(e,t,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return r?e({[r]:n}):{valueChanged:!0}},blendColor:(e,t,n,r,i)=>e({32773:new Float32Array([t,n,r,i])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,r,i)=>e({32969:t,32968:n,32971:r,32970:i}),clearColor:(e,t,n,r,i)=>e({3106:new Float32Array([t,n,r,i])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,r,i)=>e({3107:[t,n,r,i]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,r,i)=>e({3088:new Int32Array([t,n,r,i])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,r)=>e({2962:t,2967:n,2963:r,34816:t,36003:n,36004:r}),stencilFuncSeparate:(e,t,n,r,i)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:r,[1028===t?2963:36004]:i}),stencilOp:(e,t,n,r)=>e({2964:t,2965:n,2966:r,34817:t,34818:n,34819:r}),stencilOpSeparate:(e,t,n,r,i)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:r,[1028===t?2966:34819]:i}),viewport:(e,t,n,r,i)=>e({2978:[t,n,r,i]})},ul=(e,t)=>e.isEnabled(t),hl={3042:ul,2884:ul,2929:ul,3024:ul,32823:ul,32926:ul,32928:ul,3089:ul,2960:ul,35977:ul},dl=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function fl(e,t){if(function(e){for(const t in e)return!1;return!0}(t))return;const n={};for(const i in t){const r=Number(i),s=ol[i];s&&("string"===typeof s?n[s]=!0:s(e,t[i],r))}const r=e.state&&e.state.cache;if(r)for(const i in n){(0,ll[i])(e,t,r)}}function pl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ja;if("number"===typeof t){const n=t,r=hl[n];return r?r(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),r={};for(const i of n){const t=hl[i];r[i]=t?t(e,Number(i)):e.getParameter(Number(i))}return r}function gl(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}class ml{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,t){this.gl=e,this.log=t?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];fl(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t.copyState?pl(e):Object.assign({},Ja),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){const r=ml.get(e);r.program!==n&&(t(n),r.program=n)}}(e);for(const n in cl){yl(e,n,cl[n])}_l(e,"getParameter"),_l(e,"isEnabled")}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const i in e){const s=e[i],o=this.cache[i];gl(s,o)||(n=!0,t=o,r&&!(i in r)&&(r[i]=o),this.cache[i]=s)}return{valueChanged:n,oldValue:t}}}function _l(e,t){const n=e[t].bind(e);e[t]=function(t){if(void 0===t||dl.has(t))return n(t);const r=ml.get(e);return t in r.cache||(r.cache[t]=n(t)),r.enable?r.cache[t]:n(t)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function yl(e,t,n){if(!e[t])return;const r=e[t].bind(e);e[t]=function(){const t=ml.get(e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];const{valueChanged:a,oldValue:l}=n(t._updateCache,...s);return a&&r(...s),l},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}function vl(e,t,n){return void 0===n[t]&&(n[t]=e.getExtension(t)||null),n[t]}function bl(e,t){const n=e.getParameter(7936),r=e.getParameter(7937);vl(e,"WEBGL_debug_renderer_info",t);const i=t.WEBGL_debug_renderer_info,s=e.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936)||n,o=e.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937)||r,a=e.getParameter(7938),l=wl(s,o),c=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(s,o),u=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(wl(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(s,o);return{type:"webgl",gpu:l,gpuType:u,gpuBackend:c,vendor:s,renderer:o,version:a,shadingLanguage:"glsl",shadingLanguageVersion:300}}function wl(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function El(e){switch(e){case"uint8":case"unorm8":return 5121;case"sint8":case"snorm8":return 5120;case"uint16":case"unorm16":return 5123;case"sint16":case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}const Sl="WEBGL_compressed_texture_s3tc",xl="WEBGL_compressed_texture_s3tc_srgb",Tl="EXT_texture_compression_rgtc",Al="EXT_texture_compression_bptc",Cl="EXT_texture_norm16",Rl="EXT_render_snorm",Pl={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Rl],"norm16-renderable-webgl":[Cl],"snorm16-renderable-webgl":[Cl,Rl],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Sl,xl,Tl,Al],"texture-compression-bc5-webgl":[Tl],"texture-compression-bc7-webgl":[Al],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};const kl={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:"EXT_color_buffer_float",dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Sl},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:xl},"bc1-rgba-unorm":{gl:33777,x:Sl},"bc1-rgba-unorm-srgb":{gl:35916,x:xl},"bc2-rgba-unorm":{gl:33778,x:Sl},"bc2-rgba-unorm-srgb":{gl:35918,x:xl},"bc3-rgba-unorm":{gl:33779,x:Sl},"bc3-rgba-unorm-srgb":{gl:35919,x:xl},"bc4-r-unorm":{gl:36283,x:Tl},"bc4-r-snorm":{gl:36284,x:Tl},"bc5-rg-unorm":{gl:36285,x:Tl},"bc5-rg-snorm":{gl:36286,x:Tl},"bc6h-rgb-ufloat":{gl:36495,x:Al},"bc6h-rgb-float":{gl:36494,x:Al},"bc7-rgba-unorm":{gl:36492,x:Al},"bc7-rgba-unorm-srgb":{gl:36493,x:Al},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function Ml(e){const t=kl[e],n=function(e){const t=kl[e],n=t?.gl;if(void 0===n)throw new Error(`Unsupported texture format ${e}`);return n}(e),r=Wa(e);return{internalFormat:n,format:t?.dataFormat||Ll(r.channels,r.integer,r.normalized,n),type:r.dataType?El(r.dataType):t?.types?.[0]||5121,compressed:r.compressed||!1}}function Ll(e,t,n,r){if(6408===r||6407===r)return r;switch(e){case"r":return t&&!n?36244:6403;case"rg":return t&&!n?33320:33319;case"rgb":return t&&!n?36248:6407;case"rgba":return t&&!n?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}const Il={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class Ol extends Ha{gl;extensions;testedFeatures=(()=>new Set)();constructor(e,t,n){super([],n),this.gl=e,this.extensions=t,vl(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){return!this.disabledFeatures?.[e]&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),function(e){return e in Pl}(e)&&function(e,t,n){return(Pl[t]||[]).every((t=>vl(e,t,n)))}(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter((e=>"polygon-mode-webgl"!==e));for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(Il),...Object.keys(Pl)]}getWebGLFeature(e){const t=Il[e];return"string"===typeof t?Boolean(vl(this.gl,t,this.extensions)):Boolean(t)}}class Nl extends $a{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class Fl{static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...Fl.defaultProps,...e},e=this.props,!ue())return this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,void(this.canvas=null);if(e.canvas)"string"===typeof e.canvas?this.canvas=function(e){const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}(e.canvas):this.canvas=e.canvas;else{const t=function(e){const{width:t,height:n}=e,r=document.createElement("canvas");return r.id=wa("lumagl-auto-created-canvas"),r.width=t||1,r.height=n||1,r.style.width=Number.isFinite(t)?`${t}px`:"100%",r.style.height=Number.isFinite(n)?`${n}px`:"100%",r}(e),n=function(e){if("string"===typeof e){const t=document.getElementById(e);if(!t)throw new Error(`${e} is not an HTML element`);return t}if(e)return e;return document.body}(e?.container||null);n.insertBefore(t,n.firstChild),this.canvas=t,e?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver((e=>{for(const t of e)t.target===this.canvas&&this.update()})),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){if("undefined"!==typeof OffscreenCanvas&&this.canvas instanceof OffscreenCanvas)return 1;if(!(e=void 0===e?this.props.useDevicePixels:e)||e<=0)return 1;if(!0===e){return"undefined"!==typeof window&&window.devicePixelRatio||1}return e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),t=this.canvas;return t.parentElement?[t.clientWidth*e,t.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,t]=this.getPixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),t=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return t?e/t:1}catch{return 1}}cssToDevicePixels(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.cssToDeviceRatio(),[r,i]=this.getDrawingBufferSize();return function(e,t,n,r,i){const s=e,o=Dl(s[0],t,n);let a=Bl(s[1],t,r,i),l=Dl(s[0]+1,t,n);const c=l===n-1?l:l-1;let u;l=Bl(s[1]+1,t,r,i),i?(l=0===l?l:l+1,u=a,a=l):u=l===r-1?l:l-1;return{x:o,y:a,width:Math.max(c-o+1,1),height:Math.max(u-a+1,1)}}(e,n,r,i,t)}setDevicePixelRatio(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.htmlCanvas)return;let n="width"in t?t.width:this.htmlCanvas.clientWidth,r="height"in t?t.height:this.htmlCanvas.clientHeight;n&&r||(va.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=this.htmlCanvas.width||1,r=this.htmlCanvas.height||1);const i=this._canvasSizeInfo;if(i.clientWidth!==n||i.clientHeight!==r||i.devicePixelRatio!==e){let t=e;const i=Math.floor(n*t),s=Math.floor(r*t);this.htmlCanvas.width=i,this.htmlCanvas.height=s;if(this.device.gl){const[o,a]=this.getDrawingBufferSize();o===i&&a===s||(t=Math.min(o/n,a/r),this.htmlCanvas.width=Math.floor(n*t),this.htmlCanvas.height=Math.floor(r*t),va.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=r,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;if(!e)throw new Error("canvas size");return[e.drawingBufferWidth,e.drawingBufferHeight]}_setAutoCreatedCanvasId(e){"lumagl-auto-created-canvas"===this.htmlCanvas?.id&&(this.htmlCanvas.id=e)}}function Dl(e,t,n){return Math.min(Math.round(e*t),n-1)}function Bl(e,t,n,r){return r?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}class Ul extends Ea{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps=(()=>({...Ea.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0}))();get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor(e,t){if(super(e,t=Ul.normalizeProps(e,t),Ul.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,void 0===this.props.width||void 0===this.props.height){const e=Ul.getTextureDataSize(this.props.data);this.width=e?.width||1,this.height=e?.height||1}this.props.mipmaps&&void 0===this.props.mipLevels&&(this.props.mipLevels="pyramid"),this.mipLevels="pyramid"===this.props.mipLevels?Ul.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture({...this.props,...e})}static isExternalImage(e){return"undefined"!==typeof ImageData&&e instanceof ImageData||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if("undefined"!==typeof ImageData&&e instanceof ImageData||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if("undefined"!==typeof VideoFrame&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const t=e?.data;return ArrayBuffer.isView(t)}static getTextureDataSize(e){if(!e)return null;if(ArrayBuffer.isView(e))return null;if(Array.isArray(e))return Ul.getTextureDataSize(e[0]);if(Ul.isExternalImage(e))return Ul.getExternalImageSize(e);if(e&&"object"===typeof e&&e.constructor===Object){const t=Object.values(e)[0];return{width:t.width,height:t.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,t){let n;return n=ArrayBuffer.isView(e)?[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?e:[e],n}static getMipLevelCount(e,t){return Math.floor(Math.log2(Math.max(e,t)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps(e,t){const n={...t},r=e?.props?._resourceDefaults?.texture||{};Object.assign(n,r);const{width:i,height:s}=n;return"number"===typeof i&&(n.width=Math.max(1,Math.ceil(i))),"number"===typeof s&&(n.height=Math.max(1,Math.ceil(s))),n}}class zl extends Ea{static defaultProps={...Ea.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},zl.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map((t=>t.texture.clone(e))),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:t,depthStencilAttachment:n})}resize(e){let t=!e;if(e){const[n,r]=Array.isArray(e)?e:[e.width,e.height];t=t||r!==this.height||n!==this.width,this.width=n,this.height=r}t&&(va.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(((e,t)=>{if("string"===typeof e){const n=this.createColorTexture(e,t);return this.attachResource(n),n.view}return e instanceof Ul?e.view:e}));const e=this.props.depthStencilAttachment;if(e)if("string"===typeof e){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else this.depthStencilAttachment=e instanceof Ul?e.view:e}createColorTexture(e,t){return this.device.createTexture({id:`${this.id}-color-attachment-${t}`,usage:Ul.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:Ul.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,t){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const r=this.colorAttachments[n].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=r.view,this.attachResource(r.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}}class Gl extends zl{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,t){super(e,t);const n=null===t.handle;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const e=this.colorAttachments[t];if(e){const n=36064+t;this._attachTextureView(n,e)}}if(this.depthStencilAttachment){const e=function(e){switch(Wa(e).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${e}`)}}(this.depthStencilAttachment.props.format);this._attachTextureView(e,this.depthStencilAttachment)}if(this.device.props.debug){const e=this.gl.checkFramebufferStatus(36160);if(36053!==e)throw new Error(`Framebuffer ${function(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${e}`}}(e)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,t){const{gl:n}=this.device,{texture:r}=t,i=t.props.baseMipLevel,s=t.props.baseArrayLayer;switch(n.bindTexture(r.glTarget,r.handle),r.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,r.handle,i,s);break;case 34067:const t=function(e){return e<34069?e+34069:e}(s);n.framebufferTexture2D(36160,e,t,r.handle,i);break;case 3553:n.framebufferTexture2D(36160,e,3553,r.handle,i);break;default:throw new Error("Illegal texture type")}n.bindTexture(r.glTarget,null)}}class Vl extends Fl{device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Gl(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl)if(this.canvas){const t=this.getDevicePixelRatio(e?.useDevicePixels);this.setDevicePixelRatio(t,e)}else;}commit(){}}async function jl(e,t){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",e),t&&(r.id=t),new Promise(((t,i)=>{r.onload=t,r.onerror=t=>i(new Error(`Unable to load script '${e}': ${t}`)),n.appendChild(r)}))}let Wl=null,$l=!1;const Hl={debugSpectorJS:va.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};var Xl;!function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"}(Xl||(Xl={}));function ql(e){return e.luma=e.luma||{},e.luma}function Kl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.debugWebGL||t.traceWebGL?function(e,t){if(!globalThis.WebGLDebugUtils)return va.warn("webgl-debug not loaded")(),e;const n=ql(e);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...Xl,...e});const r=globalThis.WebGLDebugUtils.makeDebugContext(e,Zl.bind(null,t),Ql.bind(null,t));for(const o in Xl)o in r||"number"!==typeof Xl[o]||(r[o]=Xl[o]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.setPrototypeOf(i,r);const s=Object.create(i);return n.realContext=e,n.debugContext=s,s.debug=!0,s}(e,t):function(e){const t=ql(e);return t.realContext?t.realContext:e}(e)}function Yl(e,t){t=Array.from(t).map((e=>void 0===e?"undefined":e));let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${e}(${n})`}function Zl(e,t,n,r){r=Array.from(r).map((e=>void 0===e?"undefined":e));const i=`${globalThis.WebGLDebugUtils.glEnumToString(t)} in gl.${n}(${globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r)})`;va.error(i)()}function Ql(e,t,n){let r="";va.level>=1&&(r=Yl(t,n),e.traceWebGL&&va.log(1,r)());for(const i of n)void 0===i&&(r=r||Yl(t,n))}const Jl={};function ec(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";Jl[e]=Jl[e]||1;return`${e}-${Jl[e]++}`}class tc extends Sa{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.device=e,this.gl=this.device.gl;const n="object"===typeof t?t.handle:void 0;this.handle=n||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=function(e){if(e&Sa.INDEX)return 34963;if(e&Sa.VERTEX)return 34962;if(e&Sa.UNIFORM)return 35345;return 34962}(this.props.usage),this.glUsage=function(e){if(e&Sa.INDEX)return 35044;if(e&Sa.VERTEX)return 35044;if(e&Sa.UNIFORM)return 35048;return 35044}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}_initWithData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;const r=this.glTarget;this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.glUsage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,t,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let t=e;0===e&&(t=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,t,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=36663;this.gl.bindBuffer(n,this.handle),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this._setDebugData(e,t,e.byteLength)}async readAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return this.readSyncWebGL(e,t)}readSyncWebGL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;t=t??this.byteLength-e;const n=new Uint8Array(t);return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,0,t),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,t),n}}function nc(e,t,n,r){if(r?.inlineSource){const r=function(e,t,n){let r="";for(let i=t-2;i<=t;i++){const s=e[i-1];void 0!==s&&(r+=rc(s,t,n))}return r}(t,n);return`\n${r}${e.linePos>0?`${" ".repeat(e.linePos+5)}^^^\n`:""}${e.type.toUpperCase()}: ${e.message}\n\n`}const i="error"===e.type?"red":"#8B4000";return r?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function rc(e,t,n){const r=n?.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return`${function(e,t){let n="";for(let r=e.length;r<t;++r)n+=" ";return n+e}(String(t),4)}: ${r}${n?.html?"<br/>":"\n"}`}class ic extends Ea{static defaultProps=(()=>({...Ea.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}))();get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,t){super(e,{id:sc(t={...t,debugShaders:t.debugShaders||e.props.debugShaders||"errors"}),...t},ic.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if("success"===this.compilationStatus)return}const t=await this.getCompilationInfo();"warnings"===e&&0===t?.length||this._displayShaderLog(t)}_displayShaderLog(e){if("undefined"===typeof document||!document?.createElement)return;const t=oc(this.source),n=`${this.stage} ${t}`;let r=function(e,t,n){let r="";const i=t.split(/\r?\n/),s=e.slice().sort(((e,t)=>e.lineNum-t.lineNum));switch(n?.showSourceCode||"no"){case"all":let t=0;for(let e=1;e<=i.length;e++)for(r+=rc(i[e-1],e,n);s.length>t&&s[t].lineNum===e;){const e=s[t++];r+=nc(e,i,e.lineNum,{...n,inlineSource:!1})}return r;case"issues":case"no":for(const s of e)r+=nc(s,i,s.lineNum,{inlineSource:"no"!==n?.showSourceCode});return r}}(e,this.source,{showSourceCode:"all",html:!0});const i=this.getTranslatedSource();i&&(r+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${i}</pre></code>`);const s=document.createElement("Button");s.innerHTML=`\n<h1>Shader Compilation Error in ${n}</h1><br /><br />\n<code style="user-select:text;"><pre>\n${r}\n</pre></code>`,s.style.top="10px",s.style.left="10px",s.style.position="absolute",s.style.zIndex="9999",s.style.width="100%",s.style.textAlign="left",document.body.appendChild(s);const o=document.getElementsByClassName("luma-compiler-log-error");o[0]?.scrollIntoView(),s.onclick=()=>{const e=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(e)}}}function sc(e){return oc(e.source)||e.id||wa(`unnamed ${e.stage}-shader`)}function oc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return n?n[1]:t}function ac(e){const t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}class lc extends ic{device;handle;constructor(e,t){switch(super(e,t),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then((()=>this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?function(e){const t=e.split(/\r?\n/),n=[];for(const r of t){if(r.length<=1)continue;const e=r.split(":");if(2===e.length){const[t,r]=e;n.push({message:r.trim(),type:ac(t),lineNum:0,linePos:0});continue}const[t,i,s,...o]=e;let a=parseInt(s,10);isNaN(a)&&(a=0);let l=parseInt(i,10);isNaN(l)&&(l=0),n.push({message:o.join(":").trim(),type:ac(t),lineNum:a,linePos:l})}return n}(e):[]}getTranslatedSource(){const e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return e?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es\n${e}`;const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),this.device.props.debug){if(this.device.features.has("compilation-status-async-webgl"))va.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),va.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`)}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const e=async e=>await new Promise((t=>setTimeout(t,e)));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}class cc extends Ea{static defaultProps={...Ea.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t=cc.normalizeProps(e,t),cc.defaultProps)}static normalizeProps(e,t){return{...t,...e?.props?._resourceDefaults?.sampler||{}}}}function uc(e,t){const n=e,{gl:r}=n;if(t.cullMode)switch(t.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029)}if(t.frontFace&&r.frontFace(gc("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&r.enable(34383),void 0!==t.depthBias&&(r.enable(32823),r.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const e=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,r=gc("provokingVertex",t.provokingVertex,{first:36429,last:36430});e?.provokingVertexWEBGL(r)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const e=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,r=gc("polygonMode",t.polygonMode,{fill:6914,line:6913});e?.polygonModeWEBGL(1028,r),e?.polygonModeWEBGL(1029,r)}t.polygonOffsetLine&&r.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&r.enable(12288),t.clipDistance1&&r.enable(12289),t.clipDistance2&&r.enable(12290),t.clipDistance3&&r.enable(12291),t.clipDistance4&&r.enable(12292),t.clipDistance5&&r.enable(12293),t.clipDistance6&&r.enable(12294),t.clipDistance7&&r.enable(12295)),void 0!==t.depthWriteEnabled&&r.depthMask(t.depthWriteEnabled),t.depthCompare&&("always"!==t.depthCompare?r.enable(2929):r.disable(2929),r.depthFunc(hc("depthCompare",t.depthCompare))),t.stencilWriteMask){const e=t.stencilWriteMask;r.stencilMaskSeparate(1028,e),r.stencilMaskSeparate(1029,e)}if(t.stencilReadMask&&va.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){const e=t.stencilReadMask||4294967295,n=hc("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,n,0,e),r.stencilFuncSeparate(1029,n,0,e)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const e=dc("stencilPassOperation",t.stencilPassOperation),n=dc("stencilFailOperation",t.stencilFailOperation),i=dc("stencilDepthFailOperation",t.stencilDepthFailOperation);r.stencilOpSeparate(1028,n,i,e),r.stencilOpSeparate(1029,n,i,e)}switch(t.blend){case!0:r.enable(3042);break;case!1:r.disable(3042)}if(t.blendColorOperation||t.blendAlphaOperation){const e=fc("blendColorOperation",t.blendColorOperation||"add"),n=fc("blendAlphaOperation",t.blendAlphaOperation||"add");r.blendEquationSeparate(e,n);const i=pc("blendColorSrcFactor",t.blendColorSrcFactor||"one"),s=pc("blendColorDstFactor",t.blendColorDstFactor||"zero"),o=pc("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),a=pc("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");r.blendFuncSeparate(i,s,o,a)}}function hc(e,t){return gc(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function dc(e,t){return gc(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function fc(e,t){return gc(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function pc(e,t){return gc(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function gc(e,t,n){if(!(t in n))throw new Error(function(e,t){return`Illegal parameter ${t} for ${e}`}(e,t));return n[t]}function mc(e){let t=!0;for(const n in e){t=!1;break}return t}function _c(e){const t={};return e.addressModeU&&(t[10242]=yc(e.addressModeU)),e.addressModeV&&(t[10243]=yc(e.addressModeV)),e.addressModeW&&(t[32882]=yc(e.addressModeW)),e.magFilter&&(t[10240]=vc(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";if(!t)return vc(e);switch(t){case"none":return vc(e);case"nearest":return"nearest"===e?9984:9986;case"linear":return"nearest"===e?9985:9987}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[33082]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[33083]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[34892]=34894),e.compare&&(t[34893]=hc("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function yc(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function vc(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}class bc extends cc{device;handle;parameters;constructor(e,t){super(e,t),this.device=e,this.parameters=_c(t),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[t,n]of Object.entries(e)){const e=Number(t);switch(e){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,e,n);break;default:this.device.gl.samplerParameteri(this.handle,e,n)}}}}class wc extends Ea{static defaultProps=(()=>({...Ea.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}))();get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,wc.defaultProps)}}class Ec extends wc{device;gl;handle;texture;constructor(e,t){super(e,{...Ul.defaultProps,...t}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}function Sc(e){switch(e){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function xc(e,t,n){if(function(e){for(const t in e)return!1;return!0}(t))return n(e);const{nocatch:r=!0}=t,i=ml.get(e);let s;if(i.push(),fl(e,t),r)s=n(e),i.pop();else try{s=n(e)}finally{i.pop()}return s}function Tc(e,t,n,r){const{width:i,height:s}=r,{dimension:o,depth:a=0,mipLevel:l=0}=r,{x:c=0,y:u=0,z:h=0}=r,{glFormat:d,glType:f}=r,p=Cc(r.glTarget,o,a),g=r.flipY?{37440:!0}:{};xc(e,g,(()=>{switch(o){case"2d-array":case"3d":e.bindTexture(p,t),e.texSubImage3D(p,l,c,u,h,i,s,a,d,f,n),e.bindTexture(p,null);break;case"2d":case"cube":e.bindTexture(p,t),e.texSubImage2D(p,l,c,u,i,s,d,f,n),e.bindTexture(p,null);break;default:throw new Error(o)}}))}function Ac(e,t,n){const{dimension:r,width:i,height:s,depth:o=0,mipLevel:a=0,byteOffset:l=0}=n,{x:c=0,y:u=0,z:h=0}=n,{glFormat:d,glType:f,compressed:p}=n,g=Cc(n.glTarget,r,o);switch(r){case"2d-array":case"3d":p?e.compressedTexSubImage3D(g,a,c,u,h,i,s,o,d,t,l):e.texSubImage3D(g,a,c,u,h,i,s,o,d,f,t,l);break;case"2d":case"cube":p?e.compressedTexSubImage2D(g,a,c,u,i,s,d,t,l):e.texSubImage2D(g,a,c,u,i,s,d,f,t,l);break;default:throw new Error(r)}}function Cc(e,t,n){return"cube"===t?34069+n:e}function Rc(e,t){const{sourceX:n=0,sourceY:r=0,sourceAttachment:i=0}=t||{};let{target:s=null,sourceWidth:o,sourceHeight:a,sourceDepth:l,sourceFormat:c,sourceType:u}=t||{};const{framebuffer:h,deleteFramebuffer:d}=Pc(e),{gl:f,handle:p}=h;o||=h.width,a||=h.height;const g=h.colorAttachments[i]?.texture;if(!g)throw new Error(`Invalid framebuffer attachment ${i}`);l=g?.depth||1,c||=g?.glFormat||6408,u||=g?.glType||5121,s=function(e,t,n,r,i){if(e)return e;t||=5121;const s=function(e,t){const{clamped:n=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}(t,{clamped:!1}),o=Sc(n);return new s(r*i*o)}(s,u,c,o,a),u=u||function(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}(s);const m=f.bindFramebuffer(36160,p);return f.readBuffer(36064+i),f.readPixels(n,r,o,a,c,u,s),f.readBuffer(36064),f.bindFramebuffer(36160,m||null),d&&h.destroy(),s}function Pc(e){return e instanceof zl?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:kc(e),deleteFramebuffer:!0}}function kc(e,t){const{device:n,width:r,height:i,id:s}=e;return n.createFramebuffer({...t,id:`framebuffer-for-${s}`,width:r,height:i,colorAttachments:[e]})}class Mc extends Ul{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor(e,t){super(e,t);const n={...this.props};n.data=t.data,this.device=e,this.gl=this.device.gl,this.glTarget=function(e){switch(e){case"1d":case"cube-array":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(e)}(this.props.dimension);const r=Ml(this.props.format);this.glInternalFormat=r.internalFormat,this.glFormat=r.format,this.glType=r.type,this.compressed=r.compressed,this.mipmaps=Boolean(this.props.mipmaps),this._initialize(n),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:e.data});let{width:t,height:n}=e;if(!t||!n){const r=Ul.getTextureDataSize(e.data);t=r?.width||1,n=r?.height||1}if(this.width=t,this.height=n,this.depth=e.depth,this.setSampler(e.sampler),this.view=new Ec(this.device,{...this.props,texture:this}),this.bind(),function(e,t,n){const{dimension:r,width:i,height:s,depth:o=0}=n,{glInternalFormat:a}=n,l=n.glTarget;switch(r){case"2d-array":case"3d":e.texStorage3D(l,t,a,i,s,o);break;default:e.texStorage2D(l,t,a,i,s)}}(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new Ec(this.device,{...e,texture:this})}setSampler(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t instanceof bc?(this.sampler=t,e=t.props):(this.sampler=new bc(this.device,t),e=t);const n=_c(e);this._setSamplerParameters(n)}generateMipmap(e){if(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format)||(va.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),e?.force))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(t){va.warn(`Error generating mipmap for ${this}: ${t.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const t=Ul.getExternalImageSize(e.image),n={...Ul.defaultCopyExternalImageOptions,...t,...e},{image:r,depth:i,mipLevel:s,x:o,y:a,z:l,flipY:c}=n;let{width:u,height:h}=n;const{dimension:d,glTarget:f,glFormat:p,glInternalFormat:g,glType:m}=this;if(u=Math.min(u,this.width-o),h=Math.min(h,this.height-a),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return Tc(this.device.gl,this.handle,r,{dimension:d,mipLevel:s,x:o,y:a,z:l,width:u,height:h,depth:i,glFormat:p,glInternalFormat:g,glType:m,glTarget:f,flipY:c}),{width:n.width,height:n.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.bind();const n=Ul.normalizeTextureData(e,this);n.length>1&&!1!==this.props.mipmaps&&va.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let r=0;r<n.length;r++){const e=n[r];this._setMipLevel(t,r,e)}this.unbind()}setTexture3DData(e){if("3d"!==this.props.dimension)throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),Ac(this.device.gl,e,this),this.unbind())}setTextureCubeData(e){if("cube"!==this.props.dimension)throw new Error(this.id);for(const t of Ul.CubeFaces)this.setTextureCubeFaceData(e[t],t)}setTextureArrayData(e){if("2d-array"!==this.props.dimension)throw new Error(this.id);throw new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,t){Array.isArray(e)&&e.length>1&&!1!==this.props.mipmaps&&va.warn(`${this.id} has mipmap and multiple LODs.`)();const n=Ul.CubeFaces.indexOf(t);this.setTexture2DData(e,n)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:t,width:n,height:r,pixels:i,data:s,format:o=6408,type:a=5121}=e,{gl:l}=this,c=i||s;this.bind(),c instanceof Promise?c.then((n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n})))):this.width||this.height?l.texImage2D(t,0,o,n,r,0,o,a,c):l.texImage2D(t,0,o,o,a,c)}_getImageDataMap(e){for(let t=0;t<Ul.CubeFaces.length;++t){const n=Ul.CubeFaces[t];e[n]&&(e[34069+t]=e[n],delete e[n])}return e}_setSamplerParameters(e){va.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,n]of Object.entries(e)){const e=Number(t),r=n;switch(e){case 33082:case 33083:this.gl.texParameterf(this.glTarget,e,r);break;case 10241:case 10242:case 10243:default:this.gl.texParameteri(this.glTarget,e,r);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,e,r)}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.glTarget;if(Ul.isExternalImage(n))Tc(this.device.gl,this.handle,n,{...this,depth:e,mipLevel:t,glTarget:r,flipY:this.props.flipY});else{if(!Ul.isTextureLevelData(n))throw new Error("Texture: invalid image data");Ac(this.device.gl,n.data,{...this,depth:e,mipLevel:t,glTarget:r})}}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,null),e}}class Lc extends Ea{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps=(()=>({...Ea.defaultProps,framebuffer:null,parameters:void 0,clearColor:Lc.defaultClearColor,clearColors:void 0,clearDepth:Lc.defaultClearDepth,clearStencil:Lc.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}))();get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t=Lc.normalizeProps(e,t),Lc.defaultProps)}static normalizeProps(e,t){const n=e.props._resourceDefaults?.renderPass;return{...n,...t}}}const Ic=[1,2,4,8];class Oc extends Lc{device;glParameters;constructor(e,t){let n;if(super(e,t),this.device=e,!t?.parameters?.viewport)if(t?.framebuffer){const{width:e,height:r}=t.framebuffer;n=[0,0,e,r]}else{const[t,r]=e.getCanvasContext().getDrawingBufferSize();n=[0,0,t,r]}if(this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters}),this.props.framebuffer){const e=this.props.framebuffer.colorAttachments.map(((e,t)=>36064+t));this.device.gl.drawBuffers(e)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={...this.glParameters};t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[2967]=e.stencilReference),e.colorMask&&(t.colorMask=Ic.map((t=>Boolean(t&e.colorMask)))),this.glParameters=t,fl(this.device.gl,t)}beginOcclusionQuery(e){const t=this.props.occlusionQuerySet;t?.beginOcclusionQuery()}endOcclusionQuery(){const e=this.props.occlusionQuerySet;e?.endOcclusionQuery()}clear(){const e={...this.glParameters};let t=0;this.props.clearColors&&this.props.clearColors.forEach(((e,t)=>{e&&this.clearColorBuffer(t,e)})),!1!==this.props.clearColor&&void 0===this.props.clearColors&&(t|=16384,e.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(t|=256,e.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(t|=1024,e.clearStencil=this.props.clearStencil),0!==t&&xc(this.device.gl,e,(()=>{this.device.gl.clear(t)}))}clearColorBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0];xc(this.device.gl,{framebuffer:this.props.framebuffer},(()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,t);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}}))}}class Nc extends Ea{static defaultProps={...Ea.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,t){super(e,t,Nc.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}const Fc=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],Dc={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function Bc(e){const t=Dc[e];if(!t)throw new Error("uniform");const[n,r,,i]=t;return{format:i,components:r,glType:n}}function Uc(e){const t=Dc[e];if(!t)throw new Error("attribute");const[,n,,r,i]=t;return{attributeType:r,vertexFormat:i,components:n}}function zc(e,t){const n={attributes:[],bindings:[]};n.attributes=function(e,t){const n=[],r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i);if(!r)throw new Error("activeInfo");const{name:s,type:o}=r,a=e.getAttribLocation(t,s);if(a>=0){const{attributeType:e}=Uc(o),t=/instance/i.test(s)?"instance":"vertex";n.push({name:s,location:a,stepMode:t,type:e})}}return n.sort(((e,t)=>e.location-t.location)),n}(e,t);const r=function(e,t){const n=(n,r)=>e.getActiveUniformBlockParameter(t,n,r),r=[],i=e.getProgramParameter(t,35382);for(let s=0;s<i;s++){const i={name:e.getActiveUniformBlockName(t,s)||"",location:n(s,35391),byteLength:n(s,35392),vertex:n(s,35396),fragment:n(s,35398),uniformCount:n(s,35394),uniforms:[]},o=n(s,35395)||[],a=e.getActiveUniforms(t,o,35383),l=e.getActiveUniforms(t,o,35384),c=e.getActiveUniforms(t,o,35387),u=e.getActiveUniforms(t,o,35388);for(let n=0;n<i.uniformCount;++n){const r=e.getActiveUniform(t,o[n]);if(!r)throw new Error("activeInfo");i.uniforms.push({name:r.name,format:Bc(a[n]).format,type:a[n],arrayLength:l[n],byteOffset:c[n],byteStride:u[n]})}r.push(i)}return r.sort(((e,t)=>e.location-t.location)),r}(e,t);for(const l of r){const e=l.uniforms.map((e=>({name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength})));n.bindings.push({type:"uniform",name:l.name,group:0,location:l.location,visibility:(l.vertex?1:0)&(l.fragment?2:0),minBindingSize:l.byteLength,uniforms:e})}const i=function(e,t){const n=[],r=e.getProgramParameter(t,35718);for(let i=0;i<r;i++){const r=e.getActiveUniform(t,i);if(!r)throw new Error("activeInfo");const{name:s,size:o,type:a}=r,{name:l,isArray:c}=jc(s);let u=e.getUniformLocation(t,l);const h={location:u,name:l,size:o,type:a,isArray:c};if(n.push(h),h.size>1)for(let i=0;i<h.size;i++){const r=`${l}[${i}]`;u=e.getUniformLocation(t,r);const s={...h,name:r,location:u};n.push(s)}}return n}(e,t);let s=0;for(const l of i)if(o=l.type,Fc.includes(o)){const{viewDimension:e,sampleType:t}=Vc(l.type);n.bindings.push({type:"texture",name:l.name,group:0,location:s,viewDimension:e,sampleType:t}),l.textureUnit=s,s+=1}var o;i.length&&(n.uniforms=i);const a=function(e,t){const n=[],r=e.getProgramParameter(t,35971);for(let i=0;i<r;i++){const r=e.getTransformFeedbackVarying(t,i);if(!r)throw new Error("activeInfo");const{name:s,type:o,size:a}=r,{glType:l,components:c}=Bc(o),u={location:i,name:s,type:l,size:a*c};n.push(u)}return n.sort(((e,t)=>e.location-t.location)),n}(e,t);return a?.length&&(n.varyings=a),n}const Gc={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function Vc(e){const t=Gc[e];if(!t)throw new Error("sampler");const[n,r]=t;return{viewDimension:n,sampleType:r}}function jc(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}function Wc(e,t,n,r){const i=e;let s=r;!0===s&&(s=1),!1===s&&(s=0);const o="number"===typeof s?[s]:s;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if("number"!==typeof r)throw new Error("samplers must be set to integers");return e.uniform1i(t,r);case 5126:return e.uniform1fv(t,o);case 35664:return e.uniform2fv(t,o);case 35665:return e.uniform3fv(t,o);case 35666:return e.uniform4fv(t,o);case 5124:case 35670:return e.uniform1iv(t,o);case 35667:case 35671:return e.uniform2iv(t,o);case 35668:case 35672:return e.uniform3iv(t,o);case 35669:case 35673:return e.uniform4iv(t,o);case 5125:return i.uniform1uiv(t,o,1);case 36294:return i.uniform2uiv(t,o,2);case 36295:return i.uniform3uiv(t,o,3);case 36296:return i.uniform4uiv(t,o,4);case 35674:return e.uniformMatrix2fv(t,!1,o);case 35675:return e.uniformMatrix3fv(t,!1,o);case 35676:return e.uniformMatrix4fv(t,!1,o);case 35685:return i.uniformMatrix2x3fv(t,!1,o);case 35686:return i.uniformMatrix2x4fv(t,!1,o);case 35687:return i.uniformMatrix3x2fv(t,!1,o);case 35688:return i.uniformMatrix3x4fv(t,!1,o);case 35689:return i.uniformMatrix4x2fv(t,!1,o);case 35690:return i.uniformMatrix4x3fv(t,!1,o)}throw new Error("Illegal uniform")}function $c(e){return function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)||function(e){return!!Array.isArray(e)&&(0===e.length||"number"===typeof e[0])}(e)}function Hc(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach((n=>{const r=e[n];var i;null!==$c(i=r)||"number"===typeof i||"boolean"===typeof i?t.uniforms[n]=r:t.bindings[n]=r})),t}class Xc extends Nc{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=t.vs,this.fs=t.fs;const{varyings:n,bufferMode:r=35981}=t;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,r)),this._linkShaders(),va.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=zc(this.device.gl,this.handle),va.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=function(e,t){const n={...e,attributes:e.attributes.map((e=>({...e})))};for(const r of t?.attributes||[]){const e=n.attributes.find((e=>e.name===r.name));e?(e.type=r.type||e.type,e.stepMode=r.stepMode||e.stepMode):va.warn(`shader layout attribute ${r.name} not present in shader`)}return n}(this.introspectedLayout,t.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,t){for(const[n,r]of Object.entries(e)){const e=this.shaderLayout.bindings.find((e=>e.name===n))||this.shaderLayout.bindings.find((e=>e.name===`${n}Uniforms`));if(e){switch(r||va.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),e.type){case"uniform":if(!(r instanceof tc)&&!(r.buffer instanceof tc))throw new Error("buffer value");break;case"texture":if(!(r instanceof Ec||r instanceof Mc||r instanceof Gl))throw new Error("texture value");break;case"sampler":va.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(e.type)}this.bindings[n]=r}else{const e=this.shaderLayout.bindings.map((e=>`"${e.name}"`)).join(", ");t?.disableWarnings||va.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${e}`,r)()}}}draw(e){const{renderPass:t,parameters:n=this.props.parameters,topology:r=this.props.topology,vertexArray:i,vertexCount:s,instanceCount:o,isInstanced:a=!1,firstVertex:l=0,transformFeedback:c}=e,u=function(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(e)}}(r),h=Boolean(i.indexBuffer),d=i.indexBuffer?.glIndexType;if("success"!==this.linkStatus)return va.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return va.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),i.bindBeforeRender(t),c&&c.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const f=t;return function(e,t,n,r){if(mc(t))return r(e);const i=e;i.pushState();try{return uc(e,t),fl(i.gl,n),r(e)}finally{i.popState()}}(this.device,n,f.glParameters,(()=>{h&&a?this.device.gl.drawElementsInstanced(u,s||0,d,l,o||0):h?this.device.gl.drawElements(u,s||0,d,l):a?this.device.gl.drawArraysInstanced(u,l,s||0,o||0):this.device.gl.drawArrays(u,l,s||0),c&&c.end()})),i.unbindAfterRender(t),!0}setUniformsWebGL(e){const{bindings:t}=Hc(e);Object.keys(t).forEach((e=>{va.warn(`Unsupported value "${JSON.stringify(t[e])}" used in setUniforms() for key ${e}. Use setBindings() instead?`)()})),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),va.time(4,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),va.timeEnd(4,`linkProgram for ${this.id}`)(),va.level,!this.device.features.has("compilation-status-async-webgl")){const e=this._getLinkStatus();return void this._reportLinkStatus(e)}va.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),va.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){if("success"!==e){switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then((()=>this.vs.debugShader()))}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then((()=>this.fs.debugShader()))}const t=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${e}: ${t}`)}}_getLinkStatus(){const{gl:e}=this.device;if(!e.getProgramParameter(this.handle,35714))return this.linkStatus="error","linking";e.validateProgram(this.handle);return e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")}async _waitForLinkComplete(){const e=async e=>await new Promise((t=>setTimeout(t,e)));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)this.bindings[t.name]||this.bindings[t.name.replace(/Uniforms$/,"")]||(va.warn(`Binding ${t.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,n=0;for(const r of this.shaderLayout.bindings){const i=this.bindings[r.name]||this.bindings[r.name.replace(/Uniforms$/,"")];if(!i)throw new Error(`No value for binding ${r.name} in ${this.id}`);switch(r.type){case"uniform":const{name:s}=r,o=e.getUniformBlockIndex(this.handle,s);if(4294967295===o)throw new Error(`Invalid uniform block name ${s}`);e.uniformBlockBinding(this.handle,n,o),i instanceof tc?e.bindBufferBase(35345,n,i.handle):e.bindBufferRange(35345,n,i.buffer.handle,i.offset||0,i.size||i.buffer.byteLength-i.offset),n+=1;break;case"texture":if(!(i instanceof Ec||i instanceof Mc||i instanceof Gl))throw new Error("texture");let a;if(i instanceof Ec)a=i.texture;else if(i instanceof Mc)a=i;else{if(!(i instanceof Gl&&i.colorAttachments[0]instanceof Ec))throw new Error("No texture");va.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),a=i.colorAttachments[0].texture}e.activeTexture(33984+t),e.bindTexture(a.glTarget,a.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${r.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:t,location:n,type:r,textureUnit:i}=e,s=this.uniforms[t]??i;void 0!==s&&Wc(this.device.gl,n,r,s)}}}class qc extends Ea{static defaultProps=(()=>({...Ea.defaultProps,measureExecutionTime:void 0}))();get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,qc.defaultProps)}}class Kc extends Ea{static defaultProps={...Ea.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,Kc.defaultProps)}}class Yc extends Kc{device;commands=[];constructor(e){super(e,{}),this.device=e}submitCommands(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.commands;for(const t of e)switch(t.name){case"copy-buffer-to-buffer":Zc(this.device,t.options);break;case"copy-buffer-to-texture":Qc(this.device,t.options);break;case"copy-texture-to-buffer":Jc(this.device,t.options);break;case"copy-texture-to-texture":eu(this.device,t.options);break;default:throw new Error(t.name)}}}function Zc(e,t){const n=t.sourceBuffer,r=t.destinationBuffer;e.gl.bindBuffer(36662,n.handle),e.gl.bindBuffer(36663,r.handle),e.gl.copyBufferSubData(36662,36663,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function Qc(e,t){throw new Error("Not implemented")}function Jc(e,t){const{sourceTexture:n,mipLevel:r=0,aspect:i="all",width:s=t.sourceTexture.width,height:o=t.sourceTexture.height,depthOrArrayLayers:a=0,origin:l=[0,0],destinationBuffer:c,byteOffset:u=0,bytesPerRow:h,rowsPerImage:d}=t;if("all"!==i)throw new Error("aspect not supported in WebGL");if(0!==r||0!==a||h||d)throw new Error("not implemented");const{framebuffer:f,destroyFramebuffer:p}=tu(n);let g;try{const t=c,n=s||f.width,r=o||f.height,i=Ml(f.colorAttachments[0].texture.props.format),a=i.format,h=i.type;e.gl.bindBuffer(35051,t.handle),g=e.gl.bindFramebuffer(36160,f.handle),e.gl.readPixels(l[0],l[1],n,r,a,h,u)}finally{e.gl.bindBuffer(35051,null),void 0!==g&&e.gl.bindFramebuffer(36160,g),p&&f.destroy()}}function eu(e,t){const{sourceTexture:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:s=[0,0],destinationTexture:o}=t;let{width:a=t.destinationTexture.width,height:l=t.destinationTexture.height}=t;const{framebuffer:c,destroyFramebuffer:u}=tu(n),[h,d]=i,[f,p,g]=s,m=e.gl.bindFramebuffer(36160,c.handle);let _,y=null;if(!(o instanceof Mc))throw new Error("invalid destination");switch(y=o,a=Number.isFinite(a)?a:y.width,l=Number.isFinite(l)?l:y.height,y.bind(0),_=y.glTarget,_){case 3553:case 34067:e.gl.copyTexSubImage2D(_,r,f,p,h,d,a,l);break;case 35866:case 32879:e.gl.copyTexSubImage3D(_,r,f,p,g,h,d,a,l)}y&&y.unbind(),e.gl.bindFramebuffer(36160,m),u&&c.destroy()}function tu(e){if(e instanceof Ul){const{width:t,height:n,id:r}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${r}`,width:t,height:n,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}class nu extends qc{device;commandBuffer;constructor(e,t){super(e,t),this.device=e,this.commandBuffer=new Yc(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,n){}}const ru={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},iu={f32:4,f16:2,i32:4,u32:4};function su(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[n,r]=e.split("x"),i=n,s=r?parseInt(r):1,o=xa(i),a={type:i,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return t&&(a.webglOnly=!0),a}function ou(e,t){const n={};for(const r of e.attributes){const i=au(e,t,r.name);i&&(n[r.name]=i)}return n}function au(e,t,n){const r=function(e,t){const n=e.attributes.find((e=>e.name===t));n||va.warn(`shader layout attribute "${t}" not present in shader`);return n||null}(e,n),i=function(e,t){lu(e);let n=function(e,t){for(const n of e)if(n.format&&n.name===t)return{attributeName:n.name,bufferName:t,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}(e,t);if(n)return n;if(n=function(e,t){for(const n of e){let e=n.byteStride;if("number"!==typeof n.byteStride)for(const t of n.attributes||[]){e+=su(t.format).byteLength}const r=n.attributes?.find((e=>e.attribute===t));if(r)return{attributeName:r.attribute,bufferName:n.name,stepMode:n.stepMode,vertexFormat:r.format,byteOffset:r.byteOffset,byteStride:e}}return null}(e,t),n)return n;return va.warn(`layout for attribute "${t}" not present in buffer layout`),null}(t,n);if(!r)return null;const s=function(e){const[t,n]=ru[e],r="i32"===t||"u32"===t,i="u32"!==t,s=iu[t]*n,o=function(e,t){let n;switch(e){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return 1===t?n:`${n}x${t}`}(t,n);return{dataType:t,components:n,defaultVertexFormat:o,byteLength:s,integer:r,signed:i}}(r.type),o=i?.vertexFormat||s.defaultVertexFormat,a=su(o);return{attributeName:i?.attributeName||r.name,bufferName:i?.bufferName||r.name,location:r.location,shaderType:r.type,shaderDataType:s.dataType,shaderComponents:s.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:s.integer,stepMode:i?.stepMode||r.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function lu(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&va.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}class cu extends Ea{static defaultProps={...Ea.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,t){super(e,t,cu.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:n,bufferLayout:r}=t.renderPipeline||{};if(!n||!r)throw new Error("VertexArray");this.attributeInfos=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;const r=ou(e,t),i=new Array(n).fill(null);for(const s of Object.values(r))i[s.location]=s;return i}(n,r,this.maxVertexAttributes)}setConstantWebGL(e,t){throw new Error("constant attributes not supported")}}let uu;function hu(e){return(!uu||uu.byteLength<e)&&(uu=new ArrayBuffer(e)),uu}class du extends cu{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return"Chrome"===(t||ue()?ce(t)?"Electron":(t||ye.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node");var t}constructor(e,t){super(e,t),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&34963!==t.glTarget)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const n=t;if(34963===n.glTarget)throw new Error("Use .setIndexBuffer()");const{size:r,type:i,stride:s,offset:o,normalized:a,integer:l,divisor:c}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),l?this.device.gl.vertexAttribIPointer(e,r,i,s,o):this.device.gl.vertexAttribPointer(e,r,i,a,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,c||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error(`Unknown attribute location ${e}`);const n=El(t.bufferDataType);return{size:t.bufferComponents,type:n,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}}_enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=du.isConstantAttributeZeroSupported(this.device);(t||(n||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const n=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),r=n.byteLength*e,i=n.length*e;if(this.buffer&&r!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${r} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:r}),s=s||!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(n,this.bufferValue),s){const e=function(e,t){return new e(hu(e.BYTES_PER_ELEMENT*t),0,t)}(t.constructor,i);!function(e){const{target:t,source:n,start:r=0,count:i=1}=e,s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)t[l++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o);e.target}({target:e,source:n,start:0,count:i}),this.buffer.write(e),this.bufferValue=t}return this.buffer}}class fu extends Ea{static defaultProps=(()=>({...Ea.defaultProps,layout:void 0,buffers:{}}))();get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,fu.defaultProps)}}class pu extends fu{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,t){super(e,t),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"point-list";this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(e){switch(e){case"point-list":return 0;case"line-list":case"line-strip":return 1;case"triangle-list":case"triangle-strip":return 4;default:throw new Error(e)}}(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind((()=>{for(const t in e)this.setBuffer(t,e[t])}))}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(t);if(n<0)return this.unusedBuffers[e]=r,void va.warn(`${this.id} unusedBuffers varying buffer ${e}`)();this.buffers[n]={buffer:r,byteLength:i,byteOffset:s},this.bindOnUse||this._bindBuffer(n,r,s,i)}getBuffer(e){if(gu(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!==typeof t?(this.gl.bindTransformFeedback(36386,t),this):(this._bound?e=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,e=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),e)}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof tc)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:n=0,byteLength:r=e.buffer.byteLength}=e;return{buffer:t,byteOffset:n,byteLength:r}}_getVaryingIndex(e){if(gu(e))return Number(e);for(const t of this.layout.varyings)if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:n,byteOffset:r}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,r,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const i=t&&t.handle;i&&void 0!==r?this.gl.bindBufferRange(35982,e,i,n,r):this.gl.bindBufferBase(35982,e,i)}}function gu(e){return"number"===typeof e?Number.isInteger(e):/^\d+$/.test(e)}class mu extends Ea{static defaultProps=(()=>({...Ea.defaultProps,type:void 0,count:void 0}))();get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,mu.defaultProps)}}class _u extends mu{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise(((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)})),this._pollingPromise}}class yu extends Xa{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor(e){super({...e,id:e.id||ec("webgl-device")});const t=Xa._getCanvasContextProps(e);if(!t)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let n=t.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new Vl(this,t),this.lost=new Promise((e=>{this._resolveContextLost=e}));const r={...e.webgl};"premultiplied"===t.alphaMode&&(r.premultipliedAlpha=!0),void 0!==e.powerPreference&&(r.powerPreference=e.powerPreference);const i=this.props._handle||function(e,t,n){let r="";const i={preserveDrawingBuffer:!0,...n};let s=null;if(s||=e.getContext("webgl2",i),i.failIfMajorPerformanceCaveat&&(r||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),s||n.failIfMajorPerformanceCaveat||(i.failIfMajorPerformanceCaveat=!1,s=e.getContext("webgl2",i),s.luma||={},s.luma.softwareRenderer=!0),s||(s=e.getContext("webgl",{}),s&&(s=null,r||="Your browser only supports WebGL1")),!s)throw r||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${r}`);const{onContextLost:o,onContextRestored:a}=t;return e.addEventListener("webglcontextlost",(e=>o(e)),!1),e.addEventListener("webglcontextrestored",(e=>a(e)),!1),s.luma||={},s}(this.canvasContext.canvas,{onContextLost:e=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:e=>console.log("WebGL context restored")},r);if(!i)throw new Error("WebGL context creation failed");if(n=i.device,n){if(e._reuseDevices)return va.log(1,`Not creating a new Device, instead returning a reference to Device ${n.id} already attached to WebGL context`,n)(),n._reused=!0,n;throw new Error(`WebGL context already attached to device ${n.id}`)}this.handle=i,this.gl=i,this.spectorJS=function(e){if(!(e={...Hl,...e}).debugSpectorJS)return null;if(!Wl&&globalThis.SPECTOR&&!globalThis.luma?.spector){va.probe(1,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;Wl=new e,globalThis.luma&&(globalThis.luma.spector=Wl)}if(!Wl)return null;if($l||($l=!0,Wl.spyCanvases(),Wl?.onCaptureStarted.add((e=>va.info("Spector capture started:",e)())),Wl?.onCapture.add((e=>{va.info("Spector capture complete:",e)(),Wl?.getResultUI(),Wl?.resultView.display(),Wl?.resultView.addCapture(e)}))),e.gl){const t=e.gl,n=t.device;Wl?.startCapture(e.gl,500),t.device=n,new Promise((e=>setTimeout(e,2e3))).then((e=>{va.info("Spector capture stopped after 2 seconds")(),Wl?.stopCapture()}))}return Wl}({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=bl(this.gl,this._extensions),this.limits=new Nl(this.gl),this.features=new Ol(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),!1!==t.autoResize&&this.canvasContext.resize();const s=new ml(this.gl,{log:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return va.log(1,...t)()}});s.trackState(this.gl,{copyState:!1});const o=e.debugWebGL||e.debug,a=e.debugWebGL;o&&(this.gl=Kl(this.gl,{debugWebGL:o,traceWebGL:a}),va.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(va.level=Math.max(va.level,1)))}destroy(){this.props._reuseDevices||this._reused||delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new tc(this,t)}createTexture(e){return new Mc(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new bc(this,e)}createShader(e){return new lc(this,e)}createFramebuffer(e){return new Gl(this,e)}createVertexArray(e){return new du(this,e)}createTransformFeedback(e){return new pu(this,e)}createQuerySet(e){return new _u(this,e)}createRenderPipeline(e){return new Xc(this,e)}beginRenderPass(e){return new Oc(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(){return new nu(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(e,t){return Rc(e,t)}readPixelsToBufferWebGL(e,t){return function(e,t){const{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:o=0}=t||{};let{sourceWidth:a,sourceHeight:l,sourceType:c}=t||{};const{framebuffer:u,deleteFramebuffer:h}=Pc(e);a=a||u.width,l=l||u.height;const d=u;c=c||5121;let f=n;if(!f){const e=o+a*l*Sc(s)*function(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}(c);f=d.device.createBuffer({byteLength:e})}const p=e.device.createCommandEncoder();return p.copyTextureToBuffer({sourceTexture:e,width:a,height:l,origin:[r,i],destinationBuffer:f,byteOffset:o}),p.destroy(),h&&u.destroy(),f}(e,t)}setParametersWebGL(e){fl(this.gl,e)}getParametersWebGL(e){return pl(this.gl,e)}withParametersWebGL(e,t){return xc(this.gl,e,t)}resetWebGL(){va.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),fl(this.gl,Ja)}_getDeviceSpecificTextureFormatCapabilities(e){return function(e,t,n){let r=t.create;const i=kl[t.format];return void 0===i?.gl&&(r=!1),i?.x&&(r=r&&Boolean(vl(e,i.x,n))),{format:t.format,create:r&&t.create,render:r&&t.render,filter:r&&t.filter,blend:r&&t.blend,store:r&&t.store}}(this.gl,e,this._extensions)}loseDevice(){let e=!1;const t=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return t&&(e=!0,t.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){ml.get(this.gl).push()}popState(){ml.get(this.gl).pop()}setSpectorMetadata(e,t){e.__SPECTOR_Metadata=t}getGLKey(e,t){const n=Number(e);for(const r in this.gl)if(this.gl[r]===n)return`GL.${r}`;return t?.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce(((e,n)=>{let[r,i]=n;return e[`${r}:${this.getGLKey(r,t)}`]=`${i}:${this.getGLKey(i,t)}`,e}),{})}_constants;setConstantAttributeWebGL(e,t){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const r=this._constants[e];switch(r&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(r,t)&&va.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,n){switch(n.length){case 1:e.gl.vertexAttrib1fv(t,n);break;case 2:e.gl.vertexAttrib2fv(t,n);break;case 3:e.gl.vertexAttrib3fv(t,n);break;case 4:e.gl.vertexAttrib4fv(t,n)}}(this,e,t);break;case Int32Array:!function(e,t,n){e.gl.vertexAttribI4iv(t,n)}(this,e,t);break;case Uint32Array:!function(e,t,n){e.gl.vertexAttribI4uiv(t,n)}(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return vl(this.gl,e,this._extensions),this._extensions}}const vu={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},bu=e=>({drawBuffersWEBGL:t=>e.drawBuffers(t),COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),wu=e=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES:()=>e.createVertexArray(),deleteVertexArrayOES:t=>e.deleteVertexArray(t),isVertexArrayOES:t=>e.isVertexArray(t),bindVertexArrayOES:t=>e.bindVertexArray(t)}),Eu=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(){return e.drawArraysInstanced(...arguments)},drawElementsInstancedANGLE(){return e.drawElementsInstanced(...arguments)},vertexAttribDivisorANGLE(){return e.vertexAttribDivisor(...arguments)}});function Su(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){if("webgl"===e||"experimental-webgl"===e){const e=this.originalGetContext("webgl2",t);return e instanceof HTMLElement&&function(e){e.getExtension("EXT_color_buffer_float");const t={...vu,WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:bu(e),OES_vertex_array_object:wu(e),ANGLE_instanced_arrays:Eu(e)},n=e.getExtension;e.getExtension=function(r){const i=n.call(e,r);return i||(r in t?t[r]:null)};const r=e.getSupportedExtensions;e.getSupportedExtensions=function(){const n=r.apply(e)||[];return n?.concat(Object.keys(t))}}(e),e}return this.originalGetContext(e,t)}}const xu=new class extends Qa{type="webgl";constructor(){super(),Xa.defaultProps={...Xa.defaultProps,...Hl},yu.adapter=this}isSupported(){return"undefined"!==typeof WebGL2RenderingContext}enforceWebGL2(e){Su(e)}async attach(e){if(e instanceof yu)return e;if(e?.device instanceof Xa)return e.device;if(!function(e){if("undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return!0;return Boolean(e&&Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");return new yu({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};va.groupCollapsed(1,"WebGLDevice created")();const t=[];(e.debugWebGL||e.debug)&&t.push(async function(){ue()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await jl("https://unpkg.com/webgl-debug@2.0.1/index.js"))}()),e.debugSpectorJS&&t.push(async function(e){if(!globalThis.SPECTOR)try{await jl(e.debugSpectorJSUrl||Hl.debugSpectorJSUrl)}catch(t){va.warn(String(t))}}(e));const n=await Promise.allSettled(t);for(const s of n)"rejected"===s.status&&va.error(`Failed to initialize debug libraries ${s.reason}`)();const r=new yu(e),i=`${r._reused?"Reusing":"Created"} device with WebGL2 ${r.debug?"debug ":""}context: ${r.info.vendor}, ${r.info.renderer} for canvas: ${r.canvasContext.id}`;return va.probe(1,i)(),va.table(1,r.info)(),va.groupEnd(1)(),r}};let Tu=0;const Au={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:Za.stats.get("animation-loop-"+Tu++),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class Cu{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...Au,...e},!(e=this.props).device)throw new Error("No device provided");const{useDevicePixels:t=!0}=this.props;this.stats=e.stats||new Be({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:t}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){this.props.onError(e),this._error=Error();const t=this.device?.canvasContext?.canvas;if(t instanceof HTMLCanvasElement){const t=document.createElement("h1");t.innerHTML=e.message,t.style.position="absolute",t.style.top="20%",t.style.left="10px",t.style.color="black",t.style.backgroundColor="red",document.body.appendChild(t)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==e&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((e=>{this._resolveNextFrame=e}))),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){var e;this._running&&(this._animationFrameId=(e=this._animationFrame.bind(this),"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)))}_cancelAnimationFrame(){var e;null!==this._animationFrameId&&(e=this._animationFrameId,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){this.display?this.display._renderFrame(e):(this.props.onRender(this._getAnimationProps()),this.device?.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.canvasContext?.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=this.device?.canvasContext?.getPixelSize()||[1,1];let n=1;const r=this.device?.canvasContext?.canvas;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}function Ru(){}const Pu={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Ru,onWebGLInitialized:Ru,onResize:Ru,onViewStateChange:Ru,onInteractionStateChange:Ru,onBeforeRender:Ru,onAfterRender:Ru,onLoad:Ru,onError:e=>Pe.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:e=>{let{isDragging:t}=e;return t?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1};class ku{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Be({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e},this._onEvent=e=>{const t=Ji[e.type],n=e.offsetCenter;if(!t||!n||!this.layerManager)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:s}=i,o=s&&(s[t]||s.props[t]),a=this.props[t];let l=!1;o&&(l=o.call(s,i,e)),l||(a?.(i,e),this.widgetManager.onEvent(i,e))},this._onPointerDown=e=>{const t=e.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:t.x,y:t.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo},this.props={...Pu,...e},(e=this.props).viewState&&e.initialViewState&&Pe.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;!t&&e.gl&&(e.gl instanceof WebGLRenderingContext&&Pe.error("WebGL1 context not supported.")(),t=xu.attach(e.gl)),t||(t=Za.createDevice({type:"best-available",_reuseDevices:!0,adapters:[xu],...e.deviceProps,createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&_n.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,this.props.canvas||this.props.device||this.props.gl||!this.canvas||(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Pe.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Pe.removed("onLayerClick","onClick")(),e.initialViewState&&!ls(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t),this.widgetManager.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),i=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return t=t||n||r||i||s,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return Ss(this.viewManager),this.viewManager.views}getViewports(e){return Ss(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,t,n){Ss(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const i=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return r.get(t).timeEnd(),i}_createCanvas(e){let t=e.canvas;if("string"===typeof t&&(t=document.getElementById(t),Ss(t)),!t){t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay";(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||0===t){const e=Number.isFinite(t)?`${t}px`:t;this.canvas.style.width=e}if(n||0===n){const t=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth??e.width,n=e.clientHeight??e.height;t===this.width&&n===this.height||(this.width=t,this.height=n,this.viewManager?.setProps({width:t,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:t,height:n}))}_createAnimationLoop(e,t){const{gl:n,onError:r,useDevicePixels:i}=t;return new Cu({device:e,useDevicePixels:i,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:e=>this._setDevice(e.device),onRender:this._onRenderFrame.bind(this),onError:r})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new Vs({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=t.length>0;let r=n,i=!1;for(const s of t)r=s,i=s.layer?.onHover(s,e.event)||i;i||(this.props.onHover?.(r,e.event),this.widgetManager.onHover(r,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device instanceof yu&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof yu&&this.props.onWebGLInitialized(this.device.gl);const t=new l;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Ki(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(es).map((e=>{const[t,n,r,i]=es[e],s=this.props.eventRecognizerOptions?.[e];return{recognizer:new t({...n,...s,event:e}),recognizeWith:r,requestFailure:i}})),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in Ji)this.eventManager.on(r,this._onEvent);this.viewManager=new cs({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new as(this.device,{deck:this,stats:this.stats,viewport:n,timeline:t}),this.effectManager=new ko({deck:this,device:this.device}),this.deckRenderer=new No(this.device),this.deckPicker=new Go(this.device),this.widgetManager=new $o({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new Xo),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{device:n,gl:r}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:r});const i={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t};this.deckRenderer?.renderLayers(i),"screen"===i.pass&&this.widgetManager.onRedraw({viewports:i.viewports,layers:i.layers}),this.props.onAfterRender({device:n,gl:r})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Pe.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=Za.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}ku.defaultProps=Pu,ku.VERSION=_a;const Mu=ku,Lu="undefined"!==typeof window?r.useLayoutEffect:r.useEffect;function Iu(e,t){for(;e;){if(e===t)return!0;e=Object.getPrototypeOf(e)}return!1}function Ou(e){const t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function Nu(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function Fu(e,t,n){if(!t||t>4)throw new Error(`size ${t}`);const r=t;let i=Ou(e);if("uint8"===i&&n&&1===r)return"unorm8-webgl";if("uint8"===i&&n&&3===r)return"unorm8x3-webgl";if("uint8"===i||"sint8"===i){if(1===r||3===r)throw new Error(`size: ${t}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}if("uint16"===i||"sint16"===i){if(1===r||3===r)throw new Error(`size: ${t}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}return 1===r?i:`${i}x${r}`}const Du=Ou;function Bu(e,t){return{attribute:e,format:t.size>1?`${t.type}x${t.size}`:t.type,byteOffset:t.offset||0}}function Uu(e){return e.stride||e.size*e.bytesPerElement}function zu(e,t){t.offset&&Pe.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Uu(e),r=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return{...t,offset:r,stride:n}}class Gu{constructor(e,t,n){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,i="float64"===r;let s,{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),s=i?"float32":!r&&t.isIndexed?"uint32":r||"float32";let a=function(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Nu(e)}}(r||s);this.doublePrecision=i,i&&!1===t.fp64&&(a=Float32Array),this.value=null,this.settings={...t,defaultType:a,defaultValue:o,logicalType:r,type:s,normalized:s.includes("norm"),size:this.size,bytesPerElement:a.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Uu(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),_n.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n={};if(this.state.constant){const r=this.value;if(t){const i=zu(this.getAccessor(),t),s=i.offset/r.BYTES_PER_ELEMENT,o=i.size||this.size;n[e]=r.subarray(s,s+o)}else n[e]=r}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getAccessor(),r=[],i={name:this.id,byteStride:Uu(n),attributes:r};if(this.doublePrecision){const i=function(e,t){const n=zu(e,t);return{high:n,low:{...n,offset:n.offset+4*e.size}}}(n,t||{});r.push(Bu(e,{...n,...i.high}),Bu(`${e}64Low`,{...n,...i.low}))}else if(t){const i=zu(n,t);r.push(Bu(e,{...n,...i}))}else r.push(Bu(e,n));return i}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:r}=this,i=n*r;if(t&&i&&t.length>=i){const n=new Array(r).fill(1/0),s=new Array(r).fill(-1/0);for(let e=0;e<i;)for(let i=0;i<r;i++){const r=t[e++];r<n[i]&&(n[i]=r),r>s[i]&&(s[i]=r)}e=[n,s]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;n=ArrayBuffer.isView(e)?{value:e}:e instanceof Sa?{buffer:e}:e;const r={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type){if(this.doublePrecision&&n.value instanceof Float64Array)r.type="float32";else{const e=Du(n.value);r.type=r.normalized?e.replace("int","norm"):e}}r.bytesPerElement=n.value.BYTES_PER_ELEMENT,r.stride=Uu(r)}if(t.bounds=null,n.constant){let e=n.value;e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e));if(!(!t.constant||!this._areValuesEqual(e,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(e)?e:new Float32Array(e)}else if(n.buffer){const e=n.buffer;t.externalBuffer=e,t.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let e=n.value;t.externalBuffer=null,t.constant=!1,this.value=e;let{buffer:i}=this;const s=Uu(r),o=(r.vertexOffset||0)*s;if(this.doublePrecision&&e instanceof Float64Array&&(e=Yn(e,r)),this.settings.isIndexed){const t=this.settings.defaultType;e.constructor!==t&&(e=new t(e))}const a=e.byteLength+o+2*s;(!i||i.byteLength<a)&&(i=this._createBuffer(a)),i.write(e,o)}return this.setAccessor(r),!0}updateSubBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:r}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?Yn(t,{size:this.size,startIndex:n,endIndex:r}):t.subarray(n,r),n*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{state:n}=this,r=n.allocatedValue,i=_n.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=i;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<i.byteLength+s)&&(o=this._createBuffer(i.byteLength+s),t&&r&&o.write(r instanceof Float64Array?Yn(r,this):r,s)),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error(`Attribute ${this.id} does not support ${t.constructor.name}`);t instanceof n||!this.settings.normalized||"normalized"in e||Pe.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map((e=>(e+128)/255*2-1));case"snorm16":return new Float32Array(e).map((e=>(e+32768)/65535*2-1));case"unorm8":return new Float32Array(e).map((e=>e/255));case"unorm16":return new Float32Array(e).map((e=>e/65535));default:return e}}_normalizeValue(e,t,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let e=i;for(;--e>=0;)t[n+e]=r[e];return t}switch(i){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let s=i;for(;--s>=0;)t[n+s]=Number.isFinite(e[s])?e[s]:r[s]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:t,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:t?Sa.INDEX:Sa.VERTEX,indexType:t?n:void 0,byteLength:e}),this._buffer}}const Vu=[],ju=[];function Wu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=Vu;const i={index:-1,data:e,target:[]};return e?"function"===typeof e[Symbol.iterator]?r=e:e.length>0&&(ju.length=e.length,r=ju):r=Vu,(t>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(t,n),i.index=t-1),{iterable:r,objectInfo:i}}function $u(e){return e&&e[Symbol.asyncIterator]}function Hu(e,t){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=t,a=e.BYTES_PER_ELEMENT,l=r?r/a:n,c=i?i/a:0,u=Math.floor((e.length-c)/l);return(t,r)=>{let{index:i,target:a}=r;if(!s){const t=i*l+c;for(let r=0;r<n;r++)a[r]=e[t+r];return a}const h=s[i],d=s[i+1]||u;let f;if(o){f=new Array(d-h);for(let t=h;t<d;t++){const r=t*l+c;a=new Array(n);for(let t=0;t<n;t++)a[t]=e[r+t];f[t-h]=a}}else if(l===n)f=e.subarray(h*n+c,d*n+c);else{f=new e.constructor((d-h)*n);let t=0;for(let r=h;r<d;r++){const i=r*l+c;for(let r=0;r<n;r++)f[t++]=e[i+r]}}return f}}const Xu=[],qu=[[0,1/0]];const Ku={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function Yu(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const n=e.type||"interpolation";return{...Ku[n],...t,...e,type:n}}class Zu extends Gu{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:qu}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t,n,r;(t=this.state).layoutChanged||(t.layoutChanged=(n=e,r=this.getAccessor(),!(n.type===r.type&&n.size===r.size&&Uu(n)===Uu(r)&&(n.offset||0)===(r.offset||0)))),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!==typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition;return Yu(Array.isArray(t)?e[t.find((t=>e[t]))]:e[t],n)}setNeedsUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:n=1/0}=t;this.state.updateRanges=function(e,t){if(e===qu)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const n=[],r=e.length;let i=0;for(let s=0;s<r;s++){const r=e[s];r[1]<t[0]?(n.push(r),i=s+1):r[0]>t[1]?n.push(r):t=[Math.min(r[0],t[0]),Math.max(r[1],t[1])]}return n.splice(i,0,t),n}(this.state.updateRanges,[e,n])}else this.state.updateRanges=qu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Xu}setNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(e,t.updateRanges!==qu),!0))}updateBuffer(e){let{numInstances:t,data:n,props:r,context:i}=e;if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[e,a]of s)o.call(i,this,{data:n,startRow:e,endRow:a,props:r,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of s){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):a||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}else;this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){if(void 0===e||"function"===typeof e)return!1;return this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:n,settings:r}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;n.binaryValue=e,this.setNeedsRedraw();if(r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const i=e;Ss(ArrayBuffer.isView(i.value),`invalid ${r.accessor}`);const s=Boolean(i.size)&&i.size!==this.size;return n.binaryAccessor=Hu(i.value,{size:i.size||this.size,stride:i.stride,offset:i.offset,startIndices:t,nested:s}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const n in e)Object.assign(t,super.getValue(n,e[n]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:r}=this.settings;if(n.stepMode="dynamic"===r?e?e.isInstanced?"instance":"vertex":"instance":r??"vertex",!t)return n;for(const i in t){const e=super._getBufferLayout(i,t[i]);n.attributes.push(...e.attributes)}return n}_autoUpdater(e,t){let{data:n,startRow:r,endRow:i,props:s,numInstances:o}=t;if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:d,transform:f}=a,p=l.binaryAccessor||("function"===typeof d?d:s[d]);Ss("function"===typeof p,`accessor "${d}" is not a function`);let g=e.getVertexOffset(r);const{iterable:m,objectInfo:_}=Wu(n,r,i);for(const y of m){_.index++;let t=p(y,_);if(f&&(t=f.call(this,t)),h){const n=(_.index<h.length-1?h[_.index+1]:o)-h[_.index];if(t&&Array.isArray(t[0])){let n=g;for(const r of t)e._normalizeValue(r,c,n),n+=u}else t&&t.length>u?c.set(t,g):(e._normalizeValue(t,_.target,0),Ne({target:c,source:_.target,start:g,count:n}));g+=n*u}else e._normalizeValue(t,c,g),g+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||"function"===typeof e.update))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function Qu(e){const{input:t,inputChannels:n,output:r}=e||{};if(!t)return"#version 300 es\nout vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}";if(!n)throw new Error("inputChannels");return`#version 300 es\nin ${function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${e}`)}}(n)} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${function(e,t){switch(t){case 1:return`vec4(${e}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${e}, 0.0, 1.0)`;case 3:return`vec4(${e}, 1.0)`;case 4:return e;default:throw new Error(`invalid channels: ${t}`)}}(t,n)};\n}`}class Ju{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find((t=>t.name===e))||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map((e=>e.attribute)):[e.name]}mergeBufferLayouts(e,t){const n=[...e];for(const r of t){const e=n.findIndex((e=>e.name===r.name));e<0?n.push(r):n[e]=r}return n}}function eh(e){return Array.isArray(e)?0===e.length||"number"===typeof e[0]:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)}class th{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const t=e?.shaderLayout.bindings?.find((t=>"uniform"===t.type&&t.name===e?.name));if(!t)throw new Error(e?.name);const n=t;for(const e of n.uniforms||[])this.bindingLayout[e.name]=e}}setUniforms(e){for(const[t,n]of Object.entries(e))this._setUniform(t,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){var n;(function(e,t){if(e!==t)return!1;const n=e,r=t;if(!eh(n))return!1;if(eh(r)&&n.length===r.length)for(let i=0;i<n.length;++i)if(r[i]!==n[i])return!1;return!0})(this.uniforms[e],t)||(this.uniforms[e]=eh(n=t)?n.slice():n,this.modifiedUniforms[e]=!0,this.modified=!0)}}const nh={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function rh(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}class ih{layout={};byteLength;constructor(e){let t=0;for(const[r,i]of Object.entries(e)){const e=nh[i],{type:n,components:s}=e;t=rh(t,s);const o=t;t+=s,this.layout[r]={type:n,size:s,offset:o}}t+=(4-t%4)%4;const n=4*t;this.byteLength=Math.max(n,1024)}getData(e){const t=hu(Math.max(this.byteLength,1024)),n={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[r,i]of Object.entries(e)){const e=this.layout[r];if(!e){va.warn(`Supplied uniform value ${r} not present in uniform block layout`)();continue}const{type:t,size:s,offset:o}=e,a=n[t];if(1===s){if("number"!==typeof i&&"boolean"!==typeof i){va.warn(`Supplied value for single component uniform ${r} is not a number: ${i}`)();continue}a[o]=Number(i)}else{if(!eh(i)){va.warn(`Supplied value for multi component / array uniform ${r} is not a numeric array: ${i}`)();continue}a.set(i,o)}}return new Uint8Array(t)}has(e){return Boolean(this.layout[e])}get(e){return this.layout[e]}}class sh{uniformBlocks=(()=>new Map)();uniformBufferLayouts=(()=>new Map)();uniformBuffers=(()=>new Map)();constructor(e){for(const[t,n]of Object.entries(e)){const e=t,r=new ih(n.uniformTypes||{});this.uniformBufferLayouts.set(e,r);const i=new th({name:t});i.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(e,i)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,n]of Object.entries(e))this.uniformBlocks.get(t)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const t=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(t)}createUniformBuffer(e,t,n){n&&this.setUniforms(n);const r=this.getUniformBufferByteLength(t),i=e.createBuffer({usage:Sa.UNIFORM|Sa.COPY_DST,byteLength:r}),s=this.getUniformBufferData(t);return i.write(s),i}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const n=this.getUniformBufferByteLength(t),r=e.createBuffer({usage:Sa.UNIFORM|Sa.COPY_DST,byteLength:n});this.uniformBuffers.set(t,r)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(t);e||=n}return e&&va.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),r=!1;if(n&&t?.needsRedraw){r||=t.needsRedraw;const i=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(i);const s=this.uniformBlocks.get(e)?.getAllUniforms();va.log(4,`Writing to uniform buffer ${String(e)}`,i,s)()}return r}}class oh{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class ah{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(e){throw new Error("Cannot evaluate node")}evaluateString(e){return this.evaluate(e).toString()}search(e){}searchBlock(e,t){if(e){t(lh.instance);for(const n of e)n instanceof Array?this.searchBlock(n,t):n.search(t);t(ch.instance)}}}class lh extends ah{}lh.instance=new lh;class ch extends ah{}ch.instance=new ch;class uh extends ah{constructor(){super()}}class hh extends uh{constructor(e,t,n,r,i,s){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=n,this.body=r,this.startLine=i,this.endLine=s}get astNodeType(){return"function"}search(e){this.searchBlock(this.body,e)}}class dh extends uh{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class fh extends uh{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class ph extends uh{constructor(e){super(),this.body=e}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class gh extends uh{constructor(e,t,n,r){super(),this.init=e,this.condition=t,this.increment=n,this.body=r}get astNodeType(){return"for"}search(e){var t,n,r;null===(t=this.init)||void 0===t||t.search(e),null===(n=this.condition)||void 0===n||n.search(e),null===(r=this.increment)||void 0===r||r.search(e),this.searchBlock(this.body,e)}}class mh extends uh{constructor(e,t,n,r,i){super(),this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"var"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class _h extends uh{constructor(e,t,n){super(),this.name=e,this.type=t,this.value=n}get astNodeType(){return"override"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class yh extends uh{constructor(e,t,n,r,i){super(),this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"let"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class vh extends uh{constructor(e,t,n,r,i){super(),this.name=e,this.type=t,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"const"}evaluate(e){return this.value.evaluate(e)}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}var bh,wh,Eh,Sh,xh;!function(e){e.increment="++",e.decrement="--"}(bh||(bh={})),function(e){e.parse=function(t){const n=t;if("parse"==n)throw new Error("Invalid value for IncrementOperator");return e[n]}}(bh||(bh={}));class Th extends uh{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}!function(e){e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="}(wh||(wh={})),function(e){e.parse=function(e){const t=e;if("parse"==t)throw new Error("Invalid value for AssignOperator");return t}}(wh||(wh={}));class Ah extends uh{constructor(e,t,n){super(),this.operator=e,this.variable=t,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class Ch extends uh{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}search(e){for(const t of this.args)t.search(e);e(this)}}class Rh extends uh{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}}class Ph extends uh{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"body"}}class kh extends uh{constructor(e,t,n,r){super(),this.condition=e,this.body=t,this.elseif=n,this.else=r}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Mh extends uh{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class Lh extends uh{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class Ih extends uh{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Oh extends uh{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class Nh extends uh{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class Fh extends uh{constructor(){super()}get astNodeType(){return"discard"}}class Dh extends uh{constructor(){super()}get astNodeType(){return"break"}}class Bh extends uh{constructor(){super()}get astNodeType(){return"continue"}}class Uh extends uh{constructor(e){super(),this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class zh extends Uh{constructor(e,t,n,r){super(e),this.members=t,this.startLine=n,this.endLine=r}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}}class Gh extends Uh{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"template"}}class Vh extends Uh{constructor(e,t,n,r){super(e),this.storage=t,this.type=n,this.access=r}get astNodeType(){return"pointer"}}class jh extends Uh{constructor(e,t,n,r){super(e),this.attributes=t,this.format=n,this.count=r}get astNodeType(){return"array"}get isArray(){return!0}}class Wh extends Uh{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"sampler"}}class $h extends ah{constructor(){super()}}class Hh extends $h{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class Xh extends $h{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}evaluate(e){return this.args[0].evaluate(e)}}class qh extends $h{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"callExpr"}evaluate(e){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(e));case"acos":return Math.acos(this.args[0].evaluate(e));case"acosh":return Math.acosh(this.args[0].evaluate(e));case"asin":return Math.asin(this.args[0].evaluate(e));case"asinh":return Math.asinh(this.args[0].evaluate(e));case"atan":return Math.atan(this.args[0].evaluate(e));case"atan2":return Math.atan2(this.args[0].evaluate(e),this.args[1].evaluate(e));case"atanh":return Math.atanh(this.args[0].evaluate(e));case"ceil":return Math.ceil(this.args[0].evaluate(e));case"clamp":return Math.min(Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e)),this.args[2].evaluate(e));case"cos":return Math.cos(this.args[0].evaluate(e));case"degrees":return 180*this.args[0].evaluate(e)/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(e)-this.args[1].evaluate(e),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(e));case"exp2":return Math.pow(2,this.args[0].evaluate(e));case"floor":return Math.floor(this.args[0].evaluate(e));case"fma":return this.args[0].evaluate(e)*this.args[1].evaluate(e)+this.args[2].evaluate(e);case"fract":case"modf":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(e));case"log":return Math.log(this.args[0].evaluate(e));case"log2":return Math.log2(this.args[0].evaluate(e));case"max":return Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e));case"min":return Math.min(this.args[0].evaluate(e),this.args[1].evaluate(e));case"mix":return this.args[0].evaluate(e)*(1-this.args[2].evaluate(e))+this.args[1].evaluate(e)*this.args[2].evaluate(e);case"pow":return Math.pow(this.args[0].evaluate(e),this.args[1].evaluate(e));case"radians":return this.args[0].evaluate(e)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(e));case"sign":return Math.sign(this.args[0].evaluate(e));case"sin":return Math.sin(this.args[0].evaluate(e));case"sinh":return Math.sinh(this.args[0].evaluate(e));case"saturate":return Math.min(Math.max(this.args[0].evaluate(e),0),1);case"smoothstep":return this.args[0].evaluate(e)*this.args[0].evaluate(e)*(3-2*this.args[0].evaluate(e));case"sqrt":return Math.sqrt(this.args[0].evaluate(e));case"step":return this.args[0].evaluate(e)<this.args[1].evaluate(e)?0:1;case"tan":return Math.tan(this.args[0].evaluate(e));case"tanh":return Math.tanh(this.args[0].evaluate(e));case"trunc":return Math.trunc(this.args[0].evaluate(e));default:throw new Error("Non const function: "+this.name)}}search(e){for(const t of this.args)t.search(e);e(this)}}class Kh extends $h{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}evaluate(e){const t=e.constants.get(this.name);if(!t)throw new Error("Cannot evaluate node");return t.evaluate(e)}}class Yh extends $h{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}evaluate(e){var t,n;if(this.initializer instanceof Xh){const r=null===(t=this.postfix)||void 0===t?void 0:t.evaluateString(e),i=null===(n=this.initializer.type)||void 0===n?void 0:n.name,s=e.structs.get(i),o=null===s||void 0===s?void 0:s.getMemberIndex(r);if(void 0!==o&&-1!=o){return this.initializer.args[o].evaluate(e)}return this.initializer.evaluate(e)}return this.initializer.evaluate(e)}search(e){this.initializer.search(e)}}class Zh extends $h{constructor(e){super(),this.value=e}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class Qh extends $h{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class Jh extends $h{constructor(e){super(),this.contents=e}get astNodeType(){return"groupExpr"}evaluate(e){return this.contents[0].evaluate(e)}search(e){this.searchBlock(this.contents,e)}}class ed extends $h{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class td extends $h{constructor(){super()}}class nd extends td{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}evaluate(e){switch(this.operator){case"+":return this.right.evaluate(e);case"-":return-this.right.evaluate(e);case"!":return this.right.evaluate(e)?0:1;case"~":return~this.right.evaluate(e);default:throw new Error("Unknown unary operator: "+this.operator)}}search(e){this.right.search(e)}}class rd extends td{constructor(e,t,n){super(),this.operator=e,this.left=t,this.right=n}get astNodeType(){return"binaryOp"}evaluate(e){switch(this.operator){case"+":return this.left.evaluate(e)+this.right.evaluate(e);case"-":return this.left.evaluate(e)-this.right.evaluate(e);case"*":return this.left.evaluate(e)*this.right.evaluate(e);case"/":return this.left.evaluate(e)/this.right.evaluate(e);case"%":return this.left.evaluate(e)%this.right.evaluate(e);case"==":return this.left.evaluate(e)==this.right.evaluate(e)?1:0;case"!=":return this.left.evaluate(e)!=this.right.evaluate(e)?1:0;case"<":return this.left.evaluate(e)<this.right.evaluate(e)?1:0;case">":return this.left.evaluate(e)>this.right.evaluate(e)?1:0;case"<=":return this.left.evaluate(e)<=this.right.evaluate(e)?1:0;case">=":return this.left.evaluate(e)>=this.right.evaluate(e)?1:0;case"&&":return this.left.evaluate(e)&&this.right.evaluate(e)?1:0;case"||":return this.left.evaluate(e)||this.right.evaluate(e)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(e){this.left.search(e),this.right.search(e)}}class id extends ah{constructor(){super()}}class sd extends id{constructor(e,t){super(),this.selector=e,this.body=t}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class od extends id{constructor(e){super(),this.body=e}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class ad extends ah{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"argument"}}class ld extends ah{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class cd extends ah{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"member"}}class ud extends ah{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}!function(e){e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"}(Sh||(Sh={}));class hd{constructor(e,t,n){this.name=e,this.type=t,this.rule=n}toString(){return this.name}}class dd{}Eh=dd,dd.none=new hd("",Sh.reserved,""),dd.eof=new hd("EOF",Sh.token,""),dd.reserved={asm:new hd("asm",Sh.reserved,"asm"),bf16:new hd("bf16",Sh.reserved,"bf16"),do:new hd("do",Sh.reserved,"do"),enum:new hd("enum",Sh.reserved,"enum"),f16:new hd("f16",Sh.reserved,"f16"),f64:new hd("f64",Sh.reserved,"f64"),handle:new hd("handle",Sh.reserved,"handle"),i8:new hd("i8",Sh.reserved,"i8"),i16:new hd("i16",Sh.reserved,"i16"),i64:new hd("i64",Sh.reserved,"i64"),mat:new hd("mat",Sh.reserved,"mat"),premerge:new hd("premerge",Sh.reserved,"premerge"),regardless:new hd("regardless",Sh.reserved,"regardless"),typedef:new hd("typedef",Sh.reserved,"typedef"),u8:new hd("u8",Sh.reserved,"u8"),u16:new hd("u16",Sh.reserved,"u16"),u64:new hd("u64",Sh.reserved,"u64"),unless:new hd("unless",Sh.reserved,"unless"),using:new hd("using",Sh.reserved,"using"),vec:new hd("vec",Sh.reserved,"vec"),void:new hd("void",Sh.reserved,"void")},dd.keywords={array:new hd("array",Sh.keyword,"array"),atomic:new hd("atomic",Sh.keyword,"atomic"),bool:new hd("bool",Sh.keyword,"bool"),f32:new hd("f32",Sh.keyword,"f32"),i32:new hd("i32",Sh.keyword,"i32"),mat2x2:new hd("mat2x2",Sh.keyword,"mat2x2"),mat2x3:new hd("mat2x3",Sh.keyword,"mat2x3"),mat2x4:new hd("mat2x4",Sh.keyword,"mat2x4"),mat3x2:new hd("mat3x2",Sh.keyword,"mat3x2"),mat3x3:new hd("mat3x3",Sh.keyword,"mat3x3"),mat3x4:new hd("mat3x4",Sh.keyword,"mat3x4"),mat4x2:new hd("mat4x2",Sh.keyword,"mat4x2"),mat4x3:new hd("mat4x3",Sh.keyword,"mat4x3"),mat4x4:new hd("mat4x4",Sh.keyword,"mat4x4"),ptr:new hd("ptr",Sh.keyword,"ptr"),sampler:new hd("sampler",Sh.keyword,"sampler"),sampler_comparison:new hd("sampler_comparison",Sh.keyword,"sampler_comparison"),struct:new hd("struct",Sh.keyword,"struct"),texture_1d:new hd("texture_1d",Sh.keyword,"texture_1d"),texture_2d:new hd("texture_2d",Sh.keyword,"texture_2d"),texture_2d_array:new hd("texture_2d_array",Sh.keyword,"texture_2d_array"),texture_3d:new hd("texture_3d",Sh.keyword,"texture_3d"),texture_cube:new hd("texture_cube",Sh.keyword,"texture_cube"),texture_cube_array:new hd("texture_cube_array",Sh.keyword,"texture_cube_array"),texture_multisampled_2d:new hd("texture_multisampled_2d",Sh.keyword,"texture_multisampled_2d"),texture_storage_1d:new hd("texture_storage_1d",Sh.keyword,"texture_storage_1d"),texture_storage_2d:new hd("texture_storage_2d",Sh.keyword,"texture_storage_2d"),texture_storage_2d_array:new hd("texture_storage_2d_array",Sh.keyword,"texture_storage_2d_array"),texture_storage_3d:new hd("texture_storage_3d",Sh.keyword,"texture_storage_3d"),texture_depth_2d:new hd("texture_depth_2d",Sh.keyword,"texture_depth_2d"),texture_depth_2d_array:new hd("texture_depth_2d_array",Sh.keyword,"texture_depth_2d_array"),texture_depth_cube:new hd("texture_depth_cube",Sh.keyword,"texture_depth_cube"),texture_depth_cube_array:new hd("texture_depth_cube_array",Sh.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new hd("texture_depth_multisampled_2d",Sh.keyword,"texture_depth_multisampled_2d"),texture_external:new hd("texture_external",Sh.keyword,"texture_external"),u32:new hd("u32",Sh.keyword,"u32"),vec2:new hd("vec2",Sh.keyword,"vec2"),vec3:new hd("vec3",Sh.keyword,"vec3"),vec4:new hd("vec4",Sh.keyword,"vec4"),bitcast:new hd("bitcast",Sh.keyword,"bitcast"),block:new hd("block",Sh.keyword,"block"),break:new hd("break",Sh.keyword,"break"),case:new hd("case",Sh.keyword,"case"),continue:new hd("continue",Sh.keyword,"continue"),continuing:new hd("continuing",Sh.keyword,"continuing"),default:new hd("default",Sh.keyword,"default"),diagnostic:new hd("diagnostic",Sh.keyword,"diagnostic"),discard:new hd("discard",Sh.keyword,"discard"),else:new hd("else",Sh.keyword,"else"),enable:new hd("enable",Sh.keyword,"enable"),fallthrough:new hd("fallthrough",Sh.keyword,"fallthrough"),false:new hd("false",Sh.keyword,"false"),fn:new hd("fn",Sh.keyword,"fn"),for:new hd("for",Sh.keyword,"for"),function:new hd("function",Sh.keyword,"function"),if:new hd("if",Sh.keyword,"if"),let:new hd("let",Sh.keyword,"let"),const:new hd("const",Sh.keyword,"const"),loop:new hd("loop",Sh.keyword,"loop"),while:new hd("while",Sh.keyword,"while"),private:new hd("private",Sh.keyword,"private"),read:new hd("read",Sh.keyword,"read"),read_write:new hd("read_write",Sh.keyword,"read_write"),return:new hd("return",Sh.keyword,"return"),requires:new hd("requires",Sh.keyword,"requires"),storage:new hd("storage",Sh.keyword,"storage"),switch:new hd("switch",Sh.keyword,"switch"),true:new hd("true",Sh.keyword,"true"),alias:new hd("alias",Sh.keyword,"alias"),type:new hd("type",Sh.keyword,"type"),uniform:new hd("uniform",Sh.keyword,"uniform"),var:new hd("var",Sh.keyword,"var"),override:new hd("override",Sh.keyword,"override"),workgroup:new hd("workgroup",Sh.keyword,"workgroup"),write:new hd("write",Sh.keyword,"write"),r8unorm:new hd("r8unorm",Sh.keyword,"r8unorm"),r8snorm:new hd("r8snorm",Sh.keyword,"r8snorm"),r8uint:new hd("r8uint",Sh.keyword,"r8uint"),r8sint:new hd("r8sint",Sh.keyword,"r8sint"),r16uint:new hd("r16uint",Sh.keyword,"r16uint"),r16sint:new hd("r16sint",Sh.keyword,"r16sint"),r16float:new hd("r16float",Sh.keyword,"r16float"),rg8unorm:new hd("rg8unorm",Sh.keyword,"rg8unorm"),rg8snorm:new hd("rg8snorm",Sh.keyword,"rg8snorm"),rg8uint:new hd("rg8uint",Sh.keyword,"rg8uint"),rg8sint:new hd("rg8sint",Sh.keyword,"rg8sint"),r32uint:new hd("r32uint",Sh.keyword,"r32uint"),r32sint:new hd("r32sint",Sh.keyword,"r32sint"),r32float:new hd("r32float",Sh.keyword,"r32float"),rg16uint:new hd("rg16uint",Sh.keyword,"rg16uint"),rg16sint:new hd("rg16sint",Sh.keyword,"rg16sint"),rg16float:new hd("rg16float",Sh.keyword,"rg16float"),rgba8unorm:new hd("rgba8unorm",Sh.keyword,"rgba8unorm"),rgba8unorm_srgb:new hd("rgba8unorm_srgb",Sh.keyword,"rgba8unorm_srgb"),rgba8snorm:new hd("rgba8snorm",Sh.keyword,"rgba8snorm"),rgba8uint:new hd("rgba8uint",Sh.keyword,"rgba8uint"),rgba8sint:new hd("rgba8sint",Sh.keyword,"rgba8sint"),bgra8unorm:new hd("bgra8unorm",Sh.keyword,"bgra8unorm"),bgra8unorm_srgb:new hd("bgra8unorm_srgb",Sh.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new hd("rgb10a2unorm",Sh.keyword,"rgb10a2unorm"),rg11b10float:new hd("rg11b10float",Sh.keyword,"rg11b10float"),rg32uint:new hd("rg32uint",Sh.keyword,"rg32uint"),rg32sint:new hd("rg32sint",Sh.keyword,"rg32sint"),rg32float:new hd("rg32float",Sh.keyword,"rg32float"),rgba16uint:new hd("rgba16uint",Sh.keyword,"rgba16uint"),rgba16sint:new hd("rgba16sint",Sh.keyword,"rgba16sint"),rgba16float:new hd("rgba16float",Sh.keyword,"rgba16float"),rgba32uint:new hd("rgba32uint",Sh.keyword,"rgba32uint"),rgba32sint:new hd("rgba32sint",Sh.keyword,"rgba32sint"),rgba32float:new hd("rgba32float",Sh.keyword,"rgba32float"),static_assert:new hd("static_assert",Sh.keyword,"static_assert")},dd.tokens={decimal_float_literal:new hd("decimal_float_literal",Sh.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|(-?[0-9]+f)/),hex_float_literal:new hd("hex_float_literal",Sh.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new hd("int_literal",Sh.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new hd("uint_literal",Sh.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new hd("ident",Sh.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new hd("and",Sh.token,"&"),and_and:new hd("and_and",Sh.token,"&&"),arrow:new hd("arrow ",Sh.token,"->"),attr:new hd("attr",Sh.token,"@"),forward_slash:new hd("forward_slash",Sh.token,"/"),bang:new hd("bang",Sh.token,"!"),bracket_left:new hd("bracket_left",Sh.token,"["),bracket_right:new hd("bracket_right",Sh.token,"]"),brace_left:new hd("brace_left",Sh.token,"{"),brace_right:new hd("brace_right",Sh.token,"}"),colon:new hd("colon",Sh.token,":"),comma:new hd("comma",Sh.token,","),equal:new hd("equal",Sh.token,"="),equal_equal:new hd("equal_equal",Sh.token,"=="),not_equal:new hd("not_equal",Sh.token,"!="),greater_than:new hd("greater_than",Sh.token,">"),greater_than_equal:new hd("greater_than_equal",Sh.token,">="),shift_right:new hd("shift_right",Sh.token,">>"),less_than:new hd("less_than",Sh.token,"<"),less_than_equal:new hd("less_than_equal",Sh.token,"<="),shift_left:new hd("shift_left",Sh.token,"<<"),modulo:new hd("modulo",Sh.token,"%"),minus:new hd("minus",Sh.token,"-"),minus_minus:new hd("minus_minus",Sh.token,"--"),period:new hd("period",Sh.token,"."),plus:new hd("plus",Sh.token,"+"),plus_plus:new hd("plus_plus",Sh.token,"++"),or:new hd("or",Sh.token,"|"),or_or:new hd("or_or",Sh.token,"||"),paren_left:new hd("paren_left",Sh.token,"("),paren_right:new hd("paren_right",Sh.token,")"),semicolon:new hd("semicolon",Sh.token,";"),star:new hd("star",Sh.token,"*"),tilde:new hd("tilde",Sh.token,"~"),underscore:new hd("underscore",Sh.token,"_"),xor:new hd("xor",Sh.token,"^"),plus_equal:new hd("plus_equal",Sh.token,"+="),minus_equal:new hd("minus_equal",Sh.token,"-="),times_equal:new hd("times_equal",Sh.token,"*="),division_equal:new hd("division_equal",Sh.token,"/="),modulo_equal:new hd("modulo_equal",Sh.token,"%="),and_equal:new hd("and_equal",Sh.token,"&="),or_equal:new hd("or_equal",Sh.token,"|="),xor_equal:new hd("xor_equal",Sh.token,"^="),shift_right_equal:new hd("shift_right_equal",Sh.token,">>="),shift_left_equal:new hd("shift_left_equal",Sh.token,"<<=")},dd.simpleTokens={"@":Eh.tokens.attr,"{":Eh.tokens.brace_left,"}":Eh.tokens.brace_right,":":Eh.tokens.colon,",":Eh.tokens.comma,"(":Eh.tokens.paren_left,")":Eh.tokens.paren_right,";":Eh.tokens.semicolon},dd.literalTokens={"&":Eh.tokens.and,"&&":Eh.tokens.and_and,"->":Eh.tokens.arrow,"/":Eh.tokens.forward_slash,"!":Eh.tokens.bang,"[":Eh.tokens.bracket_left,"]":Eh.tokens.bracket_right,"=":Eh.tokens.equal,"==":Eh.tokens.equal_equal,"!=":Eh.tokens.not_equal,">":Eh.tokens.greater_than,">=":Eh.tokens.greater_than_equal,">>":Eh.tokens.shift_right,"<":Eh.tokens.less_than,"<=":Eh.tokens.less_than_equal,"<<":Eh.tokens.shift_left,"%":Eh.tokens.modulo,"-":Eh.tokens.minus,"--":Eh.tokens.minus_minus,".":Eh.tokens.period,"+":Eh.tokens.plus,"++":Eh.tokens.plus_plus,"|":Eh.tokens.or,"||":Eh.tokens.or_or,"*":Eh.tokens.star,"~":Eh.tokens.tilde,_:Eh.tokens.underscore,"^":Eh.tokens.xor,"+=":Eh.tokens.plus_equal,"-=":Eh.tokens.minus_equal,"*=":Eh.tokens.times_equal,"/=":Eh.tokens.division_equal,"%=":Eh.tokens.modulo_equal,"&=":Eh.tokens.and_equal,"|=":Eh.tokens.or_equal,"^=":Eh.tokens.xor_equal,">>=":Eh.tokens.shift_right_equal,"<<=":Eh.tokens.shift_left_equal},dd.regexTokens={decimal_float_literal:Eh.tokens.decimal_float_literal,hex_float_literal:Eh.tokens.hex_float_literal,int_literal:Eh.tokens.int_literal,uint_literal:Eh.tokens.uint_literal,ident:Eh.tokens.ident},dd.storage_class=[Eh.keywords.function,Eh.keywords.private,Eh.keywords.workgroup,Eh.keywords.uniform,Eh.keywords.storage],dd.access_mode=[Eh.keywords.read,Eh.keywords.write,Eh.keywords.read_write],dd.sampler_type=[Eh.keywords.sampler,Eh.keywords.sampler_comparison],dd.sampled_texture_type=[Eh.keywords.texture_1d,Eh.keywords.texture_2d,Eh.keywords.texture_2d_array,Eh.keywords.texture_3d,Eh.keywords.texture_cube,Eh.keywords.texture_cube_array],dd.multisampled_texture_type=[Eh.keywords.texture_multisampled_2d],dd.storage_texture_type=[Eh.keywords.texture_storage_1d,Eh.keywords.texture_storage_2d,Eh.keywords.texture_storage_2d_array,Eh.keywords.texture_storage_3d],dd.depth_texture_type=[Eh.keywords.texture_depth_2d,Eh.keywords.texture_depth_2d_array,Eh.keywords.texture_depth_cube,Eh.keywords.texture_depth_cube_array,Eh.keywords.texture_depth_multisampled_2d],dd.texture_external_type=[Eh.keywords.texture_external],dd.any_texture_type=[...Eh.sampled_texture_type,...Eh.multisampled_texture_type,...Eh.storage_texture_type,...Eh.depth_texture_type,...Eh.texture_external_type],dd.texel_format=[Eh.keywords.r8unorm,Eh.keywords.r8snorm,Eh.keywords.r8uint,Eh.keywords.r8sint,Eh.keywords.r16uint,Eh.keywords.r16sint,Eh.keywords.r16float,Eh.keywords.rg8unorm,Eh.keywords.rg8snorm,Eh.keywords.rg8uint,Eh.keywords.rg8sint,Eh.keywords.r32uint,Eh.keywords.r32sint,Eh.keywords.r32float,Eh.keywords.rg16uint,Eh.keywords.rg16sint,Eh.keywords.rg16float,Eh.keywords.rgba8unorm,Eh.keywords.rgba8unorm_srgb,Eh.keywords.rgba8snorm,Eh.keywords.rgba8uint,Eh.keywords.rgba8sint,Eh.keywords.bgra8unorm,Eh.keywords.bgra8unorm_srgb,Eh.keywords.rgb10a2unorm,Eh.keywords.rg11b10float,Eh.keywords.rg32uint,Eh.keywords.rg32sint,Eh.keywords.rg32float,Eh.keywords.rgba16uint,Eh.keywords.rgba16sint,Eh.keywords.rgba16float,Eh.keywords.rgba32uint,Eh.keywords.rgba32sint,Eh.keywords.rgba32float],dd.const_literal=[Eh.tokens.int_literal,Eh.tokens.uint_literal,Eh.tokens.decimal_float_literal,Eh.tokens.hex_float_literal,Eh.keywords.true,Eh.keywords.false],dd.literal_or_ident=[Eh.tokens.ident,Eh.tokens.int_literal,Eh.tokens.uint_literal,Eh.tokens.decimal_float_literal,Eh.tokens.hex_float_literal],dd.element_count_expression=[Eh.tokens.int_literal,Eh.tokens.uint_literal,Eh.tokens.ident],dd.template_types=[Eh.keywords.vec2,Eh.keywords.vec3,Eh.keywords.vec4,Eh.keywords.mat2x2,Eh.keywords.mat2x3,Eh.keywords.mat2x4,Eh.keywords.mat3x2,Eh.keywords.mat3x3,Eh.keywords.mat3x4,Eh.keywords.mat4x2,Eh.keywords.mat4x3,Eh.keywords.mat4x4,Eh.keywords.atomic,Eh.keywords.bitcast,...Eh.any_texture_type],dd.attribute_name=[Eh.tokens.ident,Eh.keywords.block,Eh.keywords.diagnostic],dd.assignment_operators=[Eh.tokens.equal,Eh.tokens.plus_equal,Eh.tokens.minus_equal,Eh.tokens.times_equal,Eh.tokens.division_equal,Eh.tokens.modulo_equal,Eh.tokens.and_equal,Eh.tokens.or_equal,Eh.tokens.xor_equal,Eh.tokens.shift_right_equal,Eh.tokens.shift_left_equal],dd.increment_operators=[Eh.tokens.plus_plus,Eh.tokens.minus_minus];class fd{constructor(e,t,n){this.type=e,this.lexeme=t,this.line=n}toString(){return this.lexeme}isTemplateType(){return-1!=dd.template_types.indexOf(this.type)}isArrayType(){return this.type==dd.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class pd{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!==e&&void 0!==e?e:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new fd(dd.eof,"",this._line)),this._tokens}scanToken(){let e=this._advance();if("\n"==e)return this._line++,!0;if(this._isWhitespace(e))return!0;if("/"==e){if("/"==this._peekAhead()){for(;"\n"!=e;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let t=1;for(;t>0;){if(this._isAtEnd())return!0;if(e=this._advance(),"\n"==e)this._line++;else if("*"==e){if("/"==this._peekAhead()&&(this._advance(),t--,0==t))return!0}else"/"==e&&"*"==this._peekAhead()&&(this._advance(),t++)}return!0}}const t=dd.simpleTokens[e];if(t)return this._addToken(t),!0;let n=dd.none;const r=this._isAlpha(e),i="_"===e;if(this._isAlphaNumeric(e)){let t=this._peekAhead();for(;this._isAlphaNumeric(t);)e+=this._advance(),t=this._peekAhead()}if(r){const t=dd.keywords[e];if(t)return this._addToken(t),!0}if(r||i)return this._addToken(dd.tokens.ident),!0;for(;;){let t=this._findType(e);const r=this._peekAhead();if("-"==e&&this._tokens.length>0){if("="==r)return this._current++,e+=r,this._addToken(dd.tokens.minus_equal),!0;if("-"==r)return this._current++,e+=r,this._addToken(dd.tokens.minus_minus),!0;const n=this._tokens.length-1;if((-1!=dd.literal_or_ident.indexOf(this._tokens[n].type)||this._tokens[n].type==dd.tokens.paren_right)&&">"!=r)return this._addToken(t),!0}if(">"==e&&(">"==r||"="==r)){let e=!1,n=this._tokens.length-1;for(let t=0;t<5&&n>=0&&-1===dd.assignment_operators.indexOf(this._tokens[n].type);++t,--n)if(this._tokens[n].type===dd.tokens.less_than){n>0&&this._tokens[n-1].isArrayOrTemplateType()&&(e=!0);break}if(e)return this._addToken(t),!0}if(t===dd.none){let r=e,i=0;const s=2;for(let e=0;e<s;++e)if(r+=this._peekAhead(e),t=this._findType(r),t!==dd.none){i=e;break}if(t===dd.none)return n!==dd.none&&(this._current--,this._addToken(n),!0);e=r,this._current+=i+1}if(n=t,this._isAtEnd())break;e+=this._advance()}return n!==dd.none&&(this._addToken(n),!0)}_findType(e){for(const n in dd.regexTokens){const t=dd.regexTokens[n];if(this._match(e,t.rule))return t}const t=dd.literalTokens[e];return t||dd.none}_match(e,t){const n=t.exec(e);return n&&0==n.index&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}_isAlphaNumeric(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"==e||e>="0"&&e<="9"}_isWhitespace(e){return" "==e||"\t"==e||"\r"==e}_advance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new fd(e,t,this._line))}}class gd{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new oh,this._deferArrayCountEval=[]}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const e=this._global_decl_or_directive();if(!e)break;t.push(e)}if(this._deferArrayCountEval.length>0){for(const e of this._deferArrayCountEval){const t=e.arrayType,r=e.countNode;if(r instanceof Kh){const e=r.name,i=this._context.constants.get(e);if(i)try{const e=i.evaluate(this._context);t.count=e}catch(n){}}}this._deferArrayCountEval.length=0}return t}_initialize(e){if(e)if("string"==typeof e){const t=new pd(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_error(e,t){return{token:e,message:t,toString:function(){return`${t}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==dd.eof}_match(e){if(e instanceof hd)return!!this._check(e)&&(this._advance(),!0);for(let t=0,n=e.length;t<n;++t){const n=e[t];if(this._check(n))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),t)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const n=t.type;return-1!=e.indexOf(n)}return t.type==e}_advance(){var e,t;return this._currentLine=null!==(t=null===(e=this._peek())||void 0===e?void 0:e.line)&&void 0!==t?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(dd.tokens.semicolon)&&!this._isAtEnd(););if(this._match(dd.keywords.alias)){const e=this._type_alias();return this._consume(dd.tokens.semicolon,"Expected ';'"),e}if(this._match(dd.keywords.diagnostic)){const e=this._diagnostic();return this._consume(dd.tokens.semicolon,"Expected ';'"),e}if(this._match(dd.keywords.requires)){const e=this._requires_directive();return this._consume(dd.tokens.semicolon,"Expected ';'"),e}if(this._match(dd.keywords.enable)){const e=this._enable_directive();return this._consume(dd.tokens.semicolon,"Expected ';'"),e}const e=this._attribute();if(this._check(dd.keywords.var)){const t=this._global_variable_decl();return null!=t&&(t.attributes=e),this._consume(dd.tokens.semicolon,"Expected ';'."),t}if(this._check(dd.keywords.override)){const t=this._override_variable_decl();return null!=t&&(t.attributes=e),this._consume(dd.tokens.semicolon,"Expected ';'."),t}if(this._check(dd.keywords.let)){const t=this._global_let_decl();return null!=t&&(t.attributes=e),this._consume(dd.tokens.semicolon,"Expected ';'."),t}if(this._check(dd.keywords.const)){const t=this._global_const_decl();return null!=t&&(t.attributes=e),this._consume(dd.tokens.semicolon,"Expected ';'."),t}if(this._check(dd.keywords.struct)){const t=this._struct_decl();return null!=t&&(t.attributes=e),t}if(this._check(dd.keywords.fn)){const t=this._function_decl();return null!=t&&(t.attributes=e),t}return null}_function_decl(){if(!this._match(dd.keywords.fn))return null;const e=this._currentLine,t=this._consume(dd.tokens.ident,"Expected function name.").toString();this._consume(dd.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(dd.tokens.paren_right))do{if(this._check(dd.tokens.paren_right))break;const e=this._attribute(),t=this._consume(dd.tokens.ident,"Expected argument name.").toString();this._consume(dd.tokens.colon,"Expected ':' for argument type.");const r=this._attribute(),i=this._type_decl();null!=i&&(i.attributes=r,n.push(new ad(t,i,e)))}while(this._match(dd.tokens.comma));this._consume(dd.tokens.paren_right,"Expected ')' after function arguments.");let r=null;if(this._match(dd.tokens.arrow)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}const i=this._compound_statement(),s=this._currentLine;return new hh(t,n,r,i,e,s)}_compound_statement(){const e=[];for(this._consume(dd.tokens.brace_left,"Expected '{' for block.");!this._check(dd.tokens.brace_right);){const t=this._statement();null!==t&&e.push(t)}return this._consume(dd.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(dd.tokens.semicolon)&&!this._isAtEnd(););if(this._check(dd.tokens.attr)&&this._attribute(),this._check(dd.keywords.if))return this._if_statement();if(this._check(dd.keywords.switch))return this._switch_statement();if(this._check(dd.keywords.loop))return this._loop_statement();if(this._check(dd.keywords.for))return this._for_statement();if(this._check(dd.keywords.while))return this._while_statement();if(this._check(dd.keywords.continuing))return this._continuing_statement();if(this._check(dd.keywords.static_assert))return this._static_assert_statement();if(this._check(dd.tokens.brace_left))return this._compound_statement();let e=null;return e=this._check(dd.keywords.return)?this._return_statement():this._check([dd.keywords.var,dd.keywords.let,dd.keywords.const])?this._variable_statement():this._match(dd.keywords.discard)?new Fh:this._match(dd.keywords.break)?new Dh:this._match(dd.keywords.continue)?new Bh:this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),null!=e&&this._consume(dd.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(dd.keywords.static_assert))return null;const e=this._optional_paren_expression();return new dh(e)}_while_statement(){if(!this._match(dd.keywords.while))return null;const e=this._optional_paren_expression();this._check(dd.tokens.attr)&&this._attribute();const t=this._compound_statement();return new fh(e,t)}_continuing_statement(){if(!this._match(dd.keywords.continuing))return null;const e=this._compound_statement();return new ph(e)}_for_statement(){if(!this._match(dd.keywords.for))return null;this._consume(dd.tokens.paren_left,"Expected '('.");const e=this._check(dd.tokens.semicolon)?null:this._for_init();this._consume(dd.tokens.semicolon,"Expected ';'.");const t=this._check(dd.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(dd.tokens.semicolon,"Expected ';'.");const n=this._check(dd.tokens.paren_right)?null:this._for_increment();this._consume(dd.tokens.paren_right,"Expected ')'."),this._check(dd.tokens.attr)&&this._attribute();const r=this._compound_statement();return new gh(e,t,n,r)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(dd.keywords.var)){const e=this._variable_decl();if(null===e)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(dd.tokens.equal)&&(t=this._short_circuit_or_expression()),new mh(e.name,e.type,e.storage,e.access,t)}if(this._match(dd.keywords.let)){const e=this._consume(dd.tokens.ident,"Expected name for let.").toString();let t=null;if(this._match(dd.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}this._consume(dd.tokens.equal,"Expected '=' for let.");const n=this._short_circuit_or_expression();return new yh(e,t,null,null,n)}if(this._match(dd.keywords.const)){const e=this._consume(dd.tokens.ident,"Expected name for const.").toString();let t=null;if(this._match(dd.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}this._consume(dd.tokens.equal,"Expected '=' for const.");const n=this._short_circuit_or_expression();return new vh(e,t,null,null,n)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(null==t)return null;if(!this._check(dd.increment_operators))return this._current=e,null;const n=this._consume(dd.increment_operators,"Expected increment operator");return new Th(n.type===dd.tokens.plus_plus?bh.increment:bh.decrement,t)}_assignment_statement(){let e=null;if(this._check(dd.tokens.brace_right))return null;let t=this._match(dd.tokens.underscore);if(t||(e=this._unary_expression()),!t&&null==e)return null;const n=this._consume(dd.assignment_operators,"Expected assignment operator."),r=this._short_circuit_or_expression();return new Ah(wh.parse(n.lexeme),e,r)}_func_call_statement(){if(!this._check(dd.tokens.ident))return null;const e=this._current,t=this._consume(dd.tokens.ident,"Expected function name."),n=this._argument_expression_list();return null===n?(this._current=e,null):new Ch(t.lexeme,n)}_loop_statement(){if(!this._match(dd.keywords.loop))return null;this._check(dd.tokens.attr)&&this._attribute(),this._consume(dd.tokens.brace_left,"Expected '{' for loop.");const e=[];let t=this._statement();for(;null!==t;){if(Array.isArray(t))for(let n of t)e.push(n);else e.push(t);t=this._statement()}let n=null;return this._match(dd.keywords.continuing)&&(n=this._compound_statement()),this._consume(dd.tokens.brace_right,"Expected '}' for loop."),new Rh(e,n)}_switch_statement(){if(!this._match(dd.keywords.switch))return null;const e=this._optional_paren_expression();this._check(dd.tokens.attr)&&this._attribute(),this._consume(dd.tokens.brace_left,"Expected '{' for switch.");const t=this._switch_body();if(null==t||0==t.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(dd.tokens.brace_right,"Expected '}' for switch."),new Ph(e,t)}_switch_body(){const e=[];if(this._match(dd.keywords.case)){const t=this._case_selectors();this._match(dd.tokens.colon),this._check(dd.tokens.attr)&&this._attribute(),this._consume(dd.tokens.brace_left,"Exected '{' for switch case.");const n=this._case_body();this._consume(dd.tokens.brace_right,"Exected '}' for switch case."),e.push(new sd(t,n))}if(this._match(dd.keywords.default)){this._match(dd.tokens.colon),this._check(dd.tokens.attr)&&this._attribute(),this._consume(dd.tokens.brace_left,"Exected '{' for switch default.");const t=this._case_body();this._consume(dd.tokens.brace_right,"Exected '}' for switch default."),e.push(new od(t))}if(this._check([dd.keywords.default,dd.keywords.case])){const t=this._switch_body();e.push(t[0])}return e}_case_selectors(){const e=[this._shift_expression()];for(;this._match(dd.tokens.comma);)e.push(this._shift_expression());return e}_case_body(){if(this._match(dd.keywords.fallthrough))return this._consume(dd.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(null==e)return[];e instanceof Array||(e=[e]);const t=this._case_body();return 0==t.length?e:[...e,t[0]]}_if_statement(){if(!this._match(dd.keywords.if))return null;const e=this._optional_paren_expression();this._check(dd.tokens.attr)&&this._attribute();const t=this._compound_statement();let n=[];this._match_elseif()&&(this._check(dd.tokens.attr)&&this._attribute(),n=this._elseif_statement(n));let r=null;return this._match(dd.keywords.else)&&(this._check(dd.tokens.attr)&&this._attribute(),r=this._compound_statement()),new kh(e,t,n,r)}_match_elseif(){return this._tokens[this._current].type===dd.keywords.else&&this._tokens[this._current+1].type===dd.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this._optional_paren_expression(),n=this._compound_statement();return e.push(new ld(t,n)),this._match_elseif()&&(this._check(dd.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(dd.keywords.return))return null;const e=this._short_circuit_or_expression();return new Mh(e)}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(dd.tokens.or_or);)e=new rd(this._previous().toString(),e,this._short_circuit_and_expr());return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(dd.tokens.and_and);)e=new rd(this._previous().toString(),e,this._inclusive_or_expression());return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(dd.tokens.or);)e=new rd(this._previous().toString(),e,this._exclusive_or_expression());return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(dd.tokens.xor);)e=new rd(this._previous().toString(),e,this._and_expression());return e}_and_expression(){let e=this._equality_expression();for(;this._match(dd.tokens.and);)e=new rd(this._previous().toString(),e,this._equality_expression());return e}_equality_expression(){const e=this._relational_expression();return this._match([dd.tokens.equal_equal,dd.tokens.not_equal])?new rd(this._previous().toString(),e,this._relational_expression()):e}_relational_expression(){let e=this._shift_expression();for(;this._match([dd.tokens.less_than,dd.tokens.greater_than,dd.tokens.less_than_equal,dd.tokens.greater_than_equal]);)e=new rd(this._previous().toString(),e,this._shift_expression());return e}_shift_expression(){let e=this._additive_expression();for(;this._match([dd.tokens.shift_left,dd.tokens.shift_right]);)e=new rd(this._previous().toString(),e,this._additive_expression());return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([dd.tokens.plus,dd.tokens.minus]);)e=new rd(this._previous().toString(),e,this._multiplicative_expression());return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([dd.tokens.star,dd.tokens.forward_slash,dd.tokens.modulo]);)e=new rd(this._previous().toString(),e,this._unary_expression());return e}_unary_expression(){return this._match([dd.tokens.minus,dd.tokens.bang,dd.tokens.tilde,dd.tokens.star,dd.tokens.and])?new nd(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(dd.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(dd.tokens.bracket_right,"Expected ']'.");const t=new ed(e),n=this._postfix_expression();return n&&(t.postfix=n),t}if(this._match(dd.tokens.period)){const e=this._consume(dd.tokens.ident,"Expected member name."),t=this._postfix_expression(),n=new Hh(e.lexeme);return t&&(n.postfix=t),n}return null}_getStruct(e){if(this._context.aliases.has(e)){return this._context.aliases.get(e).type}if(this._context.structs.has(e)){return this._context.structs.get(e)}return null}_primary_expression(){if(this._match(dd.tokens.ident)){const e=this._previous().toString();if(this._check(dd.tokens.paren_left)){const t=this._argument_expression_list(),n=this._getStruct(e);return null!=n?new Xh(n,t):new qh(e,t)}if(this._context.constants.has(e)){const t=this._context.constants.get(e);return new Yh(e,t.value)}return new Kh(e)}if(this._match(dd.const_literal))return new Zh(parseFloat(this._previous().toString()));if(this._check(dd.tokens.paren_left))return this._paren_expression();if(this._match(dd.keywords.bitcast)){this._consume(dd.tokens.less_than,"Expected '<'.");const e=this._type_decl();this._consume(dd.tokens.greater_than,"Expected '>'.");const t=this._paren_expression();return new Qh(e,t)}const e=this._type_decl(),t=this._argument_expression_list();return new Xh(e,t)}_argument_expression_list(){if(!this._match(dd.tokens.paren_left))return null;const e=[];do{if(this._check(dd.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(dd.tokens.comma));return this._consume(dd.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(dd.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(dd.tokens.paren_right),new Jh([e])}_paren_expression(){this._consume(dd.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(dd.tokens.paren_right,"Expected ')'."),new Jh([e])}_struct_decl(){if(!this._match(dd.keywords.struct))return null;const e=this._currentLine,t=this._consume(dd.tokens.ident,"Expected name for struct.").toString();this._consume(dd.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(dd.tokens.brace_right);){const e=this._attribute(),t=this._consume(dd.tokens.ident,"Expected variable name.").toString();this._consume(dd.tokens.colon,"Expected ':' for struct member type.");const r=this._attribute(),i=this._type_decl();null!=i&&(i.attributes=r),this._check(dd.tokens.brace_right)?this._match(dd.tokens.comma):this._consume(dd.tokens.comma,"Expected ',' for struct member."),n.push(new cd(t,i,e))}this._consume(dd.tokens.brace_right,"Expected '}' after struct body.");const r=this._currentLine,i=new zh(t,n,e,r);return this._context.structs.set(t,i),i}_global_variable_decl(){const e=this._variable_decl();return e&&this._match(dd.tokens.equal)&&(e.value=this._const_expression()),e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(dd.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){if(!this._match(dd.keywords.const))return null;const e=this._consume(dd.tokens.ident,"Expected variable name");let t=null;if(this._match(dd.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}let n=null;if(this._match(dd.tokens.equal)){const e=this._short_circuit_or_expression();if(e instanceof Xh)n=e;else if(e instanceof Yh&&e.initializer instanceof Xh)n=e.initializer;else try{const t=e.evaluate(this._context);n=new Zh(t)}catch(Eh){n=e}}const r=new vh(e.toString(),t,"","",n);return this._context.constants.set(r.name,r),r}_global_let_decl(){if(!this._match(dd.keywords.let))return null;const e=this._consume(dd.tokens.ident,"Expected variable name");let t=null;if(this._match(dd.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}let n=null;return this._match(dd.tokens.equal)&&(n=this._const_expression()),new yh(e.toString(),t,"","",n)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(dd.keywords.var))return null;let e="",t="";this._match(dd.tokens.less_than)&&(e=this._consume(dd.storage_class,"Expected storage_class.").toString(),this._match(dd.tokens.comma)&&(t=this._consume(dd.access_mode,"Expected access_mode.").toString()),this._consume(dd.tokens.greater_than,"Expected '>'."));const n=this._consume(dd.tokens.ident,"Expected variable name");let r=null;if(this._match(dd.tokens.colon)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}return new mh(n.toString(),r,e,t,null)}_override_decl(){if(!this._match(dd.keywords.override))return null;const e=this._consume(dd.tokens.ident,"Expected variable name");let t=null;if(this._match(dd.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}return new _h(e.toString(),t,null)}_diagnostic(){this._consume(dd.tokens.paren_left,"Expected '('");const e=this._consume(dd.tokens.ident,"Expected severity control name.");this._consume(dd.tokens.comma,"Expected ','");const t=this._consume(dd.tokens.ident,"Expected diagnostic rule name.");return this._consume(dd.tokens.paren_right,"Expected ')'"),new Oh(e.toString(),t.toString())}_enable_directive(){const e=this._consume(dd.tokens.ident,"identity expected.");return new Lh(e.toString())}_requires_directive(){const e=[this._consume(dd.tokens.ident,"identity expected.").toString()];for(;this._match(dd.tokens.comma);){const t=this._consume(dd.tokens.ident,"identity expected.");e.push(t.toString())}return new Ih(e)}_type_alias(){const e=this._consume(dd.tokens.ident,"identity expected.");this._consume(dd.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(null===t)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const n=new Nh(e.toString(),t);return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([dd.tokens.ident,...dd.texel_format,dd.keywords.bool,dd.keywords.f32,dd.keywords.i32,dd.keywords.u32])){const e=this._advance(),t=e.toString();return this._context.structs.has(t)?this._context.structs.get(t):this._context.aliases.has(t)?this._context.aliases.get(t).type:new Uh(e.toString())}let e=this._texture_sampler_types();if(e)return e;if(this._check(dd.template_types)){let e=this._advance().toString(),t=null,n=null;return this._match(dd.tokens.less_than)&&(t=this._type_decl(),n=null,this._match(dd.tokens.comma)&&(n=this._consume(dd.access_mode,"Expected access_mode for pointer").toString()),this._consume(dd.tokens.greater_than,"Expected '>' for type.")),new Gh(e,t,n)}if(this._match(dd.keywords.ptr)){let e=this._previous().toString();this._consume(dd.tokens.less_than,"Expected '<' for pointer.");const t=this._consume(dd.storage_class,"Expected storage_class for pointer");this._consume(dd.tokens.comma,"Expected ',' for pointer.");const n=this._type_decl();let r=null;return this._match(dd.tokens.comma)&&(r=this._consume(dd.access_mode,"Expected access_mode for pointer").toString()),this._consume(dd.tokens.greater_than,"Expected '>' for pointer."),new Vh(e,t.toString(),n,r)}const t=this._attribute();if(this._match(dd.keywords.array)){let e=null,r=-1;const i=this._previous();let s=null;if(this._match(dd.tokens.less_than)){e=this._type_decl(),this._context.aliases.has(e.name)&&(e=this._context.aliases.get(e.name).type);let t="";if(this._match(dd.tokens.comma)){s=this._shift_expression();try{t=s.evaluate(this._context).toString(),s=null}catch(n){t="1"}}this._consume(dd.tokens.greater_than,"Expected '>' for array."),r=t?parseInt(t):0}const o=new jh(i.toString(),t,e,r);return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(dd.sampler_type))return new Wh(this._previous().toString(),null,null);if(this._match(dd.depth_texture_type))return new Wh(this._previous().toString(),null,null);if(this._match(dd.sampled_texture_type)||this._match(dd.multisampled_texture_type)){const e=this._previous();this._consume(dd.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(dd.tokens.greater_than,"Expected '>' for sampler type."),new Wh(e.toString(),t,null)}if(this._match(dd.storage_texture_type)){const e=this._previous();this._consume(dd.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(dd.texel_format,"Invalid texel format.").toString();this._consume(dd.tokens.comma,"Expected ',' after texel format.");const n=this._consume(dd.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(dd.tokens.greater_than,"Expected '>' for sampler type."),new Wh(e.toString(),t,n)}return null}_attribute(){let e=[];for(;this._match(dd.tokens.attr);){const t=this._consume(dd.attribute_name,"Expected attribute name"),n=new ud(t.toString(),null);if(this._match(dd.tokens.paren_left)){if(n.value=this._consume(dd.literal_or_ident,"Expected attribute value").toString(),this._check(dd.tokens.comma)){this._advance();do{const e=this._consume(dd.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(e)}while(this._match(dd.tokens.comma))}this._consume(dd.tokens.paren_right,"Expected ')'")}e.push(n)}return 0==e.length?null:e}}class md{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class _d{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class yd extends md{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class vd extends md{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}}class bd extends md{constructor(e,t,n,r){super(e,n),this.format=t,this.access=r}get isTemplate(){return!0}}!function(e){e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"}(xh||(xh={}));class wd{constructor(e,t,n,r,i,s,o){this.name=e,this.type=t,this.group=n,this.binding=r,this.attributes=i,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Ed{constructor(e,t){this.name=e,this.type=t}}class Sd{constructor(e,t){this.align=e,this.size=t}}class xd{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r,this.interpolation=null}}class Td{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r}}class Ad{constructor(e,t,n,r){this.name=e,this.type=t,this.attributes=n,this.id=r}}class Cd{constructor(e,t){this.name=e,this.type=t}}class Rd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t}}class Pd{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class kd{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Md{constructor(e){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new Pd,this.functions=[],this._types=new Map,this._functions=new Map,e&&this.update(e)}_isStorageTexture(e){return"texture_storage_1d"==e.name||"texture_storage_2d"==e.name||"texture_storage_2d_array"==e.name||"texture_storage_3d"==e.name}update(e){const t=(new gd).parse(e);for(const n of t)n instanceof hh&&this._functions.set(n.name,new kd(n));for(const n of t)if(n instanceof zh){const e=this._getTypeInfo(n,null);e instanceof yd&&this.structs.push(e)}for(const n of t)if(n instanceof Nh)this.aliases.push(this._getAliasInfo(n));else if(n instanceof _h){const e=n,t=this._getAttributeNum(e.attributes,"id",0),r=null!=e.type?this._getTypeInfo(e.type,e.attributes):null;this.overrides.push(new Ad(e.name,r,e.attributes,t))}else if(this._isUniformVar(n)){const e=n,t=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),s=new wd(e.name,i,t,r,e.attributes,xh.Uniform,e.access);this.uniforms.push(s)}else if(this._isStorageVar(n)){const e=n,t=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),s=this._isStorageTexture(i),o=new wd(e.name,i,t,r,e.attributes,s?xh.StorageTexture:xh.Storage,e.access);this.storage.push(o)}else if(this._isTextureVar(n)){const e=n,t=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),s=this._isStorageTexture(i),o=new wd(e.name,i,t,r,e.attributes,s?xh.StorageTexture:xh.Texture,e.access);s?this.storage.push(o):this.textures.push(o)}else if(this._isSamplerVar(n)){const e=n,t=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),s=new wd(e.name,i,t,r,e.attributes,xh.Sampler,e.access);this.samplers.push(s)}else if(n instanceof hh){const e=this._getAttribute(n,"vertex"),t=this._getAttribute(n,"fragment"),r=this._getAttribute(n,"compute"),i=e||t||r,s=new Rd(n.name,null===i||void 0===i?void 0:i.name);s.startLine=n.startLine,s.endLine=n.endLine,this.functions.push(s),this._functions.get(n.name).info=s,i&&(this._functions.get(n.name).inUse=!0,s.inUse=!0,s.resources=this._findResources(n,!!i),s.inputs=this._getInputs(n.args),s.outputs=this._getOutputs(n.returnType),this.entry[i.name].push(s)),s.arguments=n.args.map((e=>new Cd(e.name,this._getTypeInfo(e.type,e.attributes)))),s.returnType=n.returnType?this._getTypeInfo(n.returnType,n.attributes):null}else;for(const n of this._functions.values())n.info&&(n.info.inUse=n.inUse,this._addCalls(n.node,n.info.calls));for(const n of this._functions.values())n.node.search((e=>{var t;if("varExpr"===e.astNodeType){const r=e;for(const e of this.overrides)r.name==e.name&&(null===(t=n.info)||void 0===t||t.overrides.push(e))}}));for(const n of this.uniforms)this._markStructsInUse(n.type);for(const n of this.storage)this._markStructsInUse(n.type)}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var n;for(const r of e.calls){const e=null===(n=this._functions.get(r.name))||void 0===n?void 0:n.info;e&&t.add(e)}}findResource(e,t){for(const n of this.uniforms)if(n.group==e&&n.binding==t)return n;for(const n of this.storage)if(n.group==e&&n.binding==t)return n;for(const n of this.textures)if(n.group==e&&n.binding==t)return n;for(const n of this.samplers)if(n.group==e&&n.binding==t)return n;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this._getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const n=[],r=this,i=[];return e.search((s=>{if(s instanceof lh)i.push({});else if(s instanceof ch)i.pop();else if(s instanceof mh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type),i.length>0&&(i[i.length-1][e.name]=e)}else if(s instanceof Xh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type)}else if(s instanceof yh){const e=s;t&&null!==e.type&&this._markStructsFromAST(e.type),i.length>0&&(i[i.length-1][e.name]=e)}else if(s instanceof Kh){const e=s;if(i.length>0){if(i[i.length-1][e.name])return}const t=r._findResource(e.name);t&&n.push(t)}else if(s instanceof qh){const i=s,o=r._functions.get(i.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=r._findResources(o.node,t)),n.push(...o.resources))}else if(s instanceof Ch){const i=s,o=r._functions.get(i.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=r._findResources(o.node,t)),n.push(...o.resources))}})),[...new Map(n.map((e=>[e.name,e]))).values()]}getBindGroups(){const e=[];function t(t,n){t>=e.length&&(e.length=t+1),void 0===e[t]&&(e[t]=[]),n>=e[t].length&&(e[t].length=n+1)}for(const n of this.uniforms){t(n.group,n.binding);e[n.group][n.binding]=n}for(const n of this.storage){t(n.group,n.binding);e[n.group][n.binding]=n}for(const n of this.textures){t(n.group,n.binding);e[n.group][n.binding]=n}for(const n of this.samplers){t(n.group,n.binding);e[n.group][n.binding]=n}return e}_getOutputs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(void 0===t&&(t=[]),e instanceof zh)this._getStructOutputs(e,t);else{const n=this._getOutputInfo(e);null!==n&&t.push(n)}return t}_getStructOutputs(e,t){for(const n of e.members)if(n.type instanceof zh)this._getStructOutputs(n.type,t);else{const e=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(null!==e){const r=this._getTypeInfo(n.type,n.type.attributes),i=this._parseInt(e.value),s=new Td(n.name,r,e.name,i);t.push(s)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this._getTypeInfo(e,e.attributes),r=this._parseInt(t.value);return new Td("",n,t.name,r)}return null}_getInputs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;void 0===t&&(t=[]);for(const n of e)if(n.type instanceof zh)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}return t}_getStructInputs(e,t){for(const n of e.members)if(n.type instanceof zh)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this._getAttribute(e,"interpolation"),r=this._getTypeInfo(e.type,e.attributes),i=this._parseInt(t.value),s=new xd(e.name,r,t.name,i);return null!==n&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new Ed(e.name,this._getTypeInfo(e.type,null))}_getTypeInfo(e,t){if(this._types.has(e))return this._types.get(e);if(e instanceof jh){const n=e,r=n.format?this._getTypeInfo(n.format,n.attributes):null,i=new vd(n.name,t);return i.format=r,i.count=n.count,this._types.set(e,i),this._updateTypeInfo(i),i}if(e instanceof zh){const n=e,r=new yd(n.name,t);r.startLine=n.startLine,r.endLine=n.endLine;for(const e of n.members){const t=this._getTypeInfo(e.type,e.attributes);r.members.push(new _d(e.name,t,e.attributes))}return this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof Wh){const n=e,r=n.format instanceof Uh,i=n.format?r?this._getTypeInfo(n.format,null):new md(n.format,null):null,s=new bd(n.name,i,t,n.access);return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Gh){const n=e,r=n.format?this._getTypeInfo(n.format,null):null,i=new bd(n.name,r,t,n.access);return this._types.set(e,i),this._updateTypeInfo(i),i}const n=new md(e.name,t);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var t,n;const r=this._getTypeSize(e);if(e.size=null!==(t=null===r||void 0===r?void 0:r.size)&&void 0!==t?t:0,e instanceof vd&&e.format){const t=this._getTypeSize(e.format);e.stride=null!==(n=null===t||void 0===t?void 0:t.size)&&void 0!==n?n:0,this._updateTypeInfo(e.format)}e instanceof yd&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let n=0,r=0,i=0,s=0;for(let o=0,a=e.members.length;o<a;++o){const a=e.members[o],l=this._getTypeSize(a);if(!l)continue;null!==(t=this._getAlias(a.type.name))&&void 0!==t||a.type;const c=l.align,u=l.size;n=this._roundUp(c,n+r),r=u,i=n,s=Math.max(s,c),a.offset=n,a.size=u,this._updateTypeInfo(a.type)}e.size=this._roundUp(s,i+r),e.align=s}_getTypeSize(e){var t,n;if(null===e||void 0===e)return null;const r=this._getAttributeNum(e.attributes,"size",0),i=this._getAttributeNum(e.attributes,"align",0);if(e instanceof _d&&(e=e.type),e instanceof md){const t=this._getAlias(e.name);null!==t&&(e=t)}{const n=Md._typeInfo[e.name];if(void 0!==n){const s="f16"===(null===(t=e.format)||void 0===t?void 0:t.name)?2:1;return new Sd(Math.max(i,n.align/s),Math.max(r,n.size/s))}}{const t=Md._typeInfo[e.name.substring(0,e.name.length-1)];if(t){const n="h"===e.name[e.name.length-1]?2:1;return new Sd(Math.max(i,t.align/n),Math.max(r,t.size/n))}}if(e instanceof vd){let t=e,s=8,o=8;const a=this._getTypeSize(t.format);null!==a&&(o=a.size,s=a.align);return o=t.count*this._getAttributeNum(null!==(n=null===e||void 0===e?void 0:e.attributes)&&void 0!==n?n:null,"stride",this._roundUp(s,o)),r&&(o=r),new Sd(Math.max(i,s),Math.max(r,o))}if(e instanceof yd){let t=0,n=0,s=0,o=0,a=0;for(const r of e.members){const e=this._getTypeSize(r.type);null!==e&&(t=Math.max(e.align,t),s=this._roundUp(e.align,s+o),o=e.size,a=s)}return n=this._roundUp(t,a+o),new Sd(Math.max(i,t),Math.max(r,n))}return null}_isUniformVar(e){return e instanceof mh&&"uniform"==e.storage}_isStorageVar(e){return e instanceof mh&&"storage"==e.storage}_isTextureVar(e){return e instanceof mh&&null!==e.type&&-1!=Md._textureTypes.indexOf(e.type.name)}_isSamplerVar(e){return e instanceof mh&&null!==e.type&&-1!=Md._samplerTypes.indexOf(e.type.name)}_getAttribute(e,t){const n=e;if(!n||!n.attributes)return null;const r=n.attributes;for(let i of r)if(i.name==t)return i;return null}_getAttributeNum(e,t,n){if(null===e)return n;for(let r of e)if(r.name==t){let e=null!==r&&null!==r.value?r.value:n;return e instanceof Array&&(e=e[0]),"number"===typeof e?e:"string"===typeof e?parseInt(e):n}return n}_roundUp(e,t){return Math.ceil(t/e)*e}}function Ld(e){const t={attributes:[],bindings:[]};let n;try{n=function(e){try{return new Md(e)}catch(t){if(t instanceof Error)throw t;let e="WGSL parse error";throw"object"===typeof t&&t?.message&&(e+=`: ${t.message} `),"object"===typeof t&&t?.token&&(e+=t.token.line||""),new Error(e,{cause:t})}}(e)}catch(s){return va.error(s.message)(),t}for(const o of n.uniforms){const e=[];for(const t of o.type?.members||[])e.push({name:t.name,type:Id(t.type)});t.bindings.push({type:"uniform",name:o.name,group:o.group,location:o.binding,members:e})}for(const o of n.textures)t.bindings.push({type:"texture",name:o.name,group:o.group,location:o.binding});for(const o of n.samplers)t.bindings.push({type:"sampler",name:o.name,group:o.group,location:o.binding});const r=n.entry.vertex[0],i=r?.inputs.length||0;for(let o=0;o<i;o++){const e=r.inputs[o];if("location"===e.locationType){const n=Id(e.type);t.attributes.push({name:e.name,location:Number(e.location),type:n})}}return t}function Id(e){return e.format?`${e.name}<${e.format.name}>`:e.name}Md._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Md._textureTypes=dd.any_texture_type.map((e=>e.name)),Md._samplerTypes=dd.sampler_type.map((e=>e.name));const Od={};function Nd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";Od[e]=Od[e]||1;return`${e}-${Od[e]++}`}class Fd{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||Nd("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&Sa.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function Dd(e,t){if(t instanceof Fd)return t;const n=function(e,t){if(!t.indices)return;const n=t.indices.value;return e.createBuffer({usage:Sa.INDEX,data:n})}(e,t),{attributes:r,bufferLayout:i}=function(e,t){const n=[],r={};for(const[s,o]of Object.entries(t.attributes)){let t=s;switch(s){case"POSITION":t="positions";break;case"NORMAL":t="normals";break;case"TEXCOORD_0":t="texCoords";break;case"COLOR_0":t="colors"}if(o){r[t]=e.createBuffer({data:o.value,id:`${s}-buffer`});const{value:i,size:a,normalized:l}=o;n.push({name:t,format:Fu(i,a,l)})}}const i=t._calculateVertexCount(t.attributes,t.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}(e,t);return new Fd({topology:t.topology||"triangle-list",bufferLayout:i,vertexCount:t.vertexCount,indices:n,attributes:r})}class Bd extends Ea{static defaultProps=(()=>({...Ea.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}))();get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,t){super(e,t,Bd.defaultProps),this.shaderLayout=t.shaderLayout}}class Ud{static defaultProps={...Nc.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new Ud(e),e._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createRenderPipeline(e){const t={...Nc.defaultProps,...e},n=this._hashRenderPipeline(t);if(!this._renderPipelineCache[n]){const e=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:void 0});e.hash=n,this._renderPipelineCache[n]={pipeline:e,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(e){const t={...Bd.defaultProps,...e},n=this._hashComputePipeline(t);if(!this._computePipelineCache[n]){const e=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0});e.hash=n,this._computePipelineCache[n]={pipeline:e,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(e){const t=e.hash,n=e instanceof Bd?this._computePipelineCache:this._renderPipelineCache;n[t].useCount--,0===n[t].useCount&&"unused"===this.destroyPolicy&&(n[t].pipeline.destroy(),delete n[t])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,r=this._getHash(JSON.stringify(e.bufferLayout));if("webgl"===this.device.type)return`${t}/${n}V-BL${r}`;{const i=this._getHash(JSON.stringify(e.parameters));return`${t}/${n}V-T${e.topology}P${i}BL${r}`}}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class zd{static defaultProps={...ic.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new zd(e),e._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createShader(e){const t=this._hashShader(e);let n=this._cache[t];if(!n){const r=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=n={shader:r,useCount:0}}return n.useCount++,n.shader}release(e){const t=this._hashShader(e),n=this._cache[t];n&&(n.useCount--,0===n.useCount&&"unused"===this.destroyPolicy&&(delete this._cache[t],n.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}}let Gd=null,Vd=null;function jd(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!jd(e[r],t[r],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const s of r){if(!t.hasOwnProperty(s))return!1;if(!jd(e[s],t[s],n-1))return!1}return!0}return!1}function Wd(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach((n=>{const r=e[n];var i;$c(i=r)||"number"===typeof i||"boolean"===typeof i?t.uniforms[n]=r:t.bindings[n]=r})),t}class $d{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,t){Object.assign(this.options,t);const n=x(Object.values(e).filter((e=>e.dependencies)));for(const r of n)e[r.name]=r;va.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[r,i]of Object.entries(e))this._addModule(i),i.name&&r!==i.name&&!this.options.disableWarnings&&va.warn(`Module name: ${r} vs ${i.name}`)()}destroy(){}setProps(e){for(const t of Object.keys(e)){const n=t,r=e[n]||{},i=this.modules[n];if(!i){this.options.disableWarnings||va.warn(`Module ${t} not found`)();continue}const s=this.moduleUniforms[n],o=this.moduleBindings[n],a=i.getUniforms?.(r,s)||r,{uniforms:l,bindings:c}=Wd(a);this.moduleUniforms[n]={...s,...l},this.moduleBindings[n]={...o,...c}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[t,n]of Object.entries(this.moduleUniforms))for(const[r,i]of Object.entries(n))e[`${t}.${r}`]={type:this.modules[t].uniformTypes?.[r],value:String(i)};return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}let Hd="";async function Xd(e,t){const n=new Image;return n.crossOrigin=t?.crossOrigin||"anonymous",n.src=e.startsWith("http")?e:Hd+e,await n.decode(),t?await createImageBitmap(n,t):await createImageBitmap(n)}class qd{device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,t){this.device=e,this.id=t.id||Nd("async-texture"),"string"===typeof t?.data&&"2d"===t.dimension&&(t={...t,data:Xd(t.data)}),this.ready=new Promise(((e,t)=>{this.resolveReady=()=>{this.isReady=!0,e()},this.rejectReady=t})),this.initAsync(t)}async initAsync(e){const t=e.data,n=await Kd(t).then(undefined,undefined);if(this.destroyed)return;const r={...e,data:n};this.texture=this.device.createTexture(r),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}}async function Kd(e){if(e=await e,Array.isArray(e))return await Promise.all(e.map(Kd));if(e&&"object"===typeof e&&e.constructor===Object){const t=e,n=await Promise.all(Object.values(t)),r=Object.keys(t),i={};for(let e=0;e<r.length;e++)i[r[e]]=n[e];return i}return e}class Yd{static defaultProps=(()=>({...Nc.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:j.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0}))();device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,t){this.props={...Yd.defaultProps,...t},t=this.props,this.id=t.id||Nd("model"),this.device=e,Object.assign(this.userData,t.userData);const n=Object.fromEntries(this.props.modules?.map((e=>[e.name,e]))||[]),r=t.shaderInputs||new $d(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(r);const i=function(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}(e),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if("webgpu"===this.device.type&&this.props.source){this.props.shaderLayout||=Ld(this.props.source);const{source:e,getUniforms:t}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:i,...this.props,modules:s});this.source=e,this._getModuleUniforms=t}else{const{vs:e,fs:t,getUniforms:n}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:i,...this.props,modules:s});this.vs=e,this.fs=t,this._getModuleUniforms=n}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||Ud.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||zd.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.uniforms&&this.setUniformsWebGL(t.uniforms),t.moduleSettings&&this.updateModuleSettingsWebGL(t.moduleSettings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return va.info(2,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const t=this._getBindings();this.pipeline.setBindings(t,{disableWarnings:this.props.disableWarnings}),Qd(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:r}=this.vertexArray,i=r?r.byteLength/("uint32"===r.indexType?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:i,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const t=e&&Dd(this.device,e);if(t){this.setTopology(t.topology||"triangle-list");const e=new Ju(this.bufferLayout);this.bufferLayout=e.mergeBufferLayouts(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)}this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new Ju(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){jd(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,void 0===this.isInstanced&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new sh(this.shaderInputs.modules);for(const[t,n]of Object.entries(this.shaderInputs.modules))if(Zd(n)){const e=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=e}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const n=t?.disableWarnings??this.props.disableWarnings;e.indices&&va.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();const r=new Ju(this.bufferLayout);for(const[i,s]of Object.entries(e)){const e=r.getBufferLayout(i);if(!e){n||va.warn(`Model(${this.id}): Missing layout for buffer "${i}".`)();continue}const t=r.getAttributeNamesForBuffer(e);let o=!1;for(const n of t){const e=this._attributeInfos[n];e&&(this.vertexArray.setBuffer(e.location,s),o=!0)}o||n||va.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${i}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[n,r]of Object.entries(e)){const e=this._attributeInfos[n];e?this.vertexArray.setConstantWebGL(e.location,r):(t?.disableWarnings??this.props.disableWarnings)||va.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){Qd(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:t,uniforms:n}=Wd(this._getModuleUniforms(e));Object.assign(this.bindings,t),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof qd&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,n]of Object.entries(this.bindings))n instanceof qd?n.isReady&&(e[t]=n.texture):e[t]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof wc?e=Math.max(e,t.texture.updateTimestamp):t instanceof Sa||t instanceof Ul?e=Math.max(e,t.updateTimestamp):t instanceof qd?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof cc||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[n]of Object.entries(t))this.pipeline.shaderLayout.attributes.find((e=>e.name===n))||"positions"===n||delete t[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(va.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let r=null;this.source?r=n:this.fs&&(r=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:r}),this._attributeInfos=ou(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=va.level>3?0:1e4;va.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,va.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:va.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=function(e){const t={},n="Values";if(0===e.attributes.length&&!e.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(const r of e.attributes)r&&(t[`in ${r.location} ${r.name}: ${r.type}`]={[n]:r.stepMode||"vertex"});for(const r of e.varyings||[])t[`out ${r.location} ${r.name}`]={[n]:JSON.stringify(r)};return t}(this.pipeline.shaderLayout,this.id);va.table(2,e)();const t=this.shaderInputs.getDebugTable();for(const[r,i]of Object.entries(this.uniforms))t[r]={value:i};va.table(2,t)();const n=this._getAttributeDebugTable();va.table(2,this._attributeInfos)(),va.table(2,n)(),va.groupEnd(2)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const n=e.props.framebuffer;n&&function(e,t){let{id:n,minimap:r,opaque:i,top:s="0",left:o="0",rgbaScale:a=1}=t;Gd||(Gd=document.createElement("canvas"),Gd.id=n,Gd.title=n,Gd.style.zIndex="100",Gd.style.position="absolute",Gd.style.top=s,Gd.style.left=o,Gd.style.border="blue 5px solid",Gd.style.transform="scaleY(-1)",document.body.appendChild(Gd),Vd=Gd.getContext("2d")),Gd.width===e.width&&Gd.height===e.height||(Gd.width=e.width/2,Gd.height=e.height/2,Gd.style.width="400px",Gd.style.height="400px");const l=e.device.readPixelsToArrayWebGL(e),c=Vd?.createImageData(e.width,e.height);if(c){const e=0;for(let t=0;t<l.length;t+=4)c.data[e+t+0]=l[t+0]*a,c.data[e+t+1]=l[t+1]*a,c.data[e+t+2]=l[t+2]*a,c.data[e+t+3]=i?255:l[t+3]*a;Vd?.putImageData(c,0,0)}}(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,n]of Object.entries(this._attributeInfos)){const r=this.vertexArray.attributes[n.location];e[n.location]={name:t,type:n.shaderType,values:r?this._getBufferOrConstantValues(r,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,n="uint32"===t.indexType?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,t){const n=Nu(t);return(e instanceof Sa?new n(e.debugData):e).toString()}}function Zd(e){return Boolean(e.uniformTypes&&!Qd(e.uniformTypes))}function Qd(e){for(const t in e)return!1;return!0}class Jd{device;model;transformFeedback;static defaultProps=(()=>({...Yd.defaultProps,outputs:void 0,feedbackBuffers:void 0}))();static isSupported(e){return"webgl"===e?.info?.type}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jd.defaultProps;if(!Jd.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new Yd(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||Qu(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings,...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof Sa)return t.readAsync();const{buffer:n,byteOffset:r=0,byteLength:i=n.byteLength}=t;return n.readAsync(r,i)}}function ef(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Math.fround(e),i=e-r;return t[n]=r,t[n+1]=i,t}function tf(e){return e-Math.fround(e)}function nf(e){const t=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=4*n+r;ef(e[4*r+n],t,2*i)}return t}const rf={name:"fp64arithmetic",vs:"\nuniform fp64arithmeticUniforms {\n  uniform float ONE;\n} fp64;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' form.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * fp64.ONE - (t - a);\n  float a_lo = a * fp64.ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * fp64.ONE;\n  float err = b - (sum - a) * fp64.ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *\n    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",defaultUniforms:{ONE:1},uniformTypes:{ONE:"f32"},fp64ify:ef,fp64LowPart:tf,fp64ifyMatrix4:nf};function sf(e){const{source:t,target:n,start:r=0,size:i,getData:s}=e,o=e.end||n.length,a=t.length,l=o-r;if(a>l)return void n.set(t.subarray(0,l),r);if(n.set(t,r),!s)return;let c=a;for(;c<l;){const e=s(c,t);for(let t=0;t<i;t++)n[r+c]=e[t]||0,c++}}function of(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${e}"`)}}function af(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function lf(e){e.push(e.shift())}function cf(e){let{device:t,source:n,target:r}=e;return(!r||r.byteLength<n.byteLength)&&(r?.destroy(),r=t.createBuffer({byteLength:n.byteLength,usage:n.usage})),r}function uf(e){let{device:t,buffer:n,attribute:r,fromLength:i,toLength:s,fromStartIndices:o,getData:a=e=>e}=e;const l=r.doublePrecision&&r.value instanceof Float64Array?2:1,c=r.size*l,u=r.byteOffset,h=r.settings.bytesPerElement<4?u/r.settings.bytesPerElement*4:u,d=r.startIndices,f=o&&d,p=r.isConstant;if(!f&&n&&i>=s)return n;const g=r.value instanceof Float64Array?Float32Array:r.value.constructor,m=p?r.value:new g(r.getBuffer().readSyncWebGL(u,s*g.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!p){const e=a;a=(t,n)=>r.normalizeConstant(e(t,n))}const _=p?(e,t)=>a(m,t):(e,t)=>a(m.subarray(e+u,e+u+c),t),y=n?new Float32Array(n.readSyncWebGL(h,4*i).buffer):new Float32Array(0),v=new Float32Array(s);return function(e){let{source:t,target:n,size:r,getData:i,sourceStartIndices:s,targetStartIndices:o}=e;if(!s||!o)return sf({source:t,target:n,size:r,getData:i}),n;let a=0,l=0;const c=i&&((e,t)=>i(e+l,t)),u=Math.min(s.length,o.length);for(let h=1;h<u;h++){const e=s[h]*r,i=o[h]*r;sf({source:t.subarray(a,e),target:n,start:l,end:i,size:r,getData:c}),a=e,l=i}l<n.length&&sf({source:[],target:n,start:l,size:r,getData:c})}({source:y,target:v,sourceStartIndices:o,targetStartIndices:d,size:c,getData:_}),(!n||n.byteLength<v.byteLength+h)&&(n?.destroy(),n=t.createBuffer({byteLength:v.byteLength+h,usage:35050})),n.write(v,h),n}class hf{constructor(e){let{device:t,attribute:n,timeline:r}=e;this.buffers=[],this.currentLength=0,this.device=t,this.transition=new ms(r),this.attribute=n,this.attributeInTransition=function(e){const{device:t,settings:n,value:r}=e,i=new Zu(t,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=function(e,t){const{doublePrecision:n,settings:r,value:i,size:s}=e,o=n&&i instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=e.settings;if(l)for(const c of Object.values(l))a=Math.max(a,c.vertexOffset??0);return(r.noAlloc?i.length:(t+a)*s)*o}(this.attribute,t),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}const df={name:"interpolation",vs:"uniform interpolationUniforms {\n  float time;\n} interpolation;\n",uniformTypes:{time:"f32"}},ff="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, interpolation.time);\n  gl_Position = vec4(0.0);\n}\n",pf="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aFrom64Low;\nin ATTRIBUTE_TYPE aTo;\nin ATTRIBUTE_TYPE aTo64Low;\nout ATTRIBUTE_TYPE vCurrent;\nout ATTRIBUTE_TYPE vCurrent64Low;\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid main(void) {\n  for (int i=0; i<ATTRIBUTE_SIZE; i++) {\n    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);\n    vCurrent[i] = value.x;\n    vCurrent64Low[i] = value.y;\n  }\n  gl_Position = vec4(0.0);\n}\n";function gf(e){return e.doublePrecision&&e.value instanceof Float64Array}const mf={name:"spring",vs:"uniform springUniforms {\n  float damping;\n  float stiffness;\n} spring;\n",uniformTypes:{damping:"f32",stiffness:"f32"}},_f="#version 300 es\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nin ATTRIBUTE_TYPE aPrev;\nin ATTRIBUTE_TYPE aCur;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vNext;\nout float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE force = delta * spring.stiffness;\n  ATTRIBUTE_TYPE resistance = velocity * spring.damping;\n  return force - resistance + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",yf="#version 300 es\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nin float vIsTransitioningFlag;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  fragColor = vec4(1.0);\n}";const vf={interpolation:class extends hf{constructor(e){let{device:t,attribute:n,timeline:r}=e;super({device:t,attribute:n,timeline:r}),this.type="interpolation",this.transform=function(e,t){const n=t.size,r=of(n),i=af(n),s=t.getBufferLayout();if(gf(t))return new Jd(e,{vs:pf,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[rf,df],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0});return new Jd(e,{vs:ff,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],modules:[df],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}(t,n)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0)return void this.transition.cancel();const{buffers:i,attribute:s}=this;lf(i),i[0]=uf({device:this.device,buffer:i[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter}),i[1]=cf({device:this.device,source:i[0],target:i[1]}),this.setBuffer(i[1]);const{transform:o}=this,a=o.model;let l=Math.floor(this.currentLength/s.size);gf(s)&&(l/=2),a.setVertexCount(l),s.isConstant?(a.setAttributes({aFrom:i[0]}),a.setConstantAttributes({aTo:s.value})):a.setAttributes({aFrom:i[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:i[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:n}=this.transition;let r=n/e;t&&(r=t(r));const{model:i}=this.transform,s={time:r};i.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},spring:class extends hf{constructor(e){let{device:t,attribute:n,timeline:r}=e;super({device:t,attribute:n,timeline:r}),this.type="spring",this.texture=function(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}(t),this.framebuffer=function(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}(t,this.texture),this.transform=function(e,t){const n=of(t.size),r=af(t.size);return new Jd(e,{vs:_f,fs:yf,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[mf],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}(t,n)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;super.start(e,t);const{buffers:i,attribute:s}=this;for(let a=0;a<2;a++)i[a]=uf({device:this.device,buffer:i[a],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter});i[2]=cf({device:this.device,source:i[0],target:i[2]}),this.setBuffer(i[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:n,transition:r}=this,i=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const s={stiffness:i.stiffness,damping:i.damping};t.model.shaderInputs.setProps({spring:s}),t.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),lf(e),this.setBuffer(e[1]);this.device.readPixelsToArrayWebGL(n)[0]>0||r.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}};class bf{constructor(e,t){let{id:n,timeline:r}=t;if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update(e){let{attributes:t,transitions:n,numInstances:r}=e;this.numInstances=r||1;for(const i in t){const e=t[i],r=e.getTransitionSetting(n);r&&this._updateAttribute(i,e,r)}for(const i in this.transitions){const e=t[i];e&&e.getTransitionSetting(n)||this._removeTransition(i)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,n){const r=this.transitions[e];let i=!r||r.type!==n.type;if(i){r&&this._removeTransition(e);const s=vf[n.type];s?this.transitions[e]=new s({attribute:t,timeline:this.timeline,device:this.device}):(Pe.error(`unsupported transition type '${n.type}'`)(),i=!1)}(i||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const wf="attributeManager.invalidate";class Ef{constructor(e){let{id:t="attribute-manager",stats:n,timeline:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.mergeBoundsMemoized=oo(Zn),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new bf(e,{id:`${t}-transitions`,timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);Le(wf,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Le(wf,this,"all")}update(e){let{data:t,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}=e,l=!1;Le("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const e=this.attributes[c],i=e.settings.accessor;e.startIndices=r,e.numInstances=n,s[c]&&Pe.removed(`props.${c}`,`data.attributes.${c}`)(),e.setExternalBuffer(o[c])||e.setBinaryValue("string"===typeof i?o[i]:void 0,t.startIndices)||"string"===typeof i&&!o[i]&&e.setConstantValue(s[i])||e.needsUpdate()&&(l=!0,this._updateAttribute({attribute:e,numInstances:n,data:t,props:s,context:a})),this.needsRedraw=this.needsRedraw||e.needsRedraw()}l&&Le("attributeManager.updateEnd",this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const t=e.map((e=>this.attributes[e]?.getBounds()));return this.mergeBoundsMemoized(t)}getChangedAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:t,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in t){const s=t[i];s.needsRedraw(e)&&!n.hasAttribute(i)&&(r[i]=s)}return r}getBufferLayouts(e){return Object.values(this.getAttributes()).map((t=>t.getBufferLayout(e)))}_add(e,t){for(const n in e){const r=e[n],i={...r,id:n,size:(r.isIndexed?1:r.size)||1,...t};this.attributes[n]=new Zu(this.device,i)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes){this.attributes[t].getUpdateTriggers().forEach((n=>{e[n]||(e[n]=[]),e[n].push(t)}))}this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:r}=this,i=r[e];return i&&i.forEach((e=>{const r=n[e];r&&r.setNeedsUpdate(r.id,t)})),i}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if(Le("attribute.updateStart",t),t.constant)return void t.setConstantValue(t.value);t.allocate(n)&&Le("attribute.allocate",t,n);t.updateBuffer(e)&&(this.needsRedraw=!0,Le("attribute.updateEnd",t,n))}}const Sf=1e-5;function xf(e,t,n,r,i){const s=t-e;return(n-t)*i+-s*r+s+t}function Tf(e,t){if(Array.isArray(e)){let n=0;for(let r=0;r<e.length;r++){const i=e[r]-t[r];n+=i*i}return Math.sqrt(n)}return Math.abs(e-t)}const Af={interpolation:class extends ms{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:r,easing:i}}=this,s=i(e/r);this._value=En(t,n,s)}},spring:class extends ms{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:r}=this.settings,{_prevValue:i=e,_currValue:s=e}=this;let o=function(e,t,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=xf(e[o],t[o],n[o],r,i);return s}return xf(e,t,n,r,i)}(i,s,t,n,r);const a=Tf(o,t),l=Tf(o,s);a<Sf&&l<Sf&&(o=t,this.end()),this._prevValue=s,this._currValue=o}}};class Cf{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,r){const{transitions:i}=this;if(i.has(e)){const n=i.get(e),{value:r=n.settings.fromValue}=n;t=r,this.remove(e)}if(!(r=Yu(r)))return;const s=Af[r.type];if(!s)return void Pe.error(`unsupported transition type '${r.type}'`)();const o=new s(this.timeline);o.start({...r,fromValue:t,toValue:n}),i.set(e,o)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Rf(e,t){const n=kf({newProps:e,oldProps:t,propTypes:e[ie],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(e,t){if(null===t)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=e;r?r(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied");n&&i&&(n=i(e.data,t.data)||n);return n}(e,t);let i=!1;return r||(i=function(e,t){if(null===t)return{all:!0};if("all"in e.updateTriggers){if(If(e,t,"all"))return{all:!0}}const n={};let r=!1;for(const i in e.updateTriggers)if("all"!==i){If(e,t,i)&&(n[i]=!0,r=!0)}return!!r&&n}(e,t)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Lf(e,t),transitionsChanged:Pf(e,t)}}function Pf(e,t){if(!e.transitions)return!1;const n={},r=e[ie];let i=!1;for(const s in e.transitions){const o=r[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&Mf(e[s],t[s],o)&&(n[s]=!0,i=!0)}return!!i&&n}function kf(e){let{newProps:t,oldProps:n,ignoreProps:r={},propTypes:i={},triggerName:s="props"}=e;if(n===t)return!1;if("object"!==typeof t||null===t)return`${s} changed shallowly`;if("object"!==typeof n||null===n)return`${s} changed shallowly`;for(const o of Object.keys(t))if(!(o in r)){if(!(o in n))return`${s}.${o} added`;const e=Mf(t[o],n[o],i[o]);if(e)return`${s}.${o} ${e}`}for(const o of Object.keys(n))if(!(o in r)){if(!(o in t))return`${s}.${o} dropped`;if(!Object.hasOwnProperty.call(t,o)){const e=Mf(t[o],n[o],i[o]);if(e)return`${s}.${o} ${e}`}}return!1}function Mf(e,t,n){let r=n&&n.equal;return r&&!r(e,t,n)?"changed deeply":r||(r=e&&t&&e.equals,!r||r.call(e,t))?r||t===e?null:"changed shallowly":"changed deeply"}function Lf(e,t){if(null===t)return!0;const n=t.extensions,{extensions:r}=e;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function If(e,t,n){let r=e.updateTriggers[n];r=void 0===r||null===r?{}:r;let i=t.updateTriggers[n];i=void 0===i||null===i?{}:i;return kf({oldProps:i,newProps:r,triggerName:n})}function Of(e){if(null===(t=e)||"object"!==typeof t)throw new Error("count(): argument not an object");var t;if("function"===typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"===typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}function Nf(e,t){if(!t)return e;const n={...e,...t};if("defines"in t&&(n.defines={...e.defines,...t.defines}),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some((e=>"project64"===e.name)))){const e=n.modules.findIndex((e=>"project32"===e.name));e>=0&&n.modules.splice(e,1)}if("inject"in t)if(e.inject){const r={...e.inject};for(const e in t.inject)r[e]=(r[e]||"")+t.inject[e];n.inject=r}else n.inject=t.inject;return n}const Ff=[0,0,0];function Df(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t.projectPosition(e);if(n&&t instanceof gs){const[n,i,s=0]=e,o=t.getDistanceScales([n,i]);r[2]=s*o.unitsPerMeter[2]}return r}function Bf(e,t){let{viewport:n,modelMatrix:r,coordinateSystem:i,coordinateOrigin:s,offsetMode:o}=t,[a,l,c=0]=e;switch(r&&([a,l,c]=fr([],[a,l,c,1],r)),i){case Yi.LNGLAT:return Df([a,l,c],n,o);case Yi.LNGLAT_OFFSETS:return Df([a+s[0],l+s[1],c+(s[2]||0)],n,o);case Yi.METER_OFFSETS:return Df(Vr(s,[a,l,c]),n,o);case Yi.CARTESIAN:default:return n.isGeospatial?[a+s[0],l+s[1],c+s[2]]:n.projectPosition([a,l,c])}}function Uf(e,t){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(e){const{viewport:t,modelMatrix:n,coordinateOrigin:r}=e;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=e;return i===Yi.DEFAULT&&(i=t.isGeospatial?Yi.LNGLAT:Yi.CARTESIAN),void 0===s&&(s=i),void 0===o&&(o=r),{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(t),{autoOffset:l=!0}=t,{geospatialOrigin:c=Ff,shaderCoordinateOrigin:u=Ff,offsetMode:h=!1}=l?po(n,r,i):{},d=Bf(e,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:h});if(h){const e=n.projectPosition(c||u);Un(d,d,e)}return d}const zf={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Gf={};const Vf={boolean:{validate:(e,t)=>!0,equal:(e,t,n)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||$f(e)&&(3===e.length||4===e.length),equal:(e,t,n)=>ls(e,t,1)},accessor:{validate(e,t){const n=Hf(e);return"function"===n||n===Hf(t.value)},equal:(e,t,n)=>"function"===typeof t||ls(e,t,1)},array:{validate:(e,t)=>t.optional&&!e||$f(e),equal(e,t,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?ls(e,t,i):e===t}},object:{equal(e,t,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?ls(e,t,i):e===t}},function:{validate:(e,t)=>t.optional&&!e||"function"===typeof e,equal:(e,t,n)=>!n.compare&&!1!==n.ignore||e===t},data:{transform:(e,t,n)=>{if(!e)return e;const{dataTransform:r}=n.props;return r?r(e):"string"===typeof e.shape&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,n)=>{const r=n.context;return r&&r.device?function(e,t,n,r){if(n instanceof Ul)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const s=t.createTexture({...n,sampler:{...zf,...i,...r},mipmaps:!0});return Gf[s.id]=e,s}(n.id,r.device,e,{...t.parameters,...n.props.textureParameters}):null},release:(e,t,n)=>{var r,i;r=n.id,(i=e)&&i instanceof Ul&&Gf[i.id]===r&&(i.delete(),delete Gf[i.id])}}};function jf(e,t){switch(Hf(t)){case"object":return Wf(e,t);case"array":return Wf(e,{type:"array",value:t,compare:!1});case"boolean":return Wf(e,{type:"boolean",value:t});case"number":return Wf(e,{type:"number",value:t});case"function":return Wf(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function Wf(e,t){return"type"in t?{name:e,...Vf[t.type],...t}:"value"in t?{name:e,type:Hf(t.value),...t}:{name:e,type:"object",value:t}}function $f(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function Hf(e){return $f(e)?"array":null===e?"null":typeof e}const Xf="_mergedDefaultProps";function qf(e,t){if(!(e instanceof ep.constructor))return{};let n=Xf;if(t)for(const i of t){const e=i.constructor;e&&(n+=`:${e.extensionName||e.name}`)}const r=Zf(e,n);return r||(e[n]=function(e,t){const n=e.prototype;if(!n)return null;const r=Object.getPrototypeOf(e),i=qf(r),s=Zf(e,"defaultProps")||{},o=function(e){const t={},n={},r={};for(const[i,s]of Object.entries(e)){const e=s?.deprecatedFor;if(e)r[i]=Array.isArray(e)?e:[e];else{const e=jf(i,s);t[i]=e,n[i]=e.value}}return{propTypes:t,defaultProps:n,deprecatedProps:r}}(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),i?.[ie],o.propTypes),c=Object.assign(Object.create(null),i?.[se],o.deprecatedProps);for(const u of t){const e=qf(u.constructor);e&&(Object.assign(a,e),Object.assign(l,e[ie]),Object.assign(c,e[se]))}(function(e,t){const n=function(e){const t=e.componentName;t||Pe.warn(`${e.name}.componentName not specified`)();return t||e.name}(t);Object.defineProperties(e,{id:{writable:!0,value:n}})})(a,e),function(e,t){const n={},r={};for(const i in t){const e=t[i],{name:s,value:o}=e;e.async&&(n[s]=o,r[s]=Kf(s))}e[oe]=n,e[ae]={},Object.defineProperties(e,r)}(a,l),function(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(e){const r=`${this.id}: ${n}`;for(const i of t[n])Yf(this,i)||(this[i]=e);Pe.deprecated(r,t[n].join("/"))()}})}(a,c),a[ie]=l,a[se]=c,0!==t.length||Yf(e,"_propTypes")||(e._propTypes=l);return a}(e,t||[]))}function Kf(e){return{enumerable:!0,set(t){"string"===typeof t||t instanceof Promise||$u(t)?this[ae][e]=t:this[le][e]=t},get(){if(this[le]){if(e in this[le]){return this[le][e]||this[oe][e]}if(e in this[ae]){const t=this[re]&&this[re].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[oe][e]}}return this[oe][e]}}}function Yf(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Zf(e,t){return Yf(e,t)&&e[t]}let Qf=0;class Jf{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.props=function(e,t){let n;for(let s=t.length-1;s>=0;s--){const e=t[s];"extensions"in e&&(n=e.extensions)}const r=qf(e.constructor,n),i=Object.create(r);i[re]=e,i[ae]={},i[le]={};for(let s=0;s<t.length;++s){const e=t[s];for(const t in e)i[t]=e[t]}return Object.freeze(i),i}(this,t),this.id=this.props.id,this.count=Qf++}clone(e){const{props:t}=this,n={};for(const r in t[oe])r in t[le]?n[r]=t[le][r]:r in t[ae]&&(n[r]=t[ae][r]);return new this.constructor({...t,...n,...e})}}Jf.componentName="Component",Jf.defaultProps={};const ep=Jf,tp=Object.freeze({});class np{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||tp}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[re]||this.component;const t=e[le]||{},n=e[ae]||e,r=e[oe]||{};for(const i in t){const e=t[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,e),t[i]=this.getAsyncProp(i)}for(const i in n){const e=n[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,e)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){this._didAsyncInputValueChange(e,t)&&("string"===typeof t&&(t=this._fetch(e,t)),t instanceof Promise?this._watchPromise(e,t):$u(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const r=this.asyncProps[e];r&&n>=r.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const r=n.pendingLoadCount;t.then((t=>{this.component&&(t=this._postProcessValue(n,t),this._setAsyncPropValue(e,t,r),this._onResolve(e,t))})).catch((t=>{this._onError(e,t)}))}}async _resolveAsyncIterable(e,t){if("data"!==e)return void this._setPropValue(e,t);const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const r=n.pendingLoadCount;let i=[],s=0;for await(const o of t){if(!this.component)return;const{dataTransform:t}=this.component.props;i=t?t(o,i):i.concat(o),Object.defineProperty(i,"__diff",{enumerable:!1,value:[{startRow:s,endRow:i.length}]}),s=i.length,this._setAsyncPropValue(e,i,r)}this._onResolve(e,i)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const n=this.component&&this.component.props[ie];this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class rp extends np{constructor(e){let{attributeManager:t,layer:n}=e;super(n),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,r=n?.props.fetch;return r?r(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const r=n.props.onDataLoad;"data"===e&&r&&r(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,`loading ${e} of ${this.layer}`)}}const ip=2**24-1,sp=Object.freeze([]),op=oo((e=>{let{oldViewport:t,viewport:n}=e;return t.equals(n)}));let ap=new Uint8ClampedArray(0);const lp={data:{type:"data",value:sp,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,t)=>{let{propName:n,layer:r,loaders:i,loadOptions:s,signal:o}=t;const{resourceManager:a}=r.context;s=s||r.getLoadOptions(),i=i||r.props.loaders,o&&(s={...s,fetch:{...s?.fetch,signal:o}});let l=a.contains(e);return l||s||(a.add({resourceId:e,data:pn(e,i),persistent:!1}),l=!0),l?a.subscribe({resourceId:e,onChange:e=>r.internalState?.reloadAsyncProp(n,e),consumerId:r.id,requestId:n}):pn(e,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Yi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:e=>{let{layerIndex:t}=e;return[0,100*-t]}},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class cp extends ep{constructor(){super(...arguments),this.internalState=null,this.lifecycle=Z,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Ss(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=Bf(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,s]=Hr(n,t.pixelProjectionMatrix);return 2===e.length?[r,i]:[r,i,s]}unproject(e){Ss(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Ss(this.internalState);return Uf(e,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(){for(const e of this.getModels())e.shaderInputs.setProps(...arguments)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Yi.DEFAULT||e===Yi.LNGLAT||e===Yi.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Ss(e instanceof Uint8Array);const[t,n,r]=e;return t+256*n+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:Of(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=Nf(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=Nf(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const r of n)t.invalidateAll(r);else t.invalidateAll();if(t){const{props:n}=e,r=this.internalState.hasPickingBuffer,i=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some((e=>e.getNeedsPickingBuffer.call(this,e)));if(r!==i){this.internalState.hasPickingBuffer=i;const{pickingColors:e,instancePickingColors:n}=t.attributes,r=e||n;r&&(i&&r.constant&&(r.constant=!1,t.invalidate(r.id)),r.value||i||(r.constant=!0,r.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo(e){let{info:t,mode:n,sourceLayer:r}=e;const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(e,t){t&&(e=new Error(`${t}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,t&&op({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const n in e)e[n].layoutChanged()&&(t=!0);for(const n of this.getModels())this._setModelAttributes(n,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const e in t)Object.defineProperty(n,e,{value:t[e]});return n}return this.props}calculateInstancePickingColors(e,t){let{numInstances:n}=t;if(e.constant)return;const r=Math.floor(ap.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>ip&&Pe.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),ap=_n.allocate(ap,n,{size:4,copy:!0,maxCount:Math.max(n,ip)});const e=Math.floor(ap.length/4),t=[0,0,0];for(let n=r;n<e;n++)this.encodePickingColor(n,t),ap[4*n+0]=t[0],ap[4*n+1]=t[1],ap[4*n+2]=t[2],ap[4*n+3]=0}e.value=ap.subarray(0,4*n)}_setModelAttributes(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!Object.keys(t).length)return;if(n){const n=this.getAttributeManager();e.setBufferLayout(n.getBufferLayouts(e)),t=n.getAttributes()}const r=e.userData?.excludeAttributes||{},i={},s={};for(const o in t){if(r[o])continue;const n=t[o].getValue();for(const r in n){const a=n[r];a instanceof Sa?t[o].settings.isIndexed?e.setIndexBuffer(a):i[r]=a:a&&(s[r]=a)}}e.setAttributes(i),e.setConstantAttributes(s)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t))return void this._disablePickingIndex(e);const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r,s=i&&t.attributes&&t.attributes[i.id];if(s&&s.value){const n=s.value,r=this.encodePickingColor(e);for(let e=0;e<t.length;e++){const t=i.getVertexOffset(e);n[t]===r[0]&&n[t+1]===r[1]&&n[t+2]===r[2]&&this._disablePickingIndex(e)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,r=t||n;if(!r)return;const i=r.getVertexOffset(e),s=r.getVertexOffset(e+1);r.buffer.write(new Uint8Array(s-i),i)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==ap.buffer&&(n.value=ap.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Ss(!this.internalState),Ss(Number.isFinite(this.props.coordinateSystem)),Le("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new rp({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Pe.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Cf(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Le("layer.matched",this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Le("layer.update",this,e),!e)return;const t=this.props,n=this.context,r=this.internalState,i=n.viewport,s=this._updateUniformTransition();r.propsInTransition=s,n.viewport=r.viewport||i,this.props=s;try{const e=this._getUpdateParams(),t=this.getModels();if(n.device)this.updateState(e);else try{this.updateState(e)}catch(o){}for(const n of this.props.extensions)n.updateState.call(this,e,n);this.setNeedsRedraw(),this._updateAttributes();const r=this.getModels()[0]!==t[0];this._postUpdate(e,r)}finally{n.viewport=i,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){Le("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer(e){let{renderPass:t,shaderModuleProps:n=null,uniforms:r={},parameters:i={}}=e;this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;try{n&&this.setShaderModuleProps(n);const{getPolygonOffset:e}=this.props,s=e&&e(r)||[0,0];o.device instanceof yu&&o.device.setParametersWebGL({polygonOffset:s});for(const t of this.getModels())t.setParameters(i);if(o.device instanceof yu)o.device.withParametersWebGL(i,(()=>{const e={renderPass:t,shaderModuleProps:n,uniforms:r,parameters:i,context:o};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)}));else{const e={renderPass:t,shaderModuleProps:n,uniforms:r,parameters:i,context:o};for(const t of this.props.extensions)t.draw.call(this,e,t);this.draw(e)}}finally{this.props=s}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let n=!1;if("dataChanged"===r){const i=e[r],s=t[r];i&&Array.isArray(s)&&(t.dataChanged=Array.isArray(i)?s.concat(i):i,n=!0)}t[r]||(t[r]=e[r],n=!0),n&&Le("layer.changeFlag",this,r,e)}const n=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=Rf(e,t);if(n.updateTriggersChanged)for(const r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,t[r],e[r],e.transitions?.[r]);return this.setChangeFlags(n)}validateProps(){!function(e){const t=e[ie];for(const n in t){const r=t[n],{validate:i}=r;if(i&&!i(e[n],r))throw new Error(`Invalid prop ${n}: ${e[n]}`)}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&"function"===typeof n&&(t.highlightColor=n(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Ef(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:r}=e,i=this.state.model;i?.isInstanced&&i.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=n;if(t||r.autoHighlight!==s||r.highlightedObjectIndex!==o||r.highlightColor!==a){const e={};Array.isArray(a)&&(e.highlightColor=a),(t||r.autoHighlight!==s||o!==r.highlightedObjectIndex)&&(e.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:e})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(e);if(t=t||r,t)for(const i of this.props.extensions)i.onNeedsRedraw.call(this,i);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}cp.defaultProps=lp,cp.layerName="Layer";const up=cp,hp={position:"absolute",zIndex:-1};function dp(e,t){if("function"===typeof e)return e(t);if(Array.isArray(e))return e.map((e=>dp(e,t)));if(fp(e)){if(n=e,n.props?.mapStyle)return t.style=hp,(0,r.cloneElement)(e,t);if(function(e){const t=e.type;return t&&t.deckGLViewProps}(e))return(0,r.cloneElement)(e,t)}var n;return e}function fp(e){return e&&"object"===typeof e&&"type"in e||!1}function pp(e){if("function"===typeof e)return(0,r.createElement)(fs,{},e);if(Array.isArray(e))return e.map(pp);if(fp(e)){if(e.type===r.Fragment)return pp(e.props.children);if(Iu(e.type,fs))return e}return e}const gp=(0,r.createContext)();const mp={mixBlendMode:null};function _p(e){e.redrawReason&&(e.deck._drawLayers(e.redrawReason),e.redrawReason=null)}const yp=r.forwardRef((function(e,t){const[n,i]=(0,r.useState)(0),s=(0,r.useRef)({control:null,version:n,forceUpdate:()=>i((e=>e+1))}).current,o=(0,r.useRef)(null),a=(0,r.useRef)(null),l=(0,r.useMemo)((()=>function(e){let{children:t,layers:n=[],views:i=null}=e;const s=[],o=[],a={};return r.Children.forEach(pp(t),(e=>{if(fp(e)){const t=e.type;if(Iu(t,up)){const n=function(e,t){const n={},r=e.defaultProps||{};for(const i in t)r[i]!==t[i]&&(n[i]=t[i]);return new e(n)}(t,e.props);o.push(n)}else s.push(e);if(Iu(t,fs)&&t!==fs&&e.props.id){const n=new t(e.props);a[n.id]=n}}else e&&s.push(e)})),Object.keys(a).length>0&&(Array.isArray(i)?i.forEach((e=>{a[e.id]=e})):i&&(a[i.id]=i),i=Object.values(a)),n=o.length>0?[...o,...n]:n,{layers:n,children:s,views:i}}(e)),[e.layers,e.views,e.children]);let c=!0;const u=t=>c&&e.viewState?(s.viewStateUpdateRequested=t,null):(s.viewStateUpdateRequested=null,e.onViewStateChange?.(t)),h=t=>{c?s.interactionStateUpdateRequested=t:(s.interactionStateUpdateRequested=null,e.onInteractionStateChange?.(t))},d=(0,r.useMemo)((()=>{const t={widgets:[],...e,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:h};return delete t._customRender,s.deck&&s.deck.setProps(t),t}),[e]);(0,r.useEffect)((()=>{const t=e.Deck||Mu;return s.deck=function(e,t,n){const r=new t({...n,_customRender:t=>{e.redrawReason=t;const n=r.getViewports();e.lastRenderedViewports!==n?e.forceUpdate():_p(e)}});return r}(s,t,{...d,parent:o.current,canvas:a.current}),()=>s.deck?.finalize()}),[]),Lu((()=>{_p(s);const{viewStateUpdateRequested:e,interactionStateUpdateRequested:t}=s;e&&u(e),t&&h(t)})),(0,r.useImperativeHandle)(t,(()=>function(e){return{get deck(){return e.deck},pickObject:t=>e.deck.pickObject(t),pickMultipleObjects:t=>e.deck.pickMultipleObjects(t),pickObjects:t=>e.deck.pickObjects(t)}}(s)),[]);const f=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:p,width:g="100%",height:m="100%",id:_,style:y}=e,{containerStyle:v,canvasStyle:b}=(0,r.useMemo)((()=>function(e){let{width:t,height:n,style:r}=e;const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:n},s={left:0,top:0};if(r)for(const o in r)o in mp?s[o]=r[o]:i[o]=r[o];return{containerStyle:i,canvasStyle:s}}({width:g,height:m,style:y})),[g,m,y]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===f||s.version!==n){s.lastRenderedViewports=f,s.version=n;const e=function(e){let{children:t,deck:n,ContextProvider:i=gp.Provider}=e;const{viewManager:s}=n||{};if(!s||!s.views.length)return[];const o={},a=s.views[0].id;for(const r of t){let e=a,t=r;fp(r)&&Iu(r.type,fs)&&(e=r.props.id||a,t=r.props.children);const n=s.getViewport(e),i=s.getViewState(e);if(n){i.padding=n.padding;const{x:r,y:s,width:a,height:l}=n;t=dp(t,{x:r,y:s,width:a,height:l,viewport:n,viewState:i}),o[e]||(o[e]={viewport:n,children:[]}),o[e].children.push(t)}}return Object.keys(o).map((e=>{const{viewport:t,children:s}=o[e],{x:a,y:l,width:c,height:u}=t,h={position:"absolute",left:a,top:l,width:c,height:u},d=`view-${e}`,f=(0,r.createElement)("div",{key:d,id:d,style:h},...s),p={deck:n,viewport:t,container:n.canvas.offsetParent,eventManager:n.eventManager,onViewStateChange:t=>{t.viewId=e,n._onViewStateChange(t)},widgets:[]},g=`view-${e}-context`;return(0,r.createElement)(i,{key:g,value:p},f)}))}({children:l.children,deck:s.deck,ContextProvider:p}),t=(0,r.createElement)("canvas",{key:"canvas",id:_||"deckgl-overlay",ref:a,style:b});s.control=(0,r.createElement)("div",{id:`${_||"deckgl"}-wrapper`,ref:o,style:v},[t,e])}return c=!1,s.control})),vp=yp;class bp extends up{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((e=>e.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo(e){let{info:t}=e;const{object:n}=t;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?(t.object=n.__source.object,t.index=n.__source.index,t):t}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||t}getSubLayerRow(e,t,n){return e.__source={parent:this,object:t,index:n},e}getSubLayerAccessor(e){if("function"===typeof e){const t={index:-1,data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,r)}return e}getSubLayerProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{opacity:t,pickable:n,visible:r,parameters:i,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:a,highlightColor:l,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:h,positionFormat:d,modelMatrix:f,extensions:p,fetch:g,operation:m,_subLayerProps:_}=this.props,y={id:"",updateTriggers:{},opacity:t,pickable:n,visible:r,parameters:i,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:a,highlightColor:l,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:h,positionFormat:d,modelMatrix:f,extensions:p,fetch:g,operation:m},v=_&&e.id&&_[e.id],b=v&&v.updateTriggers,w=e.id||"sublayer";if(v){const t=this.props[ie],n=e.type?e.type._propTypes:{};for(const e in v){const r=n[e]||t[e];r&&"accessor"===r.type&&(v[e]=this.getSubLayerAccessor(v[e]))}}Object.assign(y,e,v),y.id=`${this.props.id}-${w}`,y.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...b};for(const E of p){const e=E.getSubLayerProps.call(this,E);e&&Object.assign(y,e,{updateTriggers:Object.assign(y.updateTriggers,e.updateTriggers)})}return y}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let n=this.internalState.subLayers;const r=!n||this.needsUpdate();if(r){n=Ie(this.renderLayers(),Boolean),this.internalState.subLayers=n}Le("compositeLayer.renderLayers",this,r,n);for(const i of n)i.parent=this}}bp.layerName="CompositeLayer";const wp=bp;function Ep(e){let{data:t,getIndex:n,dataRange:r,replace:i}=e;const{startRow:s=0,endRow:o=1/0}=r,a=t.length;let l=a,c=a;for(let d=0;d<a;d++){const e=n(t[d]);if(l>d&&e>=s&&(l=d),e>=o){c=d;break}}let u=l;const h=c-l!==i.length?t.slice(c):void 0;for(let d=0;d<i.length;d++)t[u++]=i[d];if(h){for(let e=0;e<h.length;e++)t[u++]=h[e];t.length=u}return{startRow:l,endRow:l+i.length}}const Sp={name:"project32",dependencies:[mo],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},xp={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:[0,1,1,1]},vs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nout vec4 picking_vRGBcolor_Avalid;\n\n// Normalize unsigned byte color to 0-1 range\nvec3 picking_normalizeColor(vec3 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\n// Normalize unsigned byte color to 0-1 range\nvec4 picking_normalizeColor(vec4 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\nbool picking_isColorZero(vec3 color) {\n  return dot(color, vec3(1.0)) < 0.00001;\n}\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.00001;\n}\n\n// Check if this vertex is highlighted \nbool isVertexHighlighted(vec3 vertexColor) {\n  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\n  return\n    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\n\n// Set the current picking color\nvoid picking_setPickingColor(vec3 pickingColor) {\n  pickingColor = picking_normalizeColor(pickingColor);\n\n  if (bool(picking.isActive)) {\n    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!bool(picking.isAttribute)) {\n      // Stores the picking color so that the fragment shader can render it during picking\n      picking_vRGBcolor_Avalid.rgb = pickingColor;\n    }\n  } else {\n    // Do the comparison with selected item color in vertex shader as it should mean fewer compares\n    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec2 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec3 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nin vec4 picking_vRGBcolor_Avalid;\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 picking_filterHighlightColor(vec4 color) {\n  // If we are still picking, we don't highlight\n  if (picking.isActive > 0.5) {\n    return color;\n  }\n\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    // Blend in highlight color based on its alpha value\n    float highLightAlpha = picking.highlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 picking_filterPickingColor(vec4 color) {\n  if (bool(picking.isActive)) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 picking_filterColor(vec4 color) {\n  vec4 highlightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highlightColor);\n}\n",getUniforms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};if(void 0===e.highlightedObjectColor);else if(null===e.highlightedObjectColor)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const n=e.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=n}if(e.highlightColor){const n=Array.from(e.highlightColor,(e=>e/255));Number.isFinite(n[3])||(n[3]=1),t.highlightColor=n}void 0!==e.isActive&&(t.isActive=Boolean(e.isActive),t.isAttribute=Boolean(e.isAttribute));void 0!==e.useFloatColors&&(t.useFloatColors=Boolean(e.useFloatColors));return t}};const Tp={...xp,defaultUniforms:{...xp.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}};class Ap{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:t={},indices:n=null,vertexCount:r=null}=e;this.id=e.id||Nd("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[i,s]of Object.entries(t)){const e=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(e.value))throw new Error(`${this._print(i)}: must be typed array or object with value as typed array`);if("POSITION"!==i&&"positions"!==i||e.size||(e.size=3),"indices"===i){if(this.indices)throw new Error("Multiple indices detected");this.indices=e}else this.attributes[i]=e}this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=r||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const r of Object.values(e)){const{value:e,size:t,constant:i}=r;!i&&e&&void 0!==t&&t>=1&&(n=Math.min(n,e.length/t))}return n}}const Cp="uniform iconUniforms {\n  float sizeScale;\n  vec2 iconsTextureDim;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  bool billboard;\n  highp int sizeUnits;\n  float alphaCutoff;\n} icon;\n",Rp={name:"icon",vs:Cp,fs:Cp,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}},Pp=()=>{},kp={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Mp={x:0,y:0,width:0,height:0};function Lp(e,t,n,r){const i=Math.min(n/t.width,r/t.height),s=Math.floor(t.width*i),o=Math.floor(t.height*i);return 1===i?{image:t,width:s,height:o}:(e.canvas.height=o,e.canvas.width=s,e.clearRect(0,0,s,o),e.drawImage(t,0,0,t.width,t.height,0,0,s,o),{image:e.canvas,width:s,height:o})}function Ip(e){return e&&(e.id||e.url)}function Op(e,t,n){for(let r=0;r<t.length;r++){const{icon:i,xOffset:s}=t[r];e[Ip(i)]={...i,x:s,y:n}}}class Np{constructor(e,t){let{onUpdate:n=Pp,onError:r=Pp}=t;this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=n,this.onError=r}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?Ip(e):e;return this._mapping[t]||Mp}setProps(e){let{loadOptions:t,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}=e;t&&(this._loadOptions=t),void 0!==n&&(this._autoPacking=n),i&&(this._mapping=i),r&&(this._texture?.delete(),this._texture=null,this._externalTexture=r),s&&(this._samplerParameters=s)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||"undefined"===typeof document)return;const n=Object.values(function(e,t,n){if(!e||!t)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Wu(e);for(const o of i){s.index++;const e=t(o,s),i=Ip(e);if(!e)throw new Error("Icon is missing.");if(!e.url)throw new Error("Icon url is missing.");r[i]||n[i]&&e.url===n[i].url||(r[i]={...e,source:o,sourceIndex:s.index})}return r}(e,t,this._mapping)||{});if(n.length>0){const{mapping:e,xOffset:t,yOffset:r,rowHeight:i,canvasHeight:s}=function(e){let{icons:t,buffer:n,mapping:r={},xOffset:i=0,yOffset:s=0,rowHeight:o=0,canvasWidth:a}=e,l=[];for(let u=0;u<t.length;u++){const e=t[u];if(!r[Ip(e)]){const{height:t,width:c}=e;i+c+n>a&&(Op(r,l,s),i=0,s=o+s+n,o=0,l=[]),l.push({icon:e,xOffset:i}),i=i+c+n,o=Math.max(o,t)}}return l.length>0&&Op(r,l,s),{mapping:r,rowHeight:o,xOffset:i,yOffset:s,canvasWidth:a,canvasHeight:(c=o+s+n,Math.pow(2,Math.ceil(Math.log2(c))))};var c}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=e,this._xOffset=t,this._yOffset=r,this._canvasHeight=s,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||kp,mipmaps:!0})),this._texture.height!==this._canvasHeight&&(this._texture=function(e,t,n,r){const{width:i,height:s,device:o}=e,a=o.createTexture({format:"rgba8unorm",width:t,height:n,sampler:r,mipmaps:!0}),l=o.createCommandEncoder();return l.copyTextureToTexture({sourceTexture:e,destinationTexture:a,width:i,height:s}),l.finish(),e.destroy(),a}(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||kp)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of e)this._pendingCount++,pn(n.url,this._loadOptions).then((e=>{const r=Ip(n),i=this._mapping[r],{x:s,y:o,width:a,height:l}=i,{image:c,width:u,height:h}=Lp(t,e,a,l);this._texture?.copyExternalImage({image:c,x:s+(a-u)/2,y:o+(l-h)/2,width:u,height:h}),i.width=u,i.height=h,this._texture.generateMipmap(),this.onUpdate()})).catch((e=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:e})})).finally((()=>{this._pendingCount--}))}}const Fp=[0,0,0,255],Dp={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:Fp},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class Bp extends up{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME icon-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceSizes;\nin float instanceAngles;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin vec4 instanceIconFrames;\nin float instanceColorModes;\nin vec2 instanceOffsets;\nin vec2 instancePixelOffset;\nout float vColorMode;\nout vec4 vColor;\nout vec2 vTextureCoords;\nout vec2 uv;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = angle * PI / 180.0;\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvec2 iconSize = instanceIconFrames.zw;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),\nicon.sizeMinPixels, icon.sizeMaxPixels\n);\nfloat instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\nvec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\npixelOffset += instancePixelOffset;\npixelOffset.y *= -1.0;\nif (icon.billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvTextureCoords = mix(\ninstanceIconFrames.xy,\ninstanceIconFrames.xy + iconSize,\n(positions.xy + 1.0) / 2.0\n) / icon.iconsTextureDim;\nvColor = instanceColors;\nDECKGL_FILTER_COLOR(vColor, geometry);\nvColorMode = instanceColorModes;\n}\n",fs:"#version 300 es\n#define SHADER_NAME icon-layer-fragment-shader\nprecision highp float;\nuniform sampler2D iconsTexture;\nin float vColorMode;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec4 texColor = texture(iconsTexture, vTextureCoords);\nvec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\nfloat a = texColor.a * layer.opacity * vColor.a;\nif (a < icon.alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color, a);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Sp,Tp,Rp]})}initializeState(){this.state={iconManager:new Np(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:Fp},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:r}=e,i=this.getAttributeManager(),{iconAtlas:s,iconMapping:o,data:a,getIcon:l,textureParameters:c}=t,{iconManager:u}=this.state;if("string"===typeof s)return;const h=s||this.internalState.isAsyncPropLoading("iconAtlas");u.setProps({loadOptions:t.loadOptions,autoPacking:!h,iconAtlas:s,iconMapping:h?o:null,textureParameters:c}),h?n.iconMapping!==t.iconMapping&&i.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&u.packIcons(a,l),r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw(e){let{uniforms:t}=e;const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();if(c){const e=this.state.model,t={iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:Qi[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a};e.shaderInputs.setProps({icon:t}),e.draw(this.context.renderPass)}}_getModel(){return new Yd(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ap({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([-1,-1,1,-1,-1,1,1,1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){const t=this.getCurrentLayer()?.props.onIconError;t?t(e):Pe.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:n,anchorX:r=t/2,anchorY:i=n/2}=this.state.iconManager.getIconMapping(e);return[t/2-r,n/2-i]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:n,width:r,height:i}=this.state.iconManager.getIconMapping(e);return[t,n,r,i]}}Bp.defaultProps=Dp,Bp.layerName="IconLayer";const Up=Bp,zp="uniform scatterplotUniforms {\n  float radiusScale;\n  float radiusMinPixels;\n  float radiusMaxPixels;\n  float lineWidthScale;\n  float lineWidthMinPixels;\n  float lineWidthMaxPixels;\n  float stroked;\n  bool filled;\n  bool antialiasing;\n  bool billboard;\n  highp int radiusUnits;\n  highp int lineWidthUnits;\n} scatterplot;\n",Gp={name:"scatterplot",vs:zp,fs:zp,uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},Vp=[0,0,0,255],jp={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Vp},getLineColor:{type:"accessor",value:Vp},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Wp extends up{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-vertex-shader\nin vec3 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin float instanceRadius;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout vec2 unitPosition;\nout float innerUnitRadius;\nout float outerRadiusPixels;\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\nouterRadiusPixels = clamp(\nproject_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),\nscatterplot.radiusMinPixels, scatterplot.radiusMaxPixels\n);\nfloat lineWidthPixels = clamp(\nproject_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),\nscatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels\n);\nouterRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;\nfloat edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\nunitPosition = edgePadding * positions.xy;\ngeometry.uv = unitPosition;\ngeometry.pickingColor = instancePickingColors;\ninnerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;\nif (scatterplot.billboard) {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = edgePadding * positions * outerRadiusPixels;\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME scatterplot-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin vec2 unitPosition;\nin float innerUnitRadius;\nin float outerRadiusPixels;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = unitPosition;\nfloat distToCenter = length(unitPosition) * outerRadiusPixels;\nfloat inCircle = scatterplot.antialiasing ?\nsmoothedge(distToCenter, outerRadiusPixels) :\nstep(distToCenter, outerRadiusPixels);\nif (inCircle == 0.0) {\ndiscard;\n}\nif (scatterplot.stroked > 0.5) {\nfloat isLine = scatterplot.antialiasing ?\nsmoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\nstep(innerUnitRadius * outerRadiusPixels, distToCenter);\nif (scatterplot.filled) {\nfragColor = mix(vFillColor, vLineColor, isLine);\n} else {\nif (isLine == 0.0) {\ndiscard;\n}\nfragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n}\n} else if (scatterplot.filled == false) {\ndiscard;\n} else {\nfragColor = vFillColor;\n}\nfragColor.a *= inCircle;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Sp,Tp,Gp]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw(e){let{uniforms:t}=e;const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f}=this.props,p={stroked:o,filled:a,billboard:l,antialiasing:c,radiusUnits:Qi[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Qi[u],lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:f},g=this.state.model;g.shaderInputs.setProps({scatterplot:p}),g.draw(this.context.renderPass)}_getModel(){return new Yd(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ap({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0])}}}),isInstanced:!0})}}Wp.defaultProps=jp,Wp.layerName="ScatterplotLayer";const $p=Wp,Hp="uniform sdfUniforms {\n  float gamma;\n  bool enabled;\n  float buffer;\n  float outlineBuffer;\n  vec4 outlineColor;\n} sdf;\n",Xp={name:"sdf",vs:Hp,fs:Hp,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}},qp=.75,Kp=[];class Yp extends Up{getShaders(){const e=super.getShaders();return{...e,modules:[...e.modules,Xp],fs:"#version 300 es\n#define SHADER_NAME multi-icon-layer-fragment-shader\nprecision highp float;\nuniform sampler2D iconsTexture;\nin vec4 vColor;\nin vec2 vTextureCoords;\nin vec2 uv;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nif (!bool(picking.isActive)) {\nfloat alpha = texture(iconsTexture, vTextureCoords).a;\nvec4 color = vColor;\nif (sdf.enabled) {\nfloat distance = alpha;\nalpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);\nif (sdf.outlineBuffer > 0.0) {\nfloat inFill = alpha;\nfloat inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);\ncolor = mix(sdf.outlineColor, vColor, inFill);\nalpha = inBorder;\n}\n}\nfloat a = alpha * color.a;\nif (a < icon.alphaCutoff) {\ndiscard;\n}\nfragColor = vec4(color.rgb, a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"}}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(n,r)}}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;let{outlineColor:r}=t;r!==n.outlineColor&&(r=r.map((e=>e/255)),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!t.sdf&&t.outlineWidth&&Pe.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:t,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state,s=r?Math.max(n,qp*(1-r)):-1,o=this.state.model,a={buffer:qp,outlineBuffer:s,gamma:n,enabled:Boolean(t),outlineColor:i};if(o.shaderInputs.setProps({sdf:a}),super.draw(e),t&&r){const{iconManager:e}=this.state;e.getTexture()&&(o.shaderInputs.setProps({sdf:{...a,outlineBuffer:qp}}),o.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap((e=>super.getInstanceOffset(e))):Kp}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap((e=>super.getInstanceIconFrame(e))):Kp}}Yp.defaultProps={getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},Yp.layerName="MultiIconLayer";const Zp=Yp,Qp=1e20;class Jp{constructor(){let{fontSize:e=24,buffer:t=3,radius:n=8,cutoff:r=.25,fontFamily:i="sans-serif",fontWeight:s="normal",fontStyle:o="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=r,this.radius=n;const a=this.size=e+4*t,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${o} ${s} ${e}px ${i}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:i,actualBoundingBoxRight:s}=this.ctx.measureText(e),o=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-i))),l=Math.min(this.size-this.buffer,o+Math.ceil(r)),c=a+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),f={data:d,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return f;const{ctx:p,buffer:g,gridInner:m,gridOuter:_}=this;p.clearRect(g,g,a,l),p.fillText(e,g,g+o);const y=p.getImageData(g,g,a,l);_.fill(Qp,0,h),m.fill(0,0,h);for(let v=0;v<l;v++)for(let e=0;e<a;e++){const t=y.data[4*(v*a+e)+3]/255;if(0===t)continue;const n=(v+g)*c+e+g;if(1===t)_[n]=0,m[n]=Qp;else{const e=.5-t;_[n]=e>0?e*e:0,m[n]=e<0?e*e:0}}eg(_,0,0,c,u,c,this.f,this.v,this.z),eg(m,g,g,a,l,c,this.f,this.v,this.z);for(let v=0;v<h;v++){const e=Math.sqrt(_[v])-Math.sqrt(m[v]);d[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return f}}function eg(e,t,n,r,i,s,o,a,l){for(let c=t;c<t+r;c++)tg(e,n*s+c,s,i,o,a,l);for(let c=n;c<n+i;c++)tg(e,c*s+t,1,r,o,a,l)}function tg(e,t,n,r,i,s,o){s[0]=0,o[0]=-Qp,o[1]=Qp,i[0]=e[t];for(let a=1,l=0,c=0;a<r;a++){i[a]=e[t+a*n];const r=a*a;do{const e=s[l];c=(i[a]-i[e]+r-e*e)/(a-e)/2}while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=Qp}for(let a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;const r=s[l],c=a-r;e[t+a*n]=i[r]+c*c}}const ng=[];function rg(e,t,n,r){let i=0;for(let s=t;s<n;s++){const t=e[s];i+=r[t]?.layoutWidth||0}return i}function ig(e,t,n,r,i,s){let o=t,a=0;for(let l=t;l<n;l++){const t=rg(e,l,l+1,i);a+t>r&&(o<l&&s.push(l),o=l,a=0),a+=t}return a}function sg(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0;void 0===s&&(s=e.length);const o=[];return"break-all"===t?ig(e,i,s,n,r,o):function(e,t,n,r,i,s){let o=t,a=t,l=t,c=0;for(let u=t;u<n;u++)if(" "===e[u]?l=u+1:" "!==e[u+1]&&u+1!==n||(l=u+1),l>a){let t=rg(e,a,l,i);c+t>r&&(o<a&&(s.push(a),o=a,c=0),t>r&&(t=ig(e,a,l,r,i,s),o=s[s.length-1])),a=l,c+=t}}(e,i,s,n,r,o),o}function og(e,t,n,r,i,s){let o=0,a=0;for(let l=t;l<n;l++){const t=e[l],n=r[t];n?(a||(a=n.layoutHeight),i[l]=o+n.layoutWidth/2,o+=n.layoutWidth):(Pe.warn(`Missing character: ${t} (${t.codePointAt(0)})`)(),i[l]=o,o+=32)}s[0]=o,s[1]=a}class ag{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this._cache={},this._order=[],this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}const lg={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let cg=new ag(3);function ug(e,t){for(let n=0;n<e.length;n++)t.data[4*n+3]=e[n]}function hg(e,t,n,r){e.font=`${r} ${n}px ${t}`,e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}class dg{constructor(){this.props={...lg}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:t}=this.props;return(1.2*e+2*t)/e}setProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.props,e),this._key=this._getKey();const t=function(e,t){let n;n="string"===typeof t?new Set(Array.from(t)):new Set(t);const r=cg.get(e);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}(this._key,this.props.characterSet),n=cg.get(this._key);if(n&&0===t.size)return void(this._atlas!==n&&(this._atlas=n));const r=this._generateFontAtlas(t,n);this._atlas=r,cg.set(this._key,r)}_generateFontAtlas(e,t){const{fontFamily:n,fontWeight:r,fontSize:i,buffer:s,sdf:o,radius:a,cutoff:l}=this.props;let c=t&&t.data;c||(c=document.createElement("canvas"),c.width=1024);const u=c.getContext("2d",{willReadFrequently:!0});hg(u,n,i,r);const{mapping:h,canvasHeight:d,xOffset:f,yOffset:p}=function(e){let{characterSet:t,getFontWidth:n,fontHeight:r,buffer:i,maxCanvasWidth:s,mapping:o={},xOffset:a=0,yOffset:l=0}=e,c=0,u=a;const h=r+2*i;for(const f of t)if(!o[f]){const e=n(f);u+e+2*i>s&&(u=0,c++),o[f]={x:u+i,y:l+c*h+i,width:e,height:h,layoutWidth:e,layoutHeight:r},u+=e+2*i}return{mapping:o,xOffset:u,yOffset:l+c*h,canvasHeight:(d=l+(c+1)*h,Math.pow(2,Math.ceil(Math.log2(d))))};var d}({getFontWidth:e=>u.measureText(e).width,fontHeight:1.2*i,buffer:s,characterSet:e,maxCanvasWidth:1024,...t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}});if(c.height!==d){const e=u.getImageData(0,0,c.width,c.height);c.height=d,u.putImageData(e,0,0)}if(hg(u,n,i,r),o){const t=new Jp({fontSize:i,buffer:s,radius:a,cutoff:l,fontFamily:n,fontWeight:`${r}`});for(const n of e){const{data:e,width:r,height:s,glyphTop:o}=t.draw(n);h[n].width=r,h[n].layoutOffsetY=.9*i-o;const a=u.createImageData(r,s);ug(e,a),u.putImageData(a,h[n].x,h[n].y)}}else for(const g of e)u.fillText(g,h[g].x,h[g].y+s+.9*i);return{xOffset:f,yOffset:p,mapping:h,data:c,width:c.width,height:c.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:n,buffer:r,sdf:i,radius:s,cutoff:o}=this.props;return i?`${e} ${t} ${n} ${r} ${s} ${o}`:`${e} ${t} ${n} ${r}`}}const fg="uniform textBackgroundUniforms {\n  bool billboard;\n  float sizeScale;\n  float sizeMinPixels;\n  float sizeMaxPixels;\n  vec4 padding;\n  highp int sizeUnits;\n  bool stroked;\n} textBackground;\n",pg={name:"textBackground",vs:fg,fs:fg,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}},gg={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class mg extends up{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME text-background-layer-vertex-shader\nin vec2 positions;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceRects;\nin float instanceSizes;\nin float instanceAngles;\nin vec2 instancePixelOffsets;\nin float instanceLineWidths;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin vec3 instancePickingColors;\nout vec4 vFillColor;\nout vec4 vLineColor;\nout float vLineWidth;\nout vec2 uv;\nout vec2 dimensions;\nvec2 rotate_by_angle(vec2 vertex, float angle) {\nfloat angle_radian = radians(angle);\nfloat cos_angle = cos(angle_radian);\nfloat sin_angle = sin(angle_radian);\nmat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\nreturn rotationMatrix * vertex;\n}\nvoid main(void) {\ngeometry.worldPosition = instancePositions;\ngeometry.uv = positions;\ngeometry.pickingColor = instancePickingColors;\nuv = positions;\nvLineWidth = instanceLineWidths;\nfloat sizePixels = clamp(\nproject_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),\ntextBackground.sizeMinPixels, textBackground.sizeMaxPixels\n);\ndimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;\nvec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);\npixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\npixelOffset += instancePixelOffsets;\npixelOffset.y *= -1.0;\nif (textBackground.billboard)  {\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nvec3 offset = vec3(pixelOffset, 0.0);\nDECKGL_FILTER_SIZE(offset, geometry);\ngl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n} else {\nvec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\nDECKGL_FILTER_SIZE(offset_common, geometry);\ngl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nvFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vFillColor, geometry);\nvLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);\nDECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME text-background-layer-fragment-shader\nprecision highp float;\nin vec4 vFillColor;\nin vec4 vLineColor;\nin float vLineWidth;\nin vec2 uv;\nin vec2 dimensions;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = uv;\nvec2 pixelPosition = uv * dimensions;\nif (textBackground.stroked) {\nfloat distToEdge = min(\nmin(pixelPosition.x, dimensions.x - pixelPosition.x),\nmin(pixelPosition.y, dimensions.y - pixelPosition.y)\n);\nfloat isBorder = smoothedge(distToEdge, vLineWidth);\nfragColor = mix(vFillColor, vLineColor, isBorder);\n} else {\nfragColor = vFillColor;\n}\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Sp,Tp,pg]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;t.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw(e){let{uniforms:t}=e;const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]);const c=this.state.model,u={billboard:n,stroked:Boolean(a),padding:l,sizeUnits:Qi[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o};c.shaderInputs.setProps({textBackground:u}),c.draw(this.context.renderPass)}_getModel(){return new Yd(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ap({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,0,1,1,1])}}}),isInstanced:!0})}}mg.defaultProps=gg,mg.layerName="TextBackgroundLayer";const _g=mg,yg={start:1,middle:0,end:-1},vg={top:1,center:0,bottom:-1},bg=[0,0,0,255],wg={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:bg},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:lg.characterSet},fontFamily:lg.fontFamily,fontWeight:lg.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:bg},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:bg},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Eg extends wp{constructor(){super(...arguments),this.getBoundingRect=(e,t)=>{let{size:[n,r]}=this.transformParagraph(e,t);const{fontSize:i}=this.state.fontAtlasManager.props;n/=i,r/=i;const{getTextAnchor:s,getAlignmentBaseline:o}=this.props;return[(yg["function"===typeof s?s(e,t):s]-1)*n/2,(vg["function"===typeof o?o(e,t):o]-1)*r/2,n,r]},this.getIconOffsets=(e,t)=>{const{getTextAnchor:n,getAlignmentBaseline:r}=this.props,{x:i,y:s,rowWidth:o,size:[a,l]}=this.transformParagraph(e,t),c=yg["function"===typeof n?n(e,t):n],u=vg["function"===typeof r?r(e,t):r],h=i.length,d=new Array(2*h);let f=0;for(let p=0;p<h;p++){const e=(1-c)*(a-o[p])/2;d[f++]=(c-1)*a/2+e+i[p],d[f++]=(u-1)*l/2+s[p]}return d}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new dg},this.props.maxWidth>0&&Pe.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:n,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText();(this._updateFontAtlas()||t.lineHeight!==n.lineHeight||t.wordBreak!==n.wordBreak||t.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo(e){let{info:t}=e;return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:n}=this.props,{fontAtlasManager:r,characterSet:i}=this.state,s={...e,characterSet:i,fontFamily:t,fontWeight:n};if(!r.mapping)return r.setProps(s),!0;for(const o in s)if(s[o]!==r.props[o])return r.setProps(s),!0;return!1}_updateText(){const{data:e,characterSet:t}=this.props,n=e.attributes?.getText;let r,{getText:i}=this.props,s=e.startIndices;const o="auto"===t&&new Set;if(n&&s){const{texts:t,characterCount:a}=function(e){let{value:t,length:n,stride:r,offset:i,startIndices:s,characterSet:o}=e;const a=t.BYTES_PER_ELEMENT,l=r?r/a:1,c=i?i/a:0,u=s[n]||Math.ceil((t.length-c)/l),h=o&&new Set,d=new Array(n);let f=t;if(l>1||c>0){f=new(0,t.constructor)(u);for(let e=0;e<u;e++)f[e]=t[e*l+c]}for(let p=0;p<n;p++){const e=s[p],t=s[p+1]||u,n=f.subarray(e,t);d[p]=String.fromCodePoint.apply(null,n),h&&n.forEach(h.add,h)}if(h)for(const p of h)o.add(String.fromCodePoint(p));return{texts:d,characterCount:u}}({...ArrayBuffer.isView(n)?{value:n}:n,length:e.length,startIndices:s,characterSet:o});r=a,i=(e,n)=>{let{index:r}=n;return t[r]}}else{const{iterable:t,objectInfo:n}=Wu(e);s=[0],r=0;for(const e of t){n.index++;const t=Array.from(i(e,n)||"");o&&t.forEach(o.add,o),r+=t.length,s.push(r)}}this.setState({getText:i,startIndices:s,numInstances:r,characterSet:o||t})}transformParagraph(e,t){const{fontAtlasManager:n}=this.state,r=n.mapping,i=this.state.getText,{wordBreak:s,lineHeight:o,maxWidth:a}=this.props;return function(e,t,n,r,i){const s=Array.from(e),o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,h=[0,0],d=[0,0];let f=0,p=0,g=0;for(let m=0;m<=o;m++){const e=s[m];if("\n"!==e&&m!==o||(g=m),g>p){const e=u?sg(s,n,r,i,p,g):ng;for(let n=0;n<=e.length;n++){const r=0===n?p:e[n-1],o=n<e.length?e[n]:g;og(s,r,o,i,a,d);for(let e=r;e<o;e++){const t=s[e],n=i[t]?.layoutOffsetY||0;l[e]=f+d[1]/2+n,c[e]=d[0]}f+=d[1]*t,h[0]=Math.max(h[0],d[0])}p=g}"\n"===e&&(a[p]=0,l[p]=0,c[p]=0,p++)}return h[1]=f,{x:a,y:l,rowWidth:c,size:h}}(i(e,t)||"",o,s,a*n.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:t,getText:n,fontAtlasManager:{scale:r,atlas:i,mapping:s},styleVersion:o}=this.state,{data:a,_dataDiff:l,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,getBackgroundColor:p,getBorderColor:g,getBorderWidth:m,backgroundPadding:_,background:y,billboard:v,fontSettings:b,outlineWidth:w,outlineColor:E,sizeScale:S,sizeUnits:x,sizeMinPixels:T,sizeMaxPixels:A,transitions:C,updateTriggers:R}=this.props,P=this.getSubLayerClass("characters",Zp),k=this.getSubLayerClass("background",_g);return[y&&new k({getFillColor:p,getLineColor:g,getLineWidth:m,padding:_,getPosition:c,getSize:h,getAngle:d,getPixelOffset:f,billboard:v,sizeScale:S,sizeUnits:x,sizeMinPixels:T,sizeMaxPixels:A,transitions:C&&{getPosition:C.getPosition,getAngle:C.getAngle,getSize:C.getSize,getFillColor:C.getBackgroundColor,getLineColor:C.getBorderColor,getLineWidth:C.getBorderWidth,getPixelOffset:C.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:R.getPosition,getAngle:R.getAngle,getSize:R.getSize,getFillColor:R.getBackgroundColor,getLineColor:R.getBorderColor,getLineWidth:R.getBorderWidth,getPixelOffset:R.getPixelOffset,getBoundingRect:{getText:R.getText,getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:o}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new P({sdf:b.sdf,smoothing:Number.isFinite(b.smoothing)?b.smoothing:lg.smoothing,outlineWidth:w/(b.radius||lg.radius),outlineColor:E,iconAtlas:i,iconMapping:s,getPosition:c,getColor:u,getSize:h,getAngle:d,getPixelOffset:f,billboard:v,sizeScale:S*r,sizeUnits:x,sizeMinPixels:T*r,sizeMaxPixels:A*r,transitions:C&&{getPosition:C.getPosition,getAngle:C.getAngle,getColor:C.getColor,getSize:C.getSize,getPixelOffset:C.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:R.getText,getPosition:R.getPosition,getAngle:R.getAngle,getColor:R.getColor,getSize:R.getSize,getPixelOffset:R.getPixelOffset,getIconOffsets:{getTextAnchor:R.getTextAnchor,getAlignmentBaseline:R.getAlignmentBaseline,styleVersion:o}}}),{data:a,_dataDiff:l,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(e){!function(e){Pe.assert(Number.isFinite(e)&&e>=3,"Invalid cache limit"),cg=new ag(e)}(e)}}Eg.defaultProps=wg,Eg.layerName="TextLayer";const Sg=Eg;class xg{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:t={}}=e;this.typedArrayManager=_n,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:s,dataChanged:o,normalize:a=!0}=this.opts;if(this.data=t,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===s?2:3),this.buffers=n,this.normalize=a,i&&(Ss(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),a||(n.vertexPositions=i)),this.geometryBuffer=n.vertexPositions,Array.isArray(o))for(const l of o)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry(e){let{startRow:t,endRow:n}=e;this._rebuildGeometry({startRow:t,endRow:n})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?Hu(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:s}=this;for(const o in i)if(o in r)s.release(n[o]),n[o]=null;else{const r=i[o];r.copy=t,n[o]=s.allocate(n[o],e,r)}}_forEachGeometry(e,t,n){const{data:r,getGeometry:i}=this,{iterable:s,objectInfo:o}=Wu(r,t,n);for(const a of s){o.index++;e(i?i(a,o):null,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:s}=this,{startRow:o=0,endRow:a=1/0}=e||{},l={};if(e||(t=[0],n=[0]),this.normalize||!s)this._forEachGeometry(((e,t)=>{const r=e&&this.normalizeGeometry(e);l[t]=r,n[t+1]=n[t]+(r?this.getGeometrySize(r):0)}),o,a),r=n[n.length-1];else if(n=i.startIndices,r=n[i.length]||0,ArrayBuffer.isView(s))r=r||s.length/this.positionSize;else if(s instanceof Sa){const e=4*this.positionSize;r=r||s.byteLength/e}else if(s.buffer){const e=s.stride||4*this.positionSize;r=r||s.buffer.byteLength/e}else if(s.value){const e=s.value,t=s.stride/e.BYTES_PER_ELEMENT||this.positionSize;r=r||e.length/t}this._allocate(r,Boolean(e)),this.indexStarts=t,this.vertexStarts=n,this.instanceCount=r;const c={};this._forEachGeometry(((e,i)=>{const s=l[i]||e;c.vertexStart=n[i],c.indexStart=t[i];const o=i<n.length-1?n[i+1]:r;c.geometrySize=o-n[i],c.geometryIndex=i,this.updateGeometryAttributes(s,c)}),o,a),this.vertexCount=t[t.length-1]}}const Tg=1,Ag=-1;function Cg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{start:n=0,end:r=e.length,plane:i="xy"}=t,s=t.size||2;let o=0;const a=Rg[i[0]],l=Rg[i[1]];for(let c=n,u=r-s;c<r;c+=s)o+=(e[c+a]-e[u+a])*(e[c+l]+e[u+l]),u=c;return o/2}(e,t))}(e,n);return r!==t&&(function(e,t){const{start:n=0,end:r=e.length,size:i=2}=t,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const t=n+a*i,r=n+(s-1-a)*i;for(let n=0;n<i;++n){const i=e[t+n];e[t+n]=e[r+n],e[r+n]=i}}}(e,n),!0)}const Rg={x:0,y:1,z:2};function Pg(e,t,n,r){let i,s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)i=(r[3]-e[1])/(t[1]-e[1]),s=3;else if(4&n)i=(r[1]-e[1])/(t[1]-e[1]),s=1;else if(2&n)i=(r[2]-e[0])/(t[0]-e[0]),s=2;else{if(!(1&n))return null;i=(r[0]-e[0])/(t[0]-e[0]),s=0}for(let a=0;a<e.length;a++)o[a]=(1&s)===a?r[s]:i*(t[a]-e[a])+e[a];return o}function kg(e,t){let n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Mg(e,t){const n=t.length,r=e.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(e[r-n+s]!==t[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)e[r+i]=t[i];return!0}function Lg(e,t){const n=t.length;for(let r=0;r<n;r++)e[r]=t[r]}function Ig(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const s=r+t*n;for(let o=0;o<n;o++)i[o]=e[s+o];return i}function Og(e,t){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=e.length}=t||{},l=(a-o)/n;let c=[];const u=[c],h=Ig(e,0,n,o);let d,f;const p=Dg(h,i,s,[]),g=[];Mg(c,h);for(let m=1;m<l;m++){for(d=Ig(e,m,n,o,d),f=kg(d,p);f;){Pg(h,d,f,p,g);const e=kg(g,p);e&&(Pg(h,g,e,p,g),f=e),Mg(c,g),Lg(h,g),Bg(p,i,f),r&&c.length>n&&(c=[],u.push(c),Mg(c,h)),f=kg(d,p)}Mg(c,d),Lg(h,d)}return r?u:u[0]}function Ng(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(!e.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],l=[{pos:e,types:o?new Array(e.length/r).fill(1):null,holes:t||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:e,types:t,holes:n}=l.shift();Ug(e,r,n[0]||e.length,c),u=Dg(c[0],i,s,u);const h=kg(c[1],u);if(h){let i=Fg(e,t,r,0,n[0]||e.length,u,h);const s={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};l.push(s,a);for(let l=0;l<n.length;l++)i=Fg(e,t,r,n[l],n[l+1]||e.length,u,h),i[0]&&(s.holes.push(s.pos.length),s.pos=zg(s.pos,i[0].pos),o&&(s.types=zg(s.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=zg(a.pos,i[1].pos),o&&(a.types=zg(a.types,i[1].types)))}else{const r={positions:e};o&&(r.edgeTypes=t),n.length&&(r.holeIndices=n),a.push(r)}}return a}function Fg(e,t,n,r,i,s,o){const a=(i-r)/n,l=[],c=[],u=[],h=[],d=[];let f,p,g;const m=Ig(e,a-1,n,r);let _=Math.sign(8&o?m[1]-s[3]:m[0]-s[2]),y=t&&t[a-1],v=0,b=0;for(let w=0;w<a;w++)f=Ig(e,w,n,r,f),p=Math.sign(8&o?f[1]-s[3]:f[0]-s[2]),g=t&&t[r/n+w],p&&_&&_!==p&&(Pg(m,f,o,s,d),Mg(l,d)&&u.push(y),Mg(c,d)&&h.push(y)),p<=0?(Mg(l,f)&&u.push(g),v-=p):u.length&&(u[u.length-1]=0),p>=0?(Mg(c,f)&&h.push(g),b+=p):h.length&&(h[h.length-1]=0),Lg(m,f),_=p,y=g;return[v?{pos:l,types:t&&u}:null,b?{pos:c,types:t&&h}:null]}function Dg(e,t,n,r){const i=Math.floor((e[0]-n[0])/t)*t+n[0],s=Math.floor((e[1]-n[1])/t)*t+n[1];return r[0]=i,r[1]=s,r[2]=i+t,r[3]=s+t,r}function Bg(e,t,n){8&n?(e[1]+=t,e[3]+=t):4&n?(e[1]-=t,e[3]-=t):2&n?(e[0]+=t,e[2]+=t):1&n&&(e[0]-=t,e[2]-=t)}function Ug(e,t,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<n;l+=t){const t=e[l],n=e[l+1];i=t<i?t:i,s=t>s?t:s,o=n<o?n:o,a=n>a?n:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}function zg(e,t){for(let n=0;n<t.length;n++)e.push(t[n]);return e}function Gg(e,t,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=t){const t=Math.abs(e[o]);t>i&&(i=t,s=o-1)}return s}function Vg(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:85.051129;const s=e[n],o=e[r-t];if(Math.abs(s-o)>180){const r=Ig(e,0,t,n);r[0]+=360*Math.round((o-s)/360),Mg(e,r),r[1]=Math.sign(r[1])*i,Mg(e,r),r[0]=s,Mg(e,r)}}function jg(e,t,n,r){let i,s=e[0];for(let o=n;o<r;o+=t){i=e[o];const t=i-s;(t>180||t<-180)&&(i-=360*Math.round(t/360)),e[o]=s=i}}function Wg(e,t){let n;const r=e.length/t;for(let s=0;s<r&&(n=e[s*t],(n+180)%360===0);s++);const i=360*-Math.round(n/360);if(0!==i)for(let s=0;s<r;s++)e[s*t]+=i}function $g(e,t,n,r){let i;if(Array.isArray(e[0])){const n=e.length*t;i=new Array(n);for(let r=0;r<e.length;r++)for(let n=0;n<t;n++)i[r*t+n]=e[r][n]||0}else i=e;return n?Og(i,{size:t,gridResolution:n}):r?function(e,t){const{size:n=2,startIndex:r=0,endIndex:i=e.length,normalize:s=!0}=t||{},o=e.slice(r,i);jg(o,n,0,i-r);const a=Og(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)Wg(l,n);return a}(i,{size:t}):i}class Hg extends xg{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?$g(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(Xg(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize)if(e&&Xg(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const n=this.attributes.segmentTypes,r=!!e&&this.isClosed(e),{vertexStart:i,geometrySize:s}=t;n.fill(0,i,i+s),r?(n[i]=4,n[i+s-2]=4):(n[i]+=1,n[i+s-2]+=2),n[i+s-1]=4}_updatePositions(e,t){const{positions:n}=this.attributes;if(!n||!e)return;const{vertexStart:r,geometrySize:i}=t,s=new Array(3);for(let o=r,a=0;a<i;o++,a++)this.getPointOnPath(e,a,s),n[3*o]=s[0],n[3*o+1]=s[1],n[3*o+2]=s[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{positionSize:r}=this;t*r>=e.length&&(t+=1-e.length/r);const i=t*r;return n[0]=e[i],n[1]=e[i+1],n[2]=3===r&&e[i+2]||0,n}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:t}=this,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(2===t||e[2]===e[n+2])}}function Xg(e){return Array.isArray(e[0])}const qg="uniform pathUniforms {\n  float widthScale;\n  float widthMinPixels;\n  float widthMaxPixels;\n  float jointType;\n  float capType;\n  float miterLimit;\n  bool billboard;\n  highp int widthUnits;\n} path;\n",Kg={name:"path",vs:qg,fs:qg,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}},Yg=[0,0,0,255],Zg={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:Yg},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Qg={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class Jg extends up{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME path-layer-vertex-shader\nin vec2 positions;\nin float instanceTypes;\nin vec3 instanceStartPositions;\nin vec3 instanceEndPositions;\nin vec3 instanceLeftPositions;\nin vec3 instanceRightPositions;\nin vec3 instanceLeftPositions64Low;\nin vec3 instanceStartPositions64Low;\nin vec3 instanceEndPositions64Low;\nin vec3 instanceRightPositions64Low;\nin float instanceStrokeWidths;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nuniform float opacity;\nout vec4 vColor;\nout vec2 vCornerOffset;\nout float vMiterLength;\nout vec2 vPathPosition;\nout float vPathLength;\nout float vJointType;\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\nfloat flipIfTrue(bool flag) {\nreturn -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\nvec3 prevPoint, vec3 currPoint, vec3 nextPoint,\nvec2 width\n) {\nbool isEnd = positions.x > 0.0;\nfloat sideOfPath = positions.y;\nfloat isJoint = float(sideOfPath == 0.0);\nvec3 deltaA3 = (currPoint - prevPoint);\nvec3 deltaB3 = (nextPoint - currPoint);\nmat3 rotationMatrix;\nbool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);\nif (needsRotation) {\ndeltaA3 = deltaA3 * rotationMatrix;\ndeltaB3 = deltaB3 * rotationMatrix;\n}\nvec2 deltaA = deltaA3.xy / width;\nvec2 deltaB = deltaB3.xy / width;\nfloat lenA = length(deltaA);\nfloat lenB = length(deltaB);\nvec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\nvec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\nvec2 perpA = vec2(-dirA.y, dirA.x);\nvec2 perpB = vec2(-dirB.y, dirB.x);\nvec2 tangent = dirA + dirB;\ntangent = length(tangent) > 0. ? normalize(tangent) : perpA;\nvec2 miterVec = vec2(-tangent.y, tangent.x);\nvec2 dir = isEnd ? dirA : dirB;\nvec2 perp = isEnd ? perpA : perpB;\nfloat L = isEnd ? lenA : lenB;\nfloat sinHalfA = abs(dot(miterVec, perp));\nfloat cosHalfA = abs(dot(dirA, miterVec));\nfloat turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\nfloat cornerPosition = sideOfPath * turnDirection;\nfloat miterSize = 1.0 / max(sinHalfA, EPSILON);\nmiterSize = mix(\nmin(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\nmiterSize,\nstep(0.0, cornerPosition)\n);\nvec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n* (sideOfPath + isJoint * turnDirection);\nbool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\nbool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\nbool isCap = isStartCap || isEndCap;\nif (isCap) {\noffsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);\nvJointType = path.capType;\n} else {\nvJointType = path.jointType;\n}\nvPathLength = L;\nvCornerOffset = offsetVec;\nvMiterLength = dot(vCornerOffset, miterVec * turnDirection);\nvMiterLength = isCap ? isJoint : vMiterLength;\nvec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\nvPathPosition = vec2(\ndot(offsetFromStartOfPath, perp),\ndot(offsetFromStartOfPath, dir)\n);\ngeometry.uv = vPathPosition;\nfloat isValid = step(instanceTypes, 3.5);\nvec3 offset = vec3(offsetVec * width * isValid, 0.0);\nif (needsRotation) {\noffset = rotationMatrix * offset;\n}\nreturn offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\nif (position.w < EPSILON) {\nfloat r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\nposition = refPosition + (position - refPosition) * r;\n}\n}\nvoid main() {\ngeometry.pickingColor = instancePickingColors;\nvColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);\nfloat isEnd = positions.x;\nvec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\nvec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\nvec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\nvec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\nvec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\nvec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\ngeometry.worldPosition = currPosition;\nvec2 widthPixels = vec2(clamp(\nproject_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),\npath.widthMinPixels, path.widthMaxPixels) / 2.0);\nvec3 width;\nif (path.billboard) {\nvec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\nvec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\nvec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\nclipLine(prevPositionScreen, currPositionScreen);\nclipLine(nextPositionScreen, currPositionScreen);\nclipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\nwidth = vec3(widthPixels, 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(\nprevPositionScreen.xyz / prevPositionScreen.w,\ncurrPositionScreen.xyz / currPositionScreen.w,\nnextPositionScreen.xyz / nextPositionScreen.w,\nproject_pixel_size_to_clipspace(width.xy)\n);\nDECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\ngl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n} else {\nprevPosition = project_position(prevPosition, prevPosition64Low);\ncurrPosition = project_position(currPosition, currPosition64Low);\nnextPosition = project_position(nextPosition, nextPosition64Low);\nwidth = vec3(project_pixel_size(widthPixels), 0.0);\nDECKGL_FILTER_SIZE(width, geometry);\nvec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\ngeometry.position = vec4(currPosition + offset, 1.0);\ngl_Position = project_common_position_to_clipspace(geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME path-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nin vec2 vCornerOffset;\nin float vMiterLength;\nin vec2 vPathPosition;\nin float vPathLength;\nin float vJointType;\nout vec4 fragColor;\nvoid main(void) {\ngeometry.uv = vPathPosition;\nif (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\nif (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\ndiscard;\n}\nif (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {\ndiscard;\n}\n}\nfragColor = vColor;\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Sp,Tp,Kg]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){const e=!0;this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:Qg,accessor:"getPath",update:this.calculatePositions,noAlloc:e,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:e},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Qg,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:Qg,defaultValue:Yg},instancePickingColors:{size:4,type:"uint8",accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:n,r)}}}),this.setState({pathTesselator:new Hg({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:n}=e,r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:e}=this.state,i=t.data.attributes||{};e.updateGeometry({data:t.data,geometryBuffer:i.getPath,buffers:i,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||r.invalidateAll()}n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),r.invalidateAll())}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find((e=>e.__source.index===n))),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props,u=this.state.model,h={jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Qi[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:c};u.shaderInputs.setProps({path:h}),u.draw(this.context.renderPass)}_getModel(){return new Yd(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ap({topology:"triangle-list",attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}Jg.defaultProps=Zg,Jg.layerName="PathLayer";const em=Jg,tm="precision highp int;\n\n// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\n  vec3 color;\n};\n\nstruct PointLight {\n  vec3 color;\n  vec3 position;\n  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform lightingUniforms {\n  int enabled;\n  int lightType;\n\n  int directionalLightCount;\n  int pointLightCount;\n\n  vec3 ambientColor;\n\n  vec3 lightColor0;\n  vec3 lightPosition0;\n  vec3 lightDirection0;\n  vec3 lightAttenuation0;\n\n  vec3 lightColor1;\n  vec3 lightPosition1;\n  vec3 lightDirection1;\n  vec3 lightAttenuation1;\n\n  vec3 lightColor2;\n  vec3 lightPosition2;\n  vec3 lightDirection2;\n  vec3 lightAttenuation2;\n} lighting;\n\nPointLight lighting_getPointLight(int index) {\n  switch (index) {\n    case 0:\n      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);\n    case 1:\n      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);\n    case 2:\n    default:  \n      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);\n  }\n}\n\nDirectionalLight lighting_getDirectionalLight(int index) {\n  switch (index) {\n    case 0:\n      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);\n    case 1:\n      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);\n    case 2:\n    default:   \n      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);\n  }\n} \n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n// #endif\n";var nm;!function(e){e[e.POINT=0]="POINT",e[e.DIRECTIONAL=1]="DIRECTIONAL"}(nm||(nm={}));const rm={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:3},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:nm.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:"// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\nstruct AmbientLight {\n  color: vec3<f32>,\n};\n\nstruct PointLight {\n  color: vec3<f32>,\n  position: vec3<f32>,\n  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential\n};\n\nstruct DirectionalLight {\n  color: vec3<f32>,\n  direction: vec3<f32>,\n};\n\nstruct lightingUniforms {\n  enabled: i32,\n  poightCount: i32,\n  directionalLightCount: i32,\n\n  ambientColor: vec3<f32>,\n\n  // TODO - support multiple lights by uncommenting arrays below\n  lightType: i32,\n  lightColor: vec3<f32>,\n  lightDirection: vec3<f32>,\n  lightPosition: vec3<f32>,\n  lightAttenuation: vec3<f32>,\n\n  // AmbientLight ambientLight;\n  // PointLight pointLight[MAX_LIGHTS];\n  // DirectionalLight directionalLight[MAX_LIGHTS];\n};\n\n// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)\n@binding(1) @group(0) var<uniform> lighting : lightingUniforms;\n\nfn lighting_getPointLight(index: i32) -> PointLight {\n  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);\n}\n\nfn lighting_getDirectionalLight(index: i32) -> DirectionalLight {\n  return DirectionalLight(lighting.lightColor, lighting.lightDirection);\n} \n\nfn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n",vs:tm,fs:tm,getUniforms:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e=e?{...e}:e))return{...rm.defaultUniforms};e.lights&&(e={...e,...sm(e.lights),lights:void 0});const{ambientLight:n,pointLights:r,directionalLights:i}=e||{};if(!(n||r&&r.length>0||i&&i.length>0))return{...rm.defaultUniforms,enabled:0};const s={...rm.defaultUniforms,...t,...im({ambientLight:n,pointLights:r,directionalLights:i})};void 0!==e.enabled&&(s.enabled=e.enabled?1:0);return s}};function im(e){let{ambientLight:t,pointLights:n=[],directionalLights:r=[]}=e;const i={};i.ambientLightColor=om(t);let s=0;for(const o of n){i.lightType=nm.POINT;const e=s;i[`lightColor${e}`]=om(o),i[`lightPosition${e}`]=o.position,i[`lightAttenuation${e}`]=o.attenuation||[1,0,0],s++}for(const o of r){i.lightType=nm.DIRECTIONAL;const e=s;i[`lightColor${e}`]=om(o),i[`lightDirection${e}`]=o.direction,s++}return s>3&&va.warn("MAX_LIGHTS exceeded")(),i.directionalLightCount=r.length,i.pointLightCount=n.length,i}function sm(e){const t={pointLights:[],directionalLights:[]};for(const n of e||[])switch(n.type){case"ambient":t.ambientLight=n;break;case"directional":t.directionalLights?.push(n);break;case"point":t.pointLights?.push(n)}return t}function om(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t=[0,0,0],intensity:n=1}=e;return t.map((e=>e*n/255))}const am="uniform phongMaterialUniforms {\n  uniform float ambient;\n  uniform float diffuse;\n  uniform float shininess;\n  uniform vec3  specularColor;\n} material;\n",lm={props:{},name:"gouraudMaterial",vs:"uniform phongMaterialUniforms {\n  uniform float ambient;\n  uniform float diffuse;\n  uniform float shininess;\n  uniform vec3  specularColor;\n} material;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n  vec3 halfway_direction = normalize(light_direction + view_direction);\n  float lambertian = dot(light_direction, normal_worldspace);\n  float specular = 0.0;\n  if (lambertian > 0.0) {\n    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n    specular = pow(specular_angle, material.shininess);\n  }\n  lambertian = max(lambertian, 0.0);\n  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting.enabled == 0) {\n    return lightColor;\n  }\n\n  vec3 view_direction = normalize(cameraPosition - position_worldspace);\n  lightColor = material.ambient * surfaceColor * lighting.ambientColor;\n\n  for (int i = 0; i < lighting.pointLightCount; i++) {\n    PointLight pointLight = lighting_getPointLight(i);\n    vec3 light_position_worldspace = pointLight.position;\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));\n    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);\n  }\n\n  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);\n  for (int i = lighting.pointLightCount; i < totalLights; i++) {\n    DirectionalLight directionalLight = lighting_getDirectionalLight(i);\n    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n  }\n  \n  return lightColor;\n}\n".replace("phongMaterial","gouraudMaterial"),fs:am.replace("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[rm],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(e){const t={...e};return t.specularColor&&(t.specularColor=t.specularColor.map((e=>e/255))),{...lm.defaultUniforms,...t}}};var cm=n(232);const um=Tg,hm=Ag,dm={isClosed:!0};function fm(e){return"positions"in e?e.positions:e}function pm(e){return"holeIndices"in e?e.holeIndices:null}function gm(e,t,n,r,i){let s=t;const o=n.length;for(let a=0;a<o;a++)for(let t=0;t<r;t++)e[s++]=n[a][t]||0;if(!function(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}(n))for(let a=0;a<r;a++)e[s++]=n[0][a]||0;return dm.start=t,dm.end=s,dm.size=r,Cg(e,i,dm),s}function mm(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;s=s||n.length;const a=s-i;if(a<=0)return t;let l=t;for(let c=0;c<a;c++)e[l++]=n[i+c];if(!function(e,t,n,r){for(let i=0;i<t;i++)if(e[n+i]!==e[r-t+i])return!1;return!0}(n,r,i,s))for(let c=0;c<r;c++)e[l++]=n[i+c];return dm.start=t,dm.end=l,dm.size=r,Cg(e,o,dm),l}function _m(e,t){!function(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}(e);const n=[],r=[];if("positions"in e){const{positions:i,holeIndices:s}=e;if(s){let e=0;for(let o=0;o<=s.length;o++)e=mm(n,e,i,t,s[o-1],s[o],0===o?um:hm),r.push(e);return r.pop(),{positions:n,holeIndices:r}}e=i}if(!function(e){return Array.isArray(e[0])}(e))return mm(n,0,e,t,0,n.length,um),n;if(!function(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}(e)){let i=0;for(const[s,o]of e.entries())i=gm(n,i,o,t,0===s?um:hm),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return gm(n,0,e,t,um),n}function ym(e,t,n){const r=e.length/3;let i=0;for(let s=0;s<r;s++){const o=(s+1)%r;i+=e[3*s+t]*e[3*o+n],i-=e[3*o+t]*e[3*s+n]}return Math.abs(i/2)}function vm(e,t,n,r){const i=e.length/3;for(let s=0;s<i;s++){const i=3*s,o=e[i+0],a=e[i+1],l=e[i+2];e[i+t]=o,e[i+n]=a,e[i+r]=l}}class bm extends xg{constructor(e){const{fp64:t,IndexType:n=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:n,size:1}}})}get(e){const{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=_m(e,this.positionSize);return this.opts.resolution?Ng(fm(t),pm(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};t=t||[];const o=[],a=[];let l=0,c=0;for(let h=0;h<=t.length;h++){const i=t[h]||e.length,s=c,u=Gg(e,r,l,i);for(let t=u;t<i;t++)o[c++]=e[t];for(let t=l;t<u;t++)o[c++]=e[t];jg(o,r,s,c),Vg(o,r,s,c,n?.maxLatitude),l=i,a[h]=c}a.pop();const u=Ng(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const h of u)Wg(h.positions,r);return u}(fm(t),pm(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(wm(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}return fm(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&wm(e))for(const n of e){const e=this.getGeometrySize(n);t.geometrySize=e,this.updateGeometryAttributes(n,t),t.vertexStart+=e,t.indexStart=this.indexStarts[t.geometryIndex+1]}else{const n=e;this._updateIndices(n,t),this._updatePositions(n,t),this._updateVertexValid(n,t)}}_updateIndices(e,t){let{geometryIndex:n,vertexStart:r,indexStart:i}=t;const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let c=i;const u=function(e,t,n,r){let i=pm(e);i&&(i=i.map((e=>e/t)));let s=fm(e);const o=r&&3===t;if(n){const e=s.length;s=s.slice();const r=[];for(let i=0;i<e;i+=t){r[0]=s[i],r[1]=s[i+1],o&&(r[2]=s[i+2]);const e=n(r);s[i]=e[0],s[i+1]=e[1],o&&(s[i+2]=e[2])}}if(o){const e=ym(s,0,1),t=ym(s,0,2),r=ym(s,1,2);if(!e&&!t&&!r)return[];e>t&&e>r||(t>r?(n||(s=s.slice()),vm(s,0,2,1)):(n||(s=s.slice()),vm(s,2,0,1)))}return cm(s,i,t)}(e,this.positionSize,this.opts.preproject,this.opts.full3d);l=a.allocate(l,i+u.length,{copy:!0});for(let h=0;h<u.length;h++)l[c++]=u[h]+r;o[n+1]=i+u.length,s.indices=l}_updatePositions(e,t){let{vertexStart:n,geometrySize:r}=t;const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=fm(e);for(let a=n,l=0;l<r;a++,l++){const e=o[l*s],t=o[l*s+1],n=s>2?o[l*s+2]:0;i[3*a]=e,i[3*a+1]=t,i[3*a+2]=n}}_updateVertexValid(e,t){let{vertexStart:n,geometrySize:r}=t;const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&pm(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function wm(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}const Em="uniform solidPolygonUniforms {\n  bool extruded;\n  bool isWireframe;\n  float elevationScale;\n} solidPolygon;\n",Sm={name:"solidPolygon",vs:Em,fs:Em,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}},xm="in vec4 fillColors;\nin vec4 lineColors;\nin vec3 pickingColors;\nout vec4 vColor;\nstruct PolygonProps {\nvec3 positions;\nvec3 positions64Low;\nvec3 normal;\nfloat elevations;\n};\nvec3 project_offset_normal(vec3 vector) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\nreturn normalize(vector * project.commonUnitsPerWorldUnit);\n}\nreturn project_normal(vector);\n}\nvoid calculatePosition(PolygonProps props) {\nvec3 pos = props.positions;\nvec3 pos64Low = props.positions64Low;\nvec3 normal = props.normal;\nvec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;\ngeometry.worldPosition = props.positions;\ngeometry.pickingColor = pickingColors;\nif (solidPolygon.extruded) {\npos.z += props.elevations * solidPolygon.elevationScale;\n}\ngl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\nDECKGL_FILTER_GL_POSITION(gl_Position, geometry);\nif (solidPolygon.extruded) {\n#ifdef IS_SIDE_VERTEX\nnormal = project_offset_normal(normal);\n#else\nnormal = project_normal(normal);\n#endif\ngeometry.normal = normal;\nvec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);\nvColor = vec4(lightColor, colors.a * layer.opacity);\n} else {\nvColor = vec4(colors.rgb, colors.a * layer.opacity);\n}\nDECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Tm=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader\nin vec3 vertexPositions;\nin vec3 vertexPositions64Low;\nin float elevations;\n${xm}\nvoid main(void) {\nPolygonProps props;\nprops.positions = vertexPositions;\nprops.positions64Low = vertexPositions64Low;\nprops.elevations = elevations;\nprops.normal = vec3(0.0, 0.0, 1.0);\ncalculatePosition(props);\n}\n`,Am=`#version 300 es\n#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\nin vec2 positions;\nin vec3 vertexPositions;\nin vec3 nextVertexPositions;\nin vec3 vertexPositions64Low;\nin vec3 nextVertexPositions64Low;\nin float elevations;\nin float instanceVertexValid;\n${xm}\nvoid main(void) {\nif(instanceVertexValid < 0.5){\ngl_Position = vec4(0.);\nreturn;\n}\nPolygonProps props;\nvec3 pos;\nvec3 pos64Low;\nvec3 nextPos;\nvec3 nextPos64Low;\n#if RING_WINDING_ORDER_CW == 1\npos = vertexPositions;\npos64Low = vertexPositions64Low;\nnextPos = nextVertexPositions;\nnextPos64Low = nextVertexPositions64Low;\n#else\npos = nextVertexPositions;\npos64Low = nextVertexPositions64Low;\nnextPos = vertexPositions;\nnextPos64Low = vertexPositions64Low;\n#endif\nprops.positions = mix(pos, nextPos, positions.x);\nprops.positions64Low = mix(pos64Low, nextPos64Low, positions.x);\nprops.normal = vec3(\npos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),\nnextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),\n0.0);\nprops.elevations = elevations * positions.y;\ncalculatePosition(props);\n}\n`,Cm=[0,0,0,255],Rm={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Cm},getLineColor:{type:"accessor",value:Cm},material:!0},Pm={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e};class km extends up{getShaders(e){return super.getShaders({vs:"top"===e?Tm:Am,fs:"#version 300 es\n#define SHADER_NAME solid-polygon-layer-fragment-shader\nprecision highp float;\nin vec4 vColor;\nout vec4 fragColor;\nvoid main(void) {\nfragColor = vColor;\ngeometry.uv = vec2(0.);\nDECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[Sp,lm,Tp,Sm]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:t}=this.props;const{_full3d:n}=this.props;let r;e.isGeospatial&&t===Yi.DEFAULT&&(t=Yi.LNGLAT),t===Yi.LNGLAT&&(r=n?e.projectPosition.bind(e):e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new bm({preproject:r,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const i=this.getAttributeManager(),s=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:Pm,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,stepMode:"dynamic",transition:Pm,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:Pm,accessor:"getFillColor",defaultValue:Cm},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:Pm,accessor:"getLineColor",defaultValue:Cm},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(e,t)=>{let{index:n,target:r}=t;return this.encodePickingColor(e&&e.__source?e.__source.index:n,r)}}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find((e=>e.__source.index===n))),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw(e){let{uniforms:t}=e;const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,wireframeModel:l,polygonTesselator:c}=this.state,u={extruded:Boolean(n),elevationScale:s,isWireframe:!1};l&&i&&(l.setInstanceCount(c.instanceCount-1),l.shaderInputs.setProps({solidPolygon:{...u,isWireframe:!0}}),l.draw(this.context.renderPass)),a&&r&&(a.setInstanceCount(c.instanceCount-1),a.shaderInputs.setProps({solidPolygon:u}),a.draw(this.context.renderPass)),o&&r&&(o.setVertexCount(c.vertexCount),o.shaderInputs.setProps({solidPolygon:u}),o.draw(this.context.renderPass))}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:n,changeFlags:r}=e,i=this.getAttributeManager();(r.extensionsChanged||t.filled!==n.filled||t.extruded!==n.extruded)&&(this.state.models?.forEach((e=>e.destroy())),this.setState(this._getModels()),i.invalidateAll())}updateGeometry(e){let{props:t,oldProps:n,changeFlags:r}=e;if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,n=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:n.getPolygon,buffers:n,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:t,extruded:n}=this.props;let r,i,s;if(t){const t=this.getShaders("top");t.defines.NON_INSTANCED_MODEL=1;const n=this.getAttributeManager().getBufferLayouts({isInstanced:!1});r=new Yd(this.context.device,{...t,id:`${e}-top`,topology:"triangle-list",bufferLayout:n,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(n){const t=this.getAttributeManager().getBufferLayouts({isInstanced:!0});i=new Yd(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:t,geometry:new Ap({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),s=new Yd(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:t,geometry:new Ap({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[i,s,r].filter(Boolean),topModel:r,sideModel:i,wireframeModel:s}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}km.defaultProps=Rm,km.layerName="SolidPolygonLayer";const Mm={circle:{type:$p,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Up,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Sg,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Lm={type:em,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Im={type:km,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Om(e){let{type:t,props:n}=e;const r={};for(const i in n)r[i]=t.defaultProps[n[i]];return r}function Nm(e,t){const{transitions:n,updateTriggers:r}=e.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in t){const o=t[s];let a=e.props[s];s.startsWith("get")&&(a=e.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function Fm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=e.length}=n;for(let o=i;o<s;o++){const n=e[o],{geometry:i}=n;if(i)if("GeometryCollection"===i.type){Pe.assert(Array.isArray(i.geometries),"GeoJSON does not have geometries array");const{geometries:e}=i;for(let i=0;i<e.length;i++){Dm(e[i],r,t,n,o)}}else Dm(i,r,t,n,o)}return r}function Dm(e,t,n,r,i){const{type:s,coordinates:o}=e,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=t;if(function(e,t){let n=Bm[e];Pe.assert(n,`Unknown GeoJSON type ${e}`);for(;t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(s,o))switch(s){case"Point":a.push(n({geometry:e},r,i));break;case"MultiPoint":o.forEach((e=>{a.push(n({geometry:{type:"Point",coordinates:e}},r,i))}));break;case"LineString":l.push(n({geometry:e},r,i));break;case"MultiLineString":o.forEach((e=>{l.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}));break;case"Polygon":c.push(n({geometry:e},r,i)),o.forEach((e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}));break;case"MultiPolygon":o.forEach((e=>{c.push(n({geometry:{type:"Polygon",coordinates:e}},r,i)),e.forEach((e=>{u.push(n({geometry:{type:"LineString",coordinates:e}},r,i))}))}))}else Pe.warn(`${s} coordinates are malformed`)()}const Bm={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Um(e){return e.geometry.coordinates}function zm(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:i,polygons:s}=e,o=function(e,t){const n={points:null,lines:null,polygons:null};for(const r in n){const i=e[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(4*i.length);const s=[];for(let e=0;e<i.length;e++)t(i[e],s),n[r][4*e+0]=s[0],n[r][4*e+1]=s[1],n[r][4*e+2]=s[2],n[r][4*e+3]=255}return n}(e,t);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:4,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:4,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:4,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:4,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const Gm=["points","linestrings","polygons"],Vm={...Om(Mm.circle),...Om(Mm.icon),...Om(Mm.text),...Om(Lm),...Om(Im),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class jm extends wp{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState(e){let{props:t,changeFlags:n}=e;if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:n}):this._updateStateJSON({props:t,changeFlags:n})}_updateStateBinary(e){let{props:t,changeFlags:n}=e;const r=zm(t.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON(e){let{props:t,changeFlags:n}=e;const r=function(e){if(Array.isArray(e))return e;switch(Pe.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return Pe.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(t.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const e=this.state.features;for(const t in e)s[t]=e[t].slice(),o[t]=[];for(const t of n.dataChanged){const n=Fm(r,i,t);for(const r in e)o[r].push(Ep({data:s[r],getIndex:e=>e.__source.index,dataRange:t,replace:n[r]}))}}else s=Fm(r,i);const a=function(e,t){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=e;return n.points.data=r,n.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),n.points.getPosition=Um,n.lines.data=i,n.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),n.lines.getPath=Um,n.polygons.data=s,n.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),n.polygons.getPolygon=Um,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),n.polygonsOutline.getPath=Um,n}(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n,sourceLayer:r}=t;return t.featureType=Gm.find((e=>r.id.startsWith(`${this.id}-${e}-`))),n>=0&&r.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[n]),t}_updateAutoHighlight(e){const t=`${this.id}-points-`,n="points"===e.featureType;for(const r of this.getSubLayers())r.id.startsWith(t)===n&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:n}=this.state,r="polygons-fill",i=this.shouldRenderSubLayer(r,n.polygons?.data)&&this.getSubLayerClass(r,Im.type);if(i){const s=Nm(this,Im.props),o=e&&t;return o||delete s.getLineColor,s.updateTriggers.lineColors=o,new i(s,this.getSubLayerProps({id:r,updateTriggers:s.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:n}=this.state,r="polygons-stroke",i="linestrings",s=!e&&t&&this.shouldRenderSubLayer(r,n.polygonsOutline?.data)&&this.getSubLayerClass(r,Lm.type),o=this.shouldRenderSubLayer(i,n.lines?.data)&&this.getSubLayerClass(i,Lm.type);if(s||o){const e=Nm(this,Lm.props);return[s&&new s(e,this.getSubLayerProps({id:r,updateTriggers:e.updateTriggers}),n.polygonsOutline),o&&new o(e,this.getSubLayerProps({id:i,updateTriggers:e.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=t.points.data.findIndex((e=>e.__source.index===r)));const i=new Set(e.split("+")),s=[];for(const o of i){const e=`points-${o}`,i=Mm[o],a=i&&this.shouldRenderSubLayer(e,t.points?.data)&&this.getSubLayerClass(e,i.type);if(a){const l=Nm(this,i.props);let c=t.points;if("text"===o&&n){const{instancePickingColors:e,...t}=c.data.attributes;c={...c,data:{...c.data,attributes:t}}}s.push(new a(l,this.getSubLayerProps({id:e,updateTriggers:l.updateTriggers,highlightedObjectIndex:r}),c))}}return s}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return t&&"function"===typeof e?(t,n)=>{const{data:r,index:i}=n,s=function(e,t){if(!e)return null;const n="startIndices"in e?e.startIndices[t]:t,r=e.featureIds.value[n];return-1!==n?function(e,t,n){const r={properties:{...e.properties[t]}};for(const i in e.numericProps)r.properties[i]=e.numericProps[i].value[n];return r}(e,r,n):null}(r,i);return e(s,n)}:super.getSubLayerAccessor(e)}}jm.layerName="GeoJsonLayer",jm.defaultProps=Vm;const Wm=jm,$m={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class Hm{props;stats;activeRequestCount=0;requestQueue=[];requestMap=(()=>new Map)();updateTimer=null;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.props={...$m,...e},this.stats=new Be({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const n={handle:e,priority:0,getPriority:t},r=new Promise((e=>(n.resolve=e,n)));return this.requestQueue.push(n),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:t,resolve:n}=e;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout((()=>this._issueNewRequestsAsync()),this.props.debounceTime)}_issueNewRequestsAsync(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort(((e,t)=>e.priority-t.priority))}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}class Xm{constructor(e){this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,this.boundingBox="west"in e?[[e.west,e.south],[e.east,e.north]]:[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then((()=>this.data)):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData(e){let{getData:t,requestScheduler:n,onLoad:r,onError:i}=e;const{index:s,id:o,bbox:a,userData:l,zoom:c}=this,u=this._loaderId;this._abortController=new AbortController;const{signal:h}=this._abortController,d=await n.scheduleRequest(this,(e=>e.isSelected?1:-1));if(!d)return void(this._isCancelled=!0);if(this._isCancelled)return void d.done();let f,p=null;try{p=await t({index:s,id:o,bbox:a,userData:l,zoom:c,signal:h})}catch(g){f=g||!0}finally{d.done()}u===this._loaderId&&(this._loader=void 0,this.content=p,!this._isCancelled||p?(this._isLoaded=!0,this._isCancelled=!1,f?i(f,this):r(this)):this._isLoaded=!1)}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController?.abort())}}const qm=Math.PI/180,Km=180/Math.PI,Ym=6370972,Zm=256;function Qm(){const e=4018225162502676e-20,t=Math.PI/180*Zm;return{unitsPerMeter:[e,e,e],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[t,t,e],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/t,1/t,24886.609375]}}class Jm extends os{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{longitude:t=0,zoom:n=0,nearZMultiplier:r=.5,farZMultiplier:i=1,resolution:s=10}=e;let{latitude:o=0,height:a,altitude:l=1.5,fovy:c}=e;o=Math.max(Math.min(o,Nr),-85.051129),a=a||1,c?l=$r(c):c=Wr(l);const u=1/Math.PI/Math.cos(o*Math.PI/180),h=Math.pow(2,n)*u,d=e.nearZ??r,f=e.farZ??(l+512*h/a)*i,p=(new br).lookAt({eye:[0,-l,0],up:[0,0,1]});p.rotateX(o*qm),p.rotateZ(-t*qm),p.scale(h/a),super({...e,height:a,viewMatrix:p,longitude:t,latitude:o,zoom:n,distanceScales:Qm(),fovy:c,focalDistance:l,near:d,far:f}),this.scale=h,this.latitude=o,this.longitude=t,this.resolution=s}get projectionMode(){return Zi.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(){const e={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},t=this.unproject([0,this.height/2],e),n=this.unproject([this.width/2,0],e),r=this.unproject([this.width,this.height/2],e),i=this.unproject([this.width/2,this.height],e);return r[0]<this.longitude&&(r[0]+=360),t[0]>this.longitude&&(t[0]-=360),[Math.min(t[0],r[0],n[0],i[0]),Math.min(t[1],r[1],n[1],i[1]),Math.max(t[0],r[0],n[0],i[0]),Math.max(t[1],r[1],n[1],i[1])]}unproject(e){let{topLeft:t=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[r,i,s]=e,o=t?i:this.height-i,{pixelUnprojectionMatrix:a}=this;let l;if(Number.isFinite(s))l=e_(a,[r,o,s,1]);else{const e=e_(a,[r,o,-1,1]),t=e_(a,[r,o,1,1]),i=((n||0)/Ym+1)*Zm,s=Gn(Un([],e,t)),c=Gn(e),u=Gn(t),h=4*((4*c*u-(s-c-u)**2)/16)/s;l=function(e,t,n,r){const i=t[0],s=t[1],o=t[2];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=o+r*(n[2]-o),e}([],e,t,(Math.sqrt(c-h)-Math.sqrt(Math.max(0,i*i-h)))/Math.sqrt(s))}const[c,u,h]=this.unprojectPosition(l);return Number.isFinite(s)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(e){const[t,n,r=0]=e,i=t*qm,s=n*qm,o=Math.cos(s),a=(r/Ym+1)*Zm;return[Math.sin(i)*o*a,-Math.cos(i)*o*a,Math.sin(s)*a]}unprojectPosition(e){const[t,n,r]=e,i=zn(e),s=Math.asin(r/i);return[Math.atan2(t,-n)*Km,s*Km,(i/Zm-1)*Ym]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,t){const n=this.unproject(t);return{longitude:e[0]-n[0]+this.longitude,latitude:e[1]-n[1]+this.latitude}}}function e_(e,t){const n=fr([],t,e);return ur(n,n,1/n[3]),n}const t_=-1,n_=0,r_=1,i_=new Hn,s_=new Hn;class o_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=arguments.length>2?arguments[2]:void 0;n=n||i_.copy(e).add(t).scale(.5),this.center=new Hn(n),this.halfDiagonal=new Hn(t).subtract(this.center),this.minimum=new Hn(e),this.maximum=new Hn(t)}clone(){return new o_(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:t}=this,n=s_.from(e.normal),r=t.x*Math.abs(n.x)+t.y*Math.abs(n.y)+t.z*Math.abs(n.z),i=this.center.dot(n)+e.distance;return i-r>0?r_:i+r<0?t_:n_}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=i_.from(e).subtract(this.center),{halfDiagonal:n}=this;let r,i=0;return r=Math.abs(t.x)-n.x,r>0&&(i+=r*r),r=Math.abs(t.y)-n.y,r>0&&(i+=r*r),r=Math.abs(t.z)-n.z,r>0&&(i+=r*r),i}}const a_=new Hn,l_=new Hn;class c_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.radius=-0,this.center=new Hn,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=a_.from(t),this.center=(new Hn).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new c_(this.center,this.radius)}union(e){const t=this.center,n=this.radius,r=e.center,i=e.radius,s=a_.copy(r).subtract(t),o=s.magnitude();if(n>=o+i)return this.clone();if(i>=o+n)return e.clone();const a=.5*(n+o+i);return l_.copy(s).scale((-n+a)/o).add(t),this.center.copy(l_),this.radius=a,this}expand(e){const t=a_.from(e).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=sr(a_,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=a_.from(e).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const t=this.center,n=this.radius,r=e.normal.dot(t)+e.distance;return r<-n?t_:r<n?n_:r_}}function u_(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],f=n[1],p=n[2],g=n[3],m=n[4],_=n[5],y=n[6],v=n[7],b=n[8];return e[0]=d*r+f*o+p*c,e[1]=d*i+f*a+p*u,e[2]=d*s+f*l+p*h,e[3]=g*r+m*o+_*c,e[4]=g*i+m*a+_*u,e[5]=g*s+m*l+_*h,e[6]=y*r+v*o+b*c,e[7]=y*i+v*a+b*u,e[8]=y*s+v*l+b*h,e}function h_(e,t,n){const r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}var d_;!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"}(d_||(d_={}));const f_=Object.freeze([1,0,0,0,1,0,0,0,1]);class p_ extends Qn{static get IDENTITY(){return function(){__||(__=new p_,Object.freeze(__));return __}()}static get ZERO(){return function(){g_||(g_=new p_([0,0,0,0,0,0,0,0,0]),Object.freeze(g_));return g_}()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return d_}constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(f_)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,d=i*o,f=i*a,p=i*l,g=s*o,m=s*a,_=s*l;e[0]=1-h-p,e[3]=u-_,e[6]=d+m,e[1]=u+_,e[4]=1-c-p,e[7]=f-g,e[2]=d-m,e[5]=f+g,e[8]=1-c-h}(this,e),this.check()}set(e,t,n,r,i,s,o,a,l){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=l,this.check()}setRowMajor(e,t,n,r,i,s,o,a,l){return this[0]=e,this[1]=r,this[2]=o,this[3]=t,this[4]=i,this[5]=a,this[6]=n,this[7]=s,this[8]=l,this.check()}determinant(){return function(e){const t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*(c*s-o*l)+n*(-c*i+o*a)+r*(l*i-s*a)}(this)}transpose(){return function(e,t){if(e===t){const n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]}(this,this),this.check()}invert(){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*o-a*c,d=-u*s+a*l,f=c*s-o*l;let p=n*h+r*d+i*f;p&&(p=1/p,e[0]=h*p,e[1]=(-u*r+i*c)*p,e[2]=(a*r-i*o)*p,e[3]=d*p,e[4]=(u*n-i*l)*p,e[5]=(-a*n+i*s)*p,e[6]=f*p,e[7]=(-c*n+r*l)*p,e[8]=(o*n-r*s)*p)}(this,this),this.check()}multiplyLeft(e){return u_(this,e,this),this.check()}multiplyRight(e){return u_(this,this,e),this.check()}rotate(e){return function(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(n),f=Math.cos(n);e[0]=f*r+d*o,e[1]=f*i+d*a,e[2]=f*s+d*l,e[3]=f*o-d*r,e[4]=f*a-d*i,e[5]=f*l-d*s,e[6]=c,e[7]=u,e[8]=h}(this,this,e),this.check()}scale(e){return Array.isArray(e)?h_(this,this,e):h_(this,this,[e,e]),this.check()}translate(e){return function(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],f=n[1];e[0]=r,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=d*r+f*o+c,e[7]=d*i+f*a+u,e[8]=d*s+f*l+h}(this,this,e),this.check()}transform(e,t){let n;switch(e.length){case 2:n=function(e,t,n){const r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}(t||[-0,-0],e,this);break;case 3:n=Dn(t||[-0,-0,-0],e,this);break;case 4:n=jn(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Cn(n,e.length),n}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let g_,m_,__=null;class y_ extends Pn{static get ZERO(){return m_||(m_=new y_(0,0,0,0),Object.freeze(m_)),m_}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(-0,-0,-0,-0),bn(e)&&1===arguments.length?this.copy(e):(yn.debug&&(An(e),An(t),An(n),An(r)),this[0]=e,this[1]=t,this[2]=n,this[3]=r)}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return yn.debug&&(An(e.x),An(e.y),An(e.z),An(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=An(e)}get w(){return this[3]}set w(e){this[3]=An(e)}transform(e){return Fn(this,this,e),this.check()}transformByMatrix3(e){return jn(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2],e[3]=t[3]}(this,this,e),this.check()}transformByQuaternion(e){return Bn(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}function v_(){const e=new Mn(4);return Mn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function b_(e,t,n){n*=.5;const r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function w_(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+o*a+i*c-s*l,e[1]=i*u+o*l+s*a-r*c,e[2]=s*u+o*c+r*l-i*a,e[3]=o*u-r*a-i*l-s*c,e}function E_(e,t,n,r){const i=t[0],s=t[1],o=t[2],a=t[3];let l,c,u,h,d,f=n[0],p=n[1],g=n[2],m=n[3];return l=i*f+s*p+o*g+a*m,l<0&&(l=-l,f=-f,p=-p,g=-g,m=-m),1-l>kn?(c=Math.acos(l),d=Math.sin(c),u=Math.sin((1-r)*c)/d,h=Math.sin(r*c)/d):(u=1-r,h=r),e[0]=u*i+h*f,e[1]=u*s+h*p,e[2]=u*o+h*g,e[3]=u*a+h*m,e}function S_(e,t){const n=t[0]+t[4]+t[8];let r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);const i=(n+1)%3,s=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*i+i]-t[3*s+s]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*i+s]-t[3*s+i])*r,e[i]=(t[3*i+n]+t[3*n+i])*r,e[s]=(t[3*s+n]+t[3*n+s])*r}return e}const x_=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},T_=ur,A_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},C_=function(e,t,n,r){const i=t[0],s=t[1],o=t[2],a=t[3];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=o+r*(n[2]-o),e[3]=a+r*(n[3]-a),e},R_=hr,P_=dr,k_=function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3];let o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=s*o,e};const M_=function(){const e=Ln(),t=In(1,0,0),n=In(0,1,0);return function(r,i,s){const o=On(i,s);return o<-.999999?(Nn(e,t,i),zn(e)<1e-6&&Nn(e,n,i),function(e,t){const n=t[0],r=t[1],i=t[2];let s=n*n+r*r+i*i;s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s}(e,e),b_(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Nn(e,i,s),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,k_(r,r))}}(),L_=(function(){const e=v_(),t=v_()}(),function(){const e=function(){const e=new Mn(9);return Mn!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}()}(),[0,0,0,1]);class I_ extends Tn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,n,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return S_(this,e),this.check()}fromAxisRotation(e,t){return b_(this,e,t),this.check()}identity(){var e;return(e=this)[0]=0,e[1]=0,e[2]=0,e[3]=1,this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=An(e)}get y(){return this[1]}set y(e){this[1]=An(e)}get z(){return this[2]}set z(e){this[2]=An(e)}get w(){return this[3]}set w(e){this[3]=An(e)}len(){return R_(this)}lengthSquared(){return P_(this)}dot(e){return A_(this,e)}rotationTo(e,t){return M_(this,e,t),this.check()}add(e){return x_(this,this,e),this.check()}calculateW(){return function(e,t){const n=t[0],r=t[1],i=t[2];e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}conjugate(){var e,t;return t=this,(e=this)[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],this.check()}invert(){return function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;e[0]=-n*a,e[1]=-r*a,e[2]=-i*a,e[3]=s*a}(this,this),this.check()}lerp(e,t,n){return void 0===n?this.lerp(this,e,t):(C_(this,e,t,n),this.check())}multiplyRight(e){return w_(this,this,e),this.check()}multiplyLeft(e){return w_(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(e,t,n){n*=.5;const r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+o*a,e[1]=i*l+s*a,e[2]=s*l-i*a,e[3]=o*l-r*a}(this,this,e),this.check()}rotateY(e){return function(e,t,n){n*=.5;const r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l-s*a,e[1]=i*l+o*a,e[2]=s*l+r*a,e[3]=o*l-i*a}(this,this,e),this.check()}rotateZ(e){return function(e,t,n){n*=.5;const r=t[0],i=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=r*l+i*a,e[1]=i*l-r*a,e[2]=s*l+o*a,e[3]=o*l-s*a}(this,this,e),this.check()}scale(e){return T_(this,this,e),this.check()}slerp(e,t,n){let r,i,s;switch(arguments.length){case 1:({start:r=L_,target:i,ratio:s}=e);break;case 2:r=this,i=e,s=t;break;default:r=e,i=t,s=n}return E_(this,r,i,s),this.check()}transformVector4(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new y_;return function(e,t,n){const r=t[0],i=t[1],s=t[2],o=n[0],a=n[1],l=n[2],c=n[3],u=c*r+a*s-l*i,h=c*i+l*r-o*s,d=c*s+o*i-a*r,f=-o*r-a*i-l*s;e[0]=u*c+f*-o+h*-l-d*-a,e[1]=h*c+f*-a+d*-o-u*-l,e[2]=d*c+f*-l+u*-a-h*-o,e[3]=t[3]}(t,e,this),Cn(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const O_=new Hn,N_=new Hn,F_=new Hn,D_=new Hn,B_=new Hn,U_=new Hn,z_=new Hn,G_=0,V_=1,j_=2,W_=3,$_=4,H_=5,X_=6,q_=7,K_=8;class Y_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];this.center=(new Hn).from(e),this.halfAxes=new p_(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new Hn(e).len(),new Hn(t).len(),new Hn(n).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new Hn(e).normalize(),i=new Hn(t).normalize(),s=new Hn(n).normalize();return(new I_).fromMatrix3(new p_([...r,...i,...s]))}fromCenterHalfSizeQuaternion(e,t,n){const r=new I_(n),i=(new p_).fromQuaternion(r);return i[0]=i[0]*t[0],i[1]=i[1]*t[0],i[2]=i[2]*t[0],i[3]=i[3]*t[1],i[4]=i[4]*t[1],i[5]=i[5]*t[1],i[6]=i[6]*t[2],i[7]=i[7]*t[2],i[8]=i[8]*t[2],this.center=(new Hn).from(e),this.halfAxes=i,this}clone(){return new Y_(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c_;const t=this.halfAxes,n=t.getColumn(0,F_),r=t.getColumn(1,D_),i=t.getColumn(2,B_),s=O_.copy(n).add(r).add(i);return e.center.copy(this.center),e.radius=s.magnitude(),e}intersectPlane(e){const t=this.center,n=e.normal,r=this.halfAxes,i=n.x,s=n.y,o=n.z,a=Math.abs(i*r[G_]+s*r[V_]+o*r[j_])+Math.abs(i*r[W_]+s*r[$_]+o*r[H_])+Math.abs(i*r[X_]+s*r[q_]+o*r[K_]),l=n.dot(t)+e.distance;return l<=-a?t_:l>=a?r_:n_}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=N_.from(e).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,F_),i=n.getColumn(1,D_),s=n.getColumn(2,B_),o=r.magnitude(),a=i.magnitude(),l=s.magnitude();r.normalize(),i.normalize(),s.normalize();let c,u=0;return c=Math.abs(t.dot(r))-o,c>0&&(u+=c*c),c=Math.abs(t.dot(i))-a,c>0&&(u+=c*c),c=Math.abs(t.dot(s))-l,c>0&&(u+=c*c),u}computePlaneDistances(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const s=this.center,o=this.halfAxes,a=o.getColumn(0,F_),l=o.getColumn(1,D_),c=o.getColumn(2,B_),u=U_.copy(a).add(l).add(c).add(s),h=z_.copy(u).subtract(e);let d=t.dot(h);return r=Math.min(d,r),i=Math.max(d,i),u.copy(s).add(a).add(l).subtract(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),u.copy(s).add(a).subtract(l).add(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),u.copy(s).add(a).subtract(l).subtract(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),s.copy(u).subtract(a).add(l).add(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),s.copy(u).subtract(a).add(l).subtract(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),s.copy(u).subtract(a).subtract(l).add(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),s.copy(u).subtract(a).subtract(l).subtract(c),h.copy(u).subtract(e),d=t.dot(h),r=Math.min(d,r),i=Math.max(d,i),n[0]=r,n[1]=i,n}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,F_);t.transformAsPoint(e);const n=this.halfAxes.getColumn(1,D_);n.transformAsPoint(e);const r=this.halfAxes.getColumn(2,B_);return r.transformAsPoint(e),this.halfAxes=new p_([...t,...n,...r]),this}getTransform(){throw new Error("not implemented")}}const Z_=new Hn,Q_=new Hn;class J_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.normal=new Hn,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return Rn(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=Z_.from(e),this.normal.from(t).normalize();const n=-this.normal.dot(e);return this.distance=n,this}fromCoefficients(e,t,n,r){return this.normal.set(e,t,n),Rn(Sn(this.normal.len(),1)),this.distance=r,this}clone(){return new J_(this.normal,this.distance)}equals(e){return Sn(this.distance,e.distance)&&Sn(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=Q_.copy(this.normal).transformAsVector(e).normalize(),n=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(n,t)}projectPointOntoPlane(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];const n=Z_.from(e),r=this.getPointDistance(n),i=Q_.copy(this.normal).scale(r);return n.subtract(i).to(t)}}const ey=[new Hn([1,0,0]),new Hn([0,1,0]),new Hn([0,0,1])],ty=new Hn,ny=new Hn;class ry{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.planes=e}fromBoundingSphere(e){this.planes.length=2*ey.length;const t=e.center,n=e.radius;let r=0;for(const i of ey){let e=this.planes[r],s=this.planes[r+1];e||(e=this.planes[r]=new J_),s||(s=this.planes[r+1]=new J_);const o=ty.copy(i).scale(-n).add(t);e.fromPointNormal(o,i);const a=ty.copy(i).scale(n).add(t),l=ny.copy(i).negate();s.fromPointNormal(a,l),r+=2}return this}computeVisibility(e){let t=r_;for(const n of this.planes){switch(e.intersectPlane(n)){case t_:return t_;case n_:t=n_}}return t}computeVisibilityWithPlaneMask(e,t){if(Rn(Number.isFinite(t),"parentPlaneMask is required."),t===ry.MASK_OUTSIDE||t===ry.MASK_INSIDE)return t;let n=ry.MASK_INSIDE;const r=this.planes;for(let i=0;i<this.planes.length;++i){const s=i<31?1<<i:0;if(i<31&&0===(t&s))continue;const o=r[i],a=e.intersectPlane(o);if(a===t_)return ry.MASK_OUTSIDE;a===n_&&(n|=s)}return n}}ry.MASK_OUTSIDE=4294967295,ry.MASK_INSIDE=0,ry.MASK_INDETERMINATE=2147483647;new Hn,new Hn,new Hn,new Hn,new Hn;new Hn,new Hn,new Hn,new Hn,new Hn,new Hn,new Hn,new Hn,new Hn,new Hn,new Hn,new Hn;Math.PI,Math.PI,Math.PI,Math.PI;const iy=new p_,sy=new p_,oy=new p_,ay=new p_,ly=new p_;function cy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};let n=0,r=0;const i=sy,s=oy;i.identity(),s.copy(e);const o=1e-20*function(e){let t=0;for(let n=0;n<9;++n){const r=e[n];t+=r*r}return Math.sqrt(t)}(s);for(;r<10&&dy(s)>o;)fy(s,ay),ly.copy(ay).transpose(),s.multiplyRight(ay),s.multiplyLeft(ly),i.multiplyRight(ay),++n>2&&(++r,n=0);return t.unitary=i.toTarget(t.unitary),t.diagonal=s.toTarget(t.diagonal),t}const uy=[1,0,0],hy=[2,2,1];function dy(e){let t=0;for(let n=0;n<3;++n){const r=e[iy.getElementIndex(hy[n],uy[n])];t+=2*r*r}return Math.sqrt(t)}function fy(e,t){let n=0,r=1;for(let l=0;l<3;++l){const t=Math.abs(e[iy.getElementIndex(hy[l],uy[l])]);t>n&&(r=l,n=t)}const i=uy[r],s=hy[r];let o=1,a=0;if(Math.abs(e[iy.getElementIndex(s,i)])>1e-15){const t=(e[iy.getElementIndex(s,s)]-e[iy.getElementIndex(i,i)])/2/e[iy.getElementIndex(s,i)];let n;n=t<0?-1/(-t+Math.sqrt(1+t*t)):1/(t+Math.sqrt(1+t*t)),o=1/Math.sqrt(1+n*n),a=n*o}return p_.IDENTITY.to(t),t[iy.getElementIndex(i,i)]=t[iy.getElementIndex(s,s)]=o,t[iy.getElementIndex(s,i)]=a,t[iy.getElementIndex(i,s)]=-a,t}const py=new Hn,gy=new Hn,my=new Hn,_y=new Hn,yy=new Hn,vy=new p_,by={diagonal:new p_,unitary:new p_};const wy=512,Ey=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Sy=Ey.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),xy=Sy.concat([[.25,.5],[.75,.5]]);class Ty{constructor(e,t,n){this.x=e,this.y=t,this.z=n}get children(){if(!this._children){const e=2*this.x,t=2*this.y,n=this.z+1;this._children=[new Ty(e,t,n),new Ty(e,t+1,n),new Ty(e+1,t,n),new Ty(e+1,t+1,n)]}return this._children}update(e){const{viewport:t,cullingVolume:n,elevationBounds:r,minZ:i,maxZ:s,bounds:o,offset:a,project:l}=e,c=this.getBoundingVolume(r,a,l);if(o&&!this.insideBounds(o))return!1;if(n.computeVisibility(c)<0)return!1;if(!this.childVisible){let{z:e}=this;if(e<s&&e>=i){const n=c.distanceTo(t.cameraPosition)*t.scale/t.height;e+=Math.floor(Math.log2(n))}if(e>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const u of this.children)u.update(e);return!0}getSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.selected&&e.push(this),this._children)for(const t of this._children)t.getSelected(e);return e}insideBounds(e){let[t,n,r,i]=e;const s=Math.pow(2,this.z),o=wy/s;return this.x*o<r&&this.y*o<i&&(this.x+1)*o>t&&(this.y+1)*o>n}getBoundingVolume(e,t,n){if(n){const t=this.z<1?xy:this.z<2?Sy:Ey,r=[];for(const i of t){const t=Oy(this.x+i[0],this.y+i[1],this.z);t[2]=e[0],r.push(n(t)),e[0]!==e[1]&&(t[2]=e[1],r.push(n(t)))}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Y_;if(!e||0===e.length)return t.halfAxes=new p_([0,0,0,0,0,0,0,0,0]),t.center=new Hn,t;const n=e.length,r=new Hn(0,0,0);for(const T of e)r.add(T);const i=1/n;r.multiplyByScalar(i);let s=0,o=0,a=0,l=0,c=0,u=0;for(const T of e){const e=py.copy(T).subtract(r);s+=e.x*e.x,o+=e.x*e.y,a+=e.x*e.z,l+=e.y*e.y,c+=e.y*e.z,u+=e.z*e.z}s*=i,o*=i,a*=i,l*=i,c*=i,u*=i;const h=vy;h[0]=s,h[1]=o,h[2]=a,h[3]=o,h[4]=l,h[5]=c,h[6]=a,h[7]=c,h[8]=u;const{unitary:d}=cy(h,by),f=t.halfAxes.copy(d);let p=f.getColumn(0,my),g=f.getColumn(1,_y),m=f.getColumn(2,yy),_=-Number.MAX_VALUE,y=-Number.MAX_VALUE,v=-Number.MAX_VALUE,b=Number.MAX_VALUE,w=Number.MAX_VALUE,E=Number.MAX_VALUE;for(const T of e)py.copy(T),_=Math.max(py.dot(p),_),y=Math.max(py.dot(g),y),v=Math.max(py.dot(m),v),b=Math.min(py.dot(p),b),w=Math.min(py.dot(g),w),E=Math.min(py.dot(m),E);p=p.multiplyByScalar(.5*(b+_)),g=g.multiplyByScalar(.5*(w+y)),m=m.multiplyByScalar(.5*(E+v)),t.center.copy(p).add(g).add(m);const S=gy.set(_-b,y-w,v-E).multiplyByScalar(.5),x=new p_([S[0],0,0,0,S[1],0,0,0,S[2]]);return t.halfAxes.multiplyRight(x),t}(r)}const r=Math.pow(2,this.z),i=wy/r,s=this.x*i+t*wy,o=wy-(this.y+1)*i;return new o_([s,o,e[0]],[s+i,o+i,e[1]])}}const Ay=512,Cy=[-1/0,-1/0,1/0,1/0],Ry={type:"object",value:null,validate:(e,t)=>t.optional&&null===e||"string"===typeof e||Array.isArray(e)&&e.every((e=>"string"===typeof e)),equal:(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}};function Py(e,t){const n=[t.transformAsPoint([e[0],e[1]]),t.transformAsPoint([e[2],e[1]]),t.transformAsPoint([e[0],e[3]]),t.transformAsPoint([e[2],e[3]])];return[Math.min(...n.map((e=>e[0]))),Math.min(...n.map((e=>e[1]))),Math.max(...n.map((e=>e[0]))),Math.max(...n.map((e=>e[1])))]}function ky(e,t){if(!e||!e.length)return null;const{index:n,id:r}=t;if(Array.isArray(e)){e=e[(i=r,Math.abs(i.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0))%e.length)]}var i;let s=e;for(const o of Object.keys(n)){const e=new RegExp(`{${o}}`,"g");s=s.replace(e,String(n[o]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(s=s.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),s}function My(e){let{viewport:t,z:n,cullRect:r}=e;return(t.subViewports||[t]).map((e=>Ly(e,n||0,r)))}function Ly(e,t,n){if(!Array.isArray(t)){const r=n.x-e.x,i=n.y-e.y,{width:s,height:o}=n,a={targetZ:t},l=e.unproject([r,i],a),c=e.unproject([r+s,i],a),u=e.unproject([r,i+o],a),h=e.unproject([r+s,i+o],a);return[Math.min(l[0],c[0],u[0],h[0]),Math.min(l[1],c[1],u[1],h[1]),Math.max(l[0],c[0],u[0],h[0]),Math.max(l[1],c[1],u[1],h[1])]}const r=Ly(e,t[0],n),i=Ly(e,t[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function Iy(e,t){return Math.pow(2,e)*Ay/t}function Oy(e,t,n){const r=Iy(n,Ay),i=e/r*360-180,s=Math.PI-2*Math.PI*t/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)))]}function Ny(e,t,n,r){const i=Iy(n,r);return[e/i*Ay,t/i*Ay]}function Fy(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ay;if(e.isGeospatial){const[e,i]=Oy(t,n,r),[s,o]=Oy(t+1,n+1,r);return{west:e,north:i,east:s,south:o}}const[s,o]=Ny(t,n,r,i),[a,l]=Ny(t+1,n+1,r,i);return{left:s,top:o,right:a,bottom:l}}function Dy(e,t,n,r,i){const s=function(e,t,n){let r;if(t&&2===t.length){const[n,i]=t,s=e.getBounds({z:n}),o=e.getBounds({z:i});r=[Math.min(s[0],o[0]),Math.min(s[1],o[1]),Math.max(s[2],o[2]),Math.max(s[3],o[3])]}else r=e.getBounds();return e.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(e,null,r),o=Iy(t,n),[a,l,c,u]=function(e,t,n){if(n)return Py(e,n).map((e=>e*t/Ay));return e.map((e=>e*t/Ay))}(s,o,i),h=[];for(let d=Math.floor(a);d<c;d++)for(let e=Math.floor(l);e<u;e++)h.push({x:d,y:e,z:t});return h}function By(e){let{viewport:t,maxZoom:n,minZoom:r,zRange:i,extent:s,tileSize:o=Ay,modelMatrix:a,modelMatrixInverse:l,zoomOffset:c=0}=e,u=t.isGeospatial?Math.round(t.zoom+Math.log2(Ay/o))+c:Math.ceil(t.zoom)+c;if("number"===typeof r&&Number.isFinite(r)&&u<r){if(!s)return[];u=r}"number"===typeof n&&Number.isFinite(n)&&u>n&&(u=n);let h=s;return a&&l&&s&&!t.isGeospatial&&(h=Py(s,a)),t.isGeospatial?function(e,t,n,r){const i=e instanceof Jm&&e.resolution?e.projectPosition:null,s=Object.values(e.getFrustumPlanes()).map((e=>{let{normal:t,distance:n}=e;return new J_(t.clone().negate(),n)})),o=new ry(s),a=e.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,c=n&&n[1]*a||0,u=e instanceof gs&&e.pitch<=60?t:0;if(r){const[e,t,n,i]=r,s=Dr([e,i]),o=Dr([n,t]);r=[s[0],wy-s[1],o[0],wy-o[1]]}const h=new Ty(0,0,0),d={viewport:e,project:i,cullingVolume:o,elevationBounds:[l,c],minZ:u,maxZ:t,bounds:r,offset:0};if(h.update(d),e instanceof gs&&e.subViewports&&e.subViewports.length>1){for(d.offset=-1;h.update(d)&&!(--d.offset<-3););for(d.offset=1;h.update(d)&&!(++d.offset>3););}return h.getSelected()}(t,u,i,s):Dy(t,u,o,h||Cy,l)}function Uy(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}const zy="never",Gy="no-overlap",Vy="best-available",jy={[Vy]:function(e){for(const t of e)t.state=0;for(const t of e)t.isSelected&&!$y(t)&&Hy(t);for(const t of e)t.isVisible=Boolean(2&t.state)},[Gy]:function(e){for(const n of e)n.state=0;for(const n of e)n.isSelected&&$y(n);const t=Array.from(e).sort(((e,t)=>e.zoom-t.zoom));for(const n of t)if(n.isVisible=Boolean(2&n.state),n.children&&(n.isVisible||1&n.state))for(const e of n.children)e.state=1;else n.isSelected&&Hy(n)},[zy]:()=>{}},Wy={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};function $y(e){let t=e;for(;t;){if(t.isLoaded||t.content)return t.state|=2,!0;t=t.parent}return!1}function Hy(e){for(const t of e.children)t.isLoaded||t.content?t.state|=2:Hy(t)}const Xy={TilesetClass:class{constructor(e){this._getCullBounds=function(e){let t,n={};return r=>{for(const i in r)if(!Uy(r[i],n[i])){t=e(r),n=r;break}return t}}(My),this.opts={...Wy,...e},this.setOptions(this.opts),this.onTileLoad=e=>{this.opts.onTileLoad?.(e),null!==this.opts.maxCacheByteSize&&(this._cacheByteSize+=e.byteLength,this._resizeCache())},this._requestScheduler=new Hm({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new br,this._modelMatrixInverse=new br}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every((e=>e.isLoaded))}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some((e=>e.needsReload))}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const t=this._cache.get(e);this._selectedTiles&&this._selectedTiles.includes(t)?t.setNeedsReload():this._cache.delete(e)}}update(e){let{zRange:t,modelMatrix:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{zRange:null,modelMatrix:null};const r=n?new br(n):new br,i=!r.equals(this._modelMatrix);if(this._viewport&&e.equals(this._viewport)&&Sn(this._zRange,t)&&!i)this.needsReload&&(this._selectedTiles=this._selectedTiles.map((e=>this._getTile(e.index,!0))));else{i&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=t;const n=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:t,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=n.map((e=>this._getTile(e,!0))),this._dirty&&this._rebuildTree()}const s=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}isTileVisible(e,t){if(!e.isVisible)return!1;if(t&&this._viewport){const n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:t}),{bbox:r}=e;for(const[e,t,i,s]of n){let n;if("west"in r)n=r.west<i&&r.east>e&&r.south<s&&r.north>t;else{const o=Math.min(r.top,r.bottom),a=Math.max(r.top,r.bottom);n=r.left<i&&r.right>e&&o<s&&a>t}if(n)return!0}return!1}return!0}getTileIndices(e){let{viewport:t,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:o}=e;const{tileSize:a,extent:l,zoomOffset:c}=this.opts;return By({viewport:t,maxZoom:n,minZoom:r,zRange:i,tileSize:a,extent:l,modelMatrix:s,modelMatrixInverse:o,zoomOffset:c})}getTileId(e){return`${e.x}-${e.y}-${e.z}`}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:t}=this.opts;return{bbox:Fy(this._viewport,e.x,e.y,e.z,t)}}getParentIndex(e){return{x:Math.floor(e.x/2),y:Math.floor(e.y/2),z:e.z-1}}updateTileStates(){const e=this.opts.refinementStrategy||Vy,t=new Array(this._cache.size);let n=0;for(const r of this._cache.values())t[n++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;("function"===typeof e?e:jy[e])(Array.from(this._cache.values())),n=0;for(const r of this._cache.values())if(t[n++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,t=[];let n=0;for(const r of this._cache.values())r.isLoading&&(n++,r.isSelected||r.isVisible||t.push(r));for(;e>0&&n>e&&t.length>0;){t.shift().abort(),n--}}_rebuildTree(){const{_cache:e}=this;for(const t of e.values())t.parent=null,t.children&&(t.children.length=0);for(const t of e.values()){const e=this._getNearestAncestor(t);t.parent=e,e?.children&&e.children.push(t)}}_resizeCache(){const{_cache:e,opts:t}=this,n=t.maxCacheSize??(null!==t.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=t.maxCacheByteSize??1/0;if(e.size>n||this._cacheByteSize>r){for(const[i,s]of e)if(s.isVisible||s.isSelected||(this._cacheByteSize-=null!==t.maxCacheByteSize?s.byteLength:0,e.delete(i),this.opts.onTileUnload?.(s)),e.size<=n&&this._cacheByteSize<=r)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((e,t)=>e.zoom-t.zoom)),this._dirty=!1)}_getTile(e,t){const n=this.getTileId(e);let r=this._cache.get(n),i=!1;return!r&&t?(r=new Xm(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:n,zoom:this.getTileZoom(r.index)}),i=!0,this._cache.set(n,r),this._dirty=!0):r&&r.needsReload&&(i=!0),r&&i&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:t=0}=this;let n=e.index;for(;this.getTileZoom(n)>t;){n=this.getParentIndex(n);const e=this._getTile(n);if(e)return e}return null}},data:{type:"data",value:[]},dataComparator:Ry.equal,renderSubLayers:{type:"function",value:e=>new Wm(e)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:e=>{}},onTileUnload:{type:"function",value:e=>{}},onTileError:{type:"function",value:e=>console.error(e)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Vy,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0};class qy extends wp{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){this.state?.tileset?.finalize()}get isLoaded(){return Boolean(this.state?.tileset?.selectedTiles?.every((e=>e.isLoaded&&e.layers&&e.layers.every((e=>e.isLoaded)))))}shouldUpdateState(e){let{changeFlags:t}=e;return t.somethingChanged}updateState(e){let{changeFlags:t}=e,{tileset:n}=this.state;const r=t.propsOrDataChanged||t.updateTriggersChanged,i=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():n.tiles.forEach((e=>{e.layers=null}))):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:t,maxCacheByteSize:n,refinementStrategy:r,extent:i,maxZoom:s,minZoom:o,maxRequests:a,debounceTime:l,zoomOffset:c}=this.props;return{maxCacheSize:t,maxCacheByteSize:n,maxZoom:s,minZoom:o,tileSize:e,refinementStrategy:r,extent:i,maxRequests:a,debounceTime:l,zoomOffset:c,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const e=this.state.tileset,{zRange:t,modelMatrix:n}=this.props,r=e.update(this.context.viewport,{zRange:t,modelMatrix:n}),{isLoaded:i}=e,s=this.state.isLoaded!==i,o=this.state.frameNumber!==r;i&&(s||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:r}),this.state.isLoaded=i}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:t}=this.props;t&&t(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,t){this.props.onTileError(e),t.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:t,getTileData:n,fetch:r}=this.props,{signal:i}=e;return e.url="string"===typeof t||Array.isArray(t)?ky(t,e):null,n?n(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:i}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo(e){const t=e.sourceLayer,n=t.props.tile,r=e.info;return r.picked&&(r.tile=n),r.sourceTile=n,r.sourceTileSubLayer=t,r}_updateAutoHighlight(e){e.sourceTileSubLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map((e=>{const t=this.getSubLayerPropsByTile(e);if(e.isLoaded||e.content)if(e.layers)t&&e.layers[0]&&Object.keys(t).some((n=>e.layers[0].props[n]!==t[n]))&&(e.layers=e.layers.map((e=>e.clone(t))));else{const n=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=Ie(n,Boolean).map((n=>n.clone({tile:e,...t})))}else;return e.layers}))}filterSubLayer(e){let{layer:t,cullRect:n}=e;const{tile:r}=t.props;return this.state.tileset.isTileVisible(r,n)}}qy.defaultProps=Xy,qy.layerName="TileLayer";const Ky=qy,Yy=new Uint32Array([0,2,1,0,3,2]),Zy=new Float32Array([0,1,0,0,1,0,1,1]);function Qy(e,t){if(!t)return function(e){const t=new Float64Array(12);for(let n=0;n<e.length;n++)t[3*n+0]=e[n][0],t[3*n+1]=e[n][1],t[3*n+2]=e[n][2]||0;return{vertexCount:6,positions:t,indices:Yy,texCoords:Zy}}(e);const n=Math.max(Math.abs(e[0][0]-e[3][0]),Math.abs(e[1][0]-e[2][0])),r=Math.max(Math.abs(e[1][1]-e[0][1]),Math.abs(e[2][1]-e[3][1])),i=Math.ceil(n/t)+1,s=Math.ceil(r/t)+1,o=(i-1)*(s-1)*6,a=new Uint32Array(o),l=new Float32Array(i*s*2),c=new Float64Array(i*s*3);let u=0,h=0;for(let d=0;d<i;d++){const t=d/(i-1);for(let n=0;n<s;n++){const r=n/(s-1),i=Jy(e,t,r);c[3*u+0]=i[0],c[3*u+1]=i[1],c[3*u+2]=i[2]||0,l[2*u+0]=t,l[2*u+1]=1-r,d>0&&n>0&&(a[h++]=u-s,a[h++]=u-s-1,a[h++]=u-1,a[h++]=u-s,a[h++]=u-1,a[h++]=u),u++}}return{vertexCount:o,positions:c,indices:a,texCoords:l}}function Jy(e,t,n){return En(En(e[0],e[1],n),En(e[3],e[2],n),t)}const ev="uniform bitmapUniforms {\n  vec4 bounds;\n  float coordinateConversion;\n  float desaturate;\n  vec3 tintColor;\n  vec4 transparentColor;\n} bitmap;\n",tv={name:"bitmap",vs:ev,fs:ev,uniformTypes:{bounds:"vec4<f32>",coordinateConversion:"f32",desaturate:"f32",tintColor:"vec3<f32>",transparentColor:"vec4<f32>"}},nv={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Yi.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}};class rv extends up{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nin vec2 texCoords;\nin vec3 positions;\nin vec3 positions64Low;\n\nout vec2 vTexCoord;\nout vec2 vTexPos;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (bitmap.coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project.commonOrigin.xy;\n  } else if (bitmap.coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nin vec2 vTexCoord;\nin vec2 vTexPos;\n\nout vec4 fragColor;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), bitmap.desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * bitmap.tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (bitmap.transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + bitmap.transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(bitmap.transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bitmap.bounds[0]) / (bitmap.bounds[2] - bitmap.bounds[0]),\n    (pos.y - bitmap.bounds[3]) / (bitmap.bounds[1] - bitmap.bounds[3])\n  );\n}\n\n\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (bitmap.coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (bitmap.coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture(bitmapTexture, uv);\n\n  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * layer.opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  if (bool(picking.isActive) && !bool(picking.isAttribute)) {\n    // Since instance information is not used, we can use picking color for pixel index\n    fragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n",modules:[Sp,Tp,tv]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const t=!0;e.add({indices:{size:1,isIndexed:!0,update:e=>e.value=this.state.mesh.indices,noAlloc:t},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:e=>e.value=this.state.mesh.positions,noAlloc:t},texCoords:{size:2,update:e=>e.value=this.state.mesh.texCoords,noAlloc:t}})}updateState(e){let{props:t,oldProps:n,changeFlags:r}=e;const i=this.getAttributeManager();if(r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll()),t.bounds!==n.bounds){const e=this.state.mesh,t=this._createMesh();this.state.model.setVertexCount(t.vertexCount);for(const n in t)e&&e[n]!==t[n]&&i.invalidate(n);this.setState({mesh:t,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:t}=this.props,n=e.info;if(!n.color||!t)return n.bitmap=null,n;const{width:r,height:i}=t;n.index=0;const s=function(e){const[t,n,r]=e;return[(t+(15&r)/16)/256,(n+(240&r)/256)/256]}(n.color);return n.bitmap={size:{width:r,height:i},uv:s,pixel:[Math.floor(s[0]*r),Math.floor(s[1]*i)]},n}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let t=e;return sv(e)&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),Qy(t,this.context.viewport.resolution)}_getModel(){return new Yd(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1})}draw(e){const{shaderModuleProps:t}=e,{model:n,coordinateConversion:r,bounds:i,disablePicking:s}=this.state,{image:o,desaturate:a,transparentColor:l,tintColor:c}=this.props;if((!t.picking.isActive||!s)&&o&&n){const e={bitmapTexture:o,bounds:i,coordinateConversion:r,desaturate:a,tintColor:c.slice(0,3).map((e=>e/255)),transparentColor:l.map((e=>e/255))};n.shaderInputs.setProps({bitmap:e}),n.draw(this.context.renderPass)}}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:t,DEFAULT:n}=Yi;let{_imageCoordinateSystem:r}=this.props;if(r!==n){const{bounds:n}=this.props;if(!sv(n))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const i=this.context.viewport.resolution?e:t;if(r=r===e?e:t,r===e&&i===t)return{coordinateConversion:-1,bounds:n};if(r===t&&i===e){const e=Dr([n[0],n[1]]),t=Dr([n[2],n[3]]);return{coordinateConversion:1,bounds:[e[0],e[1],t[0],t[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}rv.layerName="BitmapLayer",rv.defaultProps=nv;const iv=rv;function sv(e){return Number.isFinite(e[0])}function ov(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=ov(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const av=function(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=ov(e))&&(r&&(r+=" "),r+=t);return r};function lv(e){const t=new URL(`https://mui.com/production-error/?code=${e}`);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach((e=>t.searchParams.append("args[]",e))),`Minified MUI error #${e}; visit ${t} for the full message.`}const cv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,n))};function uv(e){return cv(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)}function hv(e){if(e.type)return e;if("#"===e.charAt(0))return hv(function(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map((e=>e+e))),n?`rgb${4===n.length?"a":""}(${n.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", ")})`:""}(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(lv(9,e));let r,i=e.substring(t+1,e.length-1);if("color"===n){if(i=i.split(" "),r=i.shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(r))throw new Error(lv(10,r))}else i=i.split(",");return i=i.map((e=>parseFloat(e))),{type:n,values:i,colorSpace:r}}const dv=(e,t)=>{try{return(e=>{const t=hv(e);return t.values.slice(0,3).map(((e,n)=>t.type.includes("hsl")&&0!==n?`${e}%`:e)).join(" ")})(e)}catch(n){return e}};function fv(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return t.includes("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):t.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=t.includes("color")?`${n} ${r.join(" ")}`:`${r.join(", ")}`,`${t}(${r})`}function pv(e){e=hv(e);const{values:t}=e,n=t[0],r=t[1]/100,i=t[2]/100,s=r*Math.min(i,1-i),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return i-s*Math.max(Math.min(t-3,9-t,1),-1)};let a="rgb";const l=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(a+="a",l.push(t[3])),fv({type:a,values:l})}function gv(e){let t="hsl"===(e=hv(e)).type||"hsla"===e.type?hv(pv(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function mv(e,t){return e=hv(e),t=uv(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,fv(e)}function _v(e,t,n){try{return mv(e,t)}catch(r){return e}}function yv(e,t){if(e=hv(e),t=uv(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return fv(e)}function vv(e,t,n){try{return yv(e,t)}catch(r){return e}}function bv(e,t){if(e=hv(e),t=uv(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return fv(e)}function wv(e,t,n){try{return bv(e,t)}catch(r){return e}}function Ev(e,t,n){try{return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return gv(e)>.5?yv(e,t):bv(e,t)}(e,t)}catch(r){return e}}var Sv=n(414);const xv=r.createContext();function Tv(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.useMemo((()=>t.every((e=>null==e))?null:e=>{t.forEach((t=>{!function(e,t){"function"===typeof e?e(t):e&&(e.current=t)}(t,e)}))}),t)}const Av=function(e){return"string"===typeof e};const Cv=function(e,t,n){return void 0===e||Av(e)?t:{...t,ownerState:{...t.ownerState,...n}}};const Rv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const n={};return Object.keys(e).filter((n=>n.match(/^on[A-Z]/)&&"function"===typeof e[n]&&!t.includes(n))).forEach((t=>{n[t]=e[t]})),n};const Pv=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((n=>{t[n]=e[n]})),t};const kv=function(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:s}=e;if(!t){const e=av(n?.className,s,i?.className,r?.className),t={...n?.style,...i?.style,...r?.style},o={...n,...i,...r};return e.length>0&&(o.className=e),Object.keys(t).length>0&&(o.style=t),{props:o,internalRef:void 0}}const o=Rv({...i,...r}),a=Pv(r),l=Pv(i),c=t(o),u=av(c?.className,n?.className,s,i?.className,r?.className),h={...c?.style,...n?.style,...i?.style,...r?.style},d={...c,...n,...l,...a};return u.length>0&&(d.className=u),Object.keys(h).length>0&&(d.style=h),{props:d,internalRef:c.ref}};const Mv=function(e,t,n){return"function"===typeof e?e(t,n):e};const Lv=function(e){const{elementType:t,externalSlotProps:n,ownerState:r,skipResolvingSlotProps:i=!1,...s}=e,o=i?{}:Mv(n,r),{props:a,internalRef:l}=kv({...s,externalSlotProps:o}),c=Tv(l,o?.ref,e.additionalProps?.ref);return Cv(t,{...a,ref:c},r)};function Iv(e){return e&&e.ownerDocument||document}function Ov(e){try{return e.matches(":focus-visible")}catch(t){0}return!1}const Nv="undefined"!==typeof window?r.useLayoutEffect:r.useEffect;const Fv=function(e){const t=r.useRef(e);return Nv((()=>{t.current=e})),r.useRef((function(){return(0,t.current)(...arguments)})).current},Dv={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};const Bv=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))};function Uv(e,t,n,r,i){return 1===n?Math.min(e+t,i):Math.max(e-t,r)}function zv(e,t){return e-t}function Gv(e,t){const{index:n}=e.reduce(((e,n,r)=>{const i=Math.abs(t-n);return null===e||i<e.distance||i===e.distance?{distance:i,index:r}:e}),null)??{};return n}function Vv(e,t){if(void 0!==t.current&&e.changedTouches){const n=e;for(let e=0;e<n.changedTouches.length;e+=1){const r=n.changedTouches[e];if(r.identifier===t.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function jv(e,t,n){return 100*(e-t)/(n-t)}function Wv(e,t,n){const r=Math.round((e-n)/t)*t+n;return Number(r.toFixed(function(e){if(Math.abs(e)<1){const t=e.toExponential().split("e-"),n=t[0].split(".")[1];return(n?n.length:0)+parseInt(t[1],10)}const t=e.toString().split(".")[1];return t?t.length:0}(t)))}function $v(e){let{values:t,newValue:n,index:r}=e;const i=t.slice();return i[r]=n,i.sort(zv)}function Hv(e){let{sliderRef:t,activeIndex:n,setActive:r}=e;const i=Iv(t.current);t.current?.contains(i.activeElement)&&Number(i?.activeElement?.getAttribute("data-index"))===n||t.current?.querySelector(`[type="range"][data-index="${n}"]`).focus(),r&&r(n)}function Xv(e,t){return"number"===typeof e&&"number"===typeof t?e===t:"object"===typeof e&&"object"===typeof t&&Bv(e,t)}const qv={horizontal:{offset:e=>({left:`${e}%`}),leap:e=>({width:`${e}%`})},"horizontal-reverse":{offset:e=>({right:`${e}%`}),leap:e=>({width:`${e}%`})},vertical:{offset:e=>({bottom:`${e}%`}),leap:e=>({height:`${e}%`})}},Kv=e=>e;let Yv;function Zv(){return void 0===Yv&&(Yv="undefined"===typeof CSS||"function"!==typeof CSS.supports||CSS.supports("touch-action","none")),Yv}function Qv(e){const{"aria-labelledby":t,defaultValue:n,disabled:i=!1,disableSwap:s=!1,isRtl:o=!1,marks:a=!1,max:l=100,min:c=0,name:u,onChange:h,onChangeCommitted:d,orientation:f="horizontal",rootRef:p,scale:g=Kv,step:m=1,shiftStep:_=10,tabIndex:y,value:v}=e,b=r.useRef(void 0),[w,E]=r.useState(-1),[S,x]=r.useState(-1),[T,A]=r.useState(!1),C=r.useRef(0),R=r.useRef(null),[P,k]=function(e){let{controlled:t,default:n,name:i,state:s="value"}=e;const{current:o}=r.useRef(void 0!==t),[a,l]=r.useState(n);return[o?t:a,r.useCallback((e=>{o||l(e)}),[])]}({controlled:v,default:n??c,name:"Slider"}),M=h&&((e,t,n)=>{const r=e.nativeEvent||e,i=new r.constructor(r.type,r);Object.defineProperty(i,"target",{writable:!0,value:{value:t,name:u}}),R.current=t,h(i,t,n)}),L=Array.isArray(P);let I=L?P.slice().sort(zv):[P];I=I.map((e=>null==e?c:cv(e,c,l)));const O=!0===a&&null!==m?[...Array(Math.floor((l-c)/m)+1)].map(((e,t)=>({value:c+m*t}))):a||[],N=O.map((e=>e.value)),[F,D]=r.useState(-1),B=r.useRef(null),U=Tv(p,B),z=e=>t=>{const n=Number(t.currentTarget.getAttribute("data-index"));Ov(t.target)&&D(n),x(n),e?.onFocus?.(t)},G=e=>t=>{Ov(t.target)||D(-1),x(-1),e?.onBlur?.(t)},V=(e,t)=>{const n=Number(e.currentTarget.getAttribute("data-index")),r=I[n],i=N.indexOf(r);let o=t;if(O&&null==m){const e=N[N.length-1];o=o>=e?e:o<=N[0]?N[0]:o<r?N[i-1]:N[i+1]}if(o=cv(o,c,l),L){s&&(o=cv(o,I[n-1]||-1/0,I[n+1]||1/0));const e=o;o=$v({values:I,newValue:o,index:n});let t=n;s||(t=o.indexOf(e)),Hv({sliderRef:B,activeIndex:t})}k(o),D(n),M&&!Xv(o,P)&&M(e,o,n),d&&d(e,R.current??o)},j=e=>t=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(t.key)){t.preventDefault();const e=Number(t.currentTarget.getAttribute("data-index")),n=I[e];let r=null;if(null!=m){const e=t.shiftKey?_:m;switch(t.key){case"ArrowUp":r=Uv(n,e,1,c,l);break;case"ArrowRight":r=Uv(n,e,o?-1:1,c,l);break;case"ArrowDown":r=Uv(n,e,-1,c,l);break;case"ArrowLeft":r=Uv(n,e,o?1:-1,c,l);break;case"PageUp":r=Uv(n,_,1,c,l);break;case"PageDown":r=Uv(n,_,-1,c,l);break;case"Home":r=c;break;case"End":r=l}}else if(O){const e=N[N.length-1],i=N.indexOf(n),s=[o?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];[o?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"].includes(t.key)?r=0===i?N[0]:N[i-1]:s.includes(t.key)&&(r=i===N.length-1?e:N[i+1])}null!=r&&V(t,r)}e?.onKeyDown?.(t)};Nv((()=>{i&&B.current.contains(document.activeElement)&&document.activeElement?.blur()}),[i]),i&&-1!==w&&E(-1),i&&-1!==F&&D(-1);const W=r.useRef(void 0);let $=f;o&&"horizontal"===f&&($+="-reverse");const H=e=>{let{finger:t,move:n=!1}=e;const{current:r}=B,{width:i,height:o,bottom:a,left:u}=r.getBoundingClientRect();let h,d;if(h=$.startsWith("vertical")?(a-t.y)/o:(t.x-u)/i,$.includes("-reverse")&&(h=1-h),d=function(e,t,n){return(n-t)*e+t}(h,c,l),m)d=Wv(d,m,c);else{const e=Gv(N,d);d=N[e]}d=cv(d,c,l);let f=0;if(L){f=n?W.current:Gv(I,d),s&&(d=cv(d,I[f-1]||-1/0,I[f+1]||1/0));const e=d;d=$v({values:I,newValue:d,index:f}),s&&n||(f=d.indexOf(e),W.current=f)}return{newValue:d,activeIndex:f}},X=Fv((e=>{const t=Vv(e,b);if(!t)return;if(C.current+=1,"mousemove"===e.type&&0===e.buttons)return void q(e);const{newValue:n,activeIndex:r}=H({finger:t,move:!0});Hv({sliderRef:B,activeIndex:r,setActive:E}),k(n),!T&&C.current>2&&A(!0),M&&!Xv(n,P)&&M(e,n,r)})),q=Fv((e=>{const t=Vv(e,b);if(A(!1),!t)return;const{newValue:n}=H({finger:t,move:!0});E(-1),"touchend"===e.type&&x(-1),d&&d(e,R.current??n),b.current=void 0,Y()})),K=Fv((e=>{if(i)return;Zv()||e.preventDefault();const t=e.changedTouches[0];null!=t&&(b.current=t.identifier);const n=Vv(e,b);if(!1!==n){const{newValue:t,activeIndex:r}=H({finger:n});Hv({sliderRef:B,activeIndex:r,setActive:E}),k(t),M&&!Xv(t,P)&&M(e,t,r)}C.current=0;const r=Iv(B.current);r.addEventListener("touchmove",X,{passive:!0}),r.addEventListener("touchend",q,{passive:!0})})),Y=r.useCallback((()=>{const e=Iv(B.current);e.removeEventListener("mousemove",X),e.removeEventListener("mouseup",q),e.removeEventListener("touchmove",X),e.removeEventListener("touchend",q)}),[q,X]);r.useEffect((()=>{const{current:e}=B;return e.addEventListener("touchstart",K,{passive:Zv()}),()=>{e.removeEventListener("touchstart",K),Y()}}),[Y,K]),r.useEffect((()=>{i&&Y()}),[i,Y]);const Z=jv(L?I[0]:c,c,l),Q=jv(I[I.length-1],c,l)-Z,J=e=>t=>{e.onMouseLeave?.(t),x(-1)};let ee;"vertical"===f&&(ee=o?"vertical-rl":"vertical-lr");return{active:w,axis:$,axisProps:qv,dragging:T,focusedThumbIndex:F,getHiddenInputProps:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=Rv(n),s={onChange:(a=r||{},e=>{a.onChange?.(e),V(e,e.target.valueAsNumber)}),onFocus:z(r||{}),onBlur:G(r||{}),onKeyDown:j(r||{})};var a;const h={...r,...s};return{tabIndex:y,"aria-labelledby":t,"aria-orientation":f,"aria-valuemax":g(l),"aria-valuemin":g(c),name:u,type:"range",min:e.min,max:e.max,step:null===e.step&&e.marks?"any":e.step??void 0,disabled:i,...n,...h,style:{...Dv,direction:o?"rtl":"ltr",width:"100%",height:"100%",writingMode:ee}}},getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Rv(e),n={onMouseDown:(r=t||{},e=>{if(r.onMouseDown?.(e),i)return;if(e.defaultPrevented)return;if(0!==e.button)return;e.preventDefault();const t=Vv(e,b);if(!1!==t){const{newValue:n,activeIndex:r}=H({finger:t});Hv({sliderRef:B,activeIndex:r,setActive:E}),k(n),M&&!Xv(n,P)&&M(e,n,r)}C.current=0;const n=Iv(B.current);n.addEventListener("mousemove",X,{passive:!0}),n.addEventListener("mouseup",q)})};var r;const s={...t,...n};return{...e,ref:U,...s}},getThumbProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Rv(e),n={onMouseOver:(r=t||{},e=>{r.onMouseOver?.(e);const t=Number(e.currentTarget.getAttribute("data-index"));x(t)}),onMouseLeave:J(t||{})};var r;return{...e,...t,...n}},marks:O,open:S,range:L,rootRef:U,trackLeap:Q,trackOffset:Z,values:I,getThumbStyle:e=>({pointerEvents:-1!==w&&w!==e?"none":void 0})}}const Jv=function(e){return"string"===typeof e};function eb(){return eb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eb.apply(null,arguments)}var tb=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),nb=Math.abs,rb=String.fromCharCode,ib=Object.assign;function sb(e){return e.trim()}function ob(e,t,n){return e.replace(t,n)}function ab(e,t){return e.indexOf(t)}function lb(e,t){return 0|e.charCodeAt(t)}function cb(e,t,n){return e.slice(t,n)}function ub(e){return e.length}function hb(e){return e.length}function db(e,t){return t.push(e),e}var fb=1,pb=1,gb=0,mb=0,_b=0,yb="";function vb(e,t,n,r,i,s,o){return{value:e,root:t,parent:n,type:r,props:i,children:s,line:fb,column:pb,length:o,return:""}}function bb(e,t){return ib(vb("",null,null,"",null,null,0),e,{length:-e.length},t)}function wb(){return _b=mb>0?lb(yb,--mb):0,pb--,10===_b&&(pb=1,fb--),_b}function Eb(){return _b=mb<gb?lb(yb,mb++):0,pb++,10===_b&&(pb=1,fb++),_b}function Sb(){return lb(yb,mb)}function xb(){return mb}function Tb(e,t){return cb(yb,e,t)}function Ab(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Cb(e){return fb=pb=1,gb=ub(yb=e),mb=0,[]}function Rb(e){return yb="",e}function Pb(e){return sb(Tb(mb-1,Lb(91===e?e+2:40===e?e+1:e)))}function kb(e){for(;(_b=Sb())&&_b<33;)Eb();return Ab(e)>2||Ab(_b)>3?"":" "}function Mb(e,t){for(;--t&&Eb()&&!(_b<48||_b>102||_b>57&&_b<65||_b>70&&_b<97););return Tb(e,xb()+(t<6&&32==Sb()&&32==Eb()))}function Lb(e){for(;Eb();)switch(_b){case e:return mb;case 34:case 39:34!==e&&39!==e&&Lb(_b);break;case 40:41===e&&Lb(e);break;case 92:Eb()}return mb}function Ib(e,t){for(;Eb()&&e+_b!==57&&(e+_b!==84||47!==Sb()););return"/*"+Tb(t,mb-1)+"*"+rb(47===e?e:Eb())}function Ob(e){for(;!Ab(Sb());)Eb();return Tb(e,mb)}var Nb="-ms-",Fb="-moz-",Db="-webkit-",Bb="comm",Ub="rule",zb="decl",Gb="@keyframes";function Vb(e,t){for(var n="",r=hb(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function jb(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case zb:return e.return=e.return||e.value;case Bb:return"";case Gb:return e.return=e.value+"{"+Vb(e.children,r)+"}";case Ub:e.value=e.props.join(",")}return ub(n=Vb(e.children,r))?e.return=e.value+"{"+n+"}":""}function Wb(e){return Rb($b("",null,null,null,[""],e=Cb(e),0,[0],e))}function $b(e,t,n,r,i,s,o,a,l){for(var c=0,u=0,h=o,d=0,f=0,p=0,g=1,m=1,_=1,y=0,v="",b=i,w=s,E=r,S=v;m;)switch(p=y,y=Eb()){case 40:if(108!=p&&58==lb(S,h-1)){-1!=ab(S+=ob(Pb(y),"&","&\f"),"&\f")&&(_=-1);break}case 34:case 39:case 91:S+=Pb(y);break;case 9:case 10:case 13:case 32:S+=kb(p);break;case 92:S+=Mb(xb()-1,7);continue;case 47:switch(Sb()){case 42:case 47:db(Xb(Ib(Eb(),xb()),t,n),l);break;default:S+="/"}break;case 123*g:a[c++]=ub(S)*_;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+u:-1==_&&(S=ob(S,/\f/g,"")),f>0&&ub(S)-h&&db(f>32?qb(S+";",r,n,h-1):qb(ob(S," ","")+";",r,n,h-2),l);break;case 59:S+=";";default:if(db(E=Hb(S,t,n,c,u,i,a,v,b=[],w=[],h),s),123===y)if(0===u)$b(S,t,E,E,b,s,h,a,w);else switch(99===d&&110===lb(S,3)?100:d){case 100:case 108:case 109:case 115:$b(e,E,E,r&&db(Hb(e,E,E,0,0,i,a,v,i,b=[],h),w),i,w,h,a,r?b:w);break;default:$b(S,E,E,E,[""],w,0,a,w)}}c=u=f=0,g=_=1,v=S="",h=o;break;case 58:h=1+ub(S),f=p;default:if(g<1)if(123==y)--g;else if(125==y&&0==g++&&125==wb())continue;switch(S+=rb(y),y*g){case 38:_=u>0?1:(S+="\f",-1);break;case 44:a[c++]=(ub(S)-1)*_,_=1;break;case 64:45===Sb()&&(S+=Pb(Eb())),d=Sb(),u=h=ub(v=S+=Ob(xb())),y++;break;case 45:45===p&&2==ub(S)&&(g=0)}}return s}function Hb(e,t,n,r,i,s,o,a,l,c,u){for(var h=i-1,d=0===i?s:[""],f=hb(d),p=0,g=0,m=0;p<r;++p)for(var _=0,y=cb(e,h+1,h=nb(g=o[p])),v=e;_<f;++_)(v=sb(g>0?d[_]+" "+y:ob(y,/&\f/g,d[_])))&&(l[m++]=v);return vb(e,t,n,0===i?Ub:a,l,c,u)}function Xb(e,t,n){return vb(e,t,n,Bb,rb(_b),cb(e,2,-2),0)}function qb(e,t,n,r){return vb(e,t,n,zb,cb(e,0,r),cb(e,r+1,-1),r)}var Kb=function(e,t,n){for(var r=0,i=0;r=i,i=Sb(),38===r&&12===i&&(t[n]=1),!Ab(i);)Eb();return Tb(e,mb)},Yb=function(e,t){return Rb(function(e,t){var n=-1,r=44;do{switch(Ab(r)){case 0:38===r&&12===Sb()&&(t[n]=1),e[n]+=Kb(mb-1,t,n);break;case 2:e[n]+=Pb(r);break;case 4:if(44===r){e[++n]=58===Sb()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=rb(r)}}while(r=Eb());return e}(Cb(e),t))},Zb=new WeakMap,Qb=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Zb.get(n))&&!r){Zb.set(e,!0);for(var i=[],s=Yb(t,i),o=n.props,a=0,l=0;a<s.length;a++)for(var c=0;c<o.length;c++,l++)e.props[l]=i[a]?s[a].replace(/&\f/g,o[c]):o[c]+" "+s[a]}}},Jb=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function ew(e,t){switch(function(e,t){return 45^lb(e,0)?(((t<<2^lb(e,0))<<2^lb(e,1))<<2^lb(e,2))<<2^lb(e,3):0}(e,t)){case 5103:return Db+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Db+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Db+e+Fb+e+Nb+e+e;case 6828:case 4268:return Db+e+Nb+e+e;case 6165:return Db+e+Nb+"flex-"+e+e;case 5187:return Db+e+ob(e,/(\w+).+(:[^]+)/,Db+"box-$1$2"+Nb+"flex-$1$2")+e;case 5443:return Db+e+Nb+"flex-item-"+ob(e,/flex-|-self/,"")+e;case 4675:return Db+e+Nb+"flex-line-pack"+ob(e,/align-content|flex-|-self/,"")+e;case 5548:return Db+e+Nb+ob(e,"shrink","negative")+e;case 5292:return Db+e+Nb+ob(e,"basis","preferred-size")+e;case 6060:return Db+"box-"+ob(e,"-grow","")+Db+e+Nb+ob(e,"grow","positive")+e;case 4554:return Db+ob(e,/([^-])(transform)/g,"$1"+Db+"$2")+e;case 6187:return ob(ob(ob(e,/(zoom-|grab)/,Db+"$1"),/(image-set)/,Db+"$1"),e,"")+e;case 5495:case 3959:return ob(e,/(image-set\([^]*)/,Db+"$1$`$1");case 4968:return ob(ob(e,/(.+:)(flex-)?(.*)/,Db+"box-pack:$3"+Nb+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Db+e+e;case 4095:case 3583:case 4068:case 2532:return ob(e,/(.+)-inline(.+)/,Db+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ub(e)-1-t>6)switch(lb(e,t+1)){case 109:if(45!==lb(e,t+4))break;case 102:return ob(e,/(.+:)(.+)-([^]+)/,"$1"+Db+"$2-$3$1"+Fb+(108==lb(e,t+3)?"$3":"$2-$3"))+e;case 115:return~ab(e,"stretch")?ew(ob(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==lb(e,t+1))break;case 6444:switch(lb(e,ub(e)-3-(~ab(e,"!important")&&10))){case 107:return ob(e,":",":"+Db)+e;case 101:return ob(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Db+(45===lb(e,14)?"inline-":"")+"box$3$1"+Db+"$2$3$1"+Nb+"$2box$3")+e}break;case 5936:switch(lb(e,t+11)){case 114:return Db+e+Nb+ob(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Db+e+Nb+ob(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Db+e+Nb+ob(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Db+e+Nb+e+e}return e}var tw=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case zb:e.return=ew(e.value,e.length);break;case Gb:return Vb([bb(e,{value:ob(e.value,"@","@"+Db)})],r);case Ub:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Vb([bb(e,{props:[ob(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return Vb([bb(e,{props:[ob(t,/:(plac\w+)/,":"+Db+"input-$1")]}),bb(e,{props:[ob(t,/:(plac\w+)/,":-moz-$1")]}),bb(e,{props:[ob(t,/:(plac\w+)/,Nb+"input-$1")]})],r)}return""}))}}],nw=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r,i,s=e.stylisPlugins||tw,o={},a=[];r=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)o[t[n]]=!0;a.push(e)}));var l,c,u=[jb,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=hb(e);return function(n,r,i,s){for(var o="",a=0;a<t;a++)o+=e[a](n,r,i,s)||"";return o}}([Qb,Jb].concat(s,u));i=function(e,t,n,r){l=n,Vb(Wb(e?e+"{"+t.styles+"}":t.styles),h),r&&(d.inserted[t.name]=!0)};var d={key:t,sheet:new tb({key:t,container:r,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:i};return d.sheet.hydrate(a),d};var rw={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function iw(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var sw=/[A-Z]|^ms/g,ow=/_EMO_([^_]+?)_([^]*?)_EMO_/g,aw=function(e){return 45===e.charCodeAt(1)},lw=function(e){return null!=e&&"boolean"!==typeof e},cw=iw((function(e){return aw(e)?e:e.replace(sw,"-$&").toLowerCase()})),uw=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(ow,(function(e,t,n){return dw={name:t,styles:n,next:dw},t}))}return 1===rw[e]||aw(e)||"number"!==typeof t||0===t?t:t+"px"};function hw(e,t,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var i=n;if(1===i.anim)return dw={name:i.name,styles:i.styles,next:dw},i.name;var s=n;if(void 0!==s.styles){var o=s.next;if(void 0!==o)for(;void 0!==o;)dw={name:o.name,styles:o.styles,next:dw},o=o.next;return s.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=hw(e,t,n[i])+";";else for(var s in n){var o=n[s];if("object"!==typeof o){var a=o;null!=t&&void 0!==t[a]?r+=s+"{"+t[a]+"}":lw(a)&&(r+=cw(s)+":"+uw(s,a)+";")}else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var l=hw(e,t,o);switch(s){case"animation":case"animationName":r+=cw(s)+":"+l+";";break;default:r+=s+"{"+l+"}"}}else for(var c=0;c<o.length;c++)lw(o[c])&&(r+=cw(s)+":"+uw(s,o[c])+";")}return r}(e,t,n);case"function":if(void 0!==e){var a=dw,l=n(e);return dw=a,hw(e,t,l)}}var c=n;if(null==t)return c;var u=t[c];return void 0!==u?u:c}var dw,fw=/label:\s*([^\s;{]+)\s*(;|$)/g;function pw(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,i="";dw=void 0;var s=e[0];null==s||void 0===s.raw?(r=!1,i+=hw(n,t,s)):i+=s[0];for(var o=1;o<e.length;o++){if(i+=hw(n,t,e[o]),r)i+=s[o]}fw.lastIndex=0;for(var a,l="";null!==(a=fw.exec(i));)l+="-"+a[1];var c=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(i)+l;return{name:c,styles:i,next:dw}}var gw=!!i.useInsertionEffect&&i.useInsertionEffect,mw=gw||function(e){return e()},_w=(gw||r.useLayoutEffect,r.createContext("undefined"!==typeof HTMLElement?nw({key:"css"}):null)),yw=(_w.Provider,function(e){return(0,r.forwardRef)((function(t,n){var i=(0,r.useContext)(_w);return e(t,i,n)}))}),vw=r.createContext({});var bw=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},ww=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Ew=iw((function(e){return ww.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),Sw=function(e){return"theme"!==e},xw=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?Ew:Sw},Tw=function(e,t,n){var r;if(t){var i=t.shouldForwardProp;r=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},Aw=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return bw(t,n,r),mw((function(){return function(e,t,n){bw(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+r:"",i,e.sheet,!0),i=i.next}while(void 0!==i)}}(t,n,r)})),null},Cw=function e(t,n){var i,s,o=t.__emotion_real===t,a=o&&t.__emotion_base||t;void 0!==n&&(i=n.label,s=n.target);var l=Tw(t,n,o),c=l||xw(a),u=!c("as");return function(){var h=arguments,d=o&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&d.push("label:"+i+";"),null==h[0]||void 0===h[0].raw)d.push.apply(d,h);else{var f=h[0];d.push(f[0]);for(var p=h.length,g=1;g<p;g++)d.push(h[g],f[g])}var m=yw((function(e,t,n){var i=u&&e.as||a,o="",h=[],f=e;if(null==e.theme){for(var p in f={},e)f[p]=e[p];f.theme=r.useContext(vw)}"string"===typeof e.className?o=function(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):n&&(r+=n+" ")})),r}(t.registered,h,e.className):null!=e.className&&(o=e.className+" ");var g=pw(d.concat(h),t.registered,f);o+=t.key+"-"+g.name,void 0!==s&&(o+=" "+s);var m=u&&void 0===l?xw(i):c,_={};for(var y in e)u&&"as"===y||m(y)&&(_[y]=e[y]);return _.className=o,n&&(_.ref=n),r.createElement(r.Fragment,null,r.createElement(Aw,{cache:t,serialized:g,isStringTag:"string"===typeof i}),r.createElement(i,_))}));return m.displayName=void 0!==i?i:"Styled("+("string"===typeof a?a:a.displayName||a.name||"Component")+")",m.defaultProps=t.defaultProps,m.__emotion_real=m,m.__emotion_base=a,m.__emotion_styles=d,m.__emotion_forwardProp=l,Object.defineProperty(m,"toString",{value:function(){return"."+s}}),m.withComponent=function(t,r){return e(t,eb({},n,r,{shouldForwardProp:Tw(m,r,!0)})).apply(void 0,d)},m}}.bind(null);["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){Cw[e]=Cw(e)}));const Rw=[];function Pw(e){return Rw[0]=e,pw(Rw)}var kw=n(732);function Mw(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function Lw(e){if(r.isValidElement(e)||(0,kw.Hy)(e)||!Mw(e))return e;const t={};return Object.keys(e).forEach((n=>{t[n]=Lw(e[n])})),t}function Iw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const i=n.clone?{...e}:e;return Mw(e)&&Mw(t)&&Object.keys(t).forEach((s=>{r.isValidElement(t[s])||(0,kw.Hy)(t[s])?i[s]=t[s]:Mw(t[s])&&Object.prototype.hasOwnProperty.call(e,s)&&Mw(e[s])?i[s]=Iw(e[s],t[s],n):n.clone?i[s]=Mw(t[s])?Lw(t[s]):t[s]:i[s]=t[s]})),i}function Ow(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...i}=e,s=(e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>({...e,[t.key]:t.val})),{})})(t),o=Object.keys(s);function a(e){return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${n})`}function l(e){return`@media (max-width:${("number"===typeof t[e]?t[e]:e)-r/100}${n})`}function c(e,i){const s=o.indexOf(i);return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${n}) and (max-width:${(-1!==s&&"number"===typeof t[o[s]]?t[o[s]]:i)-r/100}${n})`}return{keys:o,values:s,up:a,down:l,between:c,only:function(e){return o.indexOf(e)+1<o.length?c(e,o[o.indexOf(e)+1]):a(e)},not:function(e){const t=o.indexOf(e);return 0===t?a(o[1]):t===o.length-1?l(o[t]):c(e,o[o.indexOf(e)+1]).replace("@media","@media not all and")},unit:n,...i}}const Nw={borderRadius:4},Fw={xs:0,sm:600,md:900,lg:1200,xl:1536},Dw={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Fw[e]}px)`},Bw={containerQueries:e=>({up:t=>{let n="number"===typeof t?t:Fw[t]||t;return"number"===typeof n&&(n=`${n}px`),e?`@container ${e} (min-width:${n})`:`@container (min-width:${n})`}})};function Uw(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||Dw;return t.reduce(((r,i,s)=>(r[e.up(e.keys[s])]=n(t[s]),r)),{})}if("object"===typeof t){const e=r.breakpoints||Dw;return Object.keys(t).reduce(((i,s)=>{if(function(e,t){return"@"===t||t.startsWith("@")&&(e.some((e=>t.startsWith(`@${e}`)))||!!t.match(/^@\d/))}(e.keys,s)){const e=function(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,i]=n,s=Number.isNaN(+r)?r||0:+r;return e.containerQueries(i).up(s)}(r.containerQueries?r:Bw,s);e&&(i[e]=n(t[s],s))}else if(Object.keys(e.values||Fw).includes(s)){i[e.up(s)]=n(t[s],s)}else{const e=s;i[e]=t[e]}return i}),{})}return n(t)}function zw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.keys?.reduce(((t,n)=>(t[e.up(n)]={},t)),{});return t||{}}function Gw(e,t){return e.reduce(((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function Vw(e){if("string"!==typeof e)throw new Error(lv(7));return e.charAt(0).toUpperCase()+e.slice(1)}function jw(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){const n=`vars.${t}`.split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=n)return n}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function Ww(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||i:jw(e,n)||i,t&&(r=t(r,i,e)),r}const $w=function(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:i}=e,s=e=>{if(null==e[t])return null;const s=e[t],o=jw(e.theme,r)||{};return Uw(e,s,(e=>{let r=Ww(o,i,e);return e===r&&"string"===typeof e&&(r=Ww(o,i,`${t}${"default"===e?"":Vw(e)}`,e)),!1===n?r:{[n]:r}}))};return s.propTypes={},s.filterProps=[t],s};const Hw=function(e,t){return t?Iw(e,t,{clone:!1}):e};const Xw={m:"margin",p:"padding"},qw={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Kw={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Yw=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}((e=>{if(e.length>2){if(!Kw[e])return[e];e=Kw[e]}const[t,n]=e.split(""),r=Xw[t],i=qw[n]||"";return Array.isArray(i)?i.map((e=>r+e)):[r+i]})),Zw=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Qw=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Jw=[...Zw,...Qw];function eE(e,t,n,r){const i=jw(e,t,!0)??n;return"number"===typeof i||"string"===typeof i?e=>"string"===typeof e?e:"string"===typeof i?`calc(${e} * ${i})`:i*e:Array.isArray(i)?e=>{if("string"===typeof e)return e;const t=Math.abs(e);const n=i[t];return e>=0?n:"number"===typeof n?-n:`-${n}`}:"function"===typeof i?i:()=>{}}function tE(e){return eE(e,"spacing",8)}function nE(e,t){return"string"===typeof t||null==t?t:e(t)}function rE(e,t,n,r){if(!t.includes(n))return null;const i=function(e,t){return n=>e.reduce(((e,r)=>(e[r]=nE(t,n),e)),{})}(Yw(n),r);return Uw(e,e[n],i)}function iE(e,t){const n=tE(e.theme);return Object.keys(e).map((r=>rE(e,t,r,n))).reduce(Hw,{})}function sE(e){return iE(e,Zw)}function oE(e){return iE(e,Qw)}function aE(e){return iE(e,Jw)}sE.propTypes={},sE.filterProps=Zw,oE.propTypes={},oE.filterProps=Qw,aE.propTypes={},aE.filterProps=Jw;function lE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tE({spacing:e});if(e.mui)return e;const n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map((e=>{const n=t(e);return"number"===typeof n?`${n}px`:n})).join(" ")};return n.mui=!0,n}const cE=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>(t.filterProps.forEach((n=>{e[n]=t})),e)),{}),i=e=>Object.keys(e).reduce(((t,n)=>r[n]?Hw(t,r[n](e)):t),{});return i.propTypes={},i.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),i};function uE(e){return"number"!==typeof e?e:`${e}px solid`}function hE(e,t){return $w({prop:e,themeKey:"borders",transform:t})}const dE=hE("border",uE),fE=hE("borderTop",uE),pE=hE("borderRight",uE),gE=hE("borderBottom",uE),mE=hE("borderLeft",uE),_E=hE("borderColor"),yE=hE("borderTopColor"),vE=hE("borderRightColor"),bE=hE("borderBottomColor"),wE=hE("borderLeftColor"),EE=hE("outline",uE),SE=hE("outlineColor"),xE=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=eE(e.theme,"shape.borderRadius",4),n=e=>({borderRadius:nE(t,e)});return Uw(e,e.borderRadius,n)}return null};xE.propTypes={},xE.filterProps=["borderRadius"];cE(dE,fE,pE,gE,mE,_E,yE,vE,bE,wE,xE,EE,SE);const TE=e=>{if(void 0!==e.gap&&null!==e.gap){const t=eE(e.theme,"spacing",8),n=e=>({gap:nE(t,e)});return Uw(e,e.gap,n)}return null};TE.propTypes={},TE.filterProps=["gap"];const AE=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=eE(e.theme,"spacing",8),n=e=>({columnGap:nE(t,e)});return Uw(e,e.columnGap,n)}return null};AE.propTypes={},AE.filterProps=["columnGap"];const CE=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=eE(e.theme,"spacing",8),n=e=>({rowGap:nE(t,e)});return Uw(e,e.rowGap,n)}return null};CE.propTypes={},CE.filterProps=["rowGap"];cE(TE,AE,CE,$w({prop:"gridColumn"}),$w({prop:"gridRow"}),$w({prop:"gridAutoFlow"}),$w({prop:"gridAutoColumns"}),$w({prop:"gridAutoRows"}),$w({prop:"gridTemplateColumns"}),$w({prop:"gridTemplateRows"}),$w({prop:"gridTemplateAreas"}),$w({prop:"gridArea"}));function RE(e,t){return"grey"===t?t:e}cE($w({prop:"color",themeKey:"palette",transform:RE}),$w({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:RE}),$w({prop:"backgroundColor",themeKey:"palette",transform:RE}));function PE(e){return e<=1&&0!==e?100*e+"%":e}const kE=$w({prop:"width",transform:PE}),ME=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{const n=e.theme?.breakpoints?.values?.[t]||Fw[t];return n?"px"!==e.theme?.breakpoints?.unit?{maxWidth:`${n}${e.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:PE(t)}};return Uw(e,e.maxWidth,t)}return null};ME.filterProps=["maxWidth"];const LE=$w({prop:"minWidth",transform:PE}),IE=$w({prop:"height",transform:PE}),OE=$w({prop:"maxHeight",transform:PE}),NE=$w({prop:"minHeight",transform:PE}),FE=($w({prop:"size",cssProperty:"width",transform:PE}),$w({prop:"size",cssProperty:"height",transform:PE}),cE(kE,ME,LE,IE,OE,NE,$w({prop:"boxSizing"})),{border:{themeKey:"borders",transform:uE},borderTop:{themeKey:"borders",transform:uE},borderRight:{themeKey:"borders",transform:uE},borderBottom:{themeKey:"borders",transform:uE},borderLeft:{themeKey:"borders",transform:uE},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:uE},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:xE},color:{themeKey:"palette",transform:RE},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:RE},backgroundColor:{themeKey:"palette",transform:RE},p:{style:oE},pt:{style:oE},pr:{style:oE},pb:{style:oE},pl:{style:oE},px:{style:oE},py:{style:oE},padding:{style:oE},paddingTop:{style:oE},paddingRight:{style:oE},paddingBottom:{style:oE},paddingLeft:{style:oE},paddingX:{style:oE},paddingY:{style:oE},paddingInline:{style:oE},paddingInlineStart:{style:oE},paddingInlineEnd:{style:oE},paddingBlock:{style:oE},paddingBlockStart:{style:oE},paddingBlockEnd:{style:oE},m:{style:sE},mt:{style:sE},mr:{style:sE},mb:{style:sE},ml:{style:sE},mx:{style:sE},my:{style:sE},margin:{style:sE},marginTop:{style:sE},marginRight:{style:sE},marginBottom:{style:sE},marginLeft:{style:sE},marginX:{style:sE},marginY:{style:sE},marginInline:{style:sE},marginInlineStart:{style:sE},marginInlineEnd:{style:sE},marginBlock:{style:sE},marginBlockStart:{style:sE},marginBlockEnd:{style:sE},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:TE},rowGap:{style:CE},columnGap:{style:AE},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:PE},maxWidth:{style:ME},minWidth:{transform:PE},height:{transform:PE},maxHeight:{transform:PE},minHeight:{transform:PE},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}});const DE=function(){function e(e,t,n,r){const i={[e]:t,theme:n},s=r[e];if(!s)return{[e]:t};const{cssProperty:o=e,themeKey:a,transform:l,style:c}=s;if(null==t)return null;if("typography"===a&&"inherit"===t)return{[e]:t};const u=jw(n,a)||{};if(c)return c(i);return Uw(i,t,(t=>{let n=Ww(u,l,t);return t===n&&"string"===typeof t&&(n=Ww(u,l,`${e}${"default"===t?"":Vw(t)}`,t)),!1===o?n:{[o]:n}}))}return function t(n){const{sx:r,theme:i={}}=n||{};if(!r)return null;const s=i.unstable_sxConfig??FE;function o(n){let r=n;if("function"===typeof n)r=n(i);else if("object"!==typeof n)return n;if(!r)return null;const o=zw(i.breakpoints),a=Object.keys(o);let l=o;return Object.keys(r).forEach((n=>{const o=function(e,t){return"function"===typeof e?e(t):e}(r[n],i);if(null!==o&&void 0!==o)if("object"===typeof o)if(s[n])l=Hw(l,e(n,o,i,s));else{const e=Uw({theme:i},o,(e=>({[n]:e})));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),i=new Set(r);return t.every((e=>i.size===Object.keys(e).length))}(e,o)?l=Hw(l,e):l[n]=t({sx:o,theme:i})}else l=Hw(l,e(n,o,i,s))})),function(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter((e=>e.startsWith("@container"))).sort(((e,t)=>{const n=/min-width:\s*([0-9.]+)/;return+(e.match(n)?.[1]||0)-+(t.match(n)?.[1]||0)}));return n.length?n.reduce(((e,n)=>{const r=t[n];return delete e[n],e[n]=r,e}),{...t}):t}(i,Gw(a,l))}return Array.isArray(r)?r.map(o):o(r)}}();DE.filterProps=["sx"];const BE=DE;function UE(e,t){const n=this;if(n.vars){if(!n.colorSchemes?.[e]||"function"!==typeof n.getColorSchemeSelector)return{};let r=n.getColorSchemeSelector(e);return"&"===r?t:((r.includes("data-")||r.includes("."))&&(r=`*:where(${r.replace(/\s*&$/,"")}) &`),{[r]:t})}return n.palette.mode===e?t:{}}const zE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:n={},spacing:r,shape:i={},...s}=e;let o=Iw({breakpoints:Ow(t),direction:"ltr",components:{},palette:{mode:"light",...n},spacing:lE(r),shape:{...Nw,...i}},s);o=function(e){const t=(e,t)=>e.replace("@media",t?`@container ${t}`:"@container");function n(n,r){n.up=function(){return t(e.breakpoints.up(...arguments),r)},n.down=function(){return t(e.breakpoints.down(...arguments),r)},n.between=function(){return t(e.breakpoints.between(...arguments),r)},n.only=function(){return t(e.breakpoints.only(...arguments),r)},n.not=function(){const n=t(e.breakpoints.not(...arguments),r);return n.includes("not all and")?n.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):n}}const r={},i=e=>(n(r,e),r);return n(i),{...e,containerQueries:i}}(o),o.applyStyles=UE;for(var a=arguments.length,l=new Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];return o=l.reduce(((e,t)=>Iw(e,t)),o),o.unstable_sxConfig={...FE,...s?.unstable_sxConfig},o.unstable_sx=function(e){return BE({sx:e,theme:this})},o};function GE(e){const{variants:t,...n}=e,r={variants:t,style:Pw(n),isProcessed:!0};return r.style===n||t&&t.forEach((e=>{"function"!==typeof e.style&&(e.style=Pw(e.style))})),r}const VE=zE();function jE(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function WE(e){return e?(t,n)=>n[e]:null}function $E(e,t){const n="function"===typeof t?t(e):t;if(Array.isArray(n))return n.flatMap((t=>$E(e,t)));if(Array.isArray(n?.variants)){let t;if(n.isProcessed)t=n.style;else{const{variants:e,...r}=n;t=r}return HE(e,n.variants,[t])}return n?.isProcessed?n.style:n}function HE(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e:for(let i=0;i<t.length;i+=1){const s=t[i];if("function"===typeof s.props){if(n??={...e,...e.ownerState,ownerState:e.ownerState},!s.props(n))continue}else for(const t in s.props)if(e[t]!==s.props[t]&&e.ownerState?.[t]!==s.props[t])continue e;"function"===typeof s.style?(n??={...e,...e.ownerState,ownerState:e.ownerState},r.push(s.style(n))):r.push(s.style)}return r}function XE(e,t){}function qE(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}const KE={black:"#000",white:"#fff"},YE={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},ZE={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},QE={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},JE={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},eS={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},tS={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},nS={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function rS(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:KE.white,default:KE.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const iS=rS();function sS(){return{text:{primary:KE.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:KE.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const oS=sS();function aS(e,t,n,r){const i=r.light||r,s=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=bv(e.main,i):"dark"===t&&(e.dark=yv(e.main,s)))}function lS(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2,...i}=e,s=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:eS[200],light:eS[50],dark:eS[400]}:{main:eS[700],light:eS[400],dark:eS[800]}}(t),o=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:ZE[200],light:ZE[50],dark:ZE[400]}:{main:ZE[500],light:ZE[300],dark:ZE[700]}}(t),a=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:QE[500],light:QE[300],dark:QE[700]}:{main:QE[700],light:QE[400],dark:QE[800]}}(t),l=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:tS[400],light:tS[300],dark:tS[700]}:{main:tS[700],light:tS[500],dark:tS[900]}}(t),c=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:nS[400],light:nS[300],dark:nS[700]}:{main:nS[800],light:nS[500],dark:nS[900]}}(t),u=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:JE[400],light:JE[300],dark:JE[700]}:{main:"#ed6c02",light:JE[500],dark:JE[900]}}(t);function h(e){const t=function(e,t){const n=gv(e),r=gv(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,oS.text.primary)>=n?oS.text.primary:iS.text.primary;return t}const d=e=>{let{color:t,name:n,mainShade:i=500,lightShade:s=300,darkShade:o=700}=e;if(t={...t},!t.main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw new Error(lv(11,n?` (${n})`:"",i));if("string"!==typeof t.main)throw new Error(lv(12,n?` (${n})`:"",JSON.stringify(t.main)));return aS(t,"light",s,r),aS(t,"dark",o,r),t.contrastText||(t.contrastText=h(t.main)),t};let f;"light"===t?f=rS():"dark"===t&&(f=sS());return Iw({common:{...KE},mode:t,primary:d({color:s,name:"primary"}),secondary:d({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:d({color:a,name:"error"}),warning:d({color:u,name:"warning"}),info:d({color:l,name:"info"}),success:d({color:c,name:"success"}),grey:YE,contrastThreshold:n,getContrastText:h,augmentColor:d,tonalOffset:r,...f},i)}function cS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(!r.length)return"";const s=r[0];return"string"!==typeof s||s.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, ${s}`:`, var(--${e?`${e}-`:""}${s}${t(...r.slice(1))})`}return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return`var(--${e?`${e}-`:""}${n}${t(...i)})`}}function uS(e){const t={};return Object.entries(e).forEach((e=>{const[n,r]=e;"object"===typeof r&&(t[n]=`${r.fontStyle?`${r.fontStyle} `:""}${r.fontVariant?`${r.fontVariant} `:""}${r.fontWeight?`${r.fontWeight} `:""}${r.fontStretch?`${r.fontStretch} `:""}${r.fontSize||""}${r.lineHeight?`/${r.lineHeight} `:""}${r.fontFamily||""}`)})),t}const hS=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=e;t.forEach(((e,s)=>{s===t.length-1?Array.isArray(i)?i[Number(e)]=n:i&&"object"===typeof i&&(i[e]=n):i&&"object"===typeof i&&(i[e]||(i[e]=r.includes(e)?[]:{}),i=i[e])}))};function dS(e,t){const{prefix:n,shouldSkipGeneratingVar:r}=t||{},i={},s={},o={};var a,l;return a=(e,t,a)=>{if(("string"===typeof t||"number"===typeof t)&&(!r||!r(e,t))){const r=`--${n?`${n}-`:""}${e.join("-")}`,l=((e,t)=>"number"===typeof t?["lineHeight","fontWeight","opacity","zIndex"].some((t=>e.includes(t)))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t)(e,t);Object.assign(i,{[r]:l}),hS(s,e,`var(${r})`,a),hS(o,e,`var(${r}, ${l})`,a)}},l=e=>"vars"===e[0],function e(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object.entries(t).forEach((t=>{let[i,s]=t;(!l||l&&!l([...n,i]))&&void 0!==s&&null!==s&&("object"===typeof s&&Object.keys(s).length>0?e(s,[...n,i],Array.isArray(s)?[...r,i]:r):a([...n,i],s,r))}))}(e),{css:i,vars:s,varsWithDefaults:o}}const fS=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{getSelector:n=m,disableCssColorScheme:r,colorSchemeSelector:i}=t,{colorSchemes:s={},components:o,defaultColorScheme:a="light",...l}=e,{vars:c,css:u,varsWithDefaults:h}=dS(l,t);let d=h;const f={},{[a]:p,...g}=s;if(Object.entries(g||{}).forEach((e=>{let[n,r]=e;const{vars:i,css:s,varsWithDefaults:o}=dS(r,t);d=Iw(d,o),f[n]={css:s,vars:i}})),p){const{css:e,vars:n,varsWithDefaults:r}=dS(p,t);d=Iw(d,r),f[a]={css:e,vars:n}}function m(t,n){let r=i;if("class"===i&&(r=".%s"),"data"===i&&(r="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(r=`[${i}="%s"]`),t){if("media"===r){if(e.defaultColorScheme===t)return":root";const r=s[t]?.palette?.mode||t;return{[`@media (prefers-color-scheme: ${r})`]:{":root":n}}}if(r)return e.defaultColorScheme===t?`:root, ${r.replace("%s",String(t))}`:r.replace("%s",String(t))}return":root"}return{vars:d,generateThemeVars:()=>{let e={...c};return Object.entries(f).forEach((t=>{let[,{vars:n}]=t;e=Iw(e,n)})),e},generateStyleSheets:()=>{const t=[],i=e.defaultColorScheme||"light";function o(e,n){Object.keys(n).length&&t.push("string"===typeof e?{[e]:{...n}}:e)}o(n(void 0,{...u}),u);const{[i]:a,...l}=f;if(a){const{css:e}=a,t=s[i]?.palette?.mode,l=!r&&t?{colorScheme:t,...e}:{...e};o(n(i,{...l}),l)}return Object.entries(l).forEach((e=>{let[t,{css:i}]=e;const a=s[t]?.palette?.mode,l=!r&&a?{colorScheme:a,...i}:{...i};o(n(t,{...l}),l)})),t}}};function pS(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}const gS={textTransform:"uppercase"},mS='"Roboto", "Helvetica", "Arial", sans-serif';function _S(e,t){const{fontFamily:n=mS,fontSize:r=14,fontWeightLight:i=300,fontWeightRegular:s=400,fontWeightMedium:o=500,fontWeightBold:a=700,htmlFontSize:l=16,allVariants:c,pxToRem:u,...h}="function"===typeof t?t(e):t;const d=r/14,f=u||(e=>e/l*d+"rem"),p=(e,t,r,i,s)=>{return{fontFamily:n,fontWeight:e,fontSize:f(t),lineHeight:r,...n===mS?{letterSpacing:(o=i/t,Math.round(1e5*o)/1e5)+"em"}:{},...s,...c};var o},g={h1:p(i,96,1.167,-1.5),h2:p(i,60,1.2,-.5),h3:p(s,48,1.167,0),h4:p(s,34,1.235,.25),h5:p(s,24,1.334,0),h6:p(o,20,1.6,.15),subtitle1:p(s,16,1.75,.15),subtitle2:p(o,14,1.57,.1),body1:p(s,16,1.5,.15),body2:p(s,14,1.43,.15),button:p(o,14,1.75,.4,gS),caption:p(s,12,1.66,.4),overline:p(s,12,2.66,1,gS),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Iw({htmlFontSize:l,pxToRem:f,fontFamily:n,fontSize:r,fontWeightLight:i,fontWeightRegular:s,fontWeightMedium:o,fontWeightBold:a,...g},h,{clone:!1})}function yS(){return[`${arguments.length<=0?void 0:arguments[0]}px ${arguments.length<=1?void 0:arguments[1]}px ${arguments.length<=2?void 0:arguments[2]}px ${arguments.length<=3?void 0:arguments[3]}px rgba(0,0,0,0.2)`,`${arguments.length<=4?void 0:arguments[4]}px ${arguments.length<=5?void 0:arguments[5]}px ${arguments.length<=6?void 0:arguments[6]}px ${arguments.length<=7?void 0:arguments[7]}px rgba(0,0,0,0.14)`,`${arguments.length<=8?void 0:arguments[8]}px ${arguments.length<=9?void 0:arguments[9]}px ${arguments.length<=10?void 0:arguments[10]}px ${arguments.length<=11?void 0:arguments[11]}px rgba(0,0,0,0.12)`].join(",")}const vS=["none",yS(0,2,1,-1,0,1,1,0,0,1,3,0),yS(0,3,1,-2,0,2,2,0,0,1,5,0),yS(0,3,3,-2,0,3,4,0,0,1,8,0),yS(0,2,4,-1,0,4,5,0,0,1,10,0),yS(0,3,5,-1,0,5,8,0,0,1,14,0),yS(0,3,5,-1,0,6,10,0,0,1,18,0),yS(0,4,5,-2,0,7,10,1,0,2,16,1),yS(0,5,5,-3,0,8,10,1,0,3,14,2),yS(0,5,6,-3,0,9,12,1,0,3,16,2),yS(0,6,6,-3,0,10,14,1,0,4,18,3),yS(0,6,7,-4,0,11,15,1,0,4,20,3),yS(0,7,8,-4,0,12,17,2,0,5,22,4),yS(0,7,8,-4,0,13,19,2,0,5,24,4),yS(0,7,9,-4,0,14,21,2,0,5,26,4),yS(0,8,9,-5,0,15,22,2,0,6,28,5),yS(0,8,10,-5,0,16,24,2,0,6,30,5),yS(0,8,11,-5,0,17,26,2,0,6,32,5),yS(0,9,11,-5,0,18,28,2,0,7,34,6),yS(0,9,12,-6,0,19,29,2,0,7,36,6),yS(0,10,13,-6,0,20,31,3,0,8,38,7),yS(0,10,13,-6,0,21,33,3,0,8,40,7),yS(0,10,14,-6,0,22,35,3,0,8,42,7),yS(0,11,14,-7,0,23,36,3,0,9,44,8),yS(0,11,15,-7,0,24,38,3,0,9,46,8)],bS={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},wS={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function ES(e){return`${Math.round(e)}ms`}function SS(e){if(!e)return 0;const t=e/36;return Math.min(Math.round(10*(4+15*t**.25+t/5)),3e3)}function xS(e){const t={...bS,...e.easing},n={...wS,...e.duration};return{getAutoHeightDuration:SS,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:i=n.standard,easing:s=t.easeInOut,delay:o=0,...a}=r;return(Array.isArray(e)?e:[e]).map((e=>`${e} ${"string"===typeof i?i:ES(i)} ${s} ${"string"===typeof o?o:ES(o)}`)).join(",")},...e,easing:t,duration:n}}const TS={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function AS(){const e={...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};return function e(t){const n=Object.entries(t);for(let i=0;i<n.length;i++){const[s,o]=n[i];!Mw(r=o)&&"undefined"!==typeof r&&"string"!==typeof r&&"boolean"!==typeof r&&"number"!==typeof r&&!Array.isArray(r)||s.startsWith("unstable_")?delete t[s]:Mw(o)&&(t[s]={...o},e(t[s]))}var r}(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ${JSON.stringify(e,null,2)};\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;`}function CS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t,mixins:n={},spacing:r,palette:i={},transitions:s={},typography:o={},shape:a,...l}=e;if(e.vars&&void 0===e.generateThemeVars)throw new Error(lv(20));const c=lS(i),u=zE(e);let h=Iw(u,{mixins:pS(u.breakpoints,n),palette:c,shadows:vS.slice(),typography:_S(c,o),transitions:xS(s),zIndex:{...TS}});h=Iw(h,l);for(var d=arguments.length,f=new Array(d>1?d-1:0),p=1;p<d;p++)f[p-1]=arguments[p];return h=f.reduce(((e,t)=>Iw(e,t)),h),h.unstable_sxConfig={...FE,...l?.unstable_sxConfig},h.unstable_sx=function(e){return BE({sx:e,theme:this})},h.toRuntimeSource=AS,h}const RS=CS;const PS=[...Array(25)].map(((e,t)=>{if(0===t)return"none";const n=function(e){let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,Math.round(10*t)/1e3}(t);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`}));function kS(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function MS(e){return"dark"===e?PS:[]}function LS(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const IS=e=>[...[...Array(25)].map(((t,n)=>`--${e?`${e}-`:""}overlays-${n}`)),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],OS=e=>(t,n)=>{const r=e.rootSelector||":root",i=e.colorSchemeSelector;let s=i;if("class"===i&&(s=".%s"),"data"===i&&(s="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(s=`[${i}="%s"]`),e.defaultColorScheme===t){if("dark"===t){const i={};return IS(e.cssVarPrefix).forEach((e=>{i[e]=n[e],delete n[e]})),"media"===s?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:i}}:s?{[s.replace("%s",t)]:i,[`${r}, ${s.replace("%s",t)}`]:n}:{[r]:{...n,...i}}}if(s&&"media"!==s)return`${r}, ${s.replace("%s",String(t))}`}else if(t){if("media"===s)return{[`@media (prefers-color-scheme: ${String(t)})`]:{[r]:n}};if(s)return s.replace("%s",String(t))}return r};function NS(e,t,n){!e[t]&&n&&(e[t]=n)}function FS(e){return"string"===typeof e&&e.startsWith("hsl")?pv(e):e}function DS(e,t){`${t}Channel`in e||(e[`${t}Channel`]=dv(FS(e[t])))}const BS=e=>{try{return e()}catch(t){}};function US(e,t,n,r){if(!t)return;t=!0===t?{}:t;const i="dark"===r?"dark":"light";if(!n)return void(e[r]=function(e){const{palette:t={mode:"light"},opacity:n,overlays:r,...i}=e,s=lS(t);return{palette:s,opacity:{...kS(s.mode),...n},overlays:r||MS(s.mode),...i}}({...t,palette:{mode:i,...t?.palette}}));const{palette:s,...o}=RS({...n,palette:{mode:i,...t?.palette}});return e[r]={...t,palette:s,opacity:{...kS(i),...t?.opacity},overlays:t?.overlays||MS(i)},o}function zS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{colorSchemes:t={light:!0},defaultColorScheme:n,disableCssColorScheme:r=!1,cssVarPrefix:i="mui",shouldSkipGeneratingVar:s=LS,colorSchemeSelector:o=(t.light&&t.dark?"media":void 0),rootSelector:a=":root",...l}=e,c=Object.keys(t)[0],u=n||(t.light&&"light"!==c?"light":c),h=function(){return cS(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mui")}(i),{[u]:d,light:f,dark:p,...g}=t,m={...g};let _=d;if(("dark"===u&&!("dark"in t)||"light"===u&&!("light"in t))&&(_=!0),!_)throw new Error(lv(21,u));const y=US(m,_,l,u);f&&!m.light&&US(m,f,void 0,"light"),p&&!m.dark&&US(m,p,void 0,"dark");let v={defaultColorScheme:u,...y,cssVarPrefix:i,colorSchemeSelector:o,rootSelector:a,getCssVar:h,colorSchemes:m,font:{...uS(y.typography),...y.font},spacing:(b=l.spacing,"number"===typeof b?`${b}px`:"string"===typeof b||"function"===typeof b||Array.isArray(b)?b:"8px")};var b;Object.keys(v.colorSchemes).forEach((e=>{const t=v.colorSchemes[e].palette,n=e=>{const n=e.split("-"),r=n[1],i=n[2];return h(e,t[r][i])};var r;if("light"===t.mode&&(NS(t.common,"background","#fff"),NS(t.common,"onBackground","#000")),"dark"===t.mode&&(NS(t.common,"background","#000"),NS(t.common,"onBackground","#fff")),r=t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"].forEach((e=>{r[e]||(r[e]={})})),"light"===t.mode){NS(t.Alert,"errorColor",vv(t.error.light,.6)),NS(t.Alert,"infoColor",vv(t.info.light,.6)),NS(t.Alert,"successColor",vv(t.success.light,.6)),NS(t.Alert,"warningColor",vv(t.warning.light,.6)),NS(t.Alert,"errorFilledBg",n("palette-error-main")),NS(t.Alert,"infoFilledBg",n("palette-info-main")),NS(t.Alert,"successFilledBg",n("palette-success-main")),NS(t.Alert,"warningFilledBg",n("palette-warning-main")),NS(t.Alert,"errorFilledColor",BS((()=>t.getContrastText(t.error.main)))),NS(t.Alert,"infoFilledColor",BS((()=>t.getContrastText(t.info.main)))),NS(t.Alert,"successFilledColor",BS((()=>t.getContrastText(t.success.main)))),NS(t.Alert,"warningFilledColor",BS((()=>t.getContrastText(t.warning.main)))),NS(t.Alert,"errorStandardBg",wv(t.error.light,.9)),NS(t.Alert,"infoStandardBg",wv(t.info.light,.9)),NS(t.Alert,"successStandardBg",wv(t.success.light,.9)),NS(t.Alert,"warningStandardBg",wv(t.warning.light,.9)),NS(t.Alert,"errorIconColor",n("palette-error-main")),NS(t.Alert,"infoIconColor",n("palette-info-main")),NS(t.Alert,"successIconColor",n("palette-success-main")),NS(t.Alert,"warningIconColor",n("palette-warning-main")),NS(t.AppBar,"defaultBg",n("palette-grey-100")),NS(t.Avatar,"defaultBg",n("palette-grey-400")),NS(t.Button,"inheritContainedBg",n("palette-grey-300")),NS(t.Button,"inheritContainedHoverBg",n("palette-grey-A100")),NS(t.Chip,"defaultBorder",n("palette-grey-400")),NS(t.Chip,"defaultAvatarColor",n("palette-grey-700")),NS(t.Chip,"defaultIconColor",n("palette-grey-700")),NS(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),NS(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),NS(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),NS(t.LinearProgress,"primaryBg",wv(t.primary.main,.62)),NS(t.LinearProgress,"secondaryBg",wv(t.secondary.main,.62)),NS(t.LinearProgress,"errorBg",wv(t.error.main,.62)),NS(t.LinearProgress,"infoBg",wv(t.info.main,.62)),NS(t.LinearProgress,"successBg",wv(t.success.main,.62)),NS(t.LinearProgress,"warningBg",wv(t.warning.main,.62)),NS(t.Skeleton,"bg",`rgba(${n("palette-text-primaryChannel")} / 0.11)`),NS(t.Slider,"primaryTrack",wv(t.primary.main,.62)),NS(t.Slider,"secondaryTrack",wv(t.secondary.main,.62)),NS(t.Slider,"errorTrack",wv(t.error.main,.62)),NS(t.Slider,"infoTrack",wv(t.info.main,.62)),NS(t.Slider,"successTrack",wv(t.success.main,.62)),NS(t.Slider,"warningTrack",wv(t.warning.main,.62));const e=Ev(t.background.default,.8);NS(t.SnackbarContent,"bg",e),NS(t.SnackbarContent,"color",BS((()=>t.getContrastText(e)))),NS(t.SpeedDialAction,"fabHoverBg",Ev(t.background.paper,.15)),NS(t.StepConnector,"border",n("palette-grey-400")),NS(t.StepContent,"border",n("palette-grey-400")),NS(t.Switch,"defaultColor",n("palette-common-white")),NS(t.Switch,"defaultDisabledColor",n("palette-grey-100")),NS(t.Switch,"primaryDisabledColor",wv(t.primary.main,.62)),NS(t.Switch,"secondaryDisabledColor",wv(t.secondary.main,.62)),NS(t.Switch,"errorDisabledColor",wv(t.error.main,.62)),NS(t.Switch,"infoDisabledColor",wv(t.info.main,.62)),NS(t.Switch,"successDisabledColor",wv(t.success.main,.62)),NS(t.Switch,"warningDisabledColor",wv(t.warning.main,.62)),NS(t.TableCell,"border",wv(_v(t.divider,1),.88)),NS(t.Tooltip,"bg",_v(t.grey[700],.92))}if("dark"===t.mode){NS(t.Alert,"errorColor",wv(t.error.light,.6)),NS(t.Alert,"infoColor",wv(t.info.light,.6)),NS(t.Alert,"successColor",wv(t.success.light,.6)),NS(t.Alert,"warningColor",wv(t.warning.light,.6)),NS(t.Alert,"errorFilledBg",n("palette-error-dark")),NS(t.Alert,"infoFilledBg",n("palette-info-dark")),NS(t.Alert,"successFilledBg",n("palette-success-dark")),NS(t.Alert,"warningFilledBg",n("palette-warning-dark")),NS(t.Alert,"errorFilledColor",BS((()=>t.getContrastText(t.error.dark)))),NS(t.Alert,"infoFilledColor",BS((()=>t.getContrastText(t.info.dark)))),NS(t.Alert,"successFilledColor",BS((()=>t.getContrastText(t.success.dark)))),NS(t.Alert,"warningFilledColor",BS((()=>t.getContrastText(t.warning.dark)))),NS(t.Alert,"errorStandardBg",vv(t.error.light,.9)),NS(t.Alert,"infoStandardBg",vv(t.info.light,.9)),NS(t.Alert,"successStandardBg",vv(t.success.light,.9)),NS(t.Alert,"warningStandardBg",vv(t.warning.light,.9)),NS(t.Alert,"errorIconColor",n("palette-error-main")),NS(t.Alert,"infoIconColor",n("palette-info-main")),NS(t.Alert,"successIconColor",n("palette-success-main")),NS(t.Alert,"warningIconColor",n("palette-warning-main")),NS(t.AppBar,"defaultBg",n("palette-grey-900")),NS(t.AppBar,"darkBg",n("palette-background-paper")),NS(t.AppBar,"darkColor",n("palette-text-primary")),NS(t.Avatar,"defaultBg",n("palette-grey-600")),NS(t.Button,"inheritContainedBg",n("palette-grey-800")),NS(t.Button,"inheritContainedHoverBg",n("palette-grey-700")),NS(t.Chip,"defaultBorder",n("palette-grey-700")),NS(t.Chip,"defaultAvatarColor",n("palette-grey-300")),NS(t.Chip,"defaultIconColor",n("palette-grey-300")),NS(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),NS(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),NS(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),NS(t.LinearProgress,"primaryBg",vv(t.primary.main,.5)),NS(t.LinearProgress,"secondaryBg",vv(t.secondary.main,.5)),NS(t.LinearProgress,"errorBg",vv(t.error.main,.5)),NS(t.LinearProgress,"infoBg",vv(t.info.main,.5)),NS(t.LinearProgress,"successBg",vv(t.success.main,.5)),NS(t.LinearProgress,"warningBg",vv(t.warning.main,.5)),NS(t.Skeleton,"bg",`rgba(${n("palette-text-primaryChannel")} / 0.13)`),NS(t.Slider,"primaryTrack",vv(t.primary.main,.5)),NS(t.Slider,"secondaryTrack",vv(t.secondary.main,.5)),NS(t.Slider,"errorTrack",vv(t.error.main,.5)),NS(t.Slider,"infoTrack",vv(t.info.main,.5)),NS(t.Slider,"successTrack",vv(t.success.main,.5)),NS(t.Slider,"warningTrack",vv(t.warning.main,.5));const e=Ev(t.background.default,.98);NS(t.SnackbarContent,"bg",e),NS(t.SnackbarContent,"color",BS((()=>t.getContrastText(e)))),NS(t.SpeedDialAction,"fabHoverBg",Ev(t.background.paper,.15)),NS(t.StepConnector,"border",n("palette-grey-600")),NS(t.StepContent,"border",n("palette-grey-600")),NS(t.Switch,"defaultColor",n("palette-grey-300")),NS(t.Switch,"defaultDisabledColor",n("palette-grey-600")),NS(t.Switch,"primaryDisabledColor",vv(t.primary.main,.55)),NS(t.Switch,"secondaryDisabledColor",vv(t.secondary.main,.55)),NS(t.Switch,"errorDisabledColor",vv(t.error.main,.55)),NS(t.Switch,"infoDisabledColor",vv(t.info.main,.55)),NS(t.Switch,"successDisabledColor",vv(t.success.main,.55)),NS(t.Switch,"warningDisabledColor",vv(t.warning.main,.55)),NS(t.TableCell,"border",vv(_v(t.divider,1),.68)),NS(t.Tooltip,"bg",_v(t.grey[700],.92))}DS(t.background,"default"),DS(t.background,"paper"),DS(t.common,"background"),DS(t.common,"onBackground"),DS(t,"divider"),Object.keys(t).forEach((e=>{const n=t[e];"tonalOffset"!==e&&n&&"object"===typeof n&&(n.main&&NS(t[e],"mainChannel",dv(FS(n.main))),n.light&&NS(t[e],"lightChannel",dv(FS(n.light))),n.dark&&NS(t[e],"darkChannel",dv(FS(n.dark))),n.contrastText&&NS(t[e],"contrastTextChannel",dv(FS(n.contrastText))),"text"===e&&(DS(t[e],"primary"),DS(t[e],"secondary")),"action"===e&&(n.active&&DS(t[e],"active"),n.selected&&DS(t[e],"selected")))}))}));for(var w=arguments.length,E=new Array(w>1?w-1:0),S=1;S<w;S++)E[S-1]=arguments[S];v=E.reduce(((e,t)=>Iw(e,t)),v);const x={prefix:i,disableCssColorScheme:r,shouldSkipGeneratingVar:s,getSelector:OS(v)},{vars:T,generateThemeVars:A,generateStyleSheets:C}=fS(v,x);return v.vars=T,Object.entries(v.colorSchemes[v.defaultColorScheme]).forEach((e=>{let[t,n]=e;v[t]=n})),v.generateThemeVars=A,v.generateStyleSheets=C,v.generateSpacing=function(){return lE(l.spacing,tE(this))},v.getColorSchemeSelector=function(e){return function(t){return"media"===e?`@media (prefers-color-scheme: ${t})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${t}"] &`:"class"===e?`.${t} &`:"data"===e?`[data-${t}] &`:`${e.replace("%s",t)} &`:"&"}}(o),v.spacing=v.generateSpacing(),v.shouldSkipGeneratingVar=s,v.unstable_sxConfig={...FE,...l?.unstable_sxConfig},v.unstable_sx=function(e){return BE({sx:e,theme:this})},v.toRuntimeSource=AS,v}function GS(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]={...!0!==n&&n,palette:lS({...!0===n?{}:n.palette,mode:t})})}const VS=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{palette:t,cssVariables:n=!1,colorSchemes:r=(t?void 0:{light:!0}),defaultColorScheme:i=t?.mode,...s}=e,o=i||"light",a=r?.[o],l={...r,...t?{[o]:{..."boolean"!==typeof a&&a,palette:t}}:void 0};for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];if(!1===n){if(!("colorSchemes"in e))return RS(e,...u);let n=t;"palette"in e||l[o]&&(!0!==l[o]?n=l[o].palette:"dark"===o&&(n={mode:"dark"}));const r=RS({...e,palette:n},...u);return r.defaultColorScheme=o,r.colorSchemes=l,"light"===r.palette.mode&&(r.colorSchemes.light={...!0!==l.light&&l.light,palette:r.palette},GS(r,"dark",l.dark)),"dark"===r.palette.mode&&(r.colorSchemes.dark={...!0!==l.dark&&l.dark,palette:r.palette},GS(r,"light",l.light)),r}return t||"light"in l||"light"!==o||(l.light=!0),zS({...s,colorSchemes:l,defaultColorScheme:o,..."boolean"!==typeof n&&n},...u)}();const jS=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e},WS=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=VE,rootShouldForwardProp:r=jE,slotShouldForwardProp:i=jE}=e;function s(e){!function(e,t,n){e.theme=function(e){for(const t in e)return!1;return!0}(e.theme)?n:e.theme[t]||e.theme}(e,t,n)}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}(e,(e=>e.filter((e=>e!==BE))));const{name:n,slot:o,skipVariantsResolver:a,skipSx:l,overridesResolver:c=WE(qE(o)),...u}=t,h=void 0!==a?a:o&&"Root"!==o&&"root"!==o||!1,d=l||!1;let f=jE;"Root"===o||"root"===o?f=r:o?f=i:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(f=void 0);const p=function(e,t){return Cw(e,t)}(e,{shouldForwardProp:f,label:XE(n,o),...u}),g=e=>{if("function"===typeof e&&e.__emotion_real!==e)return function(t){return $E(t,e)};if(Mw(e)){const t=GE(e);return t.variants?function(e){return $E(e,t)}:t.style}return e},m=function(){const t=[];for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];const a=i.map(g),l=[];if(t.push(s),n&&c&&l.push((function(e){const t=e.theme,r=t.components?.[n]?.styleOverrides;if(!r)return null;const i={};for(const n in r)i[n]=$E(e,r[n]);return c(e,i)})),n&&!h&&l.push((function(e){const t=e.theme,r=t?.components?.[n]?.variants;return r?HE(e,r):null})),d||l.push(BE),Array.isArray(a[0])){const e=a.shift(),n=new Array(t.length).fill(""),r=new Array(l.length).fill("");let i;i=[...n,...e,...r],i.raw=[...n,...e.raw,...r],t.unshift(i)}const u=[...t,...a,...l],f=p(...u);return e.muiName&&(f.muiName=e.muiName),f};return p.withConfig&&(m.withConfig=p.withConfig),m}}({themeId:"$$material",defaultTheme:VS,rootShouldForwardProp:e=>jS(e)&&"classes"!==e}),$S=WS,HS={theme:void 0};const XS=function(e){let t,n;return function(r){let i=t;return void 0!==i&&r.theme===n||(HS.theme=r.theme,i=GE(e(HS)),t=i,n=r.theme),i}};function qS(e,t){const n={...t};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const i=r;if("components"===i||"slots"===i)n[i]={...e[i],...n[i]};else if("componentsProps"===i||"slotProps"===i){const r=e[i],s=t[i];if(s)if(r){n[i]={...s};for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)){const t=e;n[i][t]=qS(r[t],s[t])}}else n[i]=s;else n[i]=r||{}}else void 0===n[i]&&(n[i]=e[i])}return n}const KS=r.createContext(void 0);function YS(e){let{props:t,name:n}=e;return function(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const i=t.components[n];return i.defaultProps?qS(i.defaultProps,r):i.styleOverrides||i.variants?r:qS(i,r)}({props:t,name:n,theme:{components:r.useContext(KS)}})}const ZS=e=>!e||!Jv(e),QS=Vw;function JS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t=>{let[,n]=t;return n&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!function(e){return"string"===typeof e.main}(e))return!1;for(const n of t)if(!e.hasOwnProperty(n)||"string"!==typeof e[n])return!1;return!0}(n,e)}}const ex=e=>e,tx=(()=>{let e=ex;return{configure(t){e=t},generate:t=>e(t),reset(){e=ex}}})(),nx={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function rx(e,t){const n=nx[t];return n?`${arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui"}-${n}`:`${tx.generate(e)}-${t}`}function ix(e){return rx("MuiSlider",e)}const sx=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const r={};return t.forEach((t=>{r[t]=rx(e,t,n)})),r}("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]);function ox(e){return e}const ax=$S("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`color${QS(n.color)}`],"medium"!==n.size&&t[`size${QS(n.size)}`],n.marked&&t.marked,"vertical"===n.orientation&&t.vertical,"inverted"===n.track&&t.trackInverted,!1===n.track&&t.trackFalse]}})(XS((e=>{let{theme:t}=e;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${sx.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${sx.dragging}`]:{[`& .${sx.thumb}, & .${sx.track}`]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(JS()).map((e=>{let[n]=e;return{props:{color:n},style:{color:(t.vars||t).palette[n].main}}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}}))),lx=$S("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(e,t)=>t.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),cx=$S("span",{name:"MuiSlider",slot:"Track",overridesResolver:(e,t)=>t.track})(XS((e=>{let{theme:t}=e;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(JS()).map((e=>{let[n]=e;return{props:{color:n,track:"inverted"},style:{...t.vars?{backgroundColor:t.vars.palette.Slider[`${n}Track`],borderColor:t.vars.palette.Slider[`${n}Track`]}:{backgroundColor:bv(t.palette[n].main,.62),borderColor:bv(t.palette[n].main,.62),...t.applyStyles("dark",{backgroundColor:yv(t.palette[n].main,.5)}),...t.applyStyles("dark",{borderColor:yv(t.palette[n].main,.5)})}}}}))]}}))),ux=$S("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.thumb,t[`thumbColor${QS(n.color)}`],"medium"!==n.size&&t[`thumbSize${QS(n.size)}`]]}})(XS((e=>{let{theme:t}=e;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${sx.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(JS()).map((e=>{let[n]=e;return{props:{color:n},style:{[`&:hover, &.${sx.focusVisible}`]:{...t.vars?{boxShadow:`0px 0px 0px 8px rgba(${t.vars.palette[n].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${mv(t.palette[n].main,.16)}`},"@media (hover: none)":{boxShadow:"none"}},[`&.${sx.active}`]:{...t.vars?{boxShadow:`0px 0px 0px 14px rgba(${t.vars.palette[n].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${mv(t.palette[n].main,.16)}`}}}}}))]}}))),hx=$S((function(e){const{children:t,className:n,value:i}=e,s=(e=>{const{open:t}=e;return{offset:av(t&&sx.valueLabelOpen),circle:sx.valueLabelCircle,label:sx.valueLabelLabel}})(e);return t?r.cloneElement(t,{className:av(t.props.className)},(0,Sv.jsxs)(r.Fragment,{children:[t.props.children,(0,Sv.jsx)("span",{className:av(s.offset,n),"aria-hidden":!0,children:(0,Sv.jsx)("span",{className:s.circle,children:(0,Sv.jsx)("span",{className:s.label,children:i})})})]})):null}),{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(e,t)=>t.valueLabel})(XS((e=>{let{theme:t}=e;return{zIndex:1,whiteSpace:"nowrap",...t.typography.body2,fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${sx.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${sx.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}}))),dx=$S("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>jS(e)&&"markActive"!==e,overridesResolver:(e,t)=>{const{markActive:n}=e;return[t.mark,n&&t.markActive]}})(XS((e=>{let{theme:t}=e;return{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}}))),fx=$S("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>jS(e)&&"markLabelActive"!==e,overridesResolver:(e,t)=>t.markLabel})(XS((e=>{let{theme:t}=e;return{...t.typography.body2,color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]}}))),px=e=>{let{children:t}=e;return t},gx=r.forwardRef((function(e,t){const n=YS({props:e,name:"MuiSlider"});const i=r.useContext(xv)??!1,{"aria-label":s,"aria-valuetext":o,"aria-labelledby":a,component:l="span",components:c={},componentsProps:u={},color:h="primary",classes:d,className:f,disableSwap:p=!1,disabled:g=!1,getAriaLabel:m,getAriaValueText:_,marks:y=!1,max:v=100,min:b=0,name:w,onChange:E,onChangeCommitted:S,orientation:x="horizontal",shiftStep:T=10,size:A="medium",step:C=1,scale:R=ox,slotProps:P,slots:k,tabIndex:M,track:L="normal",value:I,valueLabelDisplay:O="off",valueLabelFormat:N=ox,...F}=n,D={...n,isRtl:i,max:v,min:b,classes:d,disabled:g,disableSwap:p,orientation:x,marks:y,color:h,size:A,step:C,shiftStep:T,scale:R,track:L,valueLabelDisplay:O,valueLabelFormat:N},{axisProps:B,getRootProps:U,getHiddenInputProps:z,getThumbProps:G,open:V,active:j,axis:W,focusedThumbIndex:$,range:H,dragging:X,marks:q,values:K,trackOffset:Y,trackLeap:Z,getThumbStyle:Q}=Qv({...D,rootRef:t});D.marked=q.length>0&&q.some((e=>e.label)),D.dragging=X,D.focusedThumbIndex=$;const J=(e=>{const{disabled:t,dragging:n,marked:r,orientation:i,track:s,classes:o,color:a,size:l}=e;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r={};for(const i in e){const s=e[i];let o="",a=!0;for(let e=0;e<s.length;e+=1){const r=s[e];r&&(o+=(!0===a?"":" ")+t(r),a=!1,n&&n[r]&&(o+=" "+n[r]))}r[i]=o}return r}({root:["root",t&&"disabled",n&&"dragging",r&&"marked","vertical"===i&&"vertical","inverted"===s&&"trackInverted",!1===s&&"trackFalse",a&&`color${QS(a)}`,l&&`size${QS(l)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",l&&`thumbSize${QS(l)}`,a&&`thumbColor${QS(a)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]},ix,o)})(D),ee=k?.root??c.Root??ax,te=k?.rail??c.Rail??lx,ne=k?.track??c.Track??cx,re=k?.thumb??c.Thumb??ux,ie=k?.valueLabel??c.ValueLabel??hx,se=k?.mark??c.Mark??dx,oe=k?.markLabel??c.MarkLabel??fx,ae=k?.input??c.Input??"input",le=P?.root??u.root,ce=P?.rail??u.rail,ue=P?.track??u.track,he=P?.thumb??u.thumb,de=P?.valueLabel??u.valueLabel,fe=P?.mark??u.mark,pe=P?.markLabel??u.markLabel,ge=P?.input??u.input,me=Lv({elementType:ee,getSlotProps:U,externalSlotProps:le,externalForwardedProps:F,additionalProps:{...ZS(ee)&&{as:l}},ownerState:{...D,...le?.ownerState},className:[J.root,f]}),_e=Lv({elementType:te,externalSlotProps:ce,ownerState:D,className:J.rail}),ye=Lv({elementType:ne,externalSlotProps:ue,additionalProps:{style:{...B[W].offset(Y),...B[W].leap(Z)}},ownerState:{...D,...ue?.ownerState},className:J.track}),ve=Lv({elementType:re,getSlotProps:G,externalSlotProps:he,ownerState:{...D,...he?.ownerState},className:J.thumb}),be=Lv({elementType:ie,externalSlotProps:de,ownerState:{...D,...de?.ownerState},className:J.valueLabel}),we=Lv({elementType:se,externalSlotProps:fe,ownerState:D,className:J.mark}),Ee=Lv({elementType:oe,externalSlotProps:pe,ownerState:D,className:J.markLabel}),Se=Lv({elementType:ae,getSlotProps:z,externalSlotProps:ge,ownerState:D});return(0,Sv.jsxs)(ee,{...me,children:[(0,Sv.jsx)(te,{..._e}),(0,Sv.jsx)(ne,{...ye}),q.filter((e=>e.value>=b&&e.value<=v)).map(((e,t)=>{const n=jv(e.value,b,v),i=B[W].offset(n);let s;return s=!1===L?K.includes(e.value):"normal"===L&&(H?e.value>=K[0]&&e.value<=K[K.length-1]:e.value<=K[0])||"inverted"===L&&(H?e.value<=K[0]||e.value>=K[K.length-1]:e.value>=K[0]),(0,Sv.jsxs)(r.Fragment,{children:[(0,Sv.jsx)(se,{"data-index":t,...we,...!Jv(se)&&{markActive:s},style:{...i,...we.style},className:av(we.className,s&&J.markActive)}),null!=e.label?(0,Sv.jsx)(oe,{"aria-hidden":!0,"data-index":t,...Ee,...!Jv(oe)&&{markLabelActive:s},style:{...i,...Ee.style},className:av(J.markLabel,Ee.className,s&&J.markLabelActive),children:e.label}):null]},t)})),K.map(((e,t)=>{const n=jv(e,b,v),r=B[W].offset(n),i="off"===O?px:ie;return(0,Sv.jsx)(i,{...!Jv(i)&&{valueLabelFormat:N,valueLabelDisplay:O,value:"function"===typeof N?N(R(e),t):N,index:t,open:V===t||j===t||"on"===O,disabled:g},...be,children:(0,Sv.jsx)(re,{"data-index":t,...ve,className:av(J.thumb,ve.className,j===t&&J.active,$===t&&J.focusVisible),style:{...r,...Q(t),...ve.style},children:(0,Sv.jsx)(ae,{"data-index":t,"aria-label":m?m(t):s,"aria-valuenow":R(e),"aria-labelledby":a,"aria-valuetext":_?_(R(e),t):o,value:K[t],...Se})})},t)}))]})})),mx=gx,_x={latitude:36.28,longitude:-89.42,zoom:5,minZoom:3,maxZoom:12,pitch:0,bearing:0};function yx(e,t,n){const r=2*Math.random()*Math.PI,i=Math.random()*n;return[e+i*Math.cos(r),t+i*Math.sin(r)]}function vx(){const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)([]),[s,o]=(0,r.useState)(0),[a,l]=(0,r.useState)(!1),c=(0,r.useRef)(null);(0,r.useEffect)((()=>{let e=!0;return fetch("/DuckData-WebApp/WaterdowlData1.csv").then((e=>e.text())).then((n=>{if(!e)return;const r=n.trim().split("\n"),s=r[0].split(","),o=s.indexOf("timestamp"),a=s.indexOf("duck_id"),l=s.indexOf("lat"),c=s.indexOf("lon"),u=r.slice(1).map((e=>{const t=e.split(",");return{timestamp:t[o],duckId:t[a],lat:parseFloat(t[l]),lon:parseFloat(t[c])}}));t(u);let h=Array.from(new Set(u.map((e=>e.timestamp))));h.sort(((e,t)=>new Date(e)-new Date(t))),i(h)})).catch((e=>console.error("Error fetching CSV:",e))),()=>{e=!1}}),[]),(0,r.useEffect)((()=>{let e;return a&&n.length>0&&(e=setInterval((()=>{o((e=>e===n.length-1?0:e+1))}),1e3)),()=>{e&&clearInterval(e)}}),[a,n]);const u=n[s]||null,h=e.filter((e=>e.timestamp===u)),d=n[s+1]||null,f=e.filter((e=>e.timestamp===d));const p=h.filter((function(e){return!d||!f.some((t=>t.duckId===e.duckId&&t.lat===e.lat&&t.lon===e.lon))})),g=f,m=p.flatMap((e=>{const t=[];for(let n=0;n<20;n++)t.push({...e,jitteredPosition:yx(e.lon,e.lat,.3)});return t})),_=g.flatMap((e=>{const t=[];for(let n=0;n<20;n++)t.push({...e,jitteredPosition:yx(e.lon,e.lat,.3)});return t})),y=[new Ky({id:"osm-tiles",data:"https://a.tile.openstreetmap.org/{z}/{x}/{y}.png",minZoom:3,maxZoom:12,tileSize:256,renderSubLayers:e=>{const{bbox:{west:t,south:n,east:r,north:i}}=e.tile;return new iv(e,{data:null,image:e.data,bounds:[t,n,r,i]})}}),new $p({id:"leaving-scatter-layer",data:m,pickable:!0,getPosition:e=>e.jitteredPosition,getFillColor:()=>[0,0,255,150],radiusMinPixels:2,radiusMaxPixels:2}),new $p({id:"nexttime-scatter-layer",data:_,pickable:!0,getPosition:e=>e.jitteredPosition,getFillColor:()=>[255,165,0,150],radiusMinPixels:2,radiusMaxPixels:2})];return(0,Sv.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},children:[(0,Sv.jsx)(vp,{ref:c,initialViewState:_x,controller:!0,layers:y,style:{width:"100%",height:"100%"}}),(0,Sv.jsxs)("div",{style:{position:"absolute",bottom:20,left:20,width:"350px",background:"rgba(255,255,255,0.8)",padding:"10px",borderRadius:"8px",zIndex:999},children:[(0,Sv.jsx)(mx,{min:0,max:n.length-1,value:s,onChange:(e,t)=>o(t),step:1,valueLabelDisplay:"auto",valueLabelFormat:e=>n[e]||""}),(0,Sv.jsxs)("div",{style:{marginBottom:"8px"},children:["Current Time: ",(0,Sv.jsx)("strong",{children:u||"Loading..."})]}),(0,Sv.jsx)("button",{onClick:()=>l((e=>!e)),style:{cursor:"pointer"},children:a?"Pause":"Play"})]})]})}const bx=e=>{e&&e instanceof Function&&n.e(685).then(n.bind(n,685)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)}))};s.createRoot(document.getElementById("root")).render((0,Sv.jsx)(vx,{})),bx()})();